2025-05-19 23:17:56,998 - INFO - [__main__] - === Starting New Inference Session ===
2025-05-19 23:17:57,000 - INFO - [__main__] - Loading metrics from: metrics/test\20250519_230738\all_metrics_summary.csv
2025-05-19 23:17:57,029 - INFO - [__main__] - Best model for AAA: svm (F1: 0.5263)
2025-05-19 23:17:57,030 - INFO - [__main__] - Best model for AAM: transformer (F1: 0.5366)
2025-05-19 23:17:57,031 - INFO - [__main__] - Best model for ABI: svm (F1: 0.6462)
2025-05-19 23:17:57,031 - INFO - [__main__] - Best model for ABT: svm (F1: 0.6207)
2025-05-19 23:17:57,032 - INFO - [__main__] - Best model for ACB: svm (F1: 0.6545)
2025-05-19 23:17:57,033 - INFO - [__main__] - Best model for ACC: logistic_regression (F1: 0.6885)
2025-05-19 23:17:57,033 - INFO - [__main__] - Best model for ACE: svm (F1: 0.6462)
2025-05-19 23:17:57,034 - INFO - [__main__] - Best model for ACL: logistic_regression (F1: 0.4828)
2025-05-19 23:17:57,034 - INFO - [__main__] - Best model for ADC: svm (F1: 0.7059)
2025-05-19 23:17:57,035 - INFO - [__main__] - Best model for ADP: svm (F1: 0.7778)
2025-05-19 23:17:57,035 - INFO - [__main__] - Best model for AGF: lstm (F1: 0.7778)
2025-05-19 23:17:57,036 - INFO - [__main__] - Best model for AGM: transformer (F1: 0.4286)
2025-05-19 23:17:57,036 - INFO - [__main__] - Best model for AGR: svm (F1: 0.3333)
2025-05-19 23:17:57,037 - INFO - [__main__] - Best model for ALT: svm (F1: 0.6667)
2025-05-19 23:17:57,038 - INFO - [__main__] - Best model for ALV: svm (F1: 0.3571)
2025-05-19 23:17:57,039 - INFO - [__main__] - Best model for AMC: svm (F1: 0.7246)
2025-05-19 23:17:57,039 - INFO - [__main__] - Best model for AME: lstm (F1: 0.7097)
2025-05-19 23:17:57,040 - INFO - [__main__] - Best model for AMV: lstm (F1: 0.7945)
2025-05-19 23:17:57,040 - INFO - [__main__] - Best model for ANV: svm (F1: 0.6667)
2025-05-19 23:17:57,041 - INFO - [__main__] - Best model for APC: svm (F1: 0.2667)
2025-05-19 23:17:57,042 - INFO - [__main__] - Best model for APG: logistic_regression (F1: 0.5263)
2025-05-19 23:17:57,042 - INFO - [__main__] - Best model for API: svm (F1: 0.6032)
2025-05-19 23:17:57,043 - INFO - [__main__] - Best model for APP: svm (F1: 0.6667)
2025-05-19 23:17:57,043 - INFO - [__main__] - Best model for APS: svm (F1: 0.5306)
2025-05-19 23:17:57,043 - INFO - [__main__] - Best model for ARM: lstm (F1: 0.7945)
2025-05-19 23:17:57,044 - INFO - [__main__] - Best model for ASA: lstm (F1: 0.9885)
2025-05-19 23:17:57,045 - INFO - [__main__] - Best model for ASM: svm (F1: 0.5660)
2025-05-19 23:17:57,045 - INFO - [__main__] - Best model for ASP: transformer (F1: 0.5862)
2025-05-19 23:17:57,046 - INFO - [__main__] - Best model for ATA: svm (F1: 0.8108)
2025-05-19 23:17:57,046 - INFO - [__main__] - Best model for AVF: lstm (F1: 0.9885)
2025-05-19 23:17:57,047 - INFO - [__main__] - Best model for BBC: svm (F1: 0.7429)
2025-05-19 23:17:57,048 - INFO - [__main__] - Best model for BBS: svm (F1: 0.9398)
2025-05-19 23:17:57,048 - INFO - [__main__] - Best model for BCC: lstm (F1: 0.6429)
2025-05-19 23:17:57,049 - INFO - [__main__] - Best model for BCE: svm (F1: 0.6667)
2025-05-19 23:17:57,049 - INFO - [__main__] - Best model for BDB: lstm (F1: 0.9524)
2025-05-19 23:17:57,050 - INFO - [__main__] - Best model for BED: lstm (F1: 0.9885)
2025-05-19 23:17:57,050 - INFO - [__main__] - Best model for BHC: svm (F1: 0.7302)
2025-05-19 23:17:57,051 - INFO - [__main__] - Best model for BIC: transformer (F1: 0.7188)
2025-05-19 23:17:57,051 - INFO - [__main__] - Best model for BKC: svm (F1: 0.6866)
2025-05-19 23:17:57,052 - INFO - [__main__] - Best model for BLF: svm (F1: 0.6667)
2025-05-19 23:17:57,052 - INFO - [__main__] - Best model for BMC: logistic_regression (F1: 0.6538)
2025-05-19 23:17:57,053 - INFO - [__main__] - Best model for BMI: svm (F1: 0.6250)
2025-05-19 23:17:57,054 - INFO - [__main__] - Best model for BMJ: lstm (F1: 0.7606)
2025-05-19 23:17:57,054 - INFO - [__main__] - Best model for BMP: svm (F1: 0.6462)
2025-05-19 23:17:57,055 - INFO - [__main__] - Best model for BPC: svm (F1: 0.8108)
2025-05-19 23:17:57,055 - INFO - [__main__] - Best model for BRC: svm (F1: 0.7778)
2025-05-19 23:17:57,056 - INFO - [__main__] - Best model for BSC: lstm (F1: 0.9885)
2025-05-19 23:17:57,057 - INFO - [__main__] - Best model for BSI: svm (F1: 0.7429)
2025-05-19 23:17:57,058 - INFO - [__main__] - Best model for BST: svm (F1: 0.6667)
2025-05-19 23:17:57,058 - INFO - [__main__] - Best model for BT6: lstm (F1: 0.9885)
2025-05-19 23:17:57,059 - INFO - [__main__] - Best model for BTG: lstm (F1: 0.9136)
2025-05-19 23:17:57,060 - INFO - [__main__] - Best model for BTH: transformer (F1: 0.6557)
2025-05-19 23:17:57,060 - INFO - [__main__] - Best model for BTP: svm (F1: 0.6316)
2025-05-19 23:17:57,061 - INFO - [__main__] - Best model for BTS: logistic_regression (F1: 0.7419)
2025-05-19 23:17:57,061 - INFO - [__main__] - Best model for BTT: svm (F1: 0.8421)
2025-05-19 23:17:57,062 - INFO - [__main__] - Best model for BTW: svm (F1: 0.7246)
2025-05-19 23:17:57,062 - INFO - [__main__] - Best model for BVG: svm (F1: 0.9000)
2025-05-19 23:17:57,063 - INFO - [__main__] - Best model for BVH: transformer (F1: 0.6875)
2025-05-19 23:17:57,064 - INFO - [__main__] - Best model for BVN: svm (F1: 0.6866)
2025-05-19 23:17:57,064 - INFO - [__main__] - Best model for BVS: transformer (F1: 0.5116)
2025-05-19 23:17:57,065 - INFO - [__main__] - Best model for BWA: svm (F1: 0.7188)
2025-05-19 23:17:57,065 - INFO - [__main__] - Best model for BXH: lstm (F1: 0.6866)
2025-05-19 23:17:57,066 - INFO - [__main__] - Best model for C21: logistic_regression (F1: 0.7541)
2025-05-19 23:17:57,067 - INFO - [__main__] - Best model for C32: logistic_regression (F1: 0.3590)
2025-05-19 23:17:57,068 - INFO - [__main__] - Best model for C47: svm (F1: 0.6545)
2025-05-19 23:17:57,068 - INFO - [__main__] - Best model for C92: svm (F1: 0.7778)
2025-05-19 23:17:57,069 - INFO - [__main__] - Best model for CAD: lstm (F1: 0.8861)
2025-05-19 23:17:57,069 - INFO - [__main__] - Best model for CAN: svm (F1: 0.8718)
2025-05-19 23:17:57,070 - INFO - [__main__] - Best model for CAP: svm (F1: 0.5806)
2025-05-19 23:17:57,071 - INFO - [__main__] - Best model for CCI: svm (F1: 0.7606)
2025-05-19 23:17:57,071 - INFO - [__main__] - Best model for CCL: transformer (F1: 0.5417)
2025-05-19 23:17:57,072 - INFO - [__main__] - Best model for CCM: svm (F1: 0.8219)
2025-05-19 23:17:57,073 - INFO - [__main__] - Best model for CDC: svm (F1: 0.6032)
2025-05-19 23:17:57,073 - INFO - [__main__] - Best model for CHP: lstm (F1: 0.7246)
2025-05-19 23:17:57,074 - INFO - [__main__] - Best model for CI5: svm (F1: 0.7059)
2025-05-19 23:17:57,075 - INFO - [__main__] - Best model for CID: svm (F1: 0.6667)
2025-05-19 23:17:57,076 - INFO - [__main__] - Best model for CIG: logistic_regression (F1: 0.5909)
2025-05-19 23:17:57,077 - INFO - [__main__] - Best model for CII: transformer (F1: 0.6333)
2025-05-19 23:17:57,077 - INFO - [__main__] - Best model for CJC: lstm (F1: 0.9885)
2025-05-19 23:17:57,078 - INFO - [__main__] - Best model for CKV: svm (F1: 0.8571)
2025-05-19 23:17:57,079 - INFO - [__main__] - Best model for CLC: svm (F1: 0.7945)
2025-05-19 23:17:57,079 - INFO - [__main__] - Best model for CLG: transformer (F1: 0.9524)
2025-05-19 23:17:57,080 - INFO - [__main__] - Best model for CLW: svm (F1: 0.8267)
2025-05-19 23:17:57,081 - INFO - [__main__] - Best model for CMC: svm (F1: 0.4211)
2025-05-19 23:17:57,082 - INFO - [__main__] - Best model for CMG: svm (F1: 0.6000)
2025-05-19 23:17:57,083 - INFO - [__main__] - Best model for CMI: lstm (F1: 0.8571)
2025-05-19 23:17:57,084 - INFO - [__main__] - Best model for CMS: svm (F1: 0.1429)
2025-05-19 23:17:57,085 - INFO - [__main__] - Best model for CMT: transformer (F1: 0.3077)
2025-05-19 23:17:57,085 - INFO - [__main__] - Best model for CMV: svm (F1: 0.7059)
2025-05-19 23:17:57,086 - INFO - [__main__] - Best model for CMX: logistic_regression (F1: 0.3871)
2025-05-19 23:17:57,087 - INFO - [__main__] - Best model for CNG: logistic_regression (F1: 0.6316)
2025-05-19 23:17:57,087 - INFO - [__main__] - Best model for CNT: svm (F1: 0.6032)
2025-05-19 23:17:57,089 - INFO - [__main__] - Best model for COM: svm (F1: 0.7059)
2025-05-19 23:17:57,090 - INFO - [__main__] - Best model for CPC: svm (F1: 0.7945)
2025-05-19 23:17:57,091 - INFO - [__main__] - Best model for CSC: svm (F1: 0.4255)
2025-05-19 23:17:57,092 - INFO - [__main__] - Best model for CSM: lstm (F1: 0.6087)
2025-05-19 23:17:57,092 - INFO - [__main__] - Best model for CT3: svm (F1: 0.8333)
2025-05-19 23:17:57,093 - INFO - [__main__] - Best model for CT6: logistic_regression (F1: 0.3684)
2025-05-19 23:17:57,093 - INFO - [__main__] - Best model for CTA: lstm (F1: 0.9885)
2025-05-19 23:17:57,094 - INFO - [__main__] - Best model for CTB: svm (F1: 0.7059)
2025-05-19 23:17:57,094 - INFO - [__main__] - Best model for CTD: svm (F1: 0.7059)
2025-05-19 23:17:57,095 - INFO - [__main__] - Best model for CTG: transformer (F1: 0.5882)
2025-05-19 23:17:57,096 - INFO - [__main__] - Best model for CTI: svm (F1: 0.5238)
2025-05-19 23:17:57,097 - INFO - [__main__] - Best model for CTN: lstm (F1: 0.9885)
2025-05-19 23:17:57,097 - INFO - [__main__] - Best model for CTS: lstm (F1: 0.6866)
2025-05-19 23:17:57,098 - INFO - [__main__] - Best model for CTX: svm (F1: 0.9885)
2025-05-19 23:17:57,099 - INFO - [__main__] - Best model for CVN: svm (F1: 0.9268)
2025-05-19 23:17:57,099 - INFO - [__main__] - Best model for CVT: logistic_regression (F1: 0.7761)
2025-05-19 23:17:57,100 - INFO - [__main__] - Best model for CX8: svm (F1: 0.7463)
2025-05-19 23:17:57,100 - INFO - [__main__] - Best model for CYC: svm (F1: 0.9268)
2025-05-19 23:17:57,101 - INFO - [__main__] - Best model for D11: lstm (F1: 0.6667)
2025-05-19 23:17:57,101 - INFO - [__main__] - Best model for D2D: svm (F1: 0.4118)
2025-05-19 23:17:57,102 - INFO - [__main__] - Best model for DAC: lstm (F1: 0.7945)
2025-05-19 23:17:57,102 - INFO - [__main__] - Best model for DAD: svm (F1: 0.7429)
2025-05-19 23:17:57,103 - INFO - [__main__] - Best model for DAE: transformer (F1: 0.8108)
2025-05-19 23:17:57,104 - INFO - [__main__] - Best model for DAG: lstm (F1: 0.9136)
2025-05-19 23:17:57,105 - INFO - [__main__] - Best model for DBC: svm (F1: 0.5862)
2025-05-19 23:17:57,106 - INFO - [__main__] - Best model for DBM: svm (F1: 0.7606)
2025-05-19 23:17:57,107 - INFO - [__main__] - Best model for DBT: logistic_regression (F1: 0.1739)
2025-05-19 23:17:57,107 - INFO - [__main__] - Best model for DC2: svm (F1: 0.7606)
2025-05-19 23:17:57,108 - INFO - [__main__] - Best model for DC4: svm (F1: 0.7246)
2025-05-19 23:17:57,109 - INFO - [__main__] - Best model for DCL: logistic_regression (F1: 0.6970)
2025-05-19 23:17:57,109 - INFO - [__main__] - Best model for DCS: svm (F1: 0.8718)
2025-05-19 23:17:57,110 - INFO - [__main__] - Best model for DCT: lstm (F1: 0.8571)
2025-05-19 23:17:57,110 - INFO - [__main__] - Best model for DDM: svm (F1: 0.7778)
2025-05-19 23:17:57,111 - INFO - [__main__] - Best model for DDN: svm (F1: 0.8108)
2025-05-19 23:17:57,112 - INFO - [__main__] - Best model for DGT: svm (F1: 0.6462)
2025-05-19 23:17:57,112 - INFO - [__main__] - Best model for DHA: svm (F1: 0.2400)
2025-05-19 23:17:57,113 - INFO - [__main__] - Best model for DHC: svm (F1: 0.5965)
2025-05-19 23:17:57,114 - INFO - [__main__] - Best model for DHG: svm (F1: 0.4375)
2025-05-19 23:17:57,114 - INFO - [__main__] - Best model for DHM: logistic_regression (F1: 0.5641)
2025-05-19 23:17:57,115 - INFO - [__main__] - Best model for DHT: logistic_regression (F1: 0.1481)
2025-05-19 23:17:57,115 - INFO - [__main__] - Best model for DIC: logistic_regression (F1: 0.7541)
2025-05-19 23:17:57,116 - INFO - [__main__] - Best model for DID: lstm (F1: 0.7419)
2025-05-19 23:17:57,116 - INFO - [__main__] - Best model for DIG: lstm (F1: 0.6230)
2025-05-19 23:17:57,117 - INFO - [__main__] - Best model for DIH: transformer (F1: 0.5000)
2025-05-19 23:17:57,117 - INFO - [__main__] - Best model for DL1: logistic_regression (F1: 0.6230)
2025-05-19 23:17:57,118 - INFO - [__main__] - Best model for DLD: lstm (F1: 0.9000)
2025-05-19 23:17:57,119 - INFO - [__main__] - Best model for DLG: lstm (F1: 0.6275)
2025-05-19 23:17:57,120 - INFO - [__main__] - Best model for DLR: transformer (F1: 0.9647)
2025-05-19 23:17:57,121 - INFO - [__main__] - Best model for DMC: lstm (F1: 0.5600)
2025-05-19 23:17:57,121 - INFO - [__main__] - Best model for DNC: svm (F1: 0.8267)
2025-05-19 23:17:57,122 - INFO - [__main__] - Best model for DNL: svm (F1: 0.9136)
2025-05-19 23:17:57,122 - INFO - [__main__] - Best model for DNM: svm (F1: 0.7429)
2025-05-19 23:17:57,123 - INFO - [__main__] - Best model for DNP: svm (F1: 0.6250)
2025-05-19 23:17:57,123 - INFO - [__main__] - Best model for DNT: lstm (F1: 0.9000)
2025-05-19 23:17:57,124 - INFO - [__main__] - Best model for DPC: svm (F1: 0.8974)
2025-05-19 23:17:57,125 - INFO - [__main__] - Best model for DPM: lstm (F1: 0.6875)
2025-05-19 23:17:57,125 - INFO - [__main__] - Best model for DPP: svm (F1: 0.9647)
2025-05-19 23:17:57,126 - INFO - [__main__] - Best model for DPR: logistic_regression (F1: 0.7143)
2025-05-19 23:17:57,126 - INFO - [__main__] - Best model for DQC: lstm (F1: 0.4828)
2025-05-19 23:17:57,127 - INFO - [__main__] - Best model for DRC: logistic_regression (F1: 0.1053)
2025-05-19 23:17:57,128 - INFO - [__main__] - Best model for DRH: svm (F1: 0.8421)
2025-05-19 23:17:57,128 - INFO - [__main__] - Best model for DRL: lstm (F1: 0.6032)
2025-05-19 23:17:57,129 - INFO - [__main__] - Best model for DSN: logistic_regression (F1: 0.2143)
2025-05-19 23:17:57,129 - INFO - [__main__] - Best model for DST: lstm (F1: 0.7778)
2025-05-19 23:17:57,130 - INFO - [__main__] - Best model for DTA: transformer (F1: 0.6341)
2025-05-19 23:17:57,131 - INFO - [__main__] - Best model for DTC: lstm (F1: 0.6667)
2025-05-19 23:17:57,131 - INFO - [__main__] - Best model for DTL: svm (F1: 0.7246)
2025-05-19 23:17:57,132 - INFO - [__main__] - Best model for DTT: svm (F1: 0.7606)
2025-05-19 23:17:57,132 - INFO - [__main__] - Best model for DVP: logistic_regression (F1: 0.6415)
2025-05-19 23:17:57,133 - INFO - [__main__] - Best model for DXG: svm (F1: 0.8065)
2025-05-19 23:17:57,134 - INFO - [__main__] - Best model for DXL: lstm (F1: 0.8718)
2025-05-19 23:17:57,134 - INFO - [__main__] - Best model for DXP: logistic_regression (F1: 0.6349)
2025-05-19 23:17:57,135 - INFO - [__main__] - Best model for DXV: transformer (F1: 0.6222)
2025-05-19 23:17:57,136 - INFO - [__main__] - Best model for DZM: lstm (F1: 0.9885)
2025-05-19 23:17:57,137 - INFO - [__main__] - Best model for EBS: svm (F1: 0.6769)
2025-05-19 23:17:57,137 - INFO - [__main__] - Best model for ECI: svm (F1: 0.9268)
2025-05-19 23:17:57,138 - INFO - [__main__] - Best model for EFI: lstm (F1: 0.7887)
2025-05-19 23:17:57,139 - INFO - [__main__] - Best model for EIB: lstm (F1: 0.7059)
2025-05-19 23:17:57,139 - INFO - [__main__] - Best model for EID: svm (F1: 0.7059)
2025-05-19 23:17:57,140 - INFO - [__main__] - Best model for ELC: svm (F1: 0.5965)
2025-05-19 23:17:57,141 - INFO - [__main__] - Best model for EVE: transformer (F1: 0.4800)
2025-05-19 23:17:57,141 - INFO - [__main__] - Best model for FBA: lstm (F1: 0.9885)
2025-05-19 23:17:57,142 - INFO - [__main__] - Best model for FCN: svm (F1: 0.5763)
2025-05-19 23:17:57,143 - INFO - [__main__] - Best model for FDC: transformer (F1: 0.8421)
2025-05-19 23:17:57,143 - INFO - [__main__] - Best model for FLC: lstm (F1: 0.9885)
2025-05-19 23:17:57,145 - INFO - [__main__] - Best model for FMC: lstm (F1: 0.6667)
2025-05-19 23:17:57,145 - INFO - [__main__] - Best model for FPT: lstm (F1: 0.6667)
2025-05-19 23:17:57,146 - INFO - [__main__] - Best model for GAS: logistic_regression (F1: 0.6154)
2025-05-19 23:17:57,147 - INFO - [__main__] - Best model for GDT: logistic_regression (F1: 0.4500)
2025-05-19 23:17:57,148 - INFO - [__main__] - Best model for GDW: svm (F1: 0.7246)
2025-05-19 23:17:57,148 - INFO - [__main__] - Best model for GER: lstm (F1: 0.9398)
2025-05-19 23:17:57,149 - INFO - [__main__] - Best model for GGG: svm (F1: 0.6667)
2025-05-19 23:17:57,150 - INFO - [__main__] - Best model for GHC: logistic_regression (F1: 0.6557)
2025-05-19 23:17:57,150 - INFO - [__main__] - Best model for GIL: logistic_regression (F1: 0.4390)
2025-05-19 23:17:57,151 - INFO - [__main__] - Best model for GLT: logistic_regression (F1: 0.6667)
2025-05-19 23:17:57,152 - INFO - [__main__] - Best model for GMC: lstm (F1: 0.6562)
2025-05-19 23:17:57,153 - INFO - [__main__] - Best model for GMD: svm (F1: 0.6047)
2025-05-19 23:17:57,154 - INFO - [__main__] - Best model for GMX: svm (F1: 0.7059)
2025-05-19 23:17:57,155 - INFO - [__main__] - Best model for GSP: svm (F1: 0.5600)
2025-05-19 23:17:57,156 - INFO - [__main__] - Best model for GTA: logistic_regression (F1: 0.3902)
2025-05-19 23:17:57,157 - INFO - [__main__] - Best model for GTT: lstm (F1: 0.9885)
2025-05-19 23:17:57,159 - INFO - [__main__] - Best model for H11: svm (F1: 0.8108)
2025-05-19 23:17:57,160 - INFO - [__main__] - Best model for HAD: svm (F1: 0.7945)
2025-05-19 23:17:57,161 - INFO - [__main__] - Best model for HAG: svm (F1: 0.6957)
2025-05-19 23:17:57,162 - INFO - [__main__] - Best model for HAI: lstm (F1: 0.0000)
2025-05-19 23:17:57,163 - INFO - [__main__] - Best model for HAP: svm (F1: 0.4762)
2025-05-19 23:17:57,164 - INFO - [__main__] - Best model for HAS: transformer (F1: 0.6316)
2025-05-19 23:17:57,164 - INFO - [__main__] - Best model for HAT: transformer (F1: 0.7761)
2025-05-19 23:17:57,165 - INFO - [__main__] - Best model for HAX: svm (F1: 0.6667)
2025-05-19 23:17:57,166 - INFO - [__main__] - Best model for HBC: lstm (F1: 0.7333)
2025-05-19 23:17:57,166 - INFO - [__main__] - Best model for HBD: lstm (F1: 0.9136)
2025-05-19 23:17:57,167 - INFO - [__main__] - Best model for HBS: svm (F1: 0.6667)
2025-05-19 23:17:57,168 - INFO - [__main__] - Best model for HCC: svm (F1: 0.7778)
2025-05-19 23:17:57,169 - INFO - [__main__] - Best model for HCI: lstm (F1: 0.9885)
2025-05-19 23:17:57,169 - INFO - [__main__] - Best model for HCM: svm (F1: 0.7246)
2025-05-19 23:17:57,170 - INFO - [__main__] - Best model for HCT: svm (F1: 0.9398)
2025-05-19 23:17:57,170 - INFO - [__main__] - Best model for HDA: lstm (F1: 0.7164)
2025-05-19 23:17:57,171 - INFO - [__main__] - Best model for HDC: lstm (F1: 0.6667)
2025-05-19 23:17:57,172 - INFO - [__main__] - Best model for HDG: transformer (F1: 0.6462)
2025-05-19 23:17:57,172 - INFO - [__main__] - Best model for HDM: svm (F1: 0.7429)
2025-05-19 23:17:57,173 - INFO - [__main__] - Best model for HDO: lstm (F1: 0.9885)
2025-05-19 23:17:57,173 - INFO - [__main__] - Best model for HEV: lstm (F1: 0.9767)
2025-05-19 23:17:57,174 - INFO - [__main__] - Best model for HFC: svm (F1: 0.7761)
2025-05-19 23:17:57,175 - INFO - [__main__] - Best model for HFX: lstm (F1: 0.9000)
2025-05-19 23:17:57,175 - INFO - [__main__] - Best model for HGM: lstm (F1: 0.8108)
2025-05-19 23:17:57,176 - INFO - [__main__] - Best model for HHC: transformer (F1: 0.9091)
2025-05-19 23:17:57,176 - INFO - [__main__] - Best model for HHG: lstm (F1: 0.7429)
2025-05-19 23:17:57,177 - INFO - [__main__] - Best model for HHS: transformer (F1: 0.6923)
2025-05-19 23:17:57,177 - INFO - [__main__] - Best model for HIG: svm (F1: 0.7606)
2025-05-19 23:17:57,178 - INFO - [__main__] - Best model for HJS: svm (F1: 0.5806)
2025-05-19 23:17:57,179 - INFO - [__main__] - Best model for HLA: lstm (F1: 0.9885)
2025-05-19 23:17:57,179 - INFO - [__main__] - Best model for HLC: svm (F1: 0.6866)
2025-05-19 23:17:57,180 - INFO - [__main__] - Best model for HLY: transformer (F1: 0.8800)
2025-05-19 23:17:57,180 - INFO - [__main__] - Best model for HMC: svm (F1: 0.4878)
2025-05-19 23:17:57,181 - INFO - [__main__] - Best model for HMH: svm (F1: 0.7945)
2025-05-19 23:17:57,181 - INFO - [__main__] - Best model for HNM: svm (F1: 0.4545)
2025-05-19 23:17:57,182 - INFO - [__main__] - Best model for HOM: transformer (F1: 0.6875)
2025-05-19 23:17:57,182 - INFO - [__main__] - Best model for HOT: svm (F1: 0.8718)
2025-05-19 23:17:57,183 - INFO - [__main__] - Best model for HPB: svm (F1: 0.9524)
2025-05-19 23:17:57,184 - INFO - [__main__] - Best model for HPG: svm (F1: 0.5862)
2025-05-19 23:17:57,184 - INFO - [__main__] - Best model for HPP: svm (F1: 0.6866)
2025-05-19 23:17:57,185 - INFO - [__main__] - Best model for HPT: svm (F1: 0.7246)
2025-05-19 23:17:57,185 - INFO - [__main__] - Best model for HQC: svm (F1: 0.6538)
2025-05-19 23:17:57,186 - INFO - [__main__] - Best model for HRC: svm (F1: 0.7429)
2025-05-19 23:17:57,187 - INFO - [__main__] - Best model for HSG: transformer (F1: 0.5172)
2025-05-19 23:17:57,187 - INFO - [__main__] - Best model for HSI: lstm (F1: 0.8267)
2025-05-19 23:17:57,188 - INFO - [__main__] - Best model for HT1: svm (F1: 0.4615)
2025-05-19 23:17:57,189 - INFO - [__main__] - Best model for HTC: svm (F1: 0.7606)
2025-05-19 23:17:57,189 - INFO - [__main__] - Best model for HTI: svm (F1: 0.5652)
2025-05-19 23:17:57,190 - INFO - [__main__] - Best model for HTL: svm (F1: 0.7606)
2025-05-19 23:17:57,190 - INFO - [__main__] - Best model for HTP: svm (F1: 0.5902)
2025-05-19 23:17:57,191 - INFO - [__main__] - Best model for HTV: svm (F1: 0.7213)
2025-05-19 23:17:57,191 - INFO - [__main__] - Best model for HU1: svm (F1: 0.5806)
2025-05-19 23:17:57,192 - INFO - [__main__] - Best model for HU3: svm (F1: 0.7059)
2025-05-19 23:17:57,193 - INFO - [__main__] - Best model for HUT: svm (F1: 0.2667)
2025-05-19 23:17:57,193 - INFO - [__main__] - Best model for HVG: transformer (F1: 0.9885)
2025-05-19 23:17:57,194 - INFO - [__main__] - Best model for HVT: logistic_regression (F1: 0.6667)
2025-05-19 23:17:57,194 - INFO - [__main__] - Best model for HVX: svm (F1: 0.6462)
2025-05-19 23:17:57,195 - INFO - [__main__] - Best model for ICF: svm (F1: 0.5862)
2025-05-19 23:17:57,195 - INFO - [__main__] - Best model for ICG: svm (F1: 0.7059)
2025-05-19 23:17:57,196 - INFO - [__main__] - Best model for ICI: svm (F1: 0.6452)
2025-05-19 23:17:57,196 - INFO - [__main__] - Best model for IDI: lstm (F1: 0.6032)
2025-05-19 23:17:57,197 - INFO - [__main__] - Best model for IDJ: lstm (F1: 0.6250)
2025-05-19 23:17:57,198 - INFO - [__main__] - Best model for IDV: svm (F1: 0.5806)
2025-05-19 23:17:57,198 - INFO - [__main__] - Best model for IFS: lstm (F1: 0.0000)
2025-05-19 23:17:57,199 - INFO - [__main__] - Best model for IHK: svm (F1: 0.9000)
2025-05-19 23:17:57,199 - INFO - [__main__] - Best model for IJC: svm (F1: 0.6970)
2025-05-19 23:17:57,200 - INFO - [__main__] - Best model for ILC: svm (F1: 0.6250)
2025-05-19 23:17:57,201 - INFO - [__main__] - Best model for IME: lstm (F1: 0.9767)
2025-05-19 23:17:57,201 - INFO - [__main__] - Best model for IMP: svm (F1: 0.5000)
2025-05-19 23:17:57,202 - INFO - [__main__] - Best model for IN4: logistic_regression (F1: 0.7536)
2025-05-19 23:17:57,202 - INFO - [__main__] - Best model for INC: svm (F1: 0.9398)
2025-05-19 23:17:57,203 - INFO - [__main__] - Best model for INN: svm (F1: 0.7429)
2025-05-19 23:17:57,203 - INFO - [__main__] - Best model for ITA: svm (F1: 0.8421)
2025-05-19 23:17:57,204 - INFO - [__main__] - Best model for ITC: transformer (F1: 0.6667)
2025-05-19 23:17:57,205 - INFO - [__main__] - Best model for ITD: transformer (F1: 0.5417)
2025-05-19 23:17:57,205 - INFO - [__main__] - Best model for ITQ: svm (F1: 0.6866)
2025-05-19 23:17:57,206 - INFO - [__main__] - Best model for IVS: transformer (F1: 0.6182)
2025-05-19 23:17:57,206 - INFO - [__main__] - Best model for JVC: logistic_regression (F1: 0.6786)
2025-05-19 23:17:57,207 - INFO - [__main__] - Best model for KAC: lstm (F1: 0.9885)
2025-05-19 23:17:57,207 - INFO - [__main__] - Best model for KBC: transformer (F1: 0.4848)
2025-05-19 23:17:57,208 - INFO - [__main__] - Best model for KCE: svm (F1: 0.7606)
2025-05-19 23:17:57,209 - INFO - [__main__] - Best model for KDC: logistic_regression (F1: 0.4390)
2025-05-19 23:17:57,209 - INFO - [__main__] - Best model for KDH: lstm (F1: 0.6667)
2025-05-19 23:17:57,210 - INFO - [__main__] - Best model for KHL: lstm (F1: 0.9885)
2025-05-19 23:17:57,210 - INFO - [__main__] - Best model for KHP: transformer (F1: 0.5455)
2025-05-19 23:17:57,211 - INFO - [__main__] - Best model for KKC: lstm (F1: 0.7246)
2025-05-19 23:17:57,211 - INFO - [__main__] - Best model for KMR: logistic_regression (F1: 0.4242)
2025-05-19 23:17:57,212 - INFO - [__main__] - Best model for KMT: svm (F1: 0.9524)
2025-05-19 23:17:57,212 - INFO - [__main__] - Best model for KSB: lstm (F1: 0.3333)
2025-05-19 23:17:57,213 - INFO - [__main__] - Best model for KSD: svm (F1: 0.7606)
2025-05-19 23:17:57,214 - INFO - [__main__] - Best model for KSH: lstm (F1: 0.9885)
2025-05-19 23:17:57,214 - INFO - [__main__] - Best model for KST: svm (F1: 0.6207)
2025-05-19 23:17:57,215 - INFO - [__main__] - Best model for KTS: logistic_regression (F1: 0.6866)
2025-05-19 23:17:57,215 - INFO - [__main__] - Best model for KTT: lstm (F1: 0.9091)
2025-05-19 23:17:57,216 - INFO - [__main__] - Best model for L10: svm (F1: 0.7429)
2025-05-19 23:17:57,217 - INFO - [__main__] - Best model for L14: lstm (F1: 0.6829)
2025-05-19 23:17:57,217 - INFO - [__main__] - Best model for L18: logistic_regression (F1: 0.4500)
2025-05-19 23:17:57,218 - INFO - [__main__] - Best model for L35: svm (F1: 0.7606)
2025-05-19 23:17:57,219 - INFO - [__main__] - Best model for L43: logistic_regression (F1: 0.3902)
2025-05-19 23:17:57,219 - INFO - [__main__] - Best model for L44: svm (F1: 0.8571)
2025-05-19 23:17:57,220 - INFO - [__main__] - Best model for L61: svm (F1: 0.7887)
2025-05-19 23:17:57,220 - INFO - [__main__] - Best model for L62: transformer (F1: 0.7353)
2025-05-19 23:17:57,221 - INFO - [__main__] - Best model for LAF: svm (F1: 0.6667)
2025-05-19 23:17:57,221 - INFO - [__main__] - Best model for LAS: svm (F1: 0.6087)
2025-05-19 23:17:57,222 - INFO - [__main__] - Best model for LBE: svm (F1: 0.8421)
2025-05-19 23:17:57,223 - INFO - [__main__] - Best model for LBM: logistic_regression (F1: 0.6275)
2025-05-19 23:17:57,223 - INFO - [__main__] - Best model for LCC: logistic_regression (F1: 0.8919)
2025-05-19 23:17:57,224 - INFO - [__main__] - Best model for LCD: lstm (F1: 0.9767)
2025-05-19 23:17:57,224 - INFO - [__main__] - Best model for LCG: logistic_regression (F1: 0.3871)
2025-05-19 23:17:57,225 - INFO - [__main__] - Best model for LCM: lstm (F1: 0.6207)
2025-05-19 23:17:57,225 - INFO - [__main__] - Best model for LCS: lstm (F1: 0.9000)
2025-05-19 23:17:57,226 - INFO - [__main__] - Best model for LDP: lstm (F1: 0.5405)
2025-05-19 23:17:57,227 - INFO - [__main__] - Best model for LGC: transformer (F1: 0.8684)
2025-05-19 23:17:57,227 - INFO - [__main__] - Best model for LGL: logistic_regression (F1: 0.6545)
2025-05-19 23:17:57,228 - INFO - [__main__] - Best model for LHC: logistic_regression (F1: 0.2069)
2025-05-19 23:17:57,228 - INFO - [__main__] - Best model for LHG: lstm (F1: 0.6032)
2025-05-19 23:17:57,229 - INFO - [__main__] - Best model for LIG: logistic_regression (F1: 0.7500)
2025-05-19 23:17:57,229 - INFO - [__main__] - Best model for LIX: logistic_regression (F1: 0.4615)
2025-05-19 23:17:57,230 - INFO - [__main__] - Best model for LKW: transformer (F1: 0.8421)
2025-05-19 23:17:57,231 - INFO - [__main__] - Best model for LM3: logistic_regression (F1: 0.9647)
2025-05-19 23:17:57,231 - INFO - [__main__] - Best model for LM7: lstm (F1: 0.8571)
2025-05-19 23:17:57,232 - INFO - [__main__] - Best model for LM8: transformer (F1: 0.7164)
2025-05-19 23:17:57,232 - INFO - [__main__] - Best model for LO5: svm (F1: 0.8571)
2025-05-19 23:17:57,233 - INFO - [__main__] - Best model for LSS: transformer (F1: 0.6087)
2025-05-19 23:17:57,234 - INFO - [__main__] - Best model for LTC: svm (F1: 0.7429)
2025-05-19 23:17:57,234 - INFO - [__main__] - Best model for LUT: lstm (F1: 0.8718)
2025-05-19 23:17:57,235 - INFO - [__main__] - Best model for MAC: transformer (F1: 0.6875)
2025-05-19 23:17:57,235 - INFO - [__main__] - Best model for MAS: svm (F1: 0.7429)
2025-05-19 23:17:57,236 - INFO - [__main__] - Best model for MBB: logistic_regression (F1: 0.5366)
2025-05-19 23:17:57,236 - INFO - [__main__] - Best model for MCC: svm (F1: 0.9647)
2025-05-19 23:17:57,237 - INFO - [__main__] - Best model for MCF: svm (F1: 0.7429)
2025-05-19 23:17:57,238 - INFO - [__main__] - Best model for MCG: lstm (F1: 0.7692)
2025-05-19 23:17:57,238 - INFO - [__main__] - Best model for MCO: svm (F1: 0.5574)
2025-05-19 23:17:57,239 - INFO - [__main__] - Best model for MCP: svm (F1: 0.7246)
2025-05-19 23:17:57,239 - INFO - [__main__] - Best model for MDC: svm (F1: 0.7778)
2025-05-19 23:17:57,240 - INFO - [__main__] - Best model for MDF: svm (F1: 0.7246)
2025-05-19 23:17:57,241 - INFO - [__main__] - Best model for MDG: svm (F1: 0.8718)
2025-05-19 23:17:57,241 - INFO - [__main__] - Best model for MEC: svm (F1: 0.6866)
2025-05-19 23:17:57,242 - INFO - [__main__] - Best model for MEF: lstm (F1: 0.9885)
2025-05-19 23:17:57,242 - INFO - [__main__] - Best model for MHC: svm (F1: 0.5574)
2025-05-19 23:17:57,243 - INFO - [__main__] - Best model for MHL: lstm (F1: 0.9885)
2025-05-19 23:17:57,243 - INFO - [__main__] - Best model for MIC: svm (F1: 0.6129)
2025-05-19 23:17:57,244 - INFO - [__main__] - Best model for MIM: lstm (F1: 0.9885)
2025-05-19 23:17:57,244 - INFO - [__main__] - Best model for MKV: transformer (F1: 0.7429)
2025-05-19 23:17:57,245 - INFO - [__main__] - Best model for MPC: svm (F1: 0.4828)
2025-05-19 23:17:57,245 - INFO - [__main__] - Best model for MSN: lstm (F1: 0.6667)
2025-05-19 23:17:57,246 - INFO - [__main__] - Best model for MTC: lstm (F1: 0.9524)
2025-05-19 23:17:57,246 - INFO - [__main__] - Best model for MTG: svm (F1: 0.7246)
2025-05-19 23:17:57,247 - INFO - [__main__] - Best model for MTH: svm (F1: 0.9136)
2025-05-19 23:17:57,249 - INFO - [__main__] - Best model for MTP: svm (F1: 0.8571)
2025-05-19 23:17:57,249 - INFO - [__main__] - Best model for NAG: svm (F1: 0.7246)
2025-05-19 23:17:57,250 - INFO - [__main__] - Best model for NAV: lstm (F1: 0.7429)
2025-05-19 23:17:57,250 - INFO - [__main__] - Best model for NBB: svm (F1: 0.6349)
2025-05-19 23:17:57,251 - INFO - [__main__] - Best model for NBC: svm (F1: 0.3500)
2025-05-19 23:17:57,252 - INFO - [__main__] - Best model for NBP: svm (F1: 0.7429)
2025-05-19 23:17:57,252 - INFO - [__main__] - Best model for NBW: svm (F1: 0.7429)
2025-05-19 23:17:57,253 - INFO - [__main__] - Best model for ND2: svm (F1: 0.7778)
2025-05-19 23:17:57,253 - INFO - [__main__] - Best model for NDC: svm (F1: 0.7429)
2025-05-19 23:17:57,254 - INFO - [__main__] - Best model for NDN: transformer (F1: 0.5000)
2025-05-19 23:17:57,254 - INFO - [__main__] - Best model for NET: transformer (F1: 0.5000)
2025-05-19 23:17:57,255 - INFO - [__main__] - Best model for NGC: svm (F1: 0.9767)
2025-05-19 23:17:57,255 - INFO - [__main__] - Best model for NHA: logistic_regression (F1: 0.2143)
2025-05-19 23:17:57,256 - INFO - [__main__] - Best model for NHC: lstm (F1: 0.8421)
2025-05-19 23:17:57,257 - INFO - [__main__] - Best model for NKG: lstm (F1: 0.5574)
2025-05-19 23:17:57,257 - INFO - [__main__] - Best model for NNC: transformer (F1: 0.6800)
2025-05-19 23:17:57,258 - INFO - [__main__] - Best model for NNT: svm (F1: 0.2105)
2025-05-19 23:17:57,258 - INFO - [__main__] - Best model for NOS: svm (F1: 0.7606)
2025-05-19 23:17:57,259 - INFO - [__main__] - Best model for NSC: logistic_regression (F1: 0.7317)
2025-05-19 23:17:57,259 - INFO - [__main__] - Best model for NST: svm (F1: 0.7059)
2025-05-19 23:17:57,260 - INFO - [__main__] - Best model for NT2: svm (F1: 0.6250)
2025-05-19 23:17:57,260 - INFO - [__main__] - Best model for NTB: lstm (F1: 0.9885)
2025-05-19 23:17:57,261 - INFO - [__main__] - Best model for NTL: logistic_regression (F1: 0.6780)
2025-05-19 23:17:57,262 - INFO - [__main__] - Best model for NTP: logistic_regression (F1: 0.3684)
2025-05-19 23:17:57,262 - INFO - [__main__] - Best model for NTW: svm (F1: 0.7945)
2025-05-19 23:17:57,263 - INFO - [__main__] - Best model for NVB: lstm (F1: 0.7143)
2025-05-19 23:17:57,263 - INFO - [__main__] - Best model for NVT: lstm (F1: 0.5818)
2025-05-19 23:17:57,264 - INFO - [__main__] - Best model for OCH: logistic_regression (F1: 0.7097)
2025-05-19 23:17:57,265 - INFO - [__main__] - Best model for OGC: transformer (F1: 0.5000)
2025-05-19 23:17:57,265 - INFO - [__main__] - Best model for ONE: svm (F1: 0.6866)
2025-05-19 23:17:57,266 - INFO - [__main__] - Best model for OPC: svm (F1: 0.6522)
2025-05-19 23:17:57,266 - INFO - [__main__] - Best model for ORS: svm (F1: 0.6032)
2025-05-19 23:17:57,267 - INFO - [__main__] - Best model for PAC: logistic_regression (F1: 0.5614)
2025-05-19 23:17:57,267 - INFO - [__main__] - Best model for PAN: logistic_regression (F1: 0.5957)
2025-05-19 23:17:57,268 - INFO - [__main__] - Best model for PCG: transformer (F1: 0.6000)
2025-05-19 23:17:57,269 - INFO - [__main__] - Best model for PCT: svm (F1: 0.7246)
2025-05-19 23:17:57,269 - INFO - [__main__] - Best model for PDC: svm (F1: 0.7059)
2025-05-19 23:17:57,270 - INFO - [__main__] - Best model for PDN: svm (F1: 0.4348)
2025-05-19 23:17:57,270 - INFO - [__main__] - Best model for PDR: logistic_regression (F1: 0.6102)
2025-05-19 23:17:57,271 - INFO - [__main__] - Best model for PEC: logistic_regression (F1: 0.9762)
2025-05-19 23:17:57,271 - INFO - [__main__] - Best model for PET: transformer (F1: 0.6250)
2025-05-19 23:17:57,272 - INFO - [__main__] - Best model for PFL: svm (F1: 0.7778)
2025-05-19 23:17:57,272 - INFO - [__main__] - Best model for PGC: transformer (F1: 0.7606)
2025-05-19 23:17:57,273 - INFO - [__main__] - Best model for PGD: svm (F1: 0.6102)
2025-05-19 23:17:57,274 - INFO - [__main__] - Best model for PGI: svm (F1: 0.6462)
2025-05-19 23:17:57,274 - INFO - [__main__] - Best model for PGS: svm (F1: 0.6667)
2025-05-19 23:17:57,275 - INFO - [__main__] - Best model for PGT: svm (F1: 0.7778)
2025-05-19 23:17:57,275 - INFO - [__main__] - Best model for PHC: svm (F1: 0.6032)
2025-05-19 23:17:57,276 - INFO - [__main__] - Best model for PHH: svm (F1: 0.9647)
2025-05-19 23:17:57,276 - INFO - [__main__] - Best model for PHR: lstm (F1: 0.6462)
2025-05-19 23:17:57,277 - INFO - [__main__] - Best model for PHS: svm (F1: 0.8571)
2025-05-19 23:17:57,277 - INFO - [__main__] - Best model for PID: lstm (F1: 0.9885)
2025-05-19 23:17:57,278 - INFO - [__main__] - Best model for PIT: svm (F1: 0.6250)
2025-05-19 23:17:57,279 - INFO - [__main__] - Best model for PIV: svm (F1: 0.6250)
2025-05-19 23:17:57,279 - INFO - [__main__] - Best model for PJC: svm (F1: 0.7429)
2025-05-19 23:17:57,280 - INFO - [__main__] - Best model for PJS: svm (F1: 0.9000)
2025-05-19 23:17:57,280 - INFO - [__main__] - Best model for PJT: svm (F1: 0.7246)
2025-05-19 23:17:57,281 - INFO - [__main__] - Best model for PLC: svm (F1: 0.6250)
2025-05-19 23:17:57,282 - INFO - [__main__] - Best model for PMC: lstm (F1: 0.4348)
2025-05-19 23:17:57,282 - INFO - [__main__] - Best model for PMS: lstm (F1: 0.7429)
2025-05-19 23:17:57,283 - INFO - [__main__] - Best model for PMT: svm (F1: 0.9000)
2025-05-19 23:17:57,283 - INFO - [__main__] - Best model for PNC: svm (F1: 0.6122)
2025-05-19 23:17:57,284 - INFO - [__main__] - Best model for PNJ: svm (F1: 0.4286)
2025-05-19 23:17:57,285 - INFO - [__main__] - Best model for POM: logistic_regression (F1: 0.5385)
2025-05-19 23:17:57,285 - INFO - [__main__] - Best model for POT: svm (F1: 0.7059)
2025-05-19 23:17:57,286 - INFO - [__main__] - Best model for POV: svm (F1: 0.7246)
2025-05-19 23:17:57,286 - INFO - [__main__] - Best model for PPC: svm (F1: 0.5957)
2025-05-19 23:17:57,287 - INFO - [__main__] - Best model for PPE: logistic_regression (F1: 0.7576)
2025-05-19 23:17:57,288 - INFO - [__main__] - Best model for PPI: svm (F1: 0.9885)
2025-05-19 23:17:57,288 - INFO - [__main__] - Best model for PPP: svm (F1: 0.7246)
2025-05-19 23:17:57,289 - INFO - [__main__] - Best model for PPS: lstm (F1: 0.7246)
2025-05-19 23:17:57,289 - INFO - [__main__] - Best model for PRC: svm (F1: 0.6866)
2025-05-19 23:17:57,290 - INFO - [__main__] - Best model for PSB: svm (F1: 0.2609)
2025-05-19 23:17:57,291 - INFO - [__main__] - Best model for PSC: svm (F1: 0.7606)
2025-05-19 23:17:57,291 - INFO - [__main__] - Best model for PSG: lstm (F1: 0.9885)
2025-05-19 23:17:57,292 - INFO - [__main__] - Best model for PSI: svm (F1: 0.7246)
2025-05-19 23:17:57,292 - INFO - [__main__] - Best model for PSL: logistic_regression (F1: 0.5128)
2025-05-19 23:17:57,293 - INFO - [__main__] - Best model for PSP: svm (F1: 0.7606)
2025-05-19 23:17:57,294 - INFO - [__main__] - Best model for PTB: svm (F1: 0.5333)
2025-05-19 23:17:57,294 - INFO - [__main__] - Best model for PTC: transformer (F1: 0.5957)
2025-05-19 23:17:57,295 - INFO - [__main__] - Best model for PTD: svm (F1: 0.7188)
2025-05-19 23:17:57,296 - INFO - [__main__] - Best model for PTG: lstm (F1: 0.9885)
2025-05-19 23:17:57,296 - INFO - [__main__] - Best model for PTH: lstm (F1: 0.9647)
2025-05-19 23:17:57,296 - INFO - [__main__] - Best model for PTI: lstm (F1: 0.7246)
2025-05-19 23:17:57,297 - INFO - [__main__] - Best model for PTL: transformer (F1: 0.5806)
2025-05-19 23:17:57,297 - INFO - [__main__] - Best model for PTP: svm (F1: 0.6441)
2025-05-19 23:17:57,298 - INFO - [__main__] - Best model for PTS: transformer (F1: 0.7536)
2025-05-19 23:17:57,299 - INFO - [__main__] - Best model for PTT: svm (F1: 0.8108)
2025-05-19 23:17:57,299 - INFO - [__main__] - Best model for PV2: svm (F1: 0.8108)
2025-05-19 23:17:57,300 - INFO - [__main__] - Best model for PVA: svm (F1: 0.9885)
2025-05-19 23:17:57,301 - INFO - [__main__] - Best model for PVC: logistic_regression (F1: 0.6182)
2025-05-19 23:17:57,301 - INFO - [__main__] - Best model for PVD: transformer (F1: 0.6296)
2025-05-19 23:17:57,303 - INFO - [__main__] - Best model for PVE: lstm (F1: 0.7606)
2025-05-19 23:17:57,303 - INFO - [__main__] - Best model for PVG: logistic_regression (F1: 0.5833)
2025-05-19 23:17:57,304 - INFO - [__main__] - Best model for PVI: svm (F1: 0.6522)
2025-05-19 23:17:57,305 - INFO - [__main__] - Best model for PVL: svm (F1: 0.8108)
2025-05-19 23:17:57,305 - INFO - [__main__] - Best model for PVR: lstm (F1: 0.8861)
2025-05-19 23:17:57,306 - INFO - [__main__] - Best model for PVS: svm (F1: 0.6250)
2025-05-19 23:17:57,306 - INFO - [__main__] - Best model for PVT: transformer (F1: 0.3200)
2025-05-19 23:17:57,307 - INFO - [__main__] - Best model for PVV: lstm (F1: 0.8000)
2025-05-19 23:17:57,308 - INFO - [__main__] - Best model for PVX: lstm (F1: 0.7778)
2025-05-19 23:17:57,308 - INFO - [__main__] - Best model for PX1: lstm (F1: 0.9885)
2025-05-19 23:17:57,309 - INFO - [__main__] - Best model for PXA: lstm (F1: 0.7945)
2025-05-19 23:17:57,310 - INFO - [__main__] - Best model for PXI: logistic_regression (F1: 0.7164)
2025-05-19 23:17:57,310 - INFO - [__main__] - Best model for PXL: svm (F1: 0.6250)
2025-05-19 23:17:57,311 - INFO - [__main__] - Best model for PXM: lstm (F1: 0.8571)
2025-05-19 23:17:57,312 - INFO - [__main__] - Best model for PXS: transformer (F1: 0.4651)
2025-05-19 23:17:57,312 - INFO - [__main__] - Best model for PXT: transformer (F1: 0.4762)
2025-05-19 23:17:57,313 - INFO - [__main__] - Best model for QCC: svm (F1: 0.8861)
2025-05-19 23:17:57,314 - INFO - [__main__] - Best model for QCG: lstm (F1: 0.6667)
2025-05-19 23:17:57,314 - INFO - [__main__] - Best model for QNC: svm (F1: 0.6866)
2025-05-19 23:17:57,314 - INFO - [__main__] - Best model for QST: transformer (F1: 0.9383)
2025-05-19 23:17:57,314 - INFO - [__main__] - Best model for QTC: svm (F1: 0.8421)
2025-05-19 23:17:57,315 - INFO - [__main__] - Best model for RAL: logistic_regression (F1: 0.6207)
2025-05-19 23:17:57,316 - INFO - [__main__] - Best model for RCL: transformer (F1: 0.7761)
2025-05-19 23:17:57,316 - INFO - [__main__] - Best model for REE: svm (F1: 0.5106)
2025-05-19 23:17:57,318 - INFO - [__main__] - Best model for RIC: lstm (F1: 0.7945)
2025-05-19 23:17:57,318 - INFO - [__main__] - Best model for S12: svm (F1: 0.9268)
2025-05-19 23:17:57,319 - INFO - [__main__] - Best model for S27: lstm (F1: 0.9885)
2025-05-19 23:17:57,319 - INFO - [__main__] - Best model for S55: svm (F1: 0.9268)
2025-05-19 23:17:57,320 - INFO - [__main__] - Best model for S74: svm (F1: 0.8571)
2025-05-19 23:17:57,321 - INFO - [__main__] - Best model for S96: lstm (F1: 0.9885)
2025-05-19 23:17:57,321 - INFO - [__main__] - Best model for S99: svm (F1: 0.6545)
2025-05-19 23:17:57,322 - INFO - [__main__] - Best model for SAF: svm (F1: 0.7945)
2025-05-19 23:17:57,322 - INFO - [__main__] - Best model for SAM: transformer (F1: 0.5263)
2025-05-19 23:17:57,323 - INFO - [__main__] - Best model for SAP: svm (F1: 0.9136)
2025-05-19 23:17:57,323 - INFO - [__main__] - Best model for SAV: lstm (F1: 0.5818)
2025-05-19 23:17:57,324 - INFO - [__main__] - Best model for SBA: lstm (F1: 0.6667)
2025-05-19 23:17:57,324 - INFO - [__main__] - Best model for SBS: svm (F1: 0.4865)
2025-05-19 23:17:57,325 - INFO - [__main__] - Best model for SBT: svm (F1: 0.7692)
2025-05-19 23:17:57,325 - INFO - [__main__] - Best model for SC5: logistic_regression (F1: 0.6441)
2025-05-19 23:17:57,326 - INFO - [__main__] - Best model for SCC: lstm (F1: 0.9000)
2025-05-19 23:17:57,327 - INFO - [__main__] - Best model for SCD: lstm (F1: 0.8378)
2025-05-19 23:17:57,327 - INFO - [__main__] - Best model for SCJ: svm (F1: 0.7945)
2025-05-19 23:17:57,328 - INFO - [__main__] - Best model for SCL: logistic_regression (F1: 0.5116)
2025-05-19 23:17:57,328 - INFO - [__main__] - Best model for SCO: logistic_regression (F1: 0.9398)
2025-05-19 23:17:57,328 - INFO - [__main__] - Best model for SCR: lstm (F1: 0.6780)
2025-05-19 23:17:57,328 - INFO - [__main__] - Best model for SD1: lstm (F1: 0.9885)
2025-05-19 23:17:57,330 - INFO - [__main__] - Best model for SD2: lstm (F1: 0.7385)
2025-05-19 23:17:57,331 - INFO - [__main__] - Best model for SD4: svm (F1: 0.7606)
2025-05-19 23:17:57,331 - INFO - [__main__] - Best model for SD5: svm (F1: 0.7037)
2025-05-19 23:17:57,332 - INFO - [__main__] - Best model for SD6: lstm (F1: 0.7714)
2025-05-19 23:17:57,332 - INFO - [__main__] - Best model for SD7: lstm (F1: 0.9136)
2025-05-19 23:17:57,333 - INFO - [__main__] - Best model for SD8: logistic_regression (F1: 0.4000)
2025-05-19 23:17:57,333 - INFO - [__main__] - Best model for SD9: svm (F1: 0.6923)
2025-05-19 23:17:57,334 - INFO - [__main__] - Best model for SDA: svm (F1: 0.6462)
2025-05-19 23:17:57,334 - INFO - [__main__] - Best model for SDB: lstm (F1: 0.9885)
2025-05-19 23:17:57,335 - INFO - [__main__] - Best model for SDC: svm (F1: 0.4898)
2025-05-19 23:17:57,335 - INFO - [__main__] - Best model for SDD: lstm (F1: 0.7606)
2025-05-19 23:17:57,336 - INFO - [__main__] - Best model for SDG: svm (F1: 0.8861)
2025-05-19 23:17:57,337 - INFO - [__main__] - Best model for SDJ: lstm (F1: 0.9885)
2025-05-19 23:17:57,337 - INFO - [__main__] - Best model for SDK: svm (F1: 0.6866)
2025-05-19 23:17:57,338 - INFO - [__main__] - Best model for SDN: svm (F1: 0.7246)
2025-05-19 23:17:57,339 - INFO - [__main__] - Best model for SDP: lstm (F1: 0.8421)
2025-05-19 23:17:57,339 - INFO - [__main__] - Best model for SDT: svm (F1: 0.7059)
2025-05-19 23:17:57,340 - INFO - [__main__] - Best model for SDU: svm (F1: 0.8861)
2025-05-19 23:17:57,341 - INFO - [__main__] - Best model for SDV: logistic_regression (F1: 0.7887)
2025-05-19 23:17:57,341 - INFO - [__main__] - Best model for SDY: svm (F1: 0.8108)
2025-05-19 23:17:57,342 - INFO - [__main__] - Best model for SEB: svm (F1: 0.7246)
2025-05-19 23:17:57,342 - INFO - [__main__] - Best model for SED: svm (F1: 0.7246)
2025-05-19 23:17:57,343 - INFO - [__main__] - Best model for SFC: lstm (F1: 0.7200)
2025-05-19 23:17:57,344 - INFO - [__main__] - Best model for SFI: logistic_regression (F1: 0.6182)
2025-05-19 23:17:57,344 - INFO - [__main__] - Best model for SFN: svm (F1: 0.6866)
2025-05-19 23:17:57,345 - INFO - [__main__] - Best model for SGC: svm (F1: 0.6866)
2025-05-19 23:17:57,345 - INFO - [__main__] - Best model for SGD: transformer (F1: 0.8533)
2025-05-19 23:17:57,346 - INFO - [__main__] - Best model for SGH: svm (F1: 0.8108)
2025-05-19 23:17:57,346 - INFO - [__main__] - Best model for SGS: svm (F1: 0.7059)
2025-05-19 23:17:57,347 - INFO - [__main__] - Best model for SGT: svm (F1: 0.6667)
2025-05-19 23:17:57,347 - INFO - [__main__] - Best model for SHB: logistic_regression (F1: 0.4615)
2025-05-19 23:17:57,348 - INFO - [__main__] - Best model for SHC: svm (F1: 0.6667)
2025-05-19 23:17:57,349 - INFO - [__main__] - Best model for SHI: transformer (F1: 0.6866)
2025-05-19 23:17:57,349 - INFO - [__main__] - Best model for SHN: lstm (F1: 0.6462)
2025-05-19 23:17:57,350 - INFO - [__main__] - Best model for SHP: lstm (F1: 0.7077)
2025-05-19 23:17:57,351 - INFO - [__main__] - Best model for SHS: transformer (F1: 0.6667)
2025-05-19 23:17:57,351 - INFO - [__main__] - Best model for SII: svm (F1: 0.7429)
2025-05-19 23:17:57,352 - INFO - [__main__] - Best model for SJ1: svm (F1: 0.6866)
2025-05-19 23:17:57,352 - INFO - [__main__] - Best model for SJC: svm (F1: 0.9398)
2025-05-19 23:17:57,353 - INFO - [__main__] - Best model for SJD: logistic_regression (F1: 0.6000)
2025-05-19 23:17:57,354 - INFO - [__main__] - Best model for SJE: svm (F1: 0.6032)
2025-05-19 23:17:57,354 - INFO - [__main__] - Best model for SJM: svm (F1: 0.6462)
2025-05-19 23:17:57,355 - INFO - [__main__] - Best model for SJS: lstm (F1: 0.7429)
2025-05-19 23:17:57,356 - INFO - [__main__] - Best model for SLS: logistic_regression (F1: 0.5660)
2025-05-19 23:17:57,356 - INFO - [__main__] - Best model for SMA: logistic_regression (F1: 0.7059)
2025-05-19 23:17:57,357 - INFO - [__main__] - Best model for SMB: svm (F1: 0.7429)
2025-05-19 23:17:57,357 - INFO - [__main__] - Best model for SMC: lstm (F1: 0.5574)
2025-05-19 23:17:57,358 - INFO - [__main__] - Best model for SMT: svm (F1: 0.7246)
2025-05-19 23:17:57,359 - INFO - [__main__] - Best model for SPC: svm (F1: 0.8718)
2025-05-19 23:17:57,359 - INFO - [__main__] - Best model for SPD: logistic_regression (F1: 0.9647)
2025-05-19 23:17:57,360 - INFO - [__main__] - Best model for SPI: transformer (F1: 0.7576)
2025-05-19 23:17:57,361 - INFO - [__main__] - Best model for SPM: logistic_regression (F1: 0.7119)
2025-05-19 23:17:57,361 - INFO - [__main__] - Best model for SQC: lstm (F1: 0.9398)
2025-05-19 23:17:57,362 - INFO - [__main__] - Best model for SRA: logistic_regression (F1: 0.1714)
2025-05-19 23:17:57,363 - INFO - [__main__] - Best model for SRB: svm (F1: 0.7246)
2025-05-19 23:17:57,363 - INFO - [__main__] - Best model for SRC: transformer (F1: 0.1481)
2025-05-19 23:17:57,364 - INFO - [__main__] - Best model for SRF: logistic_regression (F1: 0.5385)
2025-05-19 23:17:57,364 - INFO - [__main__] - Best model for SSC: transformer (F1: 0.7463)
2025-05-19 23:17:57,365 - INFO - [__main__] - Best model for SSF: lstm (F1: 0.9885)
2025-05-19 23:17:57,366 - INFO - [__main__] - Best model for SSG: svm (F1: 0.7429)
2025-05-19 23:17:57,366 - INFO - [__main__] - Best model for SSI: lstm (F1: 0.0000)
2025-05-19 23:17:57,367 - INFO - [__main__] - Best model for SSM: lstm (F1: 0.7778)
2025-05-19 23:17:57,368 - INFO - [__main__] - Best model for ST8: lstm (F1: 0.0000)
2025-05-19 23:17:57,368 - INFO - [__main__] - Best model for STB: lstm (F1: 0.0000)
2025-05-19 23:17:57,369 - INFO - [__main__] - Best model for STC: logistic_regression (F1: 0.8060)
2025-05-19 23:17:57,370 - INFO - [__main__] - Best model for STG: svm (F1: 0.6462)
2025-05-19 23:17:57,370 - INFO - [__main__] - Best model for STL: lstm (F1: 0.9885)
2025-05-19 23:17:57,371 - INFO - [__main__] - Best model for STP: svm (F1: 0.7606)
2025-05-19 23:17:57,371 - INFO - [__main__] - Best model for STS: lstm (F1: 0.9885)
2025-05-19 23:17:57,372 - INFO - [__main__] - Best model for STT: svm (F1: 0.8267)
2025-05-19 23:17:57,373 - INFO - [__main__] - Best model for SVC: logistic_regression (F1: 0.3448)
2025-05-19 23:17:57,373 - INFO - [__main__] - Best model for SVI: svm (F1: 0.8421)
2025-05-19 23:17:57,374 - INFO - [__main__] - Best model for SVN: svm (F1: 0.6441)
2025-05-19 23:17:57,375 - INFO - [__main__] - Best model for SVT: transformer (F1: 0.1333)
2025-05-19 23:17:57,375 - INFO - [__main__] - Best model for SWC: svm (F1: 0.6667)
2025-05-19 23:17:57,376 - INFO - [__main__] - Best model for SZL: logistic_regression (F1: 0.5000)
2025-05-19 23:17:57,377 - INFO - [__main__] - Best model for TBC: lstm (F1: 0.6866)
2025-05-19 23:17:57,377 - INFO - [__main__] - Best model for TBT: lstm (F1: 0.9885)
2025-05-19 23:17:57,378 - INFO - [__main__] - Best model for TBX: lstm (F1: 0.9767)
2025-05-19 23:17:57,379 - INFO - [__main__] - Best model for TCL: transformer (F1: 0.4762)
2025-05-19 23:17:57,379 - INFO - [__main__] - Best model for TCM: lstm (F1: 0.4828)
2025-05-19 23:17:57,380 - INFO - [__main__] - Best model for TCO: logistic_regression (F1: 0.4242)
2025-05-19 23:17:57,381 - INFO - [__main__] - Best model for TCR: transformer (F1: 0.5778)
2025-05-19 23:17:57,381 - INFO - [__main__] - Best model for TCT: lstm (F1: 0.5574)
2025-05-19 23:17:57,382 - INFO - [__main__] - Best model for TDC: transformer (F1: 0.5128)
2025-05-19 23:17:57,382 - INFO - [__main__] - Best model for TDH: logistic_regression (F1: 0.4912)
2025-05-19 23:17:57,383 - INFO - [__main__] - Best model for TDS: svm (F1: 0.2609)
2025-05-19 23:17:57,384 - INFO - [__main__] - Best model for TDW: svm (F1: 0.8571)
2025-05-19 23:17:57,384 - INFO - [__main__] - Best model for TET: lstm (F1: 0.9647)
2025-05-19 23:17:57,385 - INFO - [__main__] - Best model for TGP: svm (F1: 0.8267)
2025-05-19 23:17:57,386 - INFO - [__main__] - Best model for TH1: logistic_regression (F1: 0.8800)
2025-05-19 23:17:57,386 - INFO - [__main__] - Best model for THB: svm (F1: 0.9136)
2025-05-19 23:17:57,387 - INFO - [__main__] - Best model for THG: svm (F1: 0.7059)
2025-05-19 23:17:57,388 - INFO - [__main__] - Best model for THT: transformer (F1: 0.7143)
2025-05-19 23:17:57,388 - INFO - [__main__] - Best model for TIE: svm (F1: 0.7945)
2025-05-19 23:17:57,389 - INFO - [__main__] - Best model for TIG: logistic_regression (F1: 0.5806)
2025-05-19 23:17:57,390 - INFO - [__main__] - Best model for TIS: svm (F1: 0.7606)
2025-05-19 23:17:57,390 - INFO - [__main__] - Best model for TIX: svm (F1: 0.8267)
2025-05-19 23:17:57,391 - INFO - [__main__] - Best model for TJC: svm (F1: 0.8108)
2025-05-19 23:17:57,392 - INFO - [__main__] - Best model for TKC: lstm (F1: 0.9885)
2025-05-19 23:17:57,392 - INFO - [__main__] - Best model for TKU: svm (F1: 0.7429)
2025-05-19 23:17:57,393 - INFO - [__main__] - Best model for TLG: logistic_regression (F1: 0.5500)
2025-05-19 23:17:57,393 - INFO - [__main__] - Best model for TLH: logistic_regression (F1: 0.3200)
2025-05-19 23:17:57,394 - INFO - [__main__] - Best model for TLT: svm (F1: 0.7778)
2025-05-19 23:17:57,394 - INFO - [__main__] - Best model for TMC: svm (F1: 0.7059)
2025-05-19 23:17:57,395 - INFO - [__main__] - Best model for TMP: lstm (F1: 0.6462)
2025-05-19 23:17:57,396 - INFO - [__main__] - Best model for TMS: svm (F1: 0.7246)
2025-05-19 23:17:57,396 - INFO - [__main__] - Best model for TMT: transformer (F1: 0.5769)
2025-05-19 23:17:57,397 - INFO - [__main__] - Best model for TMW: lstm (F1: 0.8718)
2025-05-19 23:17:57,397 - INFO - [__main__] - Best model for TMX: svm (F1: 0.8267)
2025-05-19 23:17:57,398 - INFO - [__main__] - Best model for TNA: lstm (F1: 0.8861)
2025-05-19 23:17:57,398 - INFO - [__main__] - Best model for TNB: lstm (F1: 0.7606)
2025-05-19 23:17:57,399 - INFO - [__main__] - Best model for TNC: svm (F1: 0.5574)
2025-05-19 23:17:57,399 - INFO - [__main__] - Best model for TNG: svm (F1: 0.6462)
2025-05-19 23:17:57,400 - INFO - [__main__] - Best model for TNM: svm (F1: 0.9885)
2025-05-19 23:17:57,401 - INFO - [__main__] - Best model for TNT: logistic_regression (F1: 0.4500)
2025-05-19 23:17:57,401 - INFO - [__main__] - Best model for TPC: svm (F1: 0.7778)
2025-05-19 23:17:57,402 - INFO - [__main__] - Best model for TPH: svm (F1: 0.8718)
2025-05-19 23:17:57,402 - INFO - [__main__] - Best model for TPP: svm (F1: 0.7429)
2025-05-19 23:17:57,403 - INFO - [__main__] - Best model for TRA: svm (F1: 0.6032)
2025-05-19 23:17:57,403 - INFO - [__main__] - Best model for TRC: logistic_regression (F1: 0.4103)
2025-05-19 23:17:57,404 - INFO - [__main__] - Best model for TS4: logistic_regression (F1: 0.9885)
2025-05-19 23:17:57,404 - INFO - [__main__] - Best model for TSB: svm (F1: 0.5574)
2025-05-19 23:17:57,405 - INFO - [__main__] - Best model for TSC: svm (F1: 0.6349)
2025-05-19 23:17:57,406 - INFO - [__main__] - Best model for TST: svm (F1: 0.8108)
2025-05-19 23:17:57,406 - INFO - [__main__] - Best model for TTC: svm (F1: 0.7246)
2025-05-19 23:17:57,407 - INFO - [__main__] - Best model for TTF: svm (F1: 0.5098)
2025-05-19 23:17:57,407 - INFO - [__main__] - Best model for TTG: svm (F1: 0.7945)
2025-05-19 23:17:57,408 - INFO - [__main__] - Best model for TV1: svm (F1: 0.6462)
2025-05-19 23:17:57,408 - INFO - [__main__] - Best model for TV2: svm (F1: 0.6032)
2025-05-19 23:17:57,409 - INFO - [__main__] - Best model for TV3: svm (F1: 0.6667)
2025-05-19 23:17:57,410 - INFO - [__main__] - Best model for TV4: svm (F1: 0.8267)
2025-05-19 23:17:57,410 - INFO - [__main__] - Best model for TVD: logistic_regression (F1: 0.5806)
2025-05-19 23:17:57,411 - INFO - [__main__] - Best model for TVG: lstm (F1: 0.9885)
2025-05-19 23:17:57,411 - INFO - [__main__] - Best model for TXM: svm (F1: 0.6250)
2025-05-19 23:17:57,412 - INFO - [__main__] - Best model for TYA: lstm (F1: 0.7606)
2025-05-19 23:17:57,412 - INFO - [__main__] - Best model for UDC: lstm (F1: 0.5385)
2025-05-19 23:17:57,413 - INFO - [__main__] - Best model for UDJ: svm (F1: 0.7429)
2025-05-19 23:17:57,413 - INFO - [__main__] - Best model for UIC: svm (F1: 0.7246)
2025-05-19 23:17:57,414 - INFO - [__main__] - Best model for UNI: logistic_regression (F1: 0.6512)
2025-05-19 23:17:57,415 - INFO - [__main__] - Best model for V12: svm (F1: 0.7246)
2025-05-19 23:17:57,415 - INFO - [__main__] - Best model for V15: lstm (F1: 0.9885)
2025-05-19 23:17:57,416 - INFO - [__main__] - Best model for V21: logistic_regression (F1: 0.7619)
2025-05-19 23:17:57,416 - INFO - [__main__] - Best model for VBC: svm (F1: 0.7246)
2025-05-19 23:17:57,417 - INFO - [__main__] - Best model for VBH: svm (F1: 0.6885)
2025-05-19 23:17:57,417 - INFO - [__main__] - Best model for VC1: svm (F1: 0.7778)
2025-05-19 23:17:57,418 - INFO - [__main__] - Best model for VC2: svm (F1: 0.6250)
2025-05-19 23:17:57,418 - INFO - [__main__] - Best model for VC3: lstm (F1: 0.6250)
2025-05-19 23:17:57,419 - INFO - [__main__] - Best model for VC5: svm (F1: 0.8718)
2025-05-19 23:17:57,420 - INFO - [__main__] - Best model for VC6: lstm (F1: 0.7945)
2025-05-19 23:17:57,420 - INFO - [__main__] - Best model for VC7: lstm (F1: 0.4211)
2025-05-19 23:17:57,421 - INFO - [__main__] - Best model for VC9: svm (F1: 0.7778)
2025-05-19 23:17:57,421 - INFO - [__main__] - Best model for VCA: logistic_regression (F1: 0.4444)
2025-05-19 23:17:57,422 - INFO - [__main__] - Best model for VCB: svm (F1: 0.6111)
2025-05-19 23:17:57,422 - INFO - [__main__] - Best model for VCC: svm (F1: 0.6667)
2025-05-19 23:17:57,423 - INFO - [__main__] - Best model for VCF: logistic_regression (F1: 0.6774)
2025-05-19 23:17:57,423 - INFO - [__main__] - Best model for VCG: svm (F1: 0.6275)
2025-05-19 23:17:57,424 - INFO - [__main__] - Best model for VCM: svm (F1: 0.6667)
2025-05-19 23:17:57,425 - INFO - [__main__] - Best model for VCR: svm (F1: 0.4545)
2025-05-19 23:17:57,425 - INFO - [__main__] - Best model for VCS: svm (F1: 0.4286)
2025-05-19 23:17:57,426 - INFO - [__main__] - Best model for VCT: lstm (F1: 0.9885)
2025-05-19 23:17:57,426 - INFO - [__main__] - Best model for VDL: svm (F1: 0.9647)
2025-05-19 23:17:57,427 - INFO - [__main__] - Best model for VDN: lstm (F1: 0.7606)
2025-05-19 23:17:57,427 - INFO - [__main__] - Best model for VDS: logistic_regression (F1: 0.5806)
2025-05-19 23:17:57,428 - INFO - [__main__] - Best model for VDT: svm (F1: 0.8421)
2025-05-19 23:17:57,428 - INFO - [__main__] - Best model for VE1: transformer (F1: 0.7606)
2025-05-19 23:17:57,429 - INFO - [__main__] - Best model for VE2: transformer (F1: 0.9885)
2025-05-19 23:17:57,429 - INFO - [__main__] - Best model for VE3: svm (F1: 0.7945)
2025-05-19 23:17:57,430 - INFO - [__main__] - Best model for VE4: lstm (F1: 0.9885)
2025-05-19 23:17:57,431 - INFO - [__main__] - Best model for VE8: transformer (F1: 0.7945)
2025-05-19 23:17:57,431 - INFO - [__main__] - Best model for VE9: lstm (F1: 0.8000)
2025-05-19 23:17:57,432 - INFO - [__main__] - Best model for VES: svm (F1: 0.9143)
2025-05-19 23:17:57,432 - INFO - [__main__] - Best model for VFC: lstm (F1: 0.8108)
2025-05-19 23:17:57,433 - INFO - [__main__] - Best model for VFG: svm (F1: 0.6462)
2025-05-19 23:17:57,433 - INFO - [__main__] - Best model for VFR: svm (F1: 0.6866)
2025-05-19 23:17:57,434 - INFO - [__main__] - Best model for VGP: svm (F1: 0.7059)
2025-05-19 23:17:57,434 - INFO - [__main__] - Best model for VGS: lstm (F1: 0.4118)
2025-05-19 23:17:57,435 - INFO - [__main__] - Best model for VHC: lstm (F1: 0.6250)
2025-05-19 23:17:57,436 - INFO - [__main__] - Best model for VHF: lstm (F1: 0.9885)
2025-05-19 23:17:57,436 - INFO - [__main__] - Best model for VHG: transformer (F1: 0.6154)
2025-05-19 23:17:57,437 - INFO - [__main__] - Best model for VHH: logistic_regression (F1: 0.4651)
2025-05-19 23:17:57,437 - INFO - [__main__] - Best model for VHL: lstm (F1: 0.7536)
2025-05-19 23:17:57,438 - INFO - [__main__] - Best model for VIC: svm (F1: 0.5098)
2025-05-19 23:17:57,438 - INFO - [__main__] - Best model for VID: svm (F1: 0.1481)
2025-05-19 23:17:57,439 - INFO - [__main__] - Best model for VIE: svm (F1: 0.7797)
2025-05-19 23:17:57,439 - INFO - [__main__] - Best model for VIG: svm (F1: 0.6866)
2025-05-19 23:17:57,440 - INFO - [__main__] - Best model for VIP: logistic_regression (F1: 0.5333)
2025-05-19 23:17:57,441 - INFO - [__main__] - Best model for VIR: lstm (F1: 0.9647)
2025-05-19 23:17:57,441 - INFO - [__main__] - Best model for VIT: svm (F1: 0.7606)
2025-05-19 23:17:57,442 - INFO - [__main__] - Best model for VIX: svm (F1: 0.6667)
2025-05-19 23:17:57,442 - INFO - [__main__] - Best model for VKC: lstm (F1: 0.7606)
2025-05-19 23:17:57,443 - INFO - [__main__] - Best model for VLA: svm (F1: 0.6866)
2025-05-19 23:17:57,443 - INFO - [__main__] - Best model for VLF: lstm (F1: 0.8219)
2025-05-19 23:17:57,443 - INFO - [__main__] - Best model for VMC: svm (F1: 0.7059)
2025-05-19 23:17:57,445 - INFO - [__main__] - Best model for VMD: transformer (F1: 0.6452)
2025-05-19 23:17:57,445 - INFO - [__main__] - Best model for VNA: svm (F1: 0.5806)
2025-05-19 23:17:57,446 - INFO - [__main__] - Best model for VNC: svm (F1: 0.7778)
2025-05-19 23:17:57,447 - INFO - [__main__] - Best model for VND: logistic_regression (F1: 0.6400)
2025-05-19 23:17:57,447 - INFO - [__main__] - Best model for VNE: transformer (F1: 0.5000)
2025-05-19 23:17:57,448 - INFO - [__main__] - Best model for VNF: svm (F1: 0.6667)
2025-05-19 23:17:57,448 - INFO - [__main__] - Best model for VNG: svm (F1: 0.5574)
2025-05-19 23:17:57,449 - INFO - [__main__] - Best model for VNH: lstm (F1: 0.8571)
2025-05-19 23:17:57,449 - INFO - [__main__] - Best model for VNI: lstm (F1: 0.8615)
2025-05-19 23:17:57,450 - INFO - [__main__] - Best model for VNL: svm (F1: 0.7059)
2025-05-19 23:17:57,450 - INFO - [__main__] - Best model for VNM: logistic_regression (F1: 0.5333)
2025-05-19 23:17:57,451 - INFO - [__main__] - Best model for VNR: svm (F1: 0.7246)
2025-05-19 23:17:57,452 - INFO - [__main__] - Best model for VNS: svm (F1: 0.6667)
2025-05-19 23:17:57,452 - INFO - [__main__] - Best model for VNT: svm (F1: 0.8571)
2025-05-19 23:17:57,453 - INFO - [__main__] - Best model for VNX: svm (F1: 0.9136)
2025-05-19 23:17:57,454 - INFO - [__main__] - Best model for VOS: transformer (F1: 0.6667)
2025-05-19 23:17:57,454 - INFO - [__main__] - Best model for VPC: svm (F1: 0.9136)
2025-05-19 23:17:57,455 - INFO - [__main__] - Best model for VPH: svm (F1: 0.2727)
2025-05-19 23:17:57,455 - INFO - [__main__] - Best model for VQC: svm (F1: 0.7606)
2025-05-19 23:17:57,456 - INFO - [__main__] - Best model for VRC: svm (F1: 0.5862)
2025-05-19 23:17:57,456 - INFO - [__main__] - Best model for VSC: svm (F1: 0.7213)
2025-05-19 23:17:57,457 - INFO - [__main__] - Best model for VSG: svm (F1: 0.8718)
2025-05-19 23:17:57,457 - INFO - [__main__] - Best model for VSH: lstm (F1: 0.7945)
2025-05-19 23:17:57,458 - INFO - [__main__] - Best model for VSI: logistic_regression (F1: 0.4651)
2025-05-19 23:17:57,458 - INFO - [__main__] - Best model for VST: svm (F1: 0.7778)
2025-05-19 23:17:57,459 - INFO - [__main__] - Best model for VTA: svm (F1: 0.7606)
2025-05-19 23:17:57,460 - INFO - [__main__] - Best model for VTB: transformer (F1: 0.5926)
2025-05-19 23:17:57,460 - INFO - [__main__] - Best model for VTC: svm (F1: 0.6667)
2025-05-19 23:17:57,461 - INFO - [__main__] - Best model for VTI: logistic_regression (F1: 0.8421)
2025-05-19 23:17:57,461 - INFO - [__main__] - Best model for VTL: transformer (F1: 0.8378)
2025-05-19 23:17:57,462 - INFO - [__main__] - Best model for VTO: transformer (F1: 0.4444)
2025-05-19 23:17:57,462 - INFO - [__main__] - Best model for VTS: svm (F1: 0.8718)
2025-05-19 23:17:57,463 - INFO - [__main__] - Best model for VTV: svm (F1: 0.6667)
2025-05-19 23:17:57,463 - INFO - [__main__] - Best model for VXB: svm (F1: 0.9398)
2025-05-19 23:17:57,464 - INFO - [__main__] - Best model for WCS: svm (F1: 0.7429)
2025-05-19 23:17:57,464 - INFO - [__main__] - Best model for WSB: svm (F1: 0.7429)
2025-05-19 23:17:57,465 - INFO - [__main__] - Best model for WSS: lstm (F1: 0.8525)
2025-05-19 23:17:57,465 - INFO - [__main__] - Best model for WTC: logistic_regression (F1: 0.4571)
2025-05-19 23:17:57,466 - INFO - [__main__] - Best model for XMC: lstm (F1: 0.6462)
2025-05-19 23:17:57,467 - INFO - [__main__] - Best model for YBC: logistic_regression (F1: 0.5652)
2025-05-19 23:17:57,467 - INFO - [__main__] - Getting last prediction for all tickers
2025-05-19 23:17:57,467 - INFO - [__main__] - 
==================================================
2025-05-19 23:17:57,467 - INFO - [__main__] - Getting last prediction point for all tickers
2025-05-19 23:17:57,467 - INFO - [__main__] - ==================================================
2025-05-19 23:17:59,907 - INFO - [__main__] - Found 714 tickers: AAA, AAM, ABI, ABT, ACB, ACC, ACE, ACL, ADC, ADP, AGF, AGM, AGR, ALT, ALV, AMC, AME, AMV, ANV, APC, APG, API, APP, APS, ARM, ASA, ASM, ASP, ATA, AVF, BBC, BBS, BCC, BCE, BDB, BED, BHC, BIC, BKC, BLF, BMC, BMI, BMJ, BMP, BPC, BRC, BSC, BSI, BST, BT6, BTG, BTH, BTP, BTS, BTT, BTW, BVG, BVH, BVN, BVS, BWA, BXH, C21, C32, C47, C92, CAD, CAN, CAP, CCI, CCL, CCM, CDC, CHP, CI5, CID, CIG, CII, CJC, CKV, CLC, CLG, CLW, CMC, CMG, CMI, CMS, CMT, CMV, CMX, CNG, CNT, COM, CPC, CSC, CSM, CT3, CT6, CTA, CTB, CTD, CTG, CTI, CTN, CTS, CTX, CVN, CVT, CX8, CYC, D11, D2D, DAC, DAD, DAE, DAG, DBC, DBM, DBT, DC2, DC4, DCL, DCS, DCT, DDM, DDN, DGT, DHA, DHC, DHG, DHM, DHT, DIC, DID, DIG, DIH, DL1, DLD, DLG, DLR, DMC, DNC, DNL, DNM, DNP, DNT, DPC, DPM, DPP, DPR, DQC, DRC, DRH, DRL, DSN, DST, DTA, DTC, DTL, DTT, DVP, DXG, DXL, DXP, DXV, DZM, EBS, ECI, EFI, EIB, EID, ELC, EVE, FBA, FCN, FDC, FLC, FMC, FPT, GAS, GDT, GDW, GER, GGG, GHC, GIL, GLT, GMC, GMD, GMX, GSP, GTA, GTT, H11, HAD, HAG, HAI, HAP, HAS, HAT, HAX, HBC, HBD, HBS, HCC, HCI, HCM, HCT, HDA, HDC, HDG, HDM, HDO, HEV, HFC, HFX, HGM, HHC, HHG, HHS, HIG, HJS, HLA, HLC, HLY, HMC, HMH, HNM, HOM, HOT, HPB, HPG, HPP, HPT, HQC, HRC, HSG, HSI, HT1, HTC, HTI, HTL, HTP, HTV, HU1, HU3, HUT, HVG, HVT, HVX, ICF, ICG, ICI, IDI, IDJ, IDV, IFS, IHK, IJC, ILC, IME, IMP, IN4, INC, INN, ITA, ITC, ITD, ITQ, IVS, JVC, KAC, KBC, KCE, KDC, KDH, KHL, KHP, KKC, KMR, KMT, KSB, KSD, KSH, KST, KTS, KTT, L10, L14, L18, L35, L43, L44, L61, L62, LAF, LAS, LBE, LBM, LCC, LCD, LCG, LCM, LCS, LDP, LGC, LGL, LHC, LHG, LIG, LIX, LKW, LM3, LM7, LM8, LO5, LSS, LTC, LUT, MAC, MAS, MBB, MCC, MCF, MCG, MCO, MCP, MDC, MDF, MDG, MEC, MEF, MHC, MHL, MIC, MIM, MKV, MPC, MSN, MTC, MTG, MTH, MTP, NAG, NAV, NBB, NBC, NBP, NBW, ND2, NDC, NDN, NET, NGC, NHA, NHC, NKG, NNC, NNT, NOS, NSC, NST, NT2, NTB, NTL, NTP, NTW, NVB, NVT, OCH, OGC, ONE, OPC, ORS, PAC, PAN, PCG, PCT, PDC, PDN, PDR, PEC, PET, PFL, PGC, PGD, PGI, PGS, PGT, PHC, PHH, PHR, PHS, PID, PIT, PIV, PJC, PJS, PJT, PLC, PMC, PMS, PMT, PNC, PNJ, POM, POT, POV, PPC, PPE, PPI, PPP, PPS, PRC, PSB, PSC, PSG, PSI, PSL, PSP, PTB, PTC, PTD, PTG, PTH, PTI, PTL, PTP, PTS, PTT, PV2, PVA, PVC, PVD, PVE, PVG, PVI, PVL, PVR, PVS, PVT, PVV, PVX, PX1, PXA, PXI, PXL, PXM, PXS, PXT, QCC, QCG, QNC, QST, QTC, RAL, RCL, REE, RIC, S12, S27, S55, S74, S96, S99, SAF, SAM, SAP, SAV, SBA, SBS, SBT, SC5, SCC, SCD, SCJ, SCL, SCO, SCR, SD1, SD2, SD4, SD5, SD6, SD7, SD8, SD9, SDA, SDB, SDC, SDD, SDG, SDJ, SDK, SDN, SDP, SDT, SDU, SDV, SDY, SEB, SED, SFC, SFI, SFN, SGC, SGD, SGH, SGS, SGT, SHB, SHC, SHI, SHN, SHP, SHS, SII, SJ1, SJC, SJD, SJE, SJM, SJS, SLS, SMA, SMB, SMC, SMT, SPC, SPD, SPI, SPM, SQC, SRA, SRB, SRC, SRF, SSC, SSF, SSG, SSI, SSM, ST8, STB, STC, STG, STL, STP, STS, STT, SVC, SVI, SVN, SVT, SWC, SZL, TBC, TBT, TBX, TCL, TCM, TCO, TCR, TCT, TDC, TDH, TDS, TDW, TET, TGP, TH1, THB, THG, THT, TIE, TIG, TIS, TIX, TJC, TKC, TKU, TLG, TLH, TLT, TMC, TMP, TMS, TMT, TMW, TMX, TNA, TNB, TNC, TNG, TNM, TNT, TPC, TPH, TPP, TRA, TRC, TS4, TSB, TSC, TST, TTC, TTF, TTG, TV1, TV2, TV3, TV4, TVD, TVG, TXM, TYA, UDC, UDJ, UIC, UNI, V12, V15, V21, VBC, VBH, VC1, VC2, VC3, VC5, VC6, VC7, VC9, VCA, VCB, VCC, VCF, VCG, VCM, VCR, VCS, VCT, VDL, VDN, VDS, VDT, VE1, VE2, VE3, VE4, VE8, VE9, VES, VFC, VFG, VFR, VGP, VGS, VHC, VHF, VHG, VHH, VHL, VIC, VID, VIE, VIG, VIP, VIR, VIT, VIX, VKC, VLA, VLF, VMC, VMD, VNA, VNC, VND, VNE, VNF, VNG, VNH, VNI, VNL, VNM, VNR, VNS, VNT, VNX, VOS, VPC, VPH, VQC, VRC, VSC, VSG, VSH, VSI, VST, VTA, VTB, VTC, VTI, VTL, VTO, VTS, VTV, VXB, WCS, WSB, WSS, WTC, XMC, YBC
2025-05-19 23:17:59,907 - INFO - [__main__] - 
Processing ticker: AAA
2025-05-19 23:17:59,907 - INFO - [__main__] - 
==================================================
2025-05-19 23:17:59,907 - INFO - [__main__] - Getting last prediction point for ticker: AAA
2025-05-19 23:17:59,908 - INFO - [__main__] - ==================================================
2025-05-19 23:17:59,908 - INFO - [__main__] - Preparing test data for AAA...
2025-05-19 23:17:59,938 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:17:59,938 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:17:59,938 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:17:59,958 - INFO - [src.data_preparation] - Ticker AAA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:17:59,959 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:18:00,275 - INFO - [src.data_preparation] - Ticker AAA - Selected features:
2025-05-19 23:18:00,275 - INFO - [src.data_preparation] -   SK: 0.0734
2025-05-19 23:18:00,275 - INFO - [src.data_preparation] -   insec_t: 0.0689
2025-05-19 23:18:00,275 - INFO - [src.data_preparation] -   vnipc_t: 0.0684
2025-05-19 23:18:00,275 - INFO - [src.data_preparation] -   Volatility: 0.0664
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   PM: 0.0585
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   ma21_t: 0.0569
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   s_d7_t: 0.0565
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   variation_t: 0.0547
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   ma7_t: 0.0547
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   ret: 0.0543
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   ma14_t: 0.0537
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   LO: 0.0534
2025-05-19 23:18:00,276 - INFO - [src.data_preparation] -   Median_HL: 0.0529
2025-05-19 23:18:00,279 - INFO - [src.data_preparation] - Ticker AAA - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'Volatility', 'TVV', 'ATR', 'PM', 'ma21_t', 's_d7_t', 'variation_t', 'ma7_t', 'ret', 'ma14_t', 'LO', 'Median_HL']
2025-05-19 23:18:00,382 - INFO - [src.data_preparation] - Ticker AAA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:00,382 - INFO - [src.data_preparation] - Ticker AAA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:00,385 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AAA
2025-05-19 23:18:00,385 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:00,385 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:18:00,385 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:18:00,390 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:18:00,390 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:18:00,395 - INFO - [src.data_preparation] - Ticker AAA - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:00,395 - INFO - [__main__] - Using best model for AAA: svm (F1: 0.5263)
2025-05-19 23:18:00,395 - INFO - [__main__] - Loading svm model for AAA...
2025-05-19 23:18:00,398 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:00,398 - INFO - [__main__] - Model size: 0.69 MB
2025-05-19 23:18:00,398 - INFO - [__main__] - Making predictions for AAA using svm
2025-05-19 23:18:00,399 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:00,399 - INFO - [__main__] - Successfully got last prediction for AAA
2025-05-19 23:18:00,400 - INFO - [__main__] - 
Processing ticker: AAM
2025-05-19 23:18:00,400 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:00,400 - INFO - [__main__] - Getting last prediction point for ticker: AAM
2025-05-19 23:18:00,400 - INFO - [__main__] - ==================================================
2025-05-19 23:18:00,400 - INFO - [__main__] - Preparing test data for AAM...
2025-05-19 23:18:00,438 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:00,439 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:00,439 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:00,467 - INFO - [src.data_preparation] - Ticker AAM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:00,467 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(300), np.int64(1): np.int64(339)}
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] - Ticker AAM - Selected features:
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   vnipc_t: 0.0797
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   Volatility: 0.0672
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   insec_t: 0.0641
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   PM: 0.0601
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   Median_HL: 0.0587
2025-05-19 23:18:00,874 - INFO - [src.data_preparation] -   SR: 0.0576
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   s_d7_t: 0.0575
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   ATR: 0.0570
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   HL: 0.0538
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   ma14_t: 0.0536
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   ma7_t: 0.0533
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:18:00,875 - INFO - [src.data_preparation] -   ma21_t: 0.0509
2025-05-19 23:18:00,877 - INFO - [src.data_preparation] - Ticker AAM - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'insec_t', 'PM', 'TVV', 'Median_HL', 'SR', 's_d7_t', 'ATR', 'HL', 'ma14_t', 'ma7_t', 'ret', 'ma21_t']
2025-05-19 23:18:00,956 - INFO - [src.data_preparation] - Ticker AAM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:00,956 - INFO - [src.data_preparation] - Ticker AAM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:00,957 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AAM
2025-05-19 23:18:00,957 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:00,957 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:18:00,957 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:18:00,959 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:18:00,959 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:18:00,962 - INFO - [src.data_preparation] - Ticker AAM - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:00,962 - INFO - [__main__] - Using best model for AAM: transformer (F1: 0.5366)
2025-05-19 23:18:00,962 - INFO - [__main__] - Loading transformer model for AAM...
2025-05-19 23:18:03,835 - INFO - [__main__] - Model loaded in 2.87 seconds
2025-05-19 23:18:03,837 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:18:03,837 - INFO - [__main__] - Making predictions for AAM using transformer
2025-05-19 23:18:03,849 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:18:03,850 - INFO - [__main__] - Successfully got last prediction for AAM
2025-05-19 23:18:03,850 - INFO - [__main__] - 
Processing ticker: ABI
2025-05-19 23:18:03,850 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:03,850 - INFO - [__main__] - Getting last prediction point for ticker: ABI
2025-05-19 23:18:03,850 - INFO - [__main__] - ==================================================
2025-05-19 23:18:03,850 - INFO - [__main__] - Preparing test data for ABI...
2025-05-19 23:18:03,885 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:03,886 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:03,886 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:03,914 - INFO - [src.data_preparation] - Ticker ABI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:03,914 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(366)}
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] - Ticker ABI - Selected features:
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   insec_t: 0.0783
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   s_d7_t: 0.0683
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   Volatility: 0.0666
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   vnipc_t: 0.0644
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   TVV: 0.0598
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   SK: 0.0578
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   Median_HL: 0.0571
2025-05-19 23:18:04,241 - INFO - [src.data_preparation] -   HL: 0.0570
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   ATR: 0.0562
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   SR: 0.0560
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   PM: 0.0559
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:18:04,242 - INFO - [src.data_preparation] -   ma21_t: 0.0542
2025-05-19 23:18:04,245 - INFO - [src.data_preparation] - Ticker ABI - Using features: ['Date', 'insec_t', 's_d7_t', 'Volatility', 'vnipc_t', 'TVV', 'SK', 'Median_HL', 'HL', 'ma7_t', 'ATR', 'SR', 'PM', 'ret', 'variation_t', 'ma21_t']
2025-05-19 23:18:04,332 - INFO - [src.data_preparation] - Ticker ABI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:04,333 - INFO - [src.data_preparation] - Ticker ABI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:04,334 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ABI
2025-05-19 23:18:04,334 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:04,335 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(185), np.int64(1): np.int64(278)}
2025-05-19 23:18:04,335 - INFO - [src.data_preparation] - Generating 93 synthetic minority samples
2025-05-19 23:18:04,339 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (556, 13, 15), y shape: (556,)
2025-05-19 23:18:04,339 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(278), np.int64(1): np.int64(278)}
2025-05-19 23:18:04,342 - INFO - [src.data_preparation] - Ticker ABI - Final 3D shapes: X_train=(556, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:04,343 - INFO - [__main__] - Using best model for ABI: svm (F1: 0.6462)
2025-05-19 23:18:04,343 - INFO - [__main__] - Loading svm model for ABI...
2025-05-19 23:18:04,344 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:04,345 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:18:04,345 - INFO - [__main__] - Making predictions for ABI using svm
2025-05-19 23:18:04,345 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:04,345 - INFO - [__main__] - Successfully got last prediction for ABI
2025-05-19 23:18:04,345 - INFO - [__main__] - 
Processing ticker: ABT
2025-05-19 23:18:04,346 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:04,346 - INFO - [__main__] - Getting last prediction point for ticker: ABT
2025-05-19 23:18:04,346 - INFO - [__main__] - ==================================================
2025-05-19 23:18:04,346 - INFO - [__main__] - Preparing test data for ABT...
2025-05-19 23:18:04,371 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:04,371 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:04,371 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:04,388 - INFO - [src.data_preparation] - Ticker ABT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:04,389 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(348)}
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] - Ticker ABT - Selected features:
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   SK: 0.0698
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   insec_t: 0.0688
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   vnipc_t: 0.0652
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   SR: 0.0640
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   TVV: 0.0634
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   HL: 0.0628
2025-05-19 23:18:04,683 - INFO - [src.data_preparation] -   Volatility: 0.0628
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   s_d7_t: 0.0624
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   ret: 0.0611
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   variation_t: 0.0590
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   LO: 0.0541
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   ma14_t: 0.0518
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   ma21_t: 0.0517
2025-05-19 23:18:04,684 - INFO - [src.data_preparation] -   ma7_t: 0.0513
2025-05-19 23:18:04,686 - INFO - [src.data_preparation] - Ticker ABT - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'SR', 'TVV', 'HL', 'Volatility', 's_d7_t', 'ret', 'ATR', 'variation_t', 'LO', 'ma14_t', 'ma21_t', 'ma7_t']
2025-05-19 23:18:04,765 - INFO - [src.data_preparation] - Ticker ABT - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:04,765 - INFO - [src.data_preparation] - Ticker ABT - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:04,766 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ABT
2025-05-19 23:18:04,767 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:04,767 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(257)}
2025-05-19 23:18:04,767 - INFO - [src.data_preparation] - Generating 52 synthetic minority samples
2025-05-19 23:18:04,769 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:18:04,769 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:18:04,772 - INFO - [src.data_preparation] - Ticker ABT - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:04,772 - INFO - [__main__] - Using best model for ABT: svm (F1: 0.6207)
2025-05-19 23:18:04,772 - INFO - [__main__] - Loading svm model for ABT...
2025-05-19 23:18:04,773 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:04,774 - INFO - [__main__] - Model size: 0.69 MB
2025-05-19 23:18:04,774 - INFO - [__main__] - Making predictions for ABT using svm
2025-05-19 23:18:04,774 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:04,775 - INFO - [__main__] - Successfully got last prediction for ABT
2025-05-19 23:18:04,775 - INFO - [__main__] - 
Processing ticker: ACB
2025-05-19 23:18:04,775 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:04,775 - INFO - [__main__] - Getting last prediction point for ticker: ACB
2025-05-19 23:18:04,775 - INFO - [__main__] - ==================================================
2025-05-19 23:18:04,775 - INFO - [__main__] - Preparing test data for ACB...
2025-05-19 23:18:04,805 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:04,805 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:04,806 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:04,839 - INFO - [src.data_preparation] - Ticker ACB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:04,840 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(270), np.int64(1): np.int64(369)}
2025-05-19 23:18:05,207 - INFO - [src.data_preparation] - Ticker ACB - Selected features:
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   SK: 0.0801
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   vnipc_t: 0.0723
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   Volatility: 0.0675
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   insec_t: 0.0664
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   s_d7_t: 0.0663
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   TVV: 0.0645
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   LO: 0.0579
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   ret: 0.0578
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   SR: 0.0572
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   variation_t: 0.0559
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   HL: 0.0548
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   ma21_t: 0.0497
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   ma14_t: 0.0495
2025-05-19 23:18:05,208 - INFO - [src.data_preparation] -   ma7_t: 0.0493
2025-05-19 23:18:05,212 - INFO - [src.data_preparation] - Ticker ACB - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'insec_t', 's_d7_t', 'TVV', 'LO', 'ret', 'SR', 'ATR', 'variation_t', 'HL', 'ma21_t', 'ma14_t', 'ma7_t']
2025-05-19 23:18:05,307 - INFO - [src.data_preparation] - Ticker ACB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:05,308 - INFO - [src.data_preparation] - Ticker ACB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:05,309 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ACB
2025-05-19 23:18:05,309 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:05,309 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:18:05,309 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:18:05,314 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:18:05,314 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:18:05,318 - INFO - [src.data_preparation] - Ticker ACB - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:05,318 - INFO - [__main__] - Using best model for ACB: svm (F1: 0.6545)
2025-05-19 23:18:05,318 - INFO - [__main__] - Loading svm model for ACB...
2025-05-19 23:18:05,319 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:05,320 - INFO - [__main__] - Model size: 0.56 MB
2025-05-19 23:18:05,320 - INFO - [__main__] - Making predictions for ACB using svm
2025-05-19 23:18:05,320 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:05,320 - INFO - [__main__] - Successfully got last prediction for ACB
2025-05-19 23:18:05,320 - INFO - [__main__] - 
Processing ticker: ACC
2025-05-19 23:18:05,320 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:05,321 - INFO - [__main__] - Getting last prediction point for ticker: ACC
2025-05-19 23:18:05,321 - INFO - [__main__] - ==================================================
2025-05-19 23:18:05,321 - INFO - [__main__] - Preparing test data for ACC...
2025-05-19 23:18:05,355 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:05,355 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:05,355 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:05,377 - INFO - [src.data_preparation] - Ticker ACC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:05,378 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:18:05,679 - INFO - [src.data_preparation] - Ticker ACC - Selected features:
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   insec_t: 0.0659
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   vnipc_t: 0.0659
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   SK: 0.0653
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   TVV: 0.0631
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   Median_HL: 0.0621
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   SR: 0.0598
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   LO: 0.0596
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   s_d7_t: 0.0577
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   ma14_t: 0.0563
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   HL: 0.0555
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   ma7_t: 0.0554
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   ma21_t: 0.0546
2025-05-19 23:18:05,680 - INFO - [src.data_preparation] -   PM: 0.0545
2025-05-19 23:18:05,681 - INFO - [src.data_preparation] -   ATR: 0.0542
2025-05-19 23:18:05,683 - INFO - [src.data_preparation] - Ticker ACC - Using features: ['Date', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 'TVV', 'Median_HL', 'SR', 'LO', 's_d7_t', 'ma14_t', 'HL', 'ma7_t', 'ma21_t', 'PM', 'ATR']
2025-05-19 23:18:05,763 - INFO - [src.data_preparation] - Ticker ACC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:05,763 - INFO - [src.data_preparation] - Ticker ACC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:05,764 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ACC
2025-05-19 23:18:05,764 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:05,764 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:18:05,764 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:18:05,767 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:18:05,767 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:18:05,770 - INFO - [src.data_preparation] - Ticker ACC - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:05,770 - INFO - [__main__] - Using best model for ACC: logistic_regression (F1: 0.6885)
2025-05-19 23:18:05,770 - INFO - [__main__] - Loading logistic_regression model for ACC...
2025-05-19 23:18:05,771 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:05,771 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:05,771 - INFO - [__main__] - Making predictions for ACC using logistic_regression
2025-05-19 23:18:05,771 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:05,772 - INFO - [__main__] - Successfully got last prediction for ACC
2025-05-19 23:18:05,772 - INFO - [__main__] - 
Processing ticker: ACE
2025-05-19 23:18:05,772 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:05,772 - INFO - [__main__] - Getting last prediction point for ticker: ACE
2025-05-19 23:18:05,772 - INFO - [__main__] - ==================================================
2025-05-19 23:18:05,772 - INFO - [__main__] - Preparing test data for ACE...
2025-05-19 23:18:05,797 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:05,797 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:05,797 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:05,815 - INFO - [src.data_preparation] - Ticker ACE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:05,815 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(227), np.int64(1): np.int64(412)}
2025-05-19 23:18:06,090 - INFO - [src.data_preparation] - Ticker ACE - Selected features:
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   HL: 0.0728
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   vnipc_t: 0.0707
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   ATR: 0.0696
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   SK: 0.0655
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   TVV: 0.0622
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   LO: 0.0610
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   insec_t: 0.0601
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   Volatility: 0.0571
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   ma7_t: 0.0552
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   ma14_t: 0.0544
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   ret: 0.0536
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   ma21_t: 0.0534
2025-05-19 23:18:06,091 - INFO - [src.data_preparation] -   SR: 0.0515
2025-05-19 23:18:06,092 - INFO - [src.data_preparation] -   variation_t: 0.0513
2025-05-19 23:18:06,094 - INFO - [src.data_preparation] - Ticker ACE - Using features: ['Date', 'HL', 'vnipc_t', 'ATR', 'SK', 'TVV', 's_d7_t', 'LO', 'insec_t', 'Volatility', 'ma7_t', 'ma14_t', 'ret', 'ma21_t', 'SR', 'variation_t']
2025-05-19 23:18:06,185 - INFO - [src.data_preparation] - Ticker ACE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:06,185 - INFO - [src.data_preparation] - Ticker ACE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:06,186 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ACE
2025-05-19 23:18:06,186 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:06,187 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(155), np.int64(1): np.int64(308)}
2025-05-19 23:18:06,187 - INFO - [src.data_preparation] - Generating 153 synthetic minority samples
2025-05-19 23:18:06,193 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (616, 13, 15), y shape: (616,)
2025-05-19 23:18:06,193 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(308), np.int64(1): np.int64(308)}
2025-05-19 23:18:06,197 - INFO - [src.data_preparation] - Ticker ACE - Final 3D shapes: X_train=(616, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:06,198 - INFO - [__main__] - Using best model for ACE: svm (F1: 0.6462)
2025-05-19 23:18:06,198 - INFO - [__main__] - Loading svm model for ACE...
2025-05-19 23:18:06,199 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:06,200 - INFO - [__main__] - Model size: 0.93 MB
2025-05-19 23:18:06,200 - INFO - [__main__] - Making predictions for ACE using svm
2025-05-19 23:18:06,200 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:06,200 - INFO - [__main__] - Successfully got last prediction for ACE
2025-05-19 23:18:06,200 - INFO - [__main__] - 
Processing ticker: ACL
2025-05-19 23:18:06,201 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:06,201 - INFO - [__main__] - Getting last prediction point for ticker: ACL
2025-05-19 23:18:06,201 - INFO - [__main__] - ==================================================
2025-05-19 23:18:06,201 - INFO - [__main__] - Preparing test data for ACL...
2025-05-19 23:18:06,227 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:06,227 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:06,227 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:06,245 - INFO - [src.data_preparation] - Ticker ACL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:06,246 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:18:06,546 - INFO - [src.data_preparation] - Ticker ACL - Selected features:
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   insec_t: 0.0781
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   Volatility: 0.0695
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   SK: 0.0681
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   TVV: 0.0639
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   vnipc_t: 0.0638
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   s_d7_t: 0.0619
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   ma7_t: 0.0614
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   ret: 0.0614
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   ma21_t: 0.0589
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   ma14_t: 0.0575
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   LO: 0.0566
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   variation_t: 0.0548
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   HL: 0.0527
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   ATR: 0.0517
2025-05-19 23:18:06,547 - INFO - [src.data_preparation] -   SR: 0.0500
2025-05-19 23:18:06,550 - INFO - [src.data_preparation] - Ticker ACL - Using features: ['Date', 'insec_t', 'Volatility', 'SK', 'TVV', 'vnipc_t', 's_d7_t', 'ma7_t', 'ret', 'ma21_t', 'ma14_t', 'LO', 'variation_t', 'HL', 'ATR', 'SR']
2025-05-19 23:18:06,634 - INFO - [src.data_preparation] - Ticker ACL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:06,634 - INFO - [src.data_preparation] - Ticker ACL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:06,635 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ACL
2025-05-19 23:18:06,636 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:06,636 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:18:06,636 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:18:06,638 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:18:06,639 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:18:06,641 - INFO - [src.data_preparation] - Ticker ACL - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:06,641 - INFO - [__main__] - Using best model for ACL: logistic_regression (F1: 0.4828)
2025-05-19 23:18:06,642 - INFO - [__main__] - Loading logistic_regression model for ACL...
2025-05-19 23:18:06,643 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:06,643 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:06,643 - INFO - [__main__] - Making predictions for ACL using logistic_regression
2025-05-19 23:18:06,644 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:06,644 - INFO - [__main__] - Successfully got last prediction for ACL
2025-05-19 23:18:06,644 - INFO - [__main__] - 
Processing ticker: ADC
2025-05-19 23:18:06,644 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:06,644 - INFO - [__main__] - Getting last prediction point for ticker: ADC
2025-05-19 23:18:06,644 - INFO - [__main__] - ==================================================
2025-05-19 23:18:06,644 - INFO - [__main__] - Preparing test data for ADC...
2025-05-19 23:18:06,671 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:06,672 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:06,672 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:06,690 - INFO - [src.data_preparation] - Ticker ADC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:06,690 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(232), np.int64(1): np.int64(407)}
2025-05-19 23:18:06,994 - INFO - [src.data_preparation] - Ticker ADC - Selected features:
2025-05-19 23:18:06,994 - INFO - [src.data_preparation] -   ATR: 0.0741
2025-05-19 23:18:06,994 - INFO - [src.data_preparation] -   vnipc_t: 0.0736
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   TVV: 0.0713
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   s_d7_t: 0.0680
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   ma14_t: 0.0661
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   insec_t: 0.0659
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   SK: 0.0651
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   ma21_t: 0.0629
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   ma7_t: 0.0567
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   Volatility: 0.0555
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   SR: 0.0532
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   PM: 0.0510
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   variation_t: 0.0496
2025-05-19 23:18:06,995 - INFO - [src.data_preparation] -   HL: 0.0491
2025-05-19 23:18:06,998 - INFO - [src.data_preparation] - Ticker ADC - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'ma14_t', 'insec_t', 'SK', 'ma21_t', 'ma7_t', 'Volatility', 'Median_HL', 'SR', 'PM', 'variation_t', 'HL']
2025-05-19 23:18:07,095 - INFO - [src.data_preparation] - Ticker ADC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:07,095 - INFO - [src.data_preparation] - Ticker ADC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:07,096 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ADC
2025-05-19 23:18:07,096 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:07,097 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(156), np.int64(1): np.int64(307)}
2025-05-19 23:18:07,097 - INFO - [src.data_preparation] - Generating 151 synthetic minority samples
2025-05-19 23:18:07,103 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (614, 13, 15), y shape: (614,)
2025-05-19 23:18:07,103 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(307), np.int64(1): np.int64(307)}
2025-05-19 23:18:07,106 - INFO - [src.data_preparation] - Ticker ADC - Final 3D shapes: X_train=(614, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:07,106 - INFO - [__main__] - Using best model for ADC: svm (F1: 0.7059)
2025-05-19 23:18:07,106 - INFO - [__main__] - Loading svm model for ADC...
2025-05-19 23:18:07,108 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:07,108 - INFO - [__main__] - Model size: 0.93 MB
2025-05-19 23:18:07,108 - INFO - [__main__] - Making predictions for ADC using svm
2025-05-19 23:18:07,110 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:07,111 - INFO - [__main__] - Successfully got last prediction for ADC
2025-05-19 23:18:07,111 - INFO - [__main__] - 
Processing ticker: ADP
2025-05-19 23:18:07,111 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:07,111 - INFO - [__main__] - Getting last prediction point for ticker: ADP
2025-05-19 23:18:07,111 - INFO - [__main__] - ==================================================
2025-05-19 23:18:07,111 - INFO - [__main__] - Preparing test data for ADP...
2025-05-19 23:18:07,155 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:07,155 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:07,155 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:07,173 - INFO - [src.data_preparation] - Ticker ADP - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:07,173 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(204), np.int64(1): np.int64(434)}
2025-05-19 23:18:07,459 - INFO - [src.data_preparation] - Ticker ADP - Selected features:
2025-05-19 23:18:07,459 - INFO - [src.data_preparation] -   insec_t: 0.0717
2025-05-19 23:18:07,459 - INFO - [src.data_preparation] -   HL: 0.0677
2025-05-19 23:18:07,459 - INFO - [src.data_preparation] -   ATR: 0.0658
2025-05-19 23:18:07,459 - INFO - [src.data_preparation] -   vnipc_t: 0.0654
2025-05-19 23:18:07,459 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   s_d7_t: 0.0611
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   PM: 0.0600
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   SK: 0.0598
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   Volatility: 0.0585
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   ma21_t: 0.0583
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   Median_HL: 0.0579
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   ret: 0.0564
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   ma7_t: 0.0547
2025-05-19 23:18:07,460 - INFO - [src.data_preparation] -   variation_t: 0.0488
2025-05-19 23:18:07,463 - INFO - [src.data_preparation] - Ticker ADP - Using features: ['Date', 'insec_t', 'HL', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'PM', 'SK', 'Volatility', 'ma21_t', 'Median_HL', 'ma14_t', 'ret', 'ma7_t', 'variation_t']
2025-05-19 23:18:07,571 - INFO - [src.data_preparation] - Ticker ADP - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:18:07,572 - INFO - [src.data_preparation] - Ticker ADP - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:07,573 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ADP
2025-05-19 23:18:07,573 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:07,574 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(145), np.int64(1): np.int64(318)}
2025-05-19 23:18:07,574 - INFO - [src.data_preparation] - Generating 173 synthetic minority samples
2025-05-19 23:18:07,581 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (636, 13, 15), y shape: (636,)
2025-05-19 23:18:07,581 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(318), np.int64(1): np.int64(318)}
2025-05-19 23:18:07,585 - INFO - [src.data_preparation] - Ticker ADP - Final 3D shapes: X_train=(636, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:07,585 - INFO - [__main__] - Using best model for ADP: svm (F1: 0.7778)
2025-05-19 23:18:07,585 - INFO - [__main__] - Loading svm model for ADP...
2025-05-19 23:18:07,587 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:07,588 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:18:07,588 - INFO - [__main__] - Making predictions for ADP using svm
2025-05-19 23:18:07,589 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:07,589 - INFO - [__main__] - Successfully got last prediction for ADP
2025-05-19 23:18:07,589 - INFO - [__main__] - 
Processing ticker: AGF
2025-05-19 23:18:07,589 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:07,589 - INFO - [__main__] - Getting last prediction point for ticker: AGF
2025-05-19 23:18:07,589 - INFO - [__main__] - ==================================================
2025-05-19 23:18:07,589 - INFO - [__main__] - Preparing test data for AGF...
2025-05-19 23:18:07,624 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:07,624 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:07,624 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:07,649 - INFO - [src.data_preparation] - Ticker AGF - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:07,650 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(291), np.int64(1): np.int64(347)}
2025-05-19 23:18:07,963 - INFO - [src.data_preparation] - Ticker AGF - Selected features:
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   Volatility: 0.0740
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   SK: 0.0704
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   s_d7_t: 0.0700
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   insec_t: 0.0695
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   vnipc_t: 0.0665
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   TVV: 0.0627
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   ma14_t: 0.0591
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   ret: 0.0561
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   variation_t: 0.0560
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   ATR: 0.0550
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:18:07,964 - INFO - [src.data_preparation] -   SR: 0.0526
2025-05-19 23:18:07,965 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:18:07,965 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:18:07,967 - INFO - [src.data_preparation] - Ticker AGF - Using features: ['Date', 'Volatility', 'SK', 's_d7_t', 'insec_t', 'vnipc_t', 'TVV', 'ma14_t', 'ret', 'variation_t', 'ATR', 'ma21_t', 'ma7_t', 'SR', 'Median_HL', 'PM']
2025-05-19 23:18:08,059 - INFO - [src.data_preparation] - Ticker AGF - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:08,059 - INFO - [src.data_preparation] - Ticker AGF - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:08,060 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AGF
2025-05-19 23:18:08,060 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:08,060 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(217), np.int64(1): np.int64(245)}
2025-05-19 23:18:08,061 - INFO - [src.data_preparation] - Generating 28 synthetic minority samples
2025-05-19 23:18:08,062 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (490, 13, 15), y shape: (490,)
2025-05-19 23:18:08,062 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(245), np.int64(1): np.int64(245)}
2025-05-19 23:18:08,065 - INFO - [src.data_preparation] - Ticker AGF - Final 3D shapes: X_train=(490, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:08,065 - INFO - [__main__] - Using best model for AGF: lstm (F1: 0.7778)
2025-05-19 23:18:08,066 - INFO - [__main__] - Loading lstm model for AGF...
2025-05-19 23:18:08,070 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:08,070 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:18:08,071 - INFO - [__main__] - Making predictions for AGF using lstm
2025-05-19 23:18:08,074 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:08,074 - INFO - [__main__] - Successfully got last prediction for AGF
2025-05-19 23:18:08,074 - INFO - [__main__] - 
Processing ticker: AGM
2025-05-19 23:18:08,074 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:08,074 - INFO - [__main__] - Getting last prediction point for ticker: AGM
2025-05-19 23:18:08,074 - INFO - [__main__] - ==================================================
2025-05-19 23:18:08,074 - INFO - [__main__] - Preparing test data for AGM...
2025-05-19 23:18:08,115 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:08,115 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:08,115 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:08,142 - INFO - [src.data_preparation] - Ticker AGM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:08,142 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(313), np.int64(1): np.int64(326)}
2025-05-19 23:18:08,540 - INFO - [src.data_preparation] - Ticker AGM - Selected features:
2025-05-19 23:18:08,540 - INFO - [src.data_preparation] -   vnipc_t: 0.0734
2025-05-19 23:18:08,540 - INFO - [src.data_preparation] -   SK: 0.0659
2025-05-19 23:18:08,540 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:18:08,540 - INFO - [src.data_preparation] -   ATR: 0.0641
2025-05-19 23:18:08,540 - INFO - [src.data_preparation] -   insec_t: 0.0634
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   HL: 0.0602
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   TVV: 0.0602
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   s_d7_t: 0.0563
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   ret: 0.0561
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   ma21_t: 0.0543
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   SR: 0.0532
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   PM: 0.0519
2025-05-19 23:18:08,541 - INFO - [src.data_preparation] -   ma14_t: 0.0508
2025-05-19 23:18:08,544 - INFO - [src.data_preparation] - Ticker AGM - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'ATR', 'insec_t', 'HL', 'TVV', 's_d7_t', 'ret', 'ma21_t', 'SR', 'ma7_t', 'variation_t', 'PM', 'ma14_t']
2025-05-19 23:18:08,631 - INFO - [src.data_preparation] - Ticker AGM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:08,631 - INFO - [src.data_preparation] - Ticker AGM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:08,633 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AGM
2025-05-19 23:18:08,633 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:08,633 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:18:08,633 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:18:08,635 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:18:08,635 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:18:08,638 - INFO - [src.data_preparation] - Ticker AGM - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:08,638 - INFO - [__main__] - Using best model for AGM: transformer (F1: 0.4286)
2025-05-19 23:18:08,638 - INFO - [__main__] - Loading transformer model for AGM...
2025-05-19 23:18:08,657 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:18:08,664 - INFO - [__main__] - Model size: 0.19 MB
2025-05-19 23:18:08,664 - INFO - [__main__] - Making predictions for AGM using transformer
2025-05-19 23:18:08,667 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:08,667 - INFO - [__main__] - Successfully got last prediction for AGM
2025-05-19 23:18:08,668 - INFO - [__main__] - 
Processing ticker: AGR
2025-05-19 23:18:08,668 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:08,668 - INFO - [__main__] - Getting last prediction point for ticker: AGR
2025-05-19 23:18:08,668 - INFO - [__main__] - ==================================================
2025-05-19 23:18:08,668 - INFO - [__main__] - Preparing test data for AGR...
2025-05-19 23:18:08,729 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:08,729 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:08,729 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:08,755 - INFO - [src.data_preparation] - Ticker AGR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:08,755 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(307), np.int64(1): np.int64(332)}
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] - Ticker AGR - Selected features:
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   Volatility: 0.0802
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   SK: 0.0790
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   vnipc_t: 0.0745
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   insec_t: 0.0718
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   TVV: 0.0646
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   s_d7_t: 0.0554
2025-05-19 23:18:09,219 - INFO - [src.data_preparation] -   ATR: 0.0551
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   Median_HL: 0.0531
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   ma21_t: 0.0528
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   ret: 0.0528
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   HL: 0.0513
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   ma14_t: 0.0509
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   ma7_t: 0.0502
2025-05-19 23:18:09,220 - INFO - [src.data_preparation] -   SR: 0.0500
2025-05-19 23:18:09,223 - INFO - [src.data_preparation] - Ticker AGR - Using features: ['Date', 'Volatility', 'SK', 'vnipc_t', 'insec_t', 'TVV', 's_d7_t', 'ATR', 'Median_HL', 'ma21_t', 'ret', 'PM', 'HL', 'ma14_t', 'ma7_t', 'SR']
2025-05-19 23:18:09,310 - INFO - [src.data_preparation] - Ticker AGR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:09,310 - INFO - [src.data_preparation] - Ticker AGR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:09,312 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AGR
2025-05-19 23:18:09,312 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:09,312 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(223), np.int64(1): np.int64(240)}
2025-05-19 23:18:09,312 - INFO - [src.data_preparation] - Generating 17 synthetic minority samples
2025-05-19 23:18:09,313 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (480, 13, 15), y shape: (480,)
2025-05-19 23:18:09,313 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(240)}
2025-05-19 23:18:09,316 - INFO - [src.data_preparation] - Ticker AGR - Final 3D shapes: X_train=(480, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:09,316 - INFO - [__main__] - Using best model for AGR: svm (F1: 0.3333)
2025-05-19 23:18:09,316 - INFO - [__main__] - Loading svm model for AGR...
2025-05-19 23:18:09,317 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:09,317 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:18:09,318 - INFO - [__main__] - Making predictions for AGR using svm
2025-05-19 23:18:09,318 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:09,318 - INFO - [__main__] - Successfully got last prediction for AGR
2025-05-19 23:18:09,318 - INFO - [__main__] - 
Processing ticker: ALT
2025-05-19 23:18:09,318 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:09,318 - INFO - [__main__] - Getting last prediction point for ticker: ALT
2025-05-19 23:18:09,318 - INFO - [__main__] - ==================================================
2025-05-19 23:18:09,319 - INFO - [__main__] - Preparing test data for ALT...
2025-05-19 23:18:09,348 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:09,348 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:09,348 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:09,368 - INFO - [src.data_preparation] - Ticker ALT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:09,368 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(214), np.int64(1): np.int64(425)}
2025-05-19 23:18:09,673 - INFO - [src.data_preparation] - Ticker ALT - Selected features:
2025-05-19 23:18:09,673 - INFO - [src.data_preparation] -   vnipc_t: 0.0836
2025-05-19 23:18:09,673 - INFO - [src.data_preparation] -   s_d7_t: 0.0740
2025-05-19 23:18:09,673 - INFO - [src.data_preparation] -   TVV: 0.0706
2025-05-19 23:18:09,673 - INFO - [src.data_preparation] -   ATR: 0.0694
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   SK: 0.0658
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   Volatility: 0.0655
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   ma14_t: 0.0622
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   PM: 0.0614
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   ma21_t: 0.0608
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   Median_HL: 0.0586
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   ma7_t: 0.0571
2025-05-19 23:18:09,674 - INFO - [src.data_preparation] -   HL: 0.0521
2025-05-19 23:18:09,675 - INFO - [src.data_preparation] -   insec_t: 0.0511
2025-05-19 23:18:09,675 - INFO - [src.data_preparation] -   ret: 0.0471
2025-05-19 23:18:09,675 - INFO - [src.data_preparation] -   SR: 0.0433
2025-05-19 23:18:09,680 - INFO - [src.data_preparation] - Ticker ALT - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'ATR', 'SK', 'Volatility', 'ma14_t', 'PM', 'ma21_t', 'Median_HL', 'ma7_t', 'HL', 'insec_t', 'ret', 'SR']
2025-05-19 23:18:09,791 - INFO - [src.data_preparation] - Ticker ALT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:09,791 - INFO - [src.data_preparation] - Ticker ALT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:09,792 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ALT
2025-05-19 23:18:09,793 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:09,793 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(134), np.int64(1): np.int64(329)}
2025-05-19 23:18:09,793 - INFO - [src.data_preparation] - Generating 195 synthetic minority samples
2025-05-19 23:18:09,801 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (658, 13, 15), y shape: (658,)
2025-05-19 23:18:09,801 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(329), np.int64(1): np.int64(329)}
2025-05-19 23:18:09,805 - INFO - [src.data_preparation] - Ticker ALT - Final 3D shapes: X_train=(658, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:09,805 - INFO - [__main__] - Using best model for ALT: svm (F1: 0.6667)
2025-05-19 23:18:09,806 - INFO - [__main__] - Loading svm model for ALT...
2025-05-19 23:18:09,808 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:09,809 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:18:09,809 - INFO - [__main__] - Making predictions for ALT using svm
2025-05-19 23:18:09,810 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:09,810 - INFO - [__main__] - Successfully got last prediction for ALT
2025-05-19 23:18:09,810 - INFO - [__main__] - 
Processing ticker: ALV
2025-05-19 23:18:09,810 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:09,810 - INFO - [__main__] - Getting last prediction point for ticker: ALV
2025-05-19 23:18:09,810 - INFO - [__main__] - ==================================================
2025-05-19 23:18:09,810 - INFO - [__main__] - Preparing test data for ALV...
2025-05-19 23:18:09,842 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:09,842 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:09,842 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:09,867 - INFO - [src.data_preparation] - Ticker ALV - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:09,867 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(265), np.int64(1): np.int64(373)}
2025-05-19 23:18:10,215 - INFO - [src.data_preparation] - Ticker ALV - Selected features:
2025-05-19 23:18:10,215 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:18:10,215 - INFO - [src.data_preparation] -   ma14_t: 0.0665
2025-05-19 23:18:10,215 - INFO - [src.data_preparation] -   TVV: 0.0658
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   insec_t: 0.0656
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   SK: 0.0636
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   ma21_t: 0.0634
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   Volatility: 0.0599
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   HL: 0.0587
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   ATR: 0.0587
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   Median_HL: 0.0568
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   s_d7_t: 0.0560
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   PM: 0.0512
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:18:10,216 - INFO - [src.data_preparation] -   LO: 0.0496
2025-05-19 23:18:10,219 - INFO - [src.data_preparation] - Ticker ALV - Using features: ['Date', 'vnipc_t', 'ma14_t', 'TVV', 'insec_t', 'SK', 'ma21_t', 'Volatility', 'HL', 'ATR', 'Median_HL', 's_d7_t', 'ma7_t', 'PM', 'ret', 'LO']
2025-05-19 23:18:10,311 - INFO - [src.data_preparation] - Ticker ALV - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:10,311 - INFO - [src.data_preparation] - Ticker ALV - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:10,313 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ALV
2025-05-19 23:18:10,313 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:10,313 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(178), np.int64(1): np.int64(284)}
2025-05-19 23:18:10,313 - INFO - [src.data_preparation] - Generating 106 synthetic minority samples
2025-05-19 23:18:10,318 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:18:10,319 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:18:10,322 - INFO - [src.data_preparation] - Ticker ALV - Final 3D shapes: X_train=(568, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:10,322 - INFO - [__main__] - Using best model for ALV: svm (F1: 0.3571)
2025-05-19 23:18:10,322 - INFO - [__main__] - Loading svm model for ALV...
2025-05-19 23:18:10,324 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:10,324 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:18:10,324 - INFO - [__main__] - Making predictions for ALV using svm
2025-05-19 23:18:10,325 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:10,325 - INFO - [__main__] - Successfully got last prediction for ALV
2025-05-19 23:18:10,325 - INFO - [__main__] - 
Processing ticker: AMC
2025-05-19 23:18:10,325 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:10,325 - INFO - [__main__] - Getting last prediction point for ticker: AMC
2025-05-19 23:18:10,325 - INFO - [__main__] - ==================================================
2025-05-19 23:18:10,325 - INFO - [__main__] - Preparing test data for AMC...
2025-05-19 23:18:10,360 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:10,360 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:10,360 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:10,383 - INFO - [src.data_preparation] - Ticker AMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:10,383 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(202), np.int64(1): np.int64(437)}
2025-05-19 23:18:10,694 - INFO - [src.data_preparation] - Ticker AMC - Selected features:
2025-05-19 23:18:10,694 - INFO - [src.data_preparation] -   TVV: 0.0849
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   s_d7_t: 0.0770
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   vnipc_t: 0.0722
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   ATR: 0.0678
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   ma7_t: 0.0629
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   Volatility: 0.0613
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   ma21_t: 0.0611
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   SK: 0.0601
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   Median_HL: 0.0585
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   ma14_t: 0.0575
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   HL: 0.0550
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   PM: 0.0528
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   variation_t: 0.0443
2025-05-19 23:18:10,695 - INFO - [src.data_preparation] -   insec_t: 0.0435
2025-05-19 23:18:10,696 - INFO - [src.data_preparation] -   SR: 0.0431
2025-05-19 23:18:10,698 - INFO - [src.data_preparation] - Ticker AMC - Using features: ['Date', 'TVV', 's_d7_t', 'vnipc_t', 'ATR', 'ma7_t', 'Volatility', 'ma21_t', 'SK', 'Median_HL', 'ma14_t', 'HL', 'PM', 'variation_t', 'insec_t', 'SR']
2025-05-19 23:18:10,788 - INFO - [src.data_preparation] - Ticker AMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:10,788 - INFO - [src.data_preparation] - Ticker AMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:10,789 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AMC
2025-05-19 23:18:10,790 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:10,790 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(144), np.int64(1): np.int64(319)}
2025-05-19 23:18:10,790 - INFO - [src.data_preparation] - Generating 175 synthetic minority samples
2025-05-19 23:18:10,797 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (638, 13, 15), y shape: (638,)
2025-05-19 23:18:10,797 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:18:10,800 - INFO - [src.data_preparation] - Ticker AMC - Final 3D shapes: X_train=(638, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:10,801 - INFO - [__main__] - Using best model for AMC: svm (F1: 0.7246)
2025-05-19 23:18:10,801 - INFO - [__main__] - Loading svm model for AMC...
2025-05-19 23:18:10,803 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:10,803 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:18:10,803 - INFO - [__main__] - Making predictions for AMC using svm
2025-05-19 23:18:10,805 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:10,805 - INFO - [__main__] - Successfully got last prediction for AMC
2025-05-19 23:18:10,805 - INFO - [__main__] - 
Processing ticker: AME
2025-05-19 23:18:10,805 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:10,805 - INFO - [__main__] - Getting last prediction point for ticker: AME
2025-05-19 23:18:10,805 - INFO - [__main__] - ==================================================
2025-05-19 23:18:10,806 - INFO - [__main__] - Preparing test data for AME...
2025-05-19 23:18:10,836 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:10,836 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:10,836 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:10,857 - INFO - [src.data_preparation] - Ticker AME - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:10,857 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(229), np.int64(1): np.int64(410)}
2025-05-19 23:18:11,139 - INFO - [src.data_preparation] - Ticker AME - Selected features:
2025-05-19 23:18:11,139 - INFO - [src.data_preparation] -   TVV: 0.0811
2025-05-19 23:18:11,139 - INFO - [src.data_preparation] -   s_d7_t: 0.0771
2025-05-19 23:18:11,139 - INFO - [src.data_preparation] -   vnipc_t: 0.0732
2025-05-19 23:18:11,139 - INFO - [src.data_preparation] -   ma14_t: 0.0725
2025-05-19 23:18:11,139 - INFO - [src.data_preparation] -   ATR: 0.0716
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   ma21_t: 0.0667
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   Volatility: 0.0616
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   ret: 0.0538
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   insec_t: 0.0521
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   variation_t: 0.0513
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   PM: 0.0504
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   Median_HL: 0.0467
2025-05-19 23:18:11,140 - INFO - [src.data_preparation] -   HL: 0.0424
2025-05-19 23:18:11,143 - INFO - [src.data_preparation] - Ticker AME - Using features: ['Date', 'TVV', 's_d7_t', 'vnipc_t', 'ma14_t', 'ATR', 'ma21_t', 'SK', 'Volatility', 'ma7_t', 'ret', 'insec_t', 'variation_t', 'PM', 'Median_HL', 'HL']
2025-05-19 23:18:11,227 - INFO - [src.data_preparation] - Ticker AME - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:11,227 - INFO - [src.data_preparation] - Ticker AME - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:11,228 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AME
2025-05-19 23:18:11,228 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:11,228 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:18:11,228 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:18:11,235 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:18:11,235 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:18:11,237 - INFO - [src.data_preparation] - Ticker AME - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:11,238 - INFO - [__main__] - Using best model for AME: lstm (F1: 0.7097)
2025-05-19 23:18:11,238 - INFO - [__main__] - Loading lstm model for AME...
2025-05-19 23:18:11,241 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:11,242 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:18:11,242 - INFO - [__main__] - Making predictions for AME using lstm
2025-05-19 23:18:11,245 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:11,245 - INFO - [__main__] - Successfully got last prediction for AME
2025-05-19 23:18:11,245 - INFO - [__main__] - 
Processing ticker: AMV
2025-05-19 23:18:11,245 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:11,245 - INFO - [__main__] - Getting last prediction point for ticker: AMV
2025-05-19 23:18:11,245 - INFO - [__main__] - ==================================================
2025-05-19 23:18:11,245 - INFO - [__main__] - Preparing test data for AMV...
2025-05-19 23:18:11,277 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:11,277 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:11,277 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:11,299 - INFO - [src.data_preparation] - Ticker AMV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:11,300 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] - Ticker AMV - Selected features:
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] -   TVV: 0.0728
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] -   SK: 0.0725
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] -   vnipc_t: 0.0687
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] -   insec_t: 0.0671
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] -   ma14_t: 0.0643
2025-05-19 23:18:11,643 - INFO - [src.data_preparation] -   Volatility: 0.0635
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   ma7_t: 0.0616
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   PM: 0.0613
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   Median_HL: 0.0602
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   s_d7_t: 0.0586
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   HL: 0.0555
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   ATR: 0.0529
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   variation_t: 0.0494
2025-05-19 23:18:11,644 - INFO - [src.data_preparation] -   ret: 0.0482
2025-05-19 23:18:11,647 - INFO - [src.data_preparation] - Ticker AMV - Using features: ['Date', 'TVV', 'SK', 'vnipc_t', 'insec_t', 'ma14_t', 'Volatility', 'ma7_t', 'PM', 'Median_HL', 'ma21_t', 's_d7_t', 'HL', 'ATR', 'variation_t', 'ret']
2025-05-19 23:18:11,735 - INFO - [src.data_preparation] - Ticker AMV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:11,735 - INFO - [src.data_preparation] - Ticker AMV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:11,737 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AMV
2025-05-19 23:18:11,737 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:11,737 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(214), np.int64(1): np.int64(249)}
2025-05-19 23:18:11,737 - INFO - [src.data_preparation] - Generating 35 synthetic minority samples
2025-05-19 23:18:11,739 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (498, 13, 15), y shape: (498,)
2025-05-19 23:18:11,739 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(249), np.int64(1): np.int64(249)}
2025-05-19 23:18:11,742 - INFO - [src.data_preparation] - Ticker AMV - Final 3D shapes: X_train=(498, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:11,742 - INFO - [__main__] - Using best model for AMV: lstm (F1: 0.7945)
2025-05-19 23:18:11,742 - INFO - [__main__] - Loading lstm model for AMV...
2025-05-19 23:18:11,746 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:11,747 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:18:11,747 - INFO - [__main__] - Making predictions for AMV using lstm
2025-05-19 23:18:11,750 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:11,750 - INFO - [__main__] - Successfully got last prediction for AMV
2025-05-19 23:18:11,750 - INFO - [__main__] - 
Processing ticker: ANV
2025-05-19 23:18:11,750 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:11,750 - INFO - [__main__] - Getting last prediction point for ticker: ANV
2025-05-19 23:18:11,750 - INFO - [__main__] - ==================================================
2025-05-19 23:18:11,750 - INFO - [__main__] - Preparing test data for ANV...
2025-05-19 23:18:11,787 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:11,787 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:11,787 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:11,809 - INFO - [src.data_preparation] - Ticker ANV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:11,809 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] - Ticker ANV - Selected features:
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   vnipc_t: 0.0761
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   SK: 0.0721
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   insec_t: 0.0678
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   Volatility: 0.0635
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   ma14_t: 0.0600
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:18:12,161 - INFO - [src.data_preparation] -   ma21_t: 0.0578
2025-05-19 23:18:12,162 - INFO - [src.data_preparation] -   variation_t: 0.0567
2025-05-19 23:18:12,162 - INFO - [src.data_preparation] -   ret: 0.0566
2025-05-19 23:18:12,162 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:18:12,162 - INFO - [src.data_preparation] -   HL: 0.0537
2025-05-19 23:18:12,162 - INFO - [src.data_preparation] -   Median_HL: 0.0525
2025-05-19 23:18:12,162 - INFO - [src.data_preparation] -   LO: 0.0512
2025-05-19 23:18:12,165 - INFO - [src.data_preparation] - Ticker ANV - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'Volatility', 's_d7_t', 'ma14_t', 'TVV', 'PM', 'ma21_t', 'variation_t', 'ret', 'ma7_t', 'HL', 'Median_HL', 'LO']
2025-05-19 23:18:12,265 - INFO - [src.data_preparation] - Ticker ANV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:12,265 - INFO - [src.data_preparation] - Ticker ANV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:12,266 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ANV
2025-05-19 23:18:12,266 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:12,267 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(260)}
2025-05-19 23:18:12,267 - INFO - [src.data_preparation] - Generating 57 synthetic minority samples
2025-05-19 23:18:12,270 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (520, 13, 15), y shape: (520,)
2025-05-19 23:18:12,270 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(260), np.int64(1): np.int64(260)}
2025-05-19 23:18:12,273 - INFO - [src.data_preparation] - Ticker ANV - Final 3D shapes: X_train=(520, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:12,273 - INFO - [__main__] - Using best model for ANV: svm (F1: 0.6667)
2025-05-19 23:18:12,273 - INFO - [__main__] - Loading svm model for ANV...
2025-05-19 23:18:12,275 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:12,275 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:18:12,276 - INFO - [__main__] - Making predictions for ANV using svm
2025-05-19 23:18:12,276 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:12,276 - INFO - [__main__] - Successfully got last prediction for ANV
2025-05-19 23:18:12,276 - INFO - [__main__] - 
Processing ticker: APC
2025-05-19 23:18:12,276 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:12,277 - INFO - [__main__] - Getting last prediction point for ticker: APC
2025-05-19 23:18:12,277 - INFO - [__main__] - ==================================================
2025-05-19 23:18:12,277 - INFO - [__main__] - Preparing test data for APC...
2025-05-19 23:18:12,308 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:18:12,308 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:12,308 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:12,327 - INFO - [src.data_preparation] - Ticker APC - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:18:12,328 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(324), np.int64(1): np.int64(313)}
2025-05-19 23:18:12,621 - INFO - [src.data_preparation] - Ticker APC - Selected features:
2025-05-19 23:18:12,621 - INFO - [src.data_preparation] -   TVV: 0.0737
2025-05-19 23:18:12,621 - INFO - [src.data_preparation] -   vnipc_t: 0.0733
2025-05-19 23:18:12,621 - INFO - [src.data_preparation] -   insec_t: 0.0677
2025-05-19 23:18:12,621 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   ma21_t: 0.0605
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   Volatility: 0.0600
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   s_d7_t: 0.0569
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   ret: 0.0566
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   HL: 0.0551
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   LO: 0.0548
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   SR: 0.0499
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   ATR: 0.0494
2025-05-19 23:18:12,622 - INFO - [src.data_preparation] -   PM: 0.0483
2025-05-19 23:18:12,625 - INFO - [src.data_preparation] - Ticker APC - Using features: ['Date', 'TVV', 'vnipc_t', 'insec_t', 'SK', 'ma21_t', 'Volatility', 's_d7_t', 'ret', 'variation_t', 'HL', 'LO', 'ma14_t', 'SR', 'ATR', 'PM']
2025-05-19 23:18:12,707 - INFO - [src.data_preparation] - Ticker APC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(43, 195)
2025-05-19 23:18:12,707 - INFO - [src.data_preparation] - Ticker APC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(43, 13, 15)
2025-05-19 23:18:12,708 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker APC
2025-05-19 23:18:12,709 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:12,709 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:18:12,709 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:18:12,709 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:18:12,710 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:18:12,712 - INFO - [src.data_preparation] - Ticker APC - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(43, 13, 15)
2025-05-19 23:18:12,712 - INFO - [__main__] - Using best model for APC: svm (F1: 0.2667)
2025-05-19 23:18:12,712 - INFO - [__main__] - Loading svm model for APC...
2025-05-19 23:18:12,714 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:12,714 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:18:12,714 - INFO - [__main__] - Making predictions for APC using svm
2025-05-19 23:18:12,714 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:12,714 - INFO - [__main__] - Successfully got last prediction for APC
2025-05-19 23:18:12,715 - INFO - [__main__] - 
Processing ticker: APG
2025-05-19 23:18:12,715 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:12,715 - INFO - [__main__] - Getting last prediction point for ticker: APG
2025-05-19 23:18:12,715 - INFO - [__main__] - ==================================================
2025-05-19 23:18:12,715 - INFO - [__main__] - Preparing test data for APG...
2025-05-19 23:18:12,742 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:12,742 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:12,742 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:12,759 - INFO - [src.data_preparation] - Ticker APG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:12,759 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] - Ticker APG - Selected features:
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] -   SK: 0.0727
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] -   TVV: 0.0667
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] -   insec_t: 0.0635
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] -   ma21_t: 0.0614
2025-05-19 23:18:13,035 - INFO - [src.data_preparation] -   ATR: 0.0597
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   Volatility: 0.0594
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   SR: 0.0591
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   HL: 0.0583
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   ma7_t: 0.0564
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   PM: 0.0557
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   s_d7_t: 0.0557
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   ma14_t: 0.0555
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:18:13,036 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:18:13,038 - INFO - [src.data_preparation] - Ticker APG - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'insec_t', 'ma21_t', 'ATR', 'Volatility', 'SR', 'HL', 'ma7_t', 'PM', 's_d7_t', 'ma14_t', 'ret', 'variation_t']
2025-05-19 23:18:13,119 - INFO - [src.data_preparation] - Ticker APG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:13,119 - INFO - [src.data_preparation] - Ticker APG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:13,121 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker APG
2025-05-19 23:18:13,121 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:13,121 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:18:13,121 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:18:13,122 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:18:13,122 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:18:13,125 - INFO - [src.data_preparation] - Ticker APG - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:13,125 - INFO - [__main__] - Using best model for APG: logistic_regression (F1: 0.5263)
2025-05-19 23:18:13,125 - INFO - [__main__] - Loading logistic_regression model for APG...
2025-05-19 23:18:13,126 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:13,126 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:13,126 - INFO - [__main__] - Making predictions for APG using logistic_regression
2025-05-19 23:18:13,126 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:13,126 - INFO - [__main__] - Successfully got last prediction for APG
2025-05-19 23:18:13,127 - INFO - [__main__] - 
Processing ticker: API
2025-05-19 23:18:13,127 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:13,127 - INFO - [__main__] - Getting last prediction point for ticker: API
2025-05-19 23:18:13,127 - INFO - [__main__] - ==================================================
2025-05-19 23:18:13,127 - INFO - [__main__] - Preparing test data for API...
2025-05-19 23:18:13,153 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:13,153 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:13,153 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:13,172 - INFO - [src.data_preparation] - Ticker API - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:13,172 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(303), np.int64(1): np.int64(336)}
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] - Ticker API - Selected features:
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   TVV: 0.0677
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   vnipc_t: 0.0666
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   SK: 0.0634
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   ma14_t: 0.0630
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   ma7_t: 0.0614
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   s_d7_t: 0.0608
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   ATR: 0.0597
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:18:13,449 - INFO - [src.data_preparation] -   HL: 0.0588
2025-05-19 23:18:13,450 - INFO - [src.data_preparation] -   ret: 0.0579
2025-05-19 23:18:13,450 - INFO - [src.data_preparation] -   insec_t: 0.0574
2025-05-19 23:18:13,450 - INFO - [src.data_preparation] -   PM: 0.0568
2025-05-19 23:18:13,450 - INFO - [src.data_preparation] -   Median_HL: 0.0527
2025-05-19 23:18:13,450 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:18:13,452 - INFO - [src.data_preparation] - Ticker API - Using features: ['Date', 'TVV', 'vnipc_t', 'Volatility', 'SK', 'ma14_t', 'ma7_t', 's_d7_t', 'ATR', 'ma21_t', 'HL', 'ret', 'insec_t', 'PM', 'Median_HL', 'variation_t']
2025-05-19 23:18:13,531 - INFO - [src.data_preparation] - Ticker API - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:13,531 - INFO - [src.data_preparation] - Ticker API - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:13,532 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker API
2025-05-19 23:18:13,532 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:13,532 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(210), np.int64(1): np.int64(253)}
2025-05-19 23:18:13,532 - INFO - [src.data_preparation] - Generating 43 synthetic minority samples
2025-05-19 23:18:13,534 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (506, 13, 15), y shape: (506,)
2025-05-19 23:18:13,535 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(253), np.int64(1): np.int64(253)}
2025-05-19 23:18:13,537 - INFO - [src.data_preparation] - Ticker API - Final 3D shapes: X_train=(506, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:13,537 - INFO - [__main__] - Using best model for API: svm (F1: 0.6032)
2025-05-19 23:18:13,537 - INFO - [__main__] - Loading svm model for API...
2025-05-19 23:18:13,538 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:13,539 - INFO - [__main__] - Model size: 0.55 MB
2025-05-19 23:18:13,539 - INFO - [__main__] - Making predictions for API using svm
2025-05-19 23:18:13,539 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:13,539 - INFO - [__main__] - Successfully got last prediction for API
2025-05-19 23:18:13,539 - INFO - [__main__] - 
Processing ticker: APP
2025-05-19 23:18:13,540 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:13,540 - INFO - [__main__] - Getting last prediction point for ticker: APP
2025-05-19 23:18:13,540 - INFO - [__main__] - ==================================================
2025-05-19 23:18:13,540 - INFO - [__main__] - Preparing test data for APP...
2025-05-19 23:18:13,567 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:18:13,567 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:13,567 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:13,584 - INFO - [src.data_preparation] - Ticker APP - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:18:13,584 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(232), np.int64(1): np.int64(405)}
2025-05-19 23:18:13,846 - INFO - [src.data_preparation] - Ticker APP - Selected features:
2025-05-19 23:18:13,846 - INFO - [src.data_preparation] -   TVV: 0.0715
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   vnipc_t: 0.0693
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   s_d7_t: 0.0671
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   ma7_t: 0.0664
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   ma21_t: 0.0632
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   ma14_t: 0.0620
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   ATR: 0.0615
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   insec_t: 0.0615
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   Volatility: 0.0580
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   PM: 0.0561
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   Median_HL: 0.0552
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   HL: 0.0507
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   ret: 0.0480
2025-05-19 23:18:13,847 - INFO - [src.data_preparation] -   variation_t: 0.0450
2025-05-19 23:18:13,850 - INFO - [src.data_preparation] - Ticker APP - Using features: ['Date', 'TVV', 'vnipc_t', 'SK', 's_d7_t', 'ma7_t', 'ma21_t', 'ma14_t', 'ATR', 'insec_t', 'Volatility', 'PM', 'Median_HL', 'HL', 'ret', 'variation_t']
2025-05-19 23:18:13,928 - INFO - [src.data_preparation] - Ticker APP - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:18:13,928 - INFO - [src.data_preparation] - Ticker APP - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:13,929 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker APP
2025-05-19 23:18:13,929 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:13,929 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(155), np.int64(1): np.int64(308)}
2025-05-19 23:18:13,929 - INFO - [src.data_preparation] - Generating 153 synthetic minority samples
2025-05-19 23:18:13,935 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (616, 13, 15), y shape: (616,)
2025-05-19 23:18:13,935 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(308), np.int64(1): np.int64(308)}
2025-05-19 23:18:13,938 - INFO - [src.data_preparation] - Ticker APP - Final 3D shapes: X_train=(616, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:13,938 - INFO - [__main__] - Using best model for APP: svm (F1: 0.6667)
2025-05-19 23:18:13,938 - INFO - [__main__] - Loading svm model for APP...
2025-05-19 23:18:13,939 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:13,940 - INFO - [__main__] - Model size: 0.93 MB
2025-05-19 23:18:13,940 - INFO - [__main__] - Making predictions for APP using svm
2025-05-19 23:18:13,941 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:13,941 - INFO - [__main__] - Successfully got last prediction for APP
2025-05-19 23:18:13,941 - INFO - [__main__] - 
Processing ticker: APS
2025-05-19 23:18:13,941 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:13,941 - INFO - [__main__] - Getting last prediction point for ticker: APS
2025-05-19 23:18:13,941 - INFO - [__main__] - ==================================================
2025-05-19 23:18:13,941 - INFO - [__main__] - Preparing test data for APS...
2025-05-19 23:18:13,968 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:13,968 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:13,968 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:13,996 - INFO - [src.data_preparation] - Ticker APS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:13,996 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(271), np.int64(1): np.int64(368)}
2025-05-19 23:18:14,276 - INFO - [src.data_preparation] - Ticker APS - Selected features:
2025-05-19 23:18:14,276 - INFO - [src.data_preparation] -   insec_t: 0.0754
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   vnipc_t: 0.0718
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   s_d7_t: 0.0717
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   TVV: 0.0704
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   Volatility: 0.0682
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   ma21_t: 0.0612
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   ATR: 0.0580
2025-05-19 23:18:14,277 - INFO - [src.data_preparation] -   ma14_t: 0.0578
2025-05-19 23:18:14,278 - INFO - [src.data_preparation] -   ret: 0.0549
2025-05-19 23:18:14,278 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:18:14,278 - INFO - [src.data_preparation] -   HL: 0.0531
2025-05-19 23:18:14,278 - INFO - [src.data_preparation] -   ma7_t: 0.0527
2025-05-19 23:18:14,278 - INFO - [src.data_preparation] -   variation_t: 0.0500
2025-05-19 23:18:14,278 - INFO - [src.data_preparation] -   PM: 0.0490
2025-05-19 23:18:14,281 - INFO - [src.data_preparation] - Ticker APS - Using features: ['Date', 'insec_t', 'vnipc_t', 's_d7_t', 'TVV', 'Volatility', 'SK', 'ma21_t', 'ATR', 'ma14_t', 'ret', 'Median_HL', 'HL', 'ma7_t', 'variation_t', 'PM']
2025-05-19 23:18:14,371 - INFO - [src.data_preparation] - Ticker APS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:14,371 - INFO - [src.data_preparation] - Ticker APS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:14,372 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker APS
2025-05-19 23:18:14,372 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:14,373 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(179), np.int64(1): np.int64(284)}
2025-05-19 23:18:14,373 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:18:14,377 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:18:14,378 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:18:14,381 - INFO - [src.data_preparation] - Ticker APS - Final 3D shapes: X_train=(568, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:14,381 - INFO - [__main__] - Using best model for APS: svm (F1: 0.5306)
2025-05-19 23:18:14,381 - INFO - [__main__] - Loading svm model for APS...
2025-05-19 23:18:14,383 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:14,383 - INFO - [__main__] - Model size: 0.74 MB
2025-05-19 23:18:14,383 - INFO - [__main__] - Making predictions for APS using svm
2025-05-19 23:18:14,384 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:14,384 - INFO - [__main__] - Successfully got last prediction for APS
2025-05-19 23:18:14,384 - INFO - [__main__] - 
Processing ticker: ARM
2025-05-19 23:18:14,384 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:14,384 - INFO - [__main__] - Getting last prediction point for ticker: ARM
2025-05-19 23:18:14,384 - INFO - [__main__] - ==================================================
2025-05-19 23:18:14,384 - INFO - [__main__] - Preparing test data for ARM...
2025-05-19 23:18:14,416 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:14,416 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:14,416 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:14,436 - INFO - [src.data_preparation] - Ticker ARM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:14,436 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(175), np.int64(1): np.int64(464)}
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] - Ticker ARM - Selected features:
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   TVV: 0.0981
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   vnipc_t: 0.0864
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   ma21_t: 0.0749
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   ma14_t: 0.0708
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   ATR: 0.0607
2025-05-19 23:18:14,705 - INFO - [src.data_preparation] -   ma7_t: 0.0592
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   s_d7_t: 0.0592
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   SK: 0.0591
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   PM: 0.0541
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   insec_t: 0.0534
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   Median_HL: 0.0503
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   HL: 0.0410
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   variation_t: 0.0409
2025-05-19 23:18:14,706 - INFO - [src.data_preparation] -   SR: 0.0399
2025-05-19 23:18:14,709 - INFO - [src.data_preparation] - Ticker ARM - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'ma14_t', 'Volatility', 'ATR', 'ma7_t', 's_d7_t', 'SK', 'PM', 'insec_t', 'Median_HL', 'HL', 'variation_t', 'SR']
2025-05-19 23:18:14,797 - INFO - [src.data_preparation] - Ticker ARM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:14,797 - INFO - [src.data_preparation] - Ticker ARM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:14,798 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ARM
2025-05-19 23:18:14,798 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:14,798 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(131), np.int64(1): np.int64(332)}
2025-05-19 23:18:14,798 - INFO - [src.data_preparation] - Generating 201 synthetic minority samples
2025-05-19 23:18:14,807 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (664, 13, 15), y shape: (664,)
2025-05-19 23:18:14,807 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(332), np.int64(1): np.int64(332)}
2025-05-19 23:18:14,811 - INFO - [src.data_preparation] - Ticker ARM - Final 3D shapes: X_train=(664, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:14,811 - INFO - [__main__] - Using best model for ARM: lstm (F1: 0.7945)
2025-05-19 23:18:14,811 - INFO - [__main__] - Loading lstm model for ARM...
2025-05-19 23:18:14,815 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:14,816 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:18:14,816 - INFO - [__main__] - Making predictions for ARM using lstm
2025-05-19 23:18:14,818 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:14,818 - INFO - [__main__] - Successfully got last prediction for ARM
2025-05-19 23:18:14,818 - INFO - [__main__] - 
Processing ticker: ASA
2025-05-19 23:18:14,818 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:14,818 - INFO - [__main__] - Getting last prediction point for ticker: ASA
2025-05-19 23:18:14,818 - INFO - [__main__] - ==================================================
2025-05-19 23:18:14,818 - INFO - [__main__] - Preparing test data for ASA...
2025-05-19 23:18:14,854 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:14,854 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:14,855 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:14,874 - INFO - [src.data_preparation] - Ticker ASA - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:14,874 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(164), np.int64(1): np.int64(474)}
2025-05-19 23:18:15,112 - INFO - [src.data_preparation] - Ticker ASA - Selected features:
2025-05-19 23:18:15,112 - INFO - [src.data_preparation] -   TVV: 0.0929
2025-05-19 23:18:15,112 - INFO - [src.data_preparation] -   ATR: 0.0925
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   vnipc_t: 0.0877
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   Volatility: 0.0742
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   HL: 0.0724
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   insec_t: 0.0545
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   ma14_t: 0.0514
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   SK: 0.0461
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   ret: 0.0444
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   ma21_t: 0.0437
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   variation_t: 0.0425
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   Median_HL: 0.0418
2025-05-19 23:18:15,113 - INFO - [src.data_preparation] -   PM: 0.0397
2025-05-19 23:18:15,116 - INFO - [src.data_preparation] - Ticker ASA - Using features: ['Date', 'TVV', 'ATR', 'vnipc_t', 'Volatility', 'HL', 's_d7_t', 'insec_t', 'ma7_t', 'ma14_t', 'SK', 'ret', 'ma21_t', 'variation_t', 'Median_HL', 'PM']
2025-05-19 23:18:15,195 - INFO - [src.data_preparation] - Ticker ASA - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:15,195 - INFO - [src.data_preparation] - Ticker ASA - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:15,197 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ASA
2025-05-19 23:18:15,197 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:15,197 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(155), np.int64(1): np.int64(307)}
2025-05-19 23:18:15,197 - INFO - [src.data_preparation] - Generating 152 synthetic minority samples
2025-05-19 23:18:15,206 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (614, 13, 15), y shape: (614,)
2025-05-19 23:18:15,206 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(307), np.int64(1): np.int64(307)}
2025-05-19 23:18:15,210 - INFO - [src.data_preparation] - Ticker ASA - Final 3D shapes: X_train=(614, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:15,211 - INFO - [__main__] - Using best model for ASA: lstm (F1: 0.9885)
2025-05-19 23:18:15,211 - INFO - [__main__] - Loading lstm model for ASA...
2025-05-19 23:18:15,215 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:15,216 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:18:15,216 - INFO - [__main__] - Making predictions for ASA using lstm
2025-05-19 23:18:15,218 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:15,219 - INFO - [__main__] - Successfully got last prediction for ASA
2025-05-19 23:18:15,219 - INFO - [__main__] - 
Processing ticker: ASM
2025-05-19 23:18:15,219 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:15,219 - INFO - [__main__] - Getting last prediction point for ticker: ASM
2025-05-19 23:18:15,219 - INFO - [__main__] - ==================================================
2025-05-19 23:18:15,219 - INFO - [__main__] - Preparing test data for ASM...
2025-05-19 23:18:15,251 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:15,251 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:15,251 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:15,276 - INFO - [src.data_preparation] - Ticker ASM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:15,277 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(317), np.int64(1): np.int64(322)}
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] - Ticker ASM - Selected features:
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   insec_t: 0.0743
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   SK: 0.0679
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   vnipc_t: 0.0678
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   TVV: 0.0677
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   SR: 0.0600
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:18:15,597 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   PM: 0.0547
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   variation_t: 0.0547
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   LO: 0.0545
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   HL: 0.0540
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   ma14_t: 0.0539
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   ATR: 0.0538
2025-05-19 23:18:15,598 - INFO - [src.data_preparation] -   ma21_t: 0.0511
2025-05-19 23:18:15,600 - INFO - [src.data_preparation] - Ticker ASM - Using features: ['Date', 'insec_t', 'SK', 'vnipc_t', 'TVV', 'Volatility', 'SR', 's_d7_t', 'ret', 'PM', 'variation_t', 'LO', 'HL', 'ma14_t', 'ATR', 'ma21_t']
2025-05-19 23:18:15,680 - INFO - [src.data_preparation] - Ticker ASM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:15,680 - INFO - [src.data_preparation] - Ticker ASM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:15,681 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ASM
2025-05-19 23:18:15,681 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:15,682 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(243)}
2025-05-19 23:18:15,682 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:18:15,683 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:18:15,683 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:18:15,686 - INFO - [src.data_preparation] - Ticker ASM - Final 3D shapes: X_train=(486, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:15,686 - INFO - [__main__] - Using best model for ASM: svm (F1: 0.5660)
2025-05-19 23:18:15,686 - INFO - [__main__] - Loading svm model for ASM...
2025-05-19 23:18:15,688 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:15,688 - INFO - [__main__] - Model size: 0.53 MB
2025-05-19 23:18:15,688 - INFO - [__main__] - Making predictions for ASM using svm
2025-05-19 23:18:15,688 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:15,689 - INFO - [__main__] - Successfully got last prediction for ASM
2025-05-19 23:18:15,689 - INFO - [__main__] - 
Processing ticker: ASP
2025-05-19 23:18:15,689 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:15,689 - INFO - [__main__] - Getting last prediction point for ticker: ASP
2025-05-19 23:18:15,689 - INFO - [__main__] - ==================================================
2025-05-19 23:18:15,689 - INFO - [__main__] - Preparing test data for ASP...
2025-05-19 23:18:15,721 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:15,721 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:15,721 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:15,740 - INFO - [src.data_preparation] - Ticker ASP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:15,740 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(308), np.int64(1): np.int64(331)}
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] - Ticker ASP - Selected features:
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   insec_t: 0.0724
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   SK: 0.0723
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   Volatility: 0.0715
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   vnipc_t: 0.0678
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   TVV: 0.0662
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   SR: 0.0596
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   s_d7_t: 0.0567
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   ma14_t: 0.0560
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   ma21_t: 0.0559
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   variation_t: 0.0556
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   HL: 0.0553
2025-05-19 23:18:16,040 - INFO - [src.data_preparation] -   ATR: 0.0541
2025-05-19 23:18:16,041 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:18:16,041 - INFO - [src.data_preparation] -   LO: 0.0536
2025-05-19 23:18:16,041 - INFO - [src.data_preparation] -   ma7_t: 0.0525
2025-05-19 23:18:16,043 - INFO - [src.data_preparation] - Ticker ASP - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'vnipc_t', 'TVV', 'SR', 's_d7_t', 'ma14_t', 'ma21_t', 'variation_t', 'HL', 'ATR', 'ret', 'LO', 'ma7_t']
2025-05-19 23:18:16,133 - INFO - [src.data_preparation] - Ticker ASP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:16,133 - INFO - [src.data_preparation] - Ticker ASP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:16,134 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ASP
2025-05-19 23:18:16,134 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:16,134 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:18:16,134 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:18:16,136 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:18:16,136 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:18:16,138 - INFO - [src.data_preparation] - Ticker ASP - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:16,139 - INFO - [__main__] - Using best model for ASP: transformer (F1: 0.5862)
2025-05-19 23:18:16,139 - INFO - [__main__] - Loading transformer model for ASP...
2025-05-19 23:18:16,156 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:18:16,161 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:18:16,161 - INFO - [__main__] - Making predictions for ASP using transformer
2025-05-19 23:18:16,164 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:16,165 - INFO - [__main__] - Successfully got last prediction for ASP
2025-05-19 23:18:16,165 - INFO - [__main__] - 
Processing ticker: ATA
2025-05-19 23:18:16,165 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:16,165 - INFO - [__main__] - Getting last prediction point for ticker: ATA
2025-05-19 23:18:16,165 - INFO - [__main__] - ==================================================
2025-05-19 23:18:16,165 - INFO - [__main__] - Preparing test data for ATA...
2025-05-19 23:18:16,206 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:16,207 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:16,207 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:16,235 - INFO - [src.data_preparation] - Ticker ATA - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:16,236 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(228), np.int64(1): np.int64(410)}
2025-05-19 23:18:16,516 - INFO - [src.data_preparation] - Ticker ATA - Selected features:
2025-05-19 23:18:16,516 - INFO - [src.data_preparation] -   vnipc_t: 0.0871
2025-05-19 23:18:16,516 - INFO - [src.data_preparation] -   TVV: 0.0816
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   ma21_t: 0.0808
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   insec_t: 0.0773
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   ma14_t: 0.0744
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   Volatility: 0.0635
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   ma7_t: 0.0625
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   ATR: 0.0602
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   s_d7_t: 0.0594
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   SK: 0.0525
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   Median_HL: 0.0493
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   variation_t: 0.0482
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   ret: 0.0469
2025-05-19 23:18:16,517 - INFO - [src.data_preparation] -   LO: 0.0312
2025-05-19 23:18:16,520 - INFO - [src.data_preparation] - Ticker ATA - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'insec_t', 'ma14_t', 'Volatility', 'ma7_t', 'ATR', 's_d7_t', 'SK', 'PM', 'Median_HL', 'variation_t', 'ret', 'LO']
2025-05-19 23:18:16,600 - INFO - [src.data_preparation] - Ticker ATA - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:16,600 - INFO - [src.data_preparation] - Ticker ATA - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:16,601 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ATA
2025-05-19 23:18:16,601 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:16,601 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(160), np.int64(1): np.int64(302)}
2025-05-19 23:18:16,601 - INFO - [src.data_preparation] - Generating 142 synthetic minority samples
2025-05-19 23:18:16,607 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (604, 13, 15), y shape: (604,)
2025-05-19 23:18:16,607 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(302), np.int64(1): np.int64(302)}
2025-05-19 23:18:16,610 - INFO - [src.data_preparation] - Ticker ATA - Final 3D shapes: X_train=(604, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:16,610 - INFO - [__main__] - Using best model for ATA: svm (F1: 0.8108)
2025-05-19 23:18:16,610 - INFO - [__main__] - Loading svm model for ATA...
2025-05-19 23:18:16,611 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:16,612 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:18:16,612 - INFO - [__main__] - Making predictions for ATA using svm
2025-05-19 23:18:16,613 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:16,613 - INFO - [__main__] - Successfully got last prediction for ATA
2025-05-19 23:18:16,613 - INFO - [__main__] - 
Processing ticker: AVF
2025-05-19 23:18:16,613 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:16,613 - INFO - [__main__] - Getting last prediction point for ticker: AVF
2025-05-19 23:18:16,613 - INFO - [__main__] - ==================================================
2025-05-19 23:18:16,613 - INFO - [__main__] - Preparing test data for AVF...
2025-05-19 23:18:16,643 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:16,643 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:16,643 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:16,668 - INFO - [src.data_preparation] - Ticker AVF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:16,668 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(175), np.int64(1): np.int64(464)}
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] - Ticker AVF - Selected features:
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   vnipc_t: 0.1001
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   TVV: 0.0867
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   insec_t: 0.0841
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   ma21_t: 0.0743
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   ma14_t: 0.0689
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   ma7_t: 0.0629
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   Median_HL: 0.0605
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   PM: 0.0571
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   ATR: 0.0559
2025-05-19 23:18:16,926 - INFO - [src.data_preparation] -   SK: 0.0549
2025-05-19 23:18:16,927 - INFO - [src.data_preparation] -   Volatility: 0.0528
2025-05-19 23:18:16,927 - INFO - [src.data_preparation] -   ret: 0.0415
2025-05-19 23:18:16,927 - INFO - [src.data_preparation] -   variation_t: 0.0405
2025-05-19 23:18:16,927 - INFO - [src.data_preparation] -   HL: 0.0336
2025-05-19 23:18:16,930 - INFO - [src.data_preparation] - Ticker AVF - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ma21_t', 'ma14_t', 's_d7_t', 'ma7_t', 'Median_HL', 'PM', 'ATR', 'SK', 'Volatility', 'ret', 'variation_t', 'HL']
2025-05-19 23:18:17,014 - INFO - [src.data_preparation] - Ticker AVF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:17,014 - INFO - [src.data_preparation] - Ticker AVF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:17,015 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker AVF
2025-05-19 23:18:17,015 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:17,016 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(143), np.int64(1): np.int64(320)}
2025-05-19 23:18:17,016 - INFO - [src.data_preparation] - Generating 177 synthetic minority samples
2025-05-19 23:18:17,022 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (640, 13, 15), y shape: (640,)
2025-05-19 23:18:17,023 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(320), np.int64(1): np.int64(320)}
2025-05-19 23:18:17,026 - INFO - [src.data_preparation] - Ticker AVF - Final 3D shapes: X_train=(640, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:17,026 - INFO - [__main__] - Using best model for AVF: lstm (F1: 0.9885)
2025-05-19 23:18:17,026 - INFO - [__main__] - Loading lstm model for AVF...
2025-05-19 23:18:17,030 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:17,031 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:18:17,031 - INFO - [__main__] - Making predictions for AVF using lstm
2025-05-19 23:18:17,033 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:17,034 - INFO - [__main__] - Successfully got last prediction for AVF
2025-05-19 23:18:17,034 - INFO - [__main__] - 
Processing ticker: BBC
2025-05-19 23:18:17,034 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:17,034 - INFO - [__main__] - Getting last prediction point for ticker: BBC
2025-05-19 23:18:17,034 - INFO - [__main__] - ==================================================
2025-05-19 23:18:17,034 - INFO - [__main__] - Preparing test data for BBC...
2025-05-19 23:18:17,079 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:17,079 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:17,079 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:17,098 - INFO - [src.data_preparation] - Ticker BBC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:17,098 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(360)}
2025-05-19 23:18:17,425 - INFO - [src.data_preparation] - Ticker BBC - Selected features:
2025-05-19 23:18:17,425 - INFO - [src.data_preparation] -   TVV: 0.0769
2025-05-19 23:18:17,425 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:18:17,425 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:18:17,425 - INFO - [src.data_preparation] -   s_d7_t: 0.0678
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   SK: 0.0643
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   HL: 0.0611
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   ATR: 0.0603
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   Volatility: 0.0601
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   LO: 0.0599
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   PM: 0.0549
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   SR: 0.0531
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   ma21_t: 0.0528
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   variation_t: 0.0527
2025-05-19 23:18:17,426 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:18:17,429 - INFO - [src.data_preparation] - Ticker BBC - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 's_d7_t', 'SK', 'HL', 'ATR', 'Volatility', 'LO', 'PM', 'ret', 'SR', 'ma21_t', 'variation_t', 'Median_HL']
2025-05-19 23:18:17,510 - INFO - [src.data_preparation] - Ticker BBC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:17,510 - INFO - [src.data_preparation] - Ticker BBC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:17,512 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BBC
2025-05-19 23:18:17,512 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:17,512 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(263)}
2025-05-19 23:18:17,512 - INFO - [src.data_preparation] - Generating 64 synthetic minority samples
2025-05-19 23:18:17,515 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:18:17,515 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:18:17,518 - INFO - [src.data_preparation] - Ticker BBC - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:17,518 - INFO - [__main__] - Using best model for BBC: svm (F1: 0.7429)
2025-05-19 23:18:17,518 - INFO - [__main__] - Loading svm model for BBC...
2025-05-19 23:18:17,520 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:17,520 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:18:17,520 - INFO - [__main__] - Making predictions for BBC using svm
2025-05-19 23:18:17,521 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:17,521 - INFO - [__main__] - Successfully got last prediction for BBC
2025-05-19 23:18:17,521 - INFO - [__main__] - 
Processing ticker: BBS
2025-05-19 23:18:17,521 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:17,521 - INFO - [__main__] - Getting last prediction point for ticker: BBS
2025-05-19 23:18:17,521 - INFO - [__main__] - ==================================================
2025-05-19 23:18:17,521 - INFO - [__main__] - Preparing test data for BBS...
2025-05-19 23:18:17,546 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:17,546 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:17,546 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:17,564 - INFO - [src.data_preparation] - Ticker BBS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:17,564 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(208), np.int64(1): np.int64(431)}
2025-05-19 23:18:17,828 - INFO - [src.data_preparation] - Ticker BBS - Selected features:
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   vnipc_t: 0.0821
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   TVV: 0.0769
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   ma14_t: 0.0717
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   ATR: 0.0706
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   ma21_t: 0.0661
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   s_d7_t: 0.0645
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   PM: 0.0590
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   SK: 0.0575
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   Volatility: 0.0552
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   ma7_t: 0.0546
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   insec_t: 0.0543
2025-05-19 23:18:17,829 - INFO - [src.data_preparation] -   Median_HL: 0.0512
2025-05-19 23:18:17,830 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:18:17,830 - INFO - [src.data_preparation] -   variation_t: 0.0460
2025-05-19 23:18:17,832 - INFO - [src.data_preparation] - Ticker BBS - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 'ATR', 'ma21_t', 's_d7_t', 'PM', 'SK', 'HL', 'Volatility', 'ma7_t', 'insec_t', 'Median_HL', 'ret', 'variation_t']
2025-05-19 23:18:17,910 - INFO - [src.data_preparation] - Ticker BBS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:17,910 - INFO - [src.data_preparation] - Ticker BBS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:17,911 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BBS
2025-05-19 23:18:17,911 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:17,911 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(173), np.int64(1): np.int64(290)}
2025-05-19 23:18:17,911 - INFO - [src.data_preparation] - Generating 117 synthetic minority samples
2025-05-19 23:18:17,916 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (580, 13, 15), y shape: (580,)
2025-05-19 23:18:17,916 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(290), np.int64(1): np.int64(290)}
2025-05-19 23:18:17,919 - INFO - [src.data_preparation] - Ticker BBS - Final 3D shapes: X_train=(580, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:17,919 - INFO - [__main__] - Using best model for BBS: svm (F1: 0.9398)
2025-05-19 23:18:17,919 - INFO - [__main__] - Loading svm model for BBS...
2025-05-19 23:18:17,921 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:17,921 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:18:17,921 - INFO - [__main__] - Making predictions for BBS using svm
2025-05-19 23:18:17,922 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:17,922 - INFO - [__main__] - Successfully got last prediction for BBS
2025-05-19 23:18:17,922 - INFO - [__main__] - 
Processing ticker: BCC
2025-05-19 23:18:17,922 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:17,922 - INFO - [__main__] - Getting last prediction point for ticker: BCC
2025-05-19 23:18:17,922 - INFO - [__main__] - ==================================================
2025-05-19 23:18:17,922 - INFO - [__main__] - Preparing test data for BCC...
2025-05-19 23:18:17,950 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:17,951 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:17,951 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:17,970 - INFO - [src.data_preparation] - Ticker BCC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:17,971 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:18:18,293 - INFO - [src.data_preparation] - Ticker BCC - Selected features:
2025-05-19 23:18:18,293 - INFO - [src.data_preparation] -   Volatility: 0.0793
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   vnipc_t: 0.0727
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   TVV: 0.0683
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   insec_t: 0.0647
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   ATR: 0.0608
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   s_d7_t: 0.0600
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   ma14_t: 0.0566
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   PM: 0.0557
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   SR: 0.0526
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   variation_t: 0.0524
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   ma21_t: 0.0523
2025-05-19 23:18:18,294 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:18:18,297 - INFO - [src.data_preparation] - Ticker BCC - Using features: ['Date', 'Volatility', 'vnipc_t', 'TVV', 'SK', 'insec_t', 'ATR', 's_d7_t', 'HL', 'ma14_t', 'PM', 'Median_HL', 'SR', 'variation_t', 'ma21_t', 'ret']
2025-05-19 23:18:18,381 - INFO - [src.data_preparation] - Ticker BCC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:18,382 - INFO - [src.data_preparation] - Ticker BCC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:18,383 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BCC
2025-05-19 23:18:18,383 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:18,383 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:18:18,383 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:18:18,385 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:18:18,385 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:18:18,387 - INFO - [src.data_preparation] - Ticker BCC - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:18,387 - INFO - [__main__] - Using best model for BCC: lstm (F1: 0.6429)
2025-05-19 23:18:18,388 - INFO - [__main__] - Loading lstm model for BCC...
2025-05-19 23:18:18,392 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:18,393 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:18:18,393 - INFO - [__main__] - Making predictions for BCC using lstm
2025-05-19 23:18:18,396 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:18,396 - INFO - [__main__] - Successfully got last prediction for BCC
2025-05-19 23:18:18,396 - INFO - [__main__] - 
Processing ticker: BCE
2025-05-19 23:18:18,396 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:18,396 - INFO - [__main__] - Getting last prediction point for ticker: BCE
2025-05-19 23:18:18,396 - INFO - [__main__] - ==================================================
2025-05-19 23:18:18,397 - INFO - [__main__] - Preparing test data for BCE...
2025-05-19 23:18:18,446 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:18,446 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:18,446 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:18,472 - INFO - [src.data_preparation] - Ticker BCE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:18,472 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] - Ticker BCE - Selected features:
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   TVV: 0.0770
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   insec_t: 0.0729
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   vnipc_t: 0.0682
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   SK: 0.0642
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   Median_HL: 0.0577
2025-05-19 23:18:18,833 - INFO - [src.data_preparation] -   PM: 0.0570
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   variation_t: 0.0568
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   HL: 0.0553
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   ret: 0.0552
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   s_d7_t: 0.0552
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   ATR: 0.0549
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   SR: 0.0509
2025-05-19 23:18:18,834 - INFO - [src.data_preparation] -   ma14_t: 0.0508
2025-05-19 23:18:18,836 - INFO - [src.data_preparation] - Ticker BCE - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 'Median_HL', 'PM', 'variation_t', 'ma21_t', 'HL', 'ret', 's_d7_t', 'ATR', 'SR', 'ma14_t']
2025-05-19 23:18:18,921 - INFO - [src.data_preparation] - Ticker BCE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:18,921 - INFO - [src.data_preparation] - Ticker BCE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:18,925 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BCE
2025-05-19 23:18:18,925 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:18,925 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:18:18,925 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:18:18,928 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:18:18,928 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:18:18,931 - INFO - [src.data_preparation] - Ticker BCE - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:18,932 - INFO - [__main__] - Using best model for BCE: svm (F1: 0.6667)
2025-05-19 23:18:18,932 - INFO - [__main__] - Loading svm model for BCE...
2025-05-19 23:18:18,933 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:18,934 - INFO - [__main__] - Model size: 0.72 MB
2025-05-19 23:18:18,934 - INFO - [__main__] - Making predictions for BCE using svm
2025-05-19 23:18:18,934 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:18,934 - INFO - [__main__] - Successfully got last prediction for BCE
2025-05-19 23:18:18,934 - INFO - [__main__] - 
Processing ticker: BDB
2025-05-19 23:18:18,934 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:18,935 - INFO - [__main__] - Getting last prediction point for ticker: BDB
2025-05-19 23:18:18,935 - INFO - [__main__] - ==================================================
2025-05-19 23:18:18,935 - INFO - [__main__] - Preparing test data for BDB...
2025-05-19 23:18:18,970 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:18,970 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:18,971 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:18,995 - INFO - [src.data_preparation] - Ticker BDB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:18,995 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(80), np.int64(1): np.int64(559)}
2025-05-19 23:18:19,253 - INFO - [src.data_preparation] - Ticker BDB - Selected features:
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   vnipc_t: 0.1243
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   ma21_t: 0.1059
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   ma14_t: 0.0925
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   ma7_t: 0.0696
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   ATR: 0.0683
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   Median_HL: 0.0652
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   PM: 0.0632
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   Volatility: 0.0597
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   SK: 0.0470
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   ret: 0.0459
2025-05-19 23:18:19,254 - INFO - [src.data_preparation] -   TVV: 0.0459
2025-05-19 23:18:19,255 - INFO - [src.data_preparation] -   variation_t: 0.0384
2025-05-19 23:18:19,255 - INFO - [src.data_preparation] -   insec_t: 0.0344
2025-05-19 23:18:19,255 - INFO - [src.data_preparation] -   HL: 0.0312
2025-05-19 23:18:19,260 - INFO - [src.data_preparation] - Ticker BDB - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'ATR', 's_d7_t', 'Median_HL', 'PM', 'Volatility', 'SK', 'ret', 'TVV', 'variation_t', 'insec_t', 'HL']
2025-05-19 23:18:19,358 - INFO - [src.data_preparation] - Ticker BDB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:19,358 - INFO - [src.data_preparation] - Ticker BDB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:19,359 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BDB
2025-05-19 23:18:19,359 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:19,359 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(44), np.int64(1): np.int64(419)}
2025-05-19 23:18:19,360 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:18:19,363 - INFO - [src.data_preparation] - Ticker BDB - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:19,363 - INFO - [__main__] - Using best model for BDB: lstm (F1: 0.9524)
2025-05-19 23:18:19,363 - INFO - [__main__] - Loading lstm model for BDB...
2025-05-19 23:18:19,367 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:19,369 - INFO - [__main__] - Model size: 0.26 MB
2025-05-19 23:18:19,369 - INFO - [__main__] - Making predictions for BDB using lstm
2025-05-19 23:18:19,373 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:19,373 - INFO - [__main__] - Successfully got last prediction for BDB
2025-05-19 23:18:19,374 - INFO - [__main__] - 
Processing ticker: BED
2025-05-19 23:18:19,374 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:19,374 - INFO - [__main__] - Getting last prediction point for ticker: BED
2025-05-19 23:18:19,374 - INFO - [__main__] - ==================================================
2025-05-19 23:18:19,374 - INFO - [__main__] - Preparing test data for BED...
2025-05-19 23:18:19,436 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:19,437 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:19,437 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:19,491 - INFO - [src.data_preparation] - Ticker BED - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:19,491 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(103), np.int64(1): np.int64(536)}
2025-05-19 23:18:19,772 - INFO - [src.data_preparation] - Ticker BED - Selected features:
2025-05-19 23:18:19,772 - INFO - [src.data_preparation] -   vnipc_t: 0.1200
2025-05-19 23:18:19,772 - INFO - [src.data_preparation] -   TVV: 0.0999
2025-05-19 23:18:19,772 - INFO - [src.data_preparation] -   ma21_t: 0.0757
2025-05-19 23:18:19,772 - INFO - [src.data_preparation] -   ma14_t: 0.0703
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   PM: 0.0561
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   Volatility: 0.0560
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   Median_HL: 0.0548
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   s_d7_t: 0.0528
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   ma7_t: 0.0525
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   ATR: 0.0508
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   variation_t: 0.0484
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   SK: 0.0471
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   LO: 0.0426
2025-05-19 23:18:19,773 - INFO - [src.data_preparation] -   HL: 0.0425
2025-05-19 23:18:19,776 - INFO - [src.data_preparation] - Ticker BED - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'PM', 'Volatility', 'Median_HL', 'ret', 's_d7_t', 'ma7_t', 'ATR', 'variation_t', 'SK', 'LO', 'HL']
2025-05-19 23:18:19,859 - INFO - [src.data_preparation] - Ticker BED - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:19,860 - INFO - [src.data_preparation] - Ticker BED - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:19,861 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BED
2025-05-19 23:18:19,861 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:19,862 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(89), np.int64(1): np.int64(374)}
2025-05-19 23:18:19,862 - INFO - [src.data_preparation] - Generating 285 synthetic minority samples
2025-05-19 23:18:19,871 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (748, 13, 15), y shape: (748,)
2025-05-19 23:18:19,871 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(374), np.int64(1): np.int64(374)}
2025-05-19 23:18:19,876 - INFO - [src.data_preparation] - Ticker BED - Final 3D shapes: X_train=(748, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:19,876 - INFO - [__main__] - Using best model for BED: lstm (F1: 0.9885)
2025-05-19 23:18:19,876 - INFO - [__main__] - Loading lstm model for BED...
2025-05-19 23:18:19,880 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:19,881 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:18:19,881 - INFO - [__main__] - Making predictions for BED using lstm
2025-05-19 23:18:19,883 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:19,883 - INFO - [__main__] - Successfully got last prediction for BED
2025-05-19 23:18:19,883 - INFO - [__main__] - 
Processing ticker: BHC
2025-05-19 23:18:19,883 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:19,884 - INFO - [__main__] - Getting last prediction point for ticker: BHC
2025-05-19 23:18:19,884 - INFO - [__main__] - ==================================================
2025-05-19 23:18:19,884 - INFO - [__main__] - Preparing test data for BHC...
2025-05-19 23:18:19,914 - INFO - [src.data_preparation] - After processing - X shape: (595, 19), y shape: (595,)
2025-05-19 23:18:19,914 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:19,914 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:19,933 - INFO - [src.data_preparation] - Ticker BHC - Original shapes: X=(595, 18), y=(595,)
2025-05-19 23:18:19,933 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(140), np.int64(1): np.int64(455)}
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] - Ticker BHC - Selected features:
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   ma21_t: 0.0987
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   TVV: 0.0943
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   vnipc_t: 0.0924
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   ma14_t: 0.0767
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   ma7_t: 0.0675
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:18:20,168 - INFO - [src.data_preparation] -   ATR: 0.0578
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   PM: 0.0568
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   Median_HL: 0.0533
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   insec_t: 0.0502
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   SK: 0.0500
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   variation_t: 0.0450
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   ret: 0.0409
2025-05-19 23:18:20,169 - INFO - [src.data_preparation] -   SR: 0.0248
2025-05-19 23:18:20,171 - INFO - [src.data_preparation] - Ticker BHC - Using features: ['Date', 'ma21_t', 'TVV', 'vnipc_t', 'ma14_t', 'ma7_t', 's_d7_t', 'Volatility', 'ATR', 'PM', 'Median_HL', 'insec_t', 'SK', 'variation_t', 'ret', 'SR']
2025-05-19 23:18:20,256 - INFO - [src.data_preparation] - Ticker BHC - 2D shapes: X_train=(419, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:20,256 - INFO - [src.data_preparation] - Ticker BHC - 3D shapes: X_train=(419, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:20,259 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BHC
2025-05-19 23:18:20,260 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (419, 13, 15), y shape: (419,)
2025-05-19 23:18:20,260 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(95), np.int64(1): np.int64(324)}
2025-05-19 23:18:20,260 - INFO - [src.data_preparation] - Generating 229 synthetic minority samples
2025-05-19 23:18:20,272 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (648, 13, 15), y shape: (648,)
2025-05-19 23:18:20,272 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(324), np.int64(1): np.int64(324)}
2025-05-19 23:18:20,275 - INFO - [src.data_preparation] - Ticker BHC - Final 3D shapes: X_train=(648, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:20,276 - INFO - [__main__] - Using best model for BHC: svm (F1: 0.7302)
2025-05-19 23:18:20,276 - INFO - [__main__] - Loading svm model for BHC...
2025-05-19 23:18:20,277 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:20,278 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:18:20,278 - INFO - [__main__] - Making predictions for BHC using svm
2025-05-19 23:18:20,278 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:20,278 - INFO - [__main__] - Successfully got last prediction for BHC
2025-05-19 23:18:20,278 - INFO - [__main__] - 
Processing ticker: BIC
2025-05-19 23:18:20,279 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:20,279 - INFO - [__main__] - Getting last prediction point for ticker: BIC
2025-05-19 23:18:20,279 - INFO - [__main__] - ==================================================
2025-05-19 23:18:20,279 - INFO - [__main__] - Preparing test data for BIC...
2025-05-19 23:18:20,307 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:20,307 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:20,307 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:20,325 - INFO - [src.data_preparation] - Ticker BIC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:20,325 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:18:20,645 - INFO - [src.data_preparation] - Ticker BIC - Selected features:
2025-05-19 23:18:20,645 - INFO - [src.data_preparation] -   TVV: 0.0782
2025-05-19 23:18:20,645 - INFO - [src.data_preparation] -   ATR: 0.0765
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   vnipc_t: 0.0668
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   s_d7_t: 0.0635
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   Volatility: 0.0608
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   insec_t: 0.0600
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   HL: 0.0596
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   LO: 0.0558
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   variation_t: 0.0540
2025-05-19 23:18:20,646 - INFO - [src.data_preparation] -   SR: 0.0527
2025-05-19 23:18:20,647 - INFO - [src.data_preparation] -   ma14_t: 0.0510
2025-05-19 23:18:20,647 - INFO - [src.data_preparation] -   ma7_t: 0.0506
2025-05-19 23:18:20,647 - INFO - [src.data_preparation] -   ret: 0.0495
2025-05-19 23:18:20,647 - INFO - [src.data_preparation] -   PM: 0.0495
2025-05-19 23:18:20,651 - INFO - [src.data_preparation] - Ticker BIC - Using features: ['Date', 'TVV', 'ATR', 'vnipc_t', 'SK', 's_d7_t', 'Volatility', 'insec_t', 'HL', 'LO', 'variation_t', 'SR', 'ma14_t', 'ma7_t', 'ret', 'PM']
2025-05-19 23:18:20,739 - INFO - [src.data_preparation] - Ticker BIC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:20,739 - INFO - [src.data_preparation] - Ticker BIC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:20,740 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BIC
2025-05-19 23:18:20,740 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:20,740 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:18:20,741 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:18:20,742 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:18:20,742 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:18:20,744 - INFO - [src.data_preparation] - Ticker BIC - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:20,744 - INFO - [__main__] - Using best model for BIC: transformer (F1: 0.7188)
2025-05-19 23:18:20,744 - INFO - [__main__] - Loading transformer model for BIC...
2025-05-19 23:18:20,760 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:18:20,768 - INFO - [__main__] - Model size: 0.55 MB
2025-05-19 23:18:20,768 - INFO - [__main__] - Making predictions for BIC using transformer
2025-05-19 23:18:20,771 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:20,772 - INFO - [__main__] - Successfully got last prediction for BIC
2025-05-19 23:18:20,772 - INFO - [__main__] - 
Processing ticker: BKC
2025-05-19 23:18:20,772 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:20,772 - INFO - [__main__] - Getting last prediction point for ticker: BKC
2025-05-19 23:18:20,772 - INFO - [__main__] - ==================================================
2025-05-19 23:18:20,772 - INFO - [__main__] - Preparing test data for BKC...
2025-05-19 23:18:20,814 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:20,814 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:20,814 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:20,840 - INFO - [src.data_preparation] - Ticker BKC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:20,840 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(227), np.int64(1): np.int64(412)}
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] - Ticker BKC - Selected features:
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   vnipc_t: 0.0853
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   SK: 0.0749
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   s_d7_t: 0.0718
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   TVV: 0.0705
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   ma21_t: 0.0679
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   ATR: 0.0648
2025-05-19 23:18:21,183 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   ma14_t: 0.0626
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   insec_t: 0.0548
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   Median_HL: 0.0523
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   variation_t: 0.0492
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   PM: 0.0444
2025-05-19 23:18:21,184 - INFO - [src.data_preparation] -   SR: 0.0395
2025-05-19 23:18:21,187 - INFO - [src.data_preparation] - Ticker BKC - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'TVV', 'ma21_t', 'ATR', 'Volatility', 'ma14_t', 'ma7_t', 'insec_t', 'ret', 'Median_HL', 'variation_t', 'PM', 'SR']
2025-05-19 23:18:21,301 - INFO - [src.data_preparation] - Ticker BKC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:21,301 - INFO - [src.data_preparation] - Ticker BKC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:21,303 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BKC
2025-05-19 23:18:21,303 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:21,303 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(151), np.int64(1): np.int64(312)}
2025-05-19 23:18:21,303 - INFO - [src.data_preparation] - Generating 161 synthetic minority samples
2025-05-19 23:18:21,312 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (624, 13, 15), y shape: (624,)
2025-05-19 23:18:21,312 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(312), np.int64(1): np.int64(312)}
2025-05-19 23:18:21,316 - INFO - [src.data_preparation] - Ticker BKC - Final 3D shapes: X_train=(624, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:21,316 - INFO - [__main__] - Using best model for BKC: svm (F1: 0.6866)
2025-05-19 23:18:21,316 - INFO - [__main__] - Loading svm model for BKC...
2025-05-19 23:18:21,318 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:21,318 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:18:21,319 - INFO - [__main__] - Making predictions for BKC using svm
2025-05-19 23:18:21,319 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:21,320 - INFO - [__main__] - Successfully got last prediction for BKC
2025-05-19 23:18:21,320 - INFO - [__main__] - 
Processing ticker: BLF
2025-05-19 23:18:21,320 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:21,320 - INFO - [__main__] - Getting last prediction point for ticker: BLF
2025-05-19 23:18:21,320 - INFO - [__main__] - ==================================================
2025-05-19 23:18:21,320 - INFO - [__main__] - Preparing test data for BLF...
2025-05-19 23:18:21,355 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:21,355 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:21,355 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:21,382 - INFO - [src.data_preparation] - Ticker BLF - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:21,382 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(239), np.int64(1): np.int64(399)}
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] - Ticker BLF - Selected features:
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] -   ma14_t: 0.0764
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] -   TVV: 0.0753
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] -   vnipc_t: 0.0691
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] -   ma21_t: 0.0689
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] -   Volatility: 0.0673
2025-05-19 23:18:21,695 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   ATR: 0.0634
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   SK: 0.0593
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   ma7_t: 0.0574
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   insec_t: 0.0572
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   HL: 0.0524
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   variation_t: 0.0495
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   PM: 0.0480
2025-05-19 23:18:21,696 - INFO - [src.data_preparation] -   ret: 0.0475
2025-05-19 23:18:21,699 - INFO - [src.data_preparation] - Ticker BLF - Using features: ['Date', 'ma14_t', 'TVV', 'vnipc_t', 'ma21_t', 'Volatility', 's_d7_t', 'ATR', 'SK', 'ma7_t', 'insec_t', 'Median_HL', 'HL', 'variation_t', 'PM', 'ret']
2025-05-19 23:18:21,901 - INFO - [src.data_preparation] - Ticker BLF - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:18:21,901 - INFO - [src.data_preparation] - Ticker BLF - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:21,902 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BLF
2025-05-19 23:18:21,902 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:21,903 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(181), np.int64(1): np.int64(282)}
2025-05-19 23:18:21,903 - INFO - [src.data_preparation] - Generating 101 synthetic minority samples
2025-05-19 23:18:21,907 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:18:21,908 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:18:21,911 - INFO - [src.data_preparation] - Ticker BLF - Final 3D shapes: X_train=(564, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:21,911 - INFO - [__main__] - Using best model for BLF: svm (F1: 0.6667)
2025-05-19 23:18:21,911 - INFO - [__main__] - Loading svm model for BLF...
2025-05-19 23:18:21,912 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:21,913 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:18:21,913 - INFO - [__main__] - Making predictions for BLF using svm
2025-05-19 23:18:21,914 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:21,914 - INFO - [__main__] - Successfully got last prediction for BLF
2025-05-19 23:18:21,914 - INFO - [__main__] - 
Processing ticker: BMC
2025-05-19 23:18:21,914 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:21,914 - INFO - [__main__] - Getting last prediction point for ticker: BMC
2025-05-19 23:18:21,914 - INFO - [__main__] - ==================================================
2025-05-19 23:18:21,914 - INFO - [__main__] - Preparing test data for BMC...
2025-05-19 23:18:21,944 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:21,944 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:21,944 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:21,964 - INFO - [src.data_preparation] - Ticker BMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:21,964 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(325), np.int64(1): np.int64(314)}
2025-05-19 23:18:22,396 - INFO - [src.data_preparation] - Ticker BMC - Selected features:
2025-05-19 23:18:22,396 - INFO - [src.data_preparation] -   s_d7_t: 0.0738
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   SK: 0.0673
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   ma21_t: 0.0636
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   ATR: 0.0623
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   Volatility: 0.0614
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   HL: 0.0609
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   vnipc_t: 0.0603
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   ma14_t: 0.0595
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   insec_t: 0.0593
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   TVV: 0.0593
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   PM: 0.0572
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   Median_HL: 0.0569
2025-05-19 23:18:22,397 - INFO - [src.data_preparation] -   SR: 0.0540
2025-05-19 23:18:22,398 - INFO - [src.data_preparation] -   ret: 0.0526
2025-05-19 23:18:22,398 - INFO - [src.data_preparation] -   ma7_t: 0.0525
2025-05-19 23:18:22,401 - INFO - [src.data_preparation] - Ticker BMC - Using features: ['Date', 's_d7_t', 'SK', 'ma21_t', 'ATR', 'Volatility', 'HL', 'vnipc_t', 'ma14_t', 'insec_t', 'TVV', 'PM', 'Median_HL', 'SR', 'ret', 'ma7_t']
2025-05-19 23:18:22,504 - INFO - [src.data_preparation] - Ticker BMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:22,505 - INFO - [src.data_preparation] - Ticker BMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:22,506 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BMC
2025-05-19 23:18:22,506 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:22,506 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(224)}
2025-05-19 23:18:22,506 - INFO - [src.data_preparation] - Generating 15 synthetic minority samples
2025-05-19 23:18:22,508 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:18:22,508 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:18:22,511 - INFO - [src.data_preparation] - Ticker BMC - Final 3D shapes: X_train=(478, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:22,511 - INFO - [__main__] - Using best model for BMC: logistic_regression (F1: 0.6538)
2025-05-19 23:18:22,511 - INFO - [__main__] - Loading logistic_regression model for BMC...
2025-05-19 23:18:22,512 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:22,512 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:22,512 - INFO - [__main__] - Making predictions for BMC using logistic_regression
2025-05-19 23:18:22,513 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:22,513 - INFO - [__main__] - Successfully got last prediction for BMC
2025-05-19 23:18:22,513 - INFO - [__main__] - 
Processing ticker: BMI
2025-05-19 23:18:22,513 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:22,513 - INFO - [__main__] - Getting last prediction point for ticker: BMI
2025-05-19 23:18:22,513 - INFO - [__main__] - ==================================================
2025-05-19 23:18:22,513 - INFO - [__main__] - Preparing test data for BMI...
2025-05-19 23:18:22,543 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:22,543 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:22,543 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:22,569 - INFO - [src.data_preparation] - Ticker BMI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:22,570 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:18:22,905 - INFO - [src.data_preparation] - Ticker BMI - Selected features:
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   insec_t: 0.0706
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   vnipc_t: 0.0698
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   Volatility: 0.0686
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   s_d7_t: 0.0662
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   LO: 0.0642
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   TVV: 0.0617
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   HL: 0.0575
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   variation_t: 0.0569
2025-05-19 23:18:22,906 - INFO - [src.data_preparation] -   ATR: 0.0557
2025-05-19 23:18:22,907 - INFO - [src.data_preparation] -   ma14_t: 0.0557
2025-05-19 23:18:22,907 - INFO - [src.data_preparation] -   SR: 0.0537
2025-05-19 23:18:22,907 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:18:22,907 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:18:22,907 - INFO - [src.data_preparation] -   ma7_t: 0.0505
2025-05-19 23:18:22,910 - INFO - [src.data_preparation] - Ticker BMI - Using features: ['Date', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 's_d7_t', 'LO', 'TVV', 'HL', 'variation_t', 'ATR', 'ma14_t', 'SR', 'ret', 'PM', 'ma7_t']
2025-05-19 23:18:22,997 - INFO - [src.data_preparation] - Ticker BMI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:22,997 - INFO - [src.data_preparation] - Ticker BMI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:22,999 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BMI
2025-05-19 23:18:22,999 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:22,999 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:18:22,999 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:18:23,001 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:18:23,001 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:18:23,004 - INFO - [src.data_preparation] - Ticker BMI - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:23,004 - INFO - [__main__] - Using best model for BMI: svm (F1: 0.6250)
2025-05-19 23:18:23,004 - INFO - [__main__] - Loading svm model for BMI...
2025-05-19 23:18:23,006 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:23,006 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:18:23,006 - INFO - [__main__] - Making predictions for BMI using svm
2025-05-19 23:18:23,007 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:23,007 - INFO - [__main__] - Successfully got last prediction for BMI
2025-05-19 23:18:23,007 - INFO - [__main__] - 
Processing ticker: BMJ
2025-05-19 23:18:23,007 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:23,007 - INFO - [__main__] - Getting last prediction point for ticker: BMJ
2025-05-19 23:18:23,007 - INFO - [__main__] - ==================================================
2025-05-19 23:18:23,007 - INFO - [__main__] - Preparing test data for BMJ...
2025-05-19 23:18:23,036 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:23,036 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:23,036 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:23,056 - INFO - [src.data_preparation] - Ticker BMJ - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:23,056 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(203), np.int64(1): np.int64(436)}
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] - Ticker BMJ - Selected features:
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   vnipc_t: 0.0762
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   s_d7_t: 0.0701
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   Median_HL: 0.0695
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   TVV: 0.0683
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   ma7_t: 0.0679
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   ma21_t: 0.0675
2025-05-19 23:18:23,348 - INFO - [src.data_preparation] -   SK: 0.0672
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   Volatility: 0.0672
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   ATR: 0.0667
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   ma14_t: 0.0651
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   PM: 0.0598
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   variation_t: 0.0536
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   insec_t: 0.0520
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   ret: 0.0493
2025-05-19 23:18:23,349 - INFO - [src.data_preparation] -   SR: 0.0388
2025-05-19 23:18:23,351 - INFO - [src.data_preparation] - Ticker BMJ - Using features: ['Date', 'vnipc_t', 's_d7_t', 'Median_HL', 'TVV', 'ma7_t', 'ma21_t', 'SK', 'Volatility', 'ATR', 'ma14_t', 'PM', 'variation_t', 'insec_t', 'ret', 'SR']
2025-05-19 23:18:23,449 - INFO - [src.data_preparation] - Ticker BMJ - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:23,449 - INFO - [src.data_preparation] - Ticker BMJ - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:23,451 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BMJ
2025-05-19 23:18:23,451 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:23,451 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(119), np.int64(1): np.int64(344)}
2025-05-19 23:18:23,451 - INFO - [src.data_preparation] - Generating 225 synthetic minority samples
2025-05-19 23:18:23,460 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (688, 13, 15), y shape: (688,)
2025-05-19 23:18:23,461 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(344), np.int64(1): np.int64(344)}
2025-05-19 23:18:23,467 - INFO - [src.data_preparation] - Ticker BMJ - Final 3D shapes: X_train=(688, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:23,467 - INFO - [__main__] - Using best model for BMJ: lstm (F1: 0.7606)
2025-05-19 23:18:23,467 - INFO - [__main__] - Loading lstm model for BMJ...
2025-05-19 23:18:23,471 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:23,472 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:18:23,473 - INFO - [__main__] - Making predictions for BMJ using lstm
2025-05-19 23:18:23,476 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:23,476 - INFO - [__main__] - Successfully got last prediction for BMJ
2025-05-19 23:18:23,476 - INFO - [__main__] - 
Processing ticker: BMP
2025-05-19 23:18:23,477 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:23,477 - INFO - [__main__] - Getting last prediction point for ticker: BMP
2025-05-19 23:18:23,477 - INFO - [__main__] - ==================================================
2025-05-19 23:18:23,477 - INFO - [__main__] - Preparing test data for BMP...
2025-05-19 23:18:23,535 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:23,535 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:23,535 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:23,567 - INFO - [src.data_preparation] - Ticker BMP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:23,567 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(337)}
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] - Ticker BMP - Selected features:
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   SK: 0.0738
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   insec_t: 0.0692
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   SR: 0.0622
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   s_d7_t: 0.0618
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   LO: 0.0610
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   TVV: 0.0609
2025-05-19 23:18:24,026 - INFO - [src.data_preparation] -   HL: 0.0598
2025-05-19 23:18:24,027 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:18:24,027 - INFO - [src.data_preparation] -   Median_HL: 0.0568
2025-05-19 23:18:24,027 - INFO - [src.data_preparation] -   ret: 0.0543
2025-05-19 23:18:24,027 - INFO - [src.data_preparation] -   variation_t: 0.0532
2025-05-19 23:18:24,027 - INFO - [src.data_preparation] -   ATR: 0.0525
2025-05-19 23:18:24,027 - INFO - [src.data_preparation] -   ma21_t: 0.0504
2025-05-19 23:18:24,031 - INFO - [src.data_preparation] - Ticker BMP - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'Volatility', 'SR', 's_d7_t', 'LO', 'TVV', 'HL', 'PM', 'Median_HL', 'ret', 'variation_t', 'ATR', 'ma21_t']
2025-05-19 23:18:24,121 - INFO - [src.data_preparation] - Ticker BMP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:24,121 - INFO - [src.data_preparation] - Ticker BMP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:24,123 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BMP
2025-05-19 23:18:24,123 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:24,123 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:18:24,123 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:18:24,125 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:18:24,125 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:18:24,128 - INFO - [src.data_preparation] - Ticker BMP - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:24,128 - INFO - [__main__] - Using best model for BMP: svm (F1: 0.6462)
2025-05-19 23:18:24,128 - INFO - [__main__] - Loading svm model for BMP...
2025-05-19 23:18:24,130 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:24,130 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:18:24,130 - INFO - [__main__] - Making predictions for BMP using svm
2025-05-19 23:18:24,131 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:24,131 - INFO - [__main__] - Successfully got last prediction for BMP
2025-05-19 23:18:24,131 - INFO - [__main__] - 
Processing ticker: BPC
2025-05-19 23:18:24,131 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:24,131 - INFO - [__main__] - Getting last prediction point for ticker: BPC
2025-05-19 23:18:24,131 - INFO - [__main__] - ==================================================
2025-05-19 23:18:24,131 - INFO - [__main__] - Preparing test data for BPC...
2025-05-19 23:18:24,178 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:24,178 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:24,178 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:24,209 - INFO - [src.data_preparation] - Ticker BPC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:24,209 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(217), np.int64(1): np.int64(422)}
2025-05-19 23:18:24,527 - INFO - [src.data_preparation] - Ticker BPC - Selected features:
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   TVV: 0.0773
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   ATR: 0.0767
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   s_d7_t: 0.0702
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   Volatility: 0.0662
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   ma14_t: 0.0662
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   insec_t: 0.0636
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   SK: 0.0629
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   ma21_t: 0.0582
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   ma7_t: 0.0580
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   PM: 0.0539
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:18:24,528 - INFO - [src.data_preparation] -   HL: 0.0479
2025-05-19 23:18:24,529 - INFO - [src.data_preparation] -   ret: 0.0467
2025-05-19 23:18:24,529 - INFO - [src.data_preparation] -   SR: 0.0463
2025-05-19 23:18:24,531 - INFO - [src.data_preparation] - Ticker BPC - Using features: ['Date', 'TVV', 'ATR', 's_d7_t', 'vnipc_t', 'Volatility', 'ma14_t', 'insec_t', 'SK', 'ma21_t', 'ma7_t', 'PM', 'Median_HL', 'HL', 'ret', 'SR']
2025-05-19 23:18:24,618 - INFO - [src.data_preparation] - Ticker BPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:24,618 - INFO - [src.data_preparation] - Ticker BPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:24,620 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BPC
2025-05-19 23:18:24,621 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:24,621 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(155), np.int64(1): np.int64(308)}
2025-05-19 23:18:24,621 - INFO - [src.data_preparation] - Generating 153 synthetic minority samples
2025-05-19 23:18:24,627 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (616, 13, 15), y shape: (616,)
2025-05-19 23:18:24,627 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(308), np.int64(1): np.int64(308)}
2025-05-19 23:18:24,630 - INFO - [src.data_preparation] - Ticker BPC - Final 3D shapes: X_train=(616, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:24,630 - INFO - [__main__] - Using best model for BPC: svm (F1: 0.8108)
2025-05-19 23:18:24,630 - INFO - [__main__] - Loading svm model for BPC...
2025-05-19 23:18:24,633 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:24,633 - INFO - [__main__] - Model size: 0.93 MB
2025-05-19 23:18:24,633 - INFO - [__main__] - Making predictions for BPC using svm
2025-05-19 23:18:24,633 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:24,633 - INFO - [__main__] - Successfully got last prediction for BPC
2025-05-19 23:18:24,634 - INFO - [__main__] - 
Processing ticker: BRC
2025-05-19 23:18:24,634 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:24,634 - INFO - [__main__] - Getting last prediction point for ticker: BRC
2025-05-19 23:18:24,634 - INFO - [__main__] - ==================================================
2025-05-19 23:18:24,634 - INFO - [__main__] - Preparing test data for BRC...
2025-05-19 23:18:24,663 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:24,663 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:24,663 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:24,682 - INFO - [src.data_preparation] - Ticker BRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:24,682 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(262), np.int64(1): np.int64(377)}
2025-05-19 23:18:25,092 - INFO - [src.data_preparation] - Ticker BRC - Selected features:
2025-05-19 23:18:25,092 - INFO - [src.data_preparation] -   SK: 0.0732
2025-05-19 23:18:25,092 - INFO - [src.data_preparation] -   ATR: 0.0726
2025-05-19 23:18:25,092 - INFO - [src.data_preparation] -   s_d7_t: 0.0714
2025-05-19 23:18:25,092 - INFO - [src.data_preparation] -   vnipc_t: 0.0711
2025-05-19 23:18:25,092 - INFO - [src.data_preparation] -   TVV: 0.0691
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   insec_t: 0.0630
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   Volatility: 0.0613
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   HL: 0.0550
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   SR: 0.0531
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   ma14_t: 0.0513
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   ma21_t: 0.0513
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   variation_t: 0.0513
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   LO: 0.0511
2025-05-19 23:18:25,093 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:18:25,096 - INFO - [src.data_preparation] - Ticker BRC - Using features: ['Date', 'SK', 'ATR', 's_d7_t', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 'HL', 'ret', 'SR', 'ma14_t', 'ma21_t', 'variation_t', 'LO', 'Median_HL']
2025-05-19 23:18:25,175 - INFO - [src.data_preparation] - Ticker BRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:25,175 - INFO - [src.data_preparation] - Ticker BRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:25,176 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BRC
2025-05-19 23:18:25,177 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:25,177 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(184), np.int64(1): np.int64(279)}
2025-05-19 23:18:25,177 - INFO - [src.data_preparation] - Generating 95 synthetic minority samples
2025-05-19 23:18:25,181 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (558, 13, 15), y shape: (558,)
2025-05-19 23:18:25,181 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(279), np.int64(1): np.int64(279)}
2025-05-19 23:18:25,184 - INFO - [src.data_preparation] - Ticker BRC - Final 3D shapes: X_train=(558, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:25,184 - INFO - [__main__] - Using best model for BRC: svm (F1: 0.7778)
2025-05-19 23:18:25,184 - INFO - [__main__] - Loading svm model for BRC...
2025-05-19 23:18:25,186 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:25,186 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:18:25,186 - INFO - [__main__] - Making predictions for BRC using svm
2025-05-19 23:18:25,187 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:25,187 - INFO - [__main__] - Successfully got last prediction for BRC
2025-05-19 23:18:25,187 - INFO - [__main__] - 
Processing ticker: BSC
2025-05-19 23:18:25,188 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:25,188 - INFO - [__main__] - Getting last prediction point for ticker: BSC
2025-05-19 23:18:25,188 - INFO - [__main__] - ==================================================
2025-05-19 23:18:25,188 - INFO - [__main__] - Preparing test data for BSC...
2025-05-19 23:18:25,213 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:25,213 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:25,213 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:25,231 - INFO - [src.data_preparation] - Ticker BSC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:25,231 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(71), np.int64(1): np.int64(568)}
2025-05-19 23:18:25,437 - INFO - [src.data_preparation] - Ticker BSC - Selected features:
2025-05-19 23:18:25,437 - INFO - [src.data_preparation] -   vnipc_t: 0.1339
2025-05-19 23:18:25,437 - INFO - [src.data_preparation] -   TVV: 0.0852
2025-05-19 23:18:25,437 - INFO - [src.data_preparation] -   ma21_t: 0.0844
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   ma14_t: 0.0716
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   PM: 0.0647
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   ma7_t: 0.0635
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   s_d7_t: 0.0617
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   Median_HL: 0.0576
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   ATR: 0.0574
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   Volatility: 0.0570
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   insec_t: 0.0485
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   HL: 0.0458
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   SK: 0.0440
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   ret: 0.0361
2025-05-19 23:18:25,438 - INFO - [src.data_preparation] -   variation_t: 0.0328
2025-05-19 23:18:25,441 - INFO - [src.data_preparation] - Ticker BSC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'PM', 'ma7_t', 's_d7_t', 'Median_HL', 'ATR', 'Volatility', 'insec_t', 'HL', 'SK', 'ret', 'variation_t']
2025-05-19 23:18:25,523 - INFO - [src.data_preparation] - Ticker BSC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:25,524 - INFO - [src.data_preparation] - Ticker BSC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:25,525 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BSC
2025-05-19 23:18:25,525 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:25,525 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(63), np.int64(1): np.int64(400)}
2025-05-19 23:18:25,526 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:18:25,529 - INFO - [src.data_preparation] - Ticker BSC - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:25,530 - INFO - [__main__] - Using best model for BSC: lstm (F1: 0.9885)
2025-05-19 23:18:25,530 - INFO - [__main__] - Loading lstm model for BSC...
2025-05-19 23:18:25,534 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:25,535 - INFO - [__main__] - Model size: 0.29 MB
2025-05-19 23:18:25,535 - INFO - [__main__] - Making predictions for BSC using lstm
2025-05-19 23:18:25,539 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:25,540 - INFO - [__main__] - Successfully got last prediction for BSC
2025-05-19 23:18:25,540 - INFO - [__main__] - 
Processing ticker: BSI
2025-05-19 23:18:25,540 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:25,540 - INFO - [__main__] - Getting last prediction point for ticker: BSI
2025-05-19 23:18:25,540 - INFO - [__main__] - ==================================================
2025-05-19 23:18:25,540 - INFO - [__main__] - Preparing test data for BSI...
2025-05-19 23:18:25,574 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:25,575 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:25,575 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:25,597 - INFO - [src.data_preparation] - Ticker BSI - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:25,597 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(295), np.int64(1): np.int64(343)}
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] - Ticker BSI - Selected features:
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] -   vnipc_t: 0.0760
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] -   TVV: 0.0739
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] -   SK: 0.0738
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] -   Volatility: 0.0698
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] -   insec_t: 0.0698
2025-05-19 23:18:25,934 - INFO - [src.data_preparation] -   s_d7_t: 0.0579
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   ret: 0.0571
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   SR: 0.0559
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   ma14_t: 0.0517
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   ma7_t: 0.0516
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   ma21_t: 0.0513
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   LO: 0.0506
2025-05-19 23:18:25,935 - INFO - [src.data_preparation] -   variation_t: 0.0483
2025-05-19 23:18:25,938 - INFO - [src.data_preparation] - Ticker BSI - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'Volatility', 'insec_t', 's_d7_t', 'ATR', 'ret', 'SR', 'Median_HL', 'ma14_t', 'ma7_t', 'ma21_t', 'LO', 'variation_t']
2025-05-19 23:18:26,035 - INFO - [src.data_preparation] - Ticker BSI - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:26,035 - INFO - [src.data_preparation] - Ticker BSI - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:26,037 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BSI
2025-05-19 23:18:26,037 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:26,037 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(250)}
2025-05-19 23:18:26,037 - INFO - [src.data_preparation] - Generating 38 synthetic minority samples
2025-05-19 23:18:26,040 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:18:26,040 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:18:26,044 - INFO - [src.data_preparation] - Ticker BSI - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:26,044 - INFO - [__main__] - Using best model for BSI: svm (F1: 0.7429)
2025-05-19 23:18:26,044 - INFO - [__main__] - Loading svm model for BSI...
2025-05-19 23:18:26,047 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:26,047 - INFO - [__main__] - Model size: 0.51 MB
2025-05-19 23:18:26,047 - INFO - [__main__] - Making predictions for BSI using svm
2025-05-19 23:18:26,048 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:26,049 - INFO - [__main__] - Successfully got last prediction for BSI
2025-05-19 23:18:26,049 - INFO - [__main__] - 
Processing ticker: BST
2025-05-19 23:18:26,049 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:26,049 - INFO - [__main__] - Getting last prediction point for ticker: BST
2025-05-19 23:18:26,049 - INFO - [__main__] - ==================================================
2025-05-19 23:18:26,049 - INFO - [__main__] - Preparing test data for BST...
2025-05-19 23:18:26,086 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:26,086 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:26,086 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:26,111 - INFO - [src.data_preparation] - Ticker BST - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:26,111 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(182), np.int64(1): np.int64(457)}
2025-05-19 23:18:26,409 - INFO - [src.data_preparation] - Ticker BST - Selected features:
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   TVV: 0.0841
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   vnipc_t: 0.0744
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   ATR: 0.0681
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   s_d7_t: 0.0643
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   ma7_t: 0.0630
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   insec_t: 0.0617
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   ma21_t: 0.0604
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   ma14_t: 0.0580
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   PM: 0.0577
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   Volatility: 0.0562
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:18:26,410 - INFO - [src.data_preparation] -   ret: 0.0513
2025-05-19 23:18:26,411 - INFO - [src.data_preparation] -   variation_t: 0.0453
2025-05-19 23:18:26,411 - INFO - [src.data_preparation] -   HL: 0.0444
2025-05-19 23:18:26,413 - INFO - [src.data_preparation] - Ticker BST - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'SK', 's_d7_t', 'ma7_t', 'insec_t', 'ma21_t', 'ma14_t', 'PM', 'Volatility', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:18:26,494 - INFO - [src.data_preparation] - Ticker BST - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:26,495 - INFO - [src.data_preparation] - Ticker BST - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:26,496 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BST
2025-05-19 23:18:26,496 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:26,496 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(118), np.int64(1): np.int64(345)}
2025-05-19 23:18:26,497 - INFO - [src.data_preparation] - Generating 227 synthetic minority samples
2025-05-19 23:18:26,505 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (690, 13, 15), y shape: (690,)
2025-05-19 23:18:26,505 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(345), np.int64(1): np.int64(345)}
2025-05-19 23:18:26,509 - INFO - [src.data_preparation] - Ticker BST - Final 3D shapes: X_train=(690, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:26,509 - INFO - [__main__] - Using best model for BST: svm (F1: 0.6667)
2025-05-19 23:18:26,509 - INFO - [__main__] - Loading svm model for BST...
2025-05-19 23:18:26,511 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:26,511 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:18:26,511 - INFO - [__main__] - Making predictions for BST using svm
2025-05-19 23:18:26,511 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:26,512 - INFO - [__main__] - Successfully got last prediction for BST
2025-05-19 23:18:26,512 - INFO - [__main__] - 
Processing ticker: BT6
2025-05-19 23:18:26,512 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:26,512 - INFO - [__main__] - Getting last prediction point for ticker: BT6
2025-05-19 23:18:26,512 - INFO - [__main__] - ==================================================
2025-05-19 23:18:26,512 - INFO - [__main__] - Preparing test data for BT6...
2025-05-19 23:18:26,539 - INFO - [src.data_preparation] - After processing - X shape: (574, 19), y shape: (574,)
2025-05-19 23:18:26,540 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:26,540 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:26,559 - INFO - [src.data_preparation] - Ticker BT6 - Original shapes: X=(574, 18), y=(574,)
2025-05-19 23:18:26,559 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(187), np.int64(1): np.int64(387)}
2025-05-19 23:18:26,790 - INFO - [src.data_preparation] - Ticker BT6 - Selected features:
2025-05-19 23:18:26,790 - INFO - [src.data_preparation] -   vnipc_t: 0.0814
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   ATR: 0.0752
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   Volatility: 0.0702
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   ma14_t: 0.0676
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   ma21_t: 0.0653
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   s_d7_t: 0.0617
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:18:26,791 - INFO - [src.data_preparation] -   SK: 0.0574
2025-05-19 23:18:26,792 - INFO - [src.data_preparation] -   ma7_t: 0.0570
2025-05-19 23:18:26,792 - INFO - [src.data_preparation] -   Median_HL: 0.0564
2025-05-19 23:18:26,792 - INFO - [src.data_preparation] -   variation_t: 0.0533
2025-05-19 23:18:26,792 - INFO - [src.data_preparation] -   insec_t: 0.0532
2025-05-19 23:18:26,792 - INFO - [src.data_preparation] -   ret: 0.0520
2025-05-19 23:18:26,792 - INFO - [src.data_preparation] -   HL: 0.0476
2025-05-19 23:18:26,795 - INFO - [src.data_preparation] - Ticker BT6 - Using features: ['Date', 'vnipc_t', 'ATR', 'Volatility', 'TVV', 'ma14_t', 'ma21_t', 's_d7_t', 'PM', 'SK', 'ma7_t', 'Median_HL', 'variation_t', 'insec_t', 'ret', 'HL']
2025-05-19 23:18:26,870 - INFO - [src.data_preparation] - Ticker BT6 - 2D shapes: X_train=(398, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:26,870 - INFO - [src.data_preparation] - Ticker BT6 - 3D shapes: X_train=(398, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:26,871 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BT6
2025-05-19 23:18:26,871 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (398, 13, 15), y shape: (398,)
2025-05-19 23:18:26,871 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(144), np.int64(1): np.int64(254)}
2025-05-19 23:18:26,871 - INFO - [src.data_preparation] - Generating 110 synthetic minority samples
2025-05-19 23:18:26,875 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:18:26,876 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:18:26,878 - INFO - [src.data_preparation] - Ticker BT6 - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:26,878 - INFO - [__main__] - Using best model for BT6: lstm (F1: 0.9885)
2025-05-19 23:18:26,878 - INFO - [__main__] - Loading lstm model for BT6...
2025-05-19 23:18:26,883 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:26,884 - INFO - [__main__] - Model size: 0.38 MB
2025-05-19 23:18:26,884 - INFO - [__main__] - Making predictions for BT6 using lstm
2025-05-19 23:18:26,889 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:18:26,889 - INFO - [__main__] - Successfully got last prediction for BT6
2025-05-19 23:18:26,889 - INFO - [__main__] - 
Processing ticker: BTG
2025-05-19 23:18:26,889 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:26,889 - INFO - [__main__] - Getting last prediction point for ticker: BTG
2025-05-19 23:18:26,889 - INFO - [__main__] - ==================================================
2025-05-19 23:18:26,889 - INFO - [__main__] - Preparing test data for BTG...
2025-05-19 23:18:26,923 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:26,923 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:26,923 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:26,946 - INFO - [src.data_preparation] - Ticker BTG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:26,947 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(66), np.int64(1): np.int64(573)}
2025-05-19 23:18:27,150 - INFO - [src.data_preparation] - Ticker BTG - Selected features:
2025-05-19 23:18:27,150 - INFO - [src.data_preparation] -   vnipc_t: 0.1014
2025-05-19 23:18:27,150 - INFO - [src.data_preparation] -   ma21_t: 0.0994
2025-05-19 23:18:27,150 - INFO - [src.data_preparation] -   ma14_t: 0.0873
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   ATR: 0.0769
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   ma7_t: 0.0758
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   Median_HL: 0.0707
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   PM: 0.0640
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   HL: 0.0610
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   Volatility: 0.0513
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   s_d7_t: 0.0462
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   SK: 0.0451
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   variation_t: 0.0433
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   TVV: 0.0415
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   ret: 0.0412
2025-05-19 23:18:27,151 - INFO - [src.data_preparation] -   insec_t: 0.0405
2025-05-19 23:18:27,154 - INFO - [src.data_preparation] - Ticker BTG - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ATR', 'ma7_t', 'Median_HL', 'PM', 'HL', 'Volatility', 's_d7_t', 'SK', 'variation_t', 'TVV', 'ret', 'insec_t']
2025-05-19 23:18:27,238 - INFO - [src.data_preparation] - Ticker BTG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:27,238 - INFO - [src.data_preparation] - Ticker BTG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:27,240 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BTG
2025-05-19 23:18:27,240 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:27,240 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(26), np.int64(1): np.int64(437)}
2025-05-19 23:18:27,240 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:18:27,243 - INFO - [src.data_preparation] - Ticker BTG - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:27,243 - INFO - [__main__] - Using best model for BTG: lstm (F1: 0.9136)
2025-05-19 23:18:27,243 - INFO - [__main__] - Loading lstm model for BTG...
2025-05-19 23:18:27,247 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:27,248 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:18:27,248 - INFO - [__main__] - Making predictions for BTG using lstm
2025-05-19 23:18:27,250 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:27,250 - INFO - [__main__] - Successfully got last prediction for BTG
2025-05-19 23:18:27,250 - INFO - [__main__] - 
Processing ticker: BTH
2025-05-19 23:18:27,251 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:27,251 - INFO - [__main__] - Getting last prediction point for ticker: BTH
2025-05-19 23:18:27,251 - INFO - [__main__] - ==================================================
2025-05-19 23:18:27,251 - INFO - [__main__] - Preparing test data for BTH...
2025-05-19 23:18:27,286 - INFO - [src.data_preparation] - After processing - X shape: (516, 19), y shape: (516,)
2025-05-19 23:18:27,286 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:27,287 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:27,311 - INFO - [src.data_preparation] - Ticker BTH - Original shapes: X=(516, 18), y=(516,)
2025-05-19 23:18:27,311 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(119), np.int64(1): np.int64(397)}
2025-05-19 23:18:27,566 - INFO - [src.data_preparation] - Ticker BTH - Selected features:
2025-05-19 23:18:27,566 - INFO - [src.data_preparation] -   vnipc_t: 0.0933
2025-05-19 23:18:27,566 - INFO - [src.data_preparation] -   TVV: 0.0831
2025-05-19 23:18:27,566 - INFO - [src.data_preparation] -   ma14_t: 0.0672
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   Volatility: 0.0648
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   ma21_t: 0.0643
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   insec_t: 0.0598
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   ma7_t: 0.0594
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   s_d7_t: 0.0592
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   PM: 0.0577
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   Median_HL: 0.0565
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   ATR: 0.0554
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   HL: 0.0503
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   LO: 0.0472
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   SK: 0.0471
2025-05-19 23:18:27,567 - INFO - [src.data_preparation] -   SR: 0.0411
2025-05-19 23:18:27,570 - INFO - [src.data_preparation] - Ticker BTH - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 'Volatility', 'ma21_t', 'insec_t', 'ma7_t', 's_d7_t', 'PM', 'Median_HL', 'ATR', 'HL', 'LO', 'SK', 'SR']
2025-05-19 23:18:27,638 - INFO - [src.data_preparation] - Ticker BTH - 2D shapes: X_train=(340, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:27,638 - INFO - [src.data_preparation] - Ticker BTH - 3D shapes: X_train=(340, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:27,640 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BTH
2025-05-19 23:18:27,640 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (340, 13, 15), y shape: (340,)
2025-05-19 23:18:27,640 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(70), np.int64(1): np.int64(270)}
2025-05-19 23:18:27,640 - INFO - [src.data_preparation] - Generating 200 synthetic minority samples
2025-05-19 23:18:27,647 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:18:27,647 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:18:27,650 - INFO - [src.data_preparation] - Ticker BTH - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:27,650 - INFO - [__main__] - Using best model for BTH: transformer (F1: 0.6557)
2025-05-19 23:18:27,650 - INFO - [__main__] - Loading transformer model for BTH...
2025-05-19 23:18:27,659 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:27,662 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:18:27,662 - INFO - [__main__] - Making predictions for BTH using transformer
2025-05-19 23:18:27,663 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:27,663 - INFO - [__main__] - Successfully got last prediction for BTH
2025-05-19 23:18:27,663 - INFO - [__main__] - 
Processing ticker: BTP
2025-05-19 23:18:27,664 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:27,664 - INFO - [__main__] - Getting last prediction point for ticker: BTP
2025-05-19 23:18:27,664 - INFO - [__main__] - ==================================================
2025-05-19 23:18:27,664 - INFO - [__main__] - Preparing test data for BTP...
2025-05-19 23:18:27,698 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:27,698 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:27,698 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:27,717 - INFO - [src.data_preparation] - Ticker BTP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:27,717 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] - Ticker BTP - Selected features:
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   SK: 0.0754
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   vnipc_t: 0.0752
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   TVV: 0.0701
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   Volatility: 0.0681
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   s_d7_t: 0.0665
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   insec_t: 0.0662
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   variation_t: 0.0566
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   LO: 0.0564
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   SR: 0.0555
2025-05-19 23:18:28,060 - INFO - [src.data_preparation] -   ATR: 0.0549
2025-05-19 23:18:28,061 - INFO - [src.data_preparation] -   ret: 0.0549
2025-05-19 23:18:28,061 - INFO - [src.data_preparation] -   ma21_t: 0.0540
2025-05-19 23:18:28,061 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:18:28,061 - INFO - [src.data_preparation] -   HL: 0.0522
2025-05-19 23:18:28,061 - INFO - [src.data_preparation] -   ma14_t: 0.0503
2025-05-19 23:18:28,063 - INFO - [src.data_preparation] - Ticker BTP - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'insec_t', 'variation_t', 'LO', 'SR', 'ATR', 'ret', 'ma21_t', 'ma7_t', 'HL', 'ma14_t']
2025-05-19 23:18:28,140 - INFO - [src.data_preparation] - Ticker BTP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:28,140 - INFO - [src.data_preparation] - Ticker BTP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:28,141 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BTP
2025-05-19 23:18:28,141 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:28,141 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:18:28,141 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:18:28,143 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:18:28,143 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:18:28,146 - INFO - [src.data_preparation] - Ticker BTP - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:28,146 - INFO - [__main__] - Using best model for BTP: svm (F1: 0.6316)
2025-05-19 23:18:28,146 - INFO - [__main__] - Loading svm model for BTP...
2025-05-19 23:18:28,148 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:28,148 - INFO - [__main__] - Model size: 0.69 MB
2025-05-19 23:18:28,148 - INFO - [__main__] - Making predictions for BTP using svm
2025-05-19 23:18:28,149 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:28,149 - INFO - [__main__] - Successfully got last prediction for BTP
2025-05-19 23:18:28,149 - INFO - [__main__] - 
Processing ticker: BTS
2025-05-19 23:18:28,149 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:28,149 - INFO - [__main__] - Getting last prediction point for ticker: BTS
2025-05-19 23:18:28,149 - INFO - [__main__] - ==================================================
2025-05-19 23:18:28,149 - INFO - [__main__] - Preparing test data for BTS...
2025-05-19 23:18:28,176 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:28,177 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:28,177 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:28,195 - INFO - [src.data_preparation] - Ticker BTS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:28,195 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] - Ticker BTS - Selected features:
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   vnipc_t: 0.0712
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   insec_t: 0.0682
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   Volatility: 0.0654
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   TVV: 0.0653
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   SK: 0.0650
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   s_d7_t: 0.0616
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   ma21_t: 0.0603
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   HL: 0.0596
2025-05-19 23:18:28,508 - INFO - [src.data_preparation] -   ma14_t: 0.0596
2025-05-19 23:18:28,509 - INFO - [src.data_preparation] -   ATR: 0.0585
2025-05-19 23:18:28,509 - INFO - [src.data_preparation] -   PM: 0.0566
2025-05-19 23:18:28,509 - INFO - [src.data_preparation] -   ret: 0.0562
2025-05-19 23:18:28,509 - INFO - [src.data_preparation] -   Median_HL: 0.0542
2025-05-19 23:18:28,509 - INFO - [src.data_preparation] -   ma7_t: 0.0542
2025-05-19 23:18:28,509 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:18:28,512 - INFO - [src.data_preparation] - Ticker BTS - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'TVV', 'SK', 's_d7_t', 'ma21_t', 'HL', 'ma14_t', 'ATR', 'PM', 'ret', 'Median_HL', 'ma7_t', 'SR']
2025-05-19 23:18:28,601 - INFO - [src.data_preparation] - Ticker BTS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:28,601 - INFO - [src.data_preparation] - Ticker BTS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:28,602 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BTS
2025-05-19 23:18:28,602 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:28,602 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(180), np.int64(1): np.int64(283)}
2025-05-19 23:18:28,603 - INFO - [src.data_preparation] - Generating 103 synthetic minority samples
2025-05-19 23:18:28,607 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (566, 13, 15), y shape: (566,)
2025-05-19 23:18:28,607 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(283), np.int64(1): np.int64(283)}
2025-05-19 23:18:28,609 - INFO - [src.data_preparation] - Ticker BTS - Final 3D shapes: X_train=(566, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:28,610 - INFO - [__main__] - Using best model for BTS: logistic_regression (F1: 0.7419)
2025-05-19 23:18:28,610 - INFO - [__main__] - Loading logistic_regression model for BTS...
2025-05-19 23:18:28,610 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:28,611 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:28,611 - INFO - [__main__] - Making predictions for BTS using logistic_regression
2025-05-19 23:18:28,611 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:28,611 - INFO - [__main__] - Successfully got last prediction for BTS
2025-05-19 23:18:28,611 - INFO - [__main__] - 
Processing ticker: BTT
2025-05-19 23:18:28,611 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:28,612 - INFO - [__main__] - Getting last prediction point for ticker: BTT
2025-05-19 23:18:28,612 - INFO - [__main__] - ==================================================
2025-05-19 23:18:28,612 - INFO - [__main__] - Preparing test data for BTT...
2025-05-19 23:18:28,639 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:28,639 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:28,639 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:28,658 - INFO - [src.data_preparation] - Ticker BTT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:28,658 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(255), np.int64(1): np.int64(384)}
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] - Ticker BTT - Selected features:
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] -   s_d7_t: 0.0833
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] -   vnipc_t: 0.0768
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] -   ATR: 0.0742
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] -   Volatility: 0.0698
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] -   SK: 0.0655
2025-05-19 23:18:28,946 - INFO - [src.data_preparation] -   TVV: 0.0634
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   insec_t: 0.0599
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   ma21_t: 0.0591
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   ma14_t: 0.0555
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   HL: 0.0550
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   ma7_t: 0.0497
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   PM: 0.0494
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   LO: 0.0483
2025-05-19 23:18:28,947 - INFO - [src.data_preparation] -   SR: 0.0476
2025-05-19 23:18:28,950 - INFO - [src.data_preparation] - Ticker BTT - Using features: ['Date', 's_d7_t', 'vnipc_t', 'ATR', 'Volatility', 'SK', 'TVV', 'insec_t', 'ma21_t', 'ma14_t', 'HL', 'Median_HL', 'ma7_t', 'PM', 'LO', 'SR']
2025-05-19 23:18:29,027 - INFO - [src.data_preparation] - Ticker BTT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:29,027 - INFO - [src.data_preparation] - Ticker BTT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:29,029 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BTT
2025-05-19 23:18:29,029 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:29,029 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:18:29,029 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:18:29,032 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:18:29,032 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:18:29,035 - INFO - [src.data_preparation] - Ticker BTT - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:29,035 - INFO - [__main__] - Using best model for BTT: svm (F1: 0.8421)
2025-05-19 23:18:29,035 - INFO - [__main__] - Loading svm model for BTT...
2025-05-19 23:18:29,036 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:29,037 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:18:29,037 - INFO - [__main__] - Making predictions for BTT using svm
2025-05-19 23:18:29,038 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:29,038 - INFO - [__main__] - Successfully got last prediction for BTT
2025-05-19 23:18:29,038 - INFO - [__main__] - 
Processing ticker: BTW
2025-05-19 23:18:29,038 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:29,038 - INFO - [__main__] - Getting last prediction point for ticker: BTW
2025-05-19 23:18:29,038 - INFO - [__main__] - ==================================================
2025-05-19 23:18:29,038 - INFO - [__main__] - Preparing test data for BTW...
2025-05-19 23:18:29,070 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:29,070 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:29,070 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:29,087 - INFO - [src.data_preparation] - Ticker BTW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:29,087 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(221), np.int64(1): np.int64(418)}
2025-05-19 23:18:29,360 - INFO - [src.data_preparation] - Ticker BTW - Selected features:
2025-05-19 23:18:29,360 - INFO - [src.data_preparation] -   Volatility: 0.0796
2025-05-19 23:18:29,360 - INFO - [src.data_preparation] -   vnipc_t: 0.0758
2025-05-19 23:18:29,360 - INFO - [src.data_preparation] -   ma21_t: 0.0677
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   s_d7_t: 0.0654
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   SK: 0.0654
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   TVV: 0.0643
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   ATR: 0.0637
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   ma14_t: 0.0606
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   HL: 0.0585
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   PM: 0.0526
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   ret: 0.0508
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   insec_t: 0.0506
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   Median_HL: 0.0505
2025-05-19 23:18:29,361 - INFO - [src.data_preparation] -   SR: 0.0477
2025-05-19 23:18:29,364 - INFO - [src.data_preparation] - Ticker BTW - Using features: ['Date', 'Volatility', 'vnipc_t', 'ma21_t', 's_d7_t', 'SK', 'TVV', 'ATR', 'ma14_t', 'HL', 'ma7_t', 'PM', 'ret', 'insec_t', 'Median_HL', 'SR']
2025-05-19 23:18:29,446 - INFO - [src.data_preparation] - Ticker BTW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:29,446 - INFO - [src.data_preparation] - Ticker BTW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:29,448 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BTW
2025-05-19 23:18:29,448 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:29,448 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:18:29,448 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:18:29,453 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:18:29,453 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:18:29,456 - INFO - [src.data_preparation] - Ticker BTW - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:29,457 - INFO - [__main__] - Using best model for BTW: svm (F1: 0.7246)
2025-05-19 23:18:29,457 - INFO - [__main__] - Loading svm model for BTW...
2025-05-19 23:18:29,458 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:29,459 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:18:29,459 - INFO - [__main__] - Making predictions for BTW using svm
2025-05-19 23:18:29,459 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:29,460 - INFO - [__main__] - Successfully got last prediction for BTW
2025-05-19 23:18:29,460 - INFO - [__main__] - 
Processing ticker: BVG
2025-05-19 23:18:29,460 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:29,460 - INFO - [__main__] - Getting last prediction point for ticker: BVG
2025-05-19 23:18:29,460 - INFO - [__main__] - ==================================================
2025-05-19 23:18:29,460 - INFO - [__main__] - Preparing test data for BVG...
2025-05-19 23:18:29,486 - INFO - [src.data_preparation] - After processing - X shape: (614, 19), y shape: (614,)
2025-05-19 23:18:29,486 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:29,486 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:29,507 - INFO - [src.data_preparation] - Ticker BVG - Original shapes: X=(614, 18), y=(614,)
2025-05-19 23:18:29,507 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(228), np.int64(1): np.int64(386)}
2025-05-19 23:18:29,755 - INFO - [src.data_preparation] - Ticker BVG - Selected features:
2025-05-19 23:18:29,755 - INFO - [src.data_preparation] -   TVV: 0.0836
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   vnipc_t: 0.0767
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   s_d7_t: 0.0710
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   insec_t: 0.0705
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   ma21_t: 0.0690
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   ma14_t: 0.0652
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   SK: 0.0647
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   ma7_t: 0.0610
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   ATR: 0.0574
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   ret: 0.0543
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   Median_HL: 0.0538
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   PM: 0.0512
2025-05-19 23:18:29,756 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:18:29,757 - INFO - [src.data_preparation] -   HL: 0.0348
2025-05-19 23:18:29,759 - INFO - [src.data_preparation] - Ticker BVG - Using features: ['Date', 'TVV', 'vnipc_t', 's_d7_t', 'insec_t', 'ma21_t', 'Volatility', 'ma14_t', 'SK', 'ma7_t', 'ATR', 'ret', 'Median_HL', 'PM', 'variation_t', 'HL']
2025-05-19 23:18:29,880 - INFO - [src.data_preparation] - Ticker BVG - 2D shapes: X_train=(438, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:29,880 - INFO - [src.data_preparation] - Ticker BVG - 3D shapes: X_train=(438, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:29,882 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BVG
2025-05-19 23:18:29,883 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (438, 13, 15), y shape: (438,)
2025-05-19 23:18:29,883 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(165), np.int64(1): np.int64(273)}
2025-05-19 23:18:29,883 - INFO - [src.data_preparation] - Generating 108 synthetic minority samples
2025-05-19 23:18:29,891 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:18:29,891 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:18:29,896 - INFO - [src.data_preparation] - Ticker BVG - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:29,896 - INFO - [__main__] - Using best model for BVG: svm (F1: 0.9000)
2025-05-19 23:18:29,896 - INFO - [__main__] - Loading svm model for BVG...
2025-05-19 23:18:29,899 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:29,900 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:18:29,900 - INFO - [__main__] - Making predictions for BVG using svm
2025-05-19 23:18:29,902 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:29,902 - INFO - [__main__] - Successfully got last prediction for BVG
2025-05-19 23:18:29,902 - INFO - [__main__] - 
Processing ticker: BVH
2025-05-19 23:18:29,902 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:29,902 - INFO - [__main__] - Getting last prediction point for ticker: BVH
2025-05-19 23:18:29,902 - INFO - [__main__] - ==================================================
2025-05-19 23:18:29,903 - INFO - [__main__] - Preparing test data for BVH...
2025-05-19 23:18:29,935 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:29,936 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:29,936 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:29,960 - INFO - [src.data_preparation] - Ticker BVH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:29,960 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(303), np.int64(1): np.int64(336)}
2025-05-19 23:18:30,310 - INFO - [src.data_preparation] - Ticker BVH - Selected features:
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   insec_t: 0.0759
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   TVV: 0.0632
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   SK: 0.0613
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   vnipc_t: 0.0610
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   SR: 0.0605
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   ret: 0.0593
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   s_d7_t: 0.0592
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   Volatility: 0.0582
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   ma7_t: 0.0566
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   ma14_t: 0.0566
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   HL: 0.0558
2025-05-19 23:18:30,311 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:18:30,312 - INFO - [src.data_preparation] -   PM: 0.0544
2025-05-19 23:18:30,314 - INFO - [src.data_preparation] - Ticker BVH - Using features: ['Date', 'insec_t', 'TVV', 'SK', 'vnipc_t', 'SR', 'ATR', 'ret', 's_d7_t', 'Volatility', 'ma7_t', 'ma14_t', 'variation_t', 'HL', 'ma21_t', 'PM']
2025-05-19 23:18:30,405 - INFO - [src.data_preparation] - Ticker BVH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:30,405 - INFO - [src.data_preparation] - Ticker BVH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:30,407 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BVH
2025-05-19 23:18:30,407 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:30,407 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:18:30,407 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:18:30,409 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:18:30,409 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:18:30,412 - INFO - [src.data_preparation] - Ticker BVH - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:30,412 - INFO - [__main__] - Using best model for BVH: transformer (F1: 0.6875)
2025-05-19 23:18:30,412 - INFO - [__main__] - Loading transformer model for BVH...
2025-05-19 23:18:30,424 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:30,426 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:18:30,427 - INFO - [__main__] - Making predictions for BVH using transformer
2025-05-19 23:18:30,428 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:30,428 - INFO - [__main__] - Successfully got last prediction for BVH
2025-05-19 23:18:30,428 - INFO - [__main__] - 
Processing ticker: BVN
2025-05-19 23:18:30,429 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:30,429 - INFO - [__main__] - Getting last prediction point for ticker: BVN
2025-05-19 23:18:30,429 - INFO - [__main__] - ==================================================
2025-05-19 23:18:30,429 - INFO - [__main__] - Preparing test data for BVN...
2025-05-19 23:18:30,476 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:30,476 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:30,476 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:30,503 - INFO - [src.data_preparation] - Ticker BVN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:30,504 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(195), np.int64(1): np.int64(444)}
2025-05-19 23:18:30,893 - INFO - [src.data_preparation] - Ticker BVN - Selected features:
2025-05-19 23:18:30,893 - INFO - [src.data_preparation] -   SK: 0.0712
2025-05-19 23:18:30,893 - INFO - [src.data_preparation] -   TVV: 0.0704
2025-05-19 23:18:30,893 - INFO - [src.data_preparation] -   ma21_t: 0.0695
2025-05-19 23:18:30,893 - INFO - [src.data_preparation] -   s_d7_t: 0.0685
2025-05-19 23:18:30,893 - INFO - [src.data_preparation] -   ma14_t: 0.0664
2025-05-19 23:18:30,894 - INFO - [src.data_preparation] -   vnipc_t: 0.0650
2025-05-19 23:18:30,894 - INFO - [src.data_preparation] -   ATR: 0.0644
2025-05-19 23:18:30,894 - INFO - [src.data_preparation] -   HL: 0.0613
2025-05-19 23:18:30,894 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:18:30,894 - INFO - [src.data_preparation] -   insec_t: 0.0576
2025-05-19 23:18:30,895 - INFO - [src.data_preparation] -   ma7_t: 0.0571
2025-05-19 23:18:30,895 - INFO - [src.data_preparation] -   ret: 0.0523
2025-05-19 23:18:30,895 - INFO - [src.data_preparation] -   PM: 0.0514
2025-05-19 23:18:30,895 - INFO - [src.data_preparation] -   Median_HL: 0.0492
2025-05-19 23:18:30,895 - INFO - [src.data_preparation] -   variation_t: 0.0462
2025-05-19 23:18:30,898 - INFO - [src.data_preparation] - Ticker BVN - Using features: ['Date', 'SK', 'TVV', 'ma21_t', 's_d7_t', 'ma14_t', 'vnipc_t', 'ATR', 'HL', 'Volatility', 'insec_t', 'ma7_t', 'ret', 'PM', 'Median_HL', 'variation_t']
2025-05-19 23:18:30,992 - INFO - [src.data_preparation] - Ticker BVN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:30,992 - INFO - [src.data_preparation] - Ticker BVN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:30,994 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BVN
2025-05-19 23:18:30,994 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:30,994 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(126), np.int64(1): np.int64(337)}
2025-05-19 23:18:30,994 - INFO - [src.data_preparation] - Generating 211 synthetic minority samples
2025-05-19 23:18:31,002 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (674, 13, 15), y shape: (674,)
2025-05-19 23:18:31,002 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(337), np.int64(1): np.int64(337)}
2025-05-19 23:18:31,007 - INFO - [src.data_preparation] - Ticker BVN - Final 3D shapes: X_train=(674, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:31,007 - INFO - [__main__] - Using best model for BVN: svm (F1: 0.6866)
2025-05-19 23:18:31,007 - INFO - [__main__] - Loading svm model for BVN...
2025-05-19 23:18:31,009 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:31,010 - INFO - [__main__] - Model size: 1.02 MB
2025-05-19 23:18:31,010 - INFO - [__main__] - Making predictions for BVN using svm
2025-05-19 23:18:31,010 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:31,011 - INFO - [__main__] - Successfully got last prediction for BVN
2025-05-19 23:18:31,011 - INFO - [__main__] - 
Processing ticker: BVS
2025-05-19 23:18:31,011 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:31,011 - INFO - [__main__] - Getting last prediction point for ticker: BVS
2025-05-19 23:18:31,011 - INFO - [__main__] - ==================================================
2025-05-19 23:18:31,011 - INFO - [__main__] - Preparing test data for BVS...
2025-05-19 23:18:31,042 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:31,042 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:31,042 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:31,060 - INFO - [src.data_preparation] - Ticker BVS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:31,060 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(300), np.int64(1): np.int64(339)}
2025-05-19 23:18:31,394 - INFO - [src.data_preparation] - Ticker BVS - Selected features:
2025-05-19 23:18:31,394 - INFO - [src.data_preparation] -   insec_t: 0.0725
2025-05-19 23:18:31,394 - INFO - [src.data_preparation] -   SK: 0.0704
2025-05-19 23:18:31,394 - INFO - [src.data_preparation] -   Volatility: 0.0685
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   vnipc_t: 0.0682
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   TVV: 0.0622
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   HL: 0.0605
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   LO: 0.0598
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   variation_t: 0.0590
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   ret: 0.0588
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   s_d7_t: 0.0556
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   ma7_t: 0.0535
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   SR: 0.0524
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   ma21_t: 0.0520
2025-05-19 23:18:31,395 - INFO - [src.data_preparation] -   PM: 0.0502
2025-05-19 23:18:31,398 - INFO - [src.data_preparation] - Ticker BVS - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'vnipc_t', 'TVV', 'HL', 'LO', 'variation_t', 'ATR', 'ret', 's_d7_t', 'ma7_t', 'SR', 'ma21_t', 'PM']
2025-05-19 23:18:31,487 - INFO - [src.data_preparation] - Ticker BVS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:31,487 - INFO - [src.data_preparation] - Ticker BVS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:31,488 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BVS
2025-05-19 23:18:31,488 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:31,488 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(218), np.int64(1): np.int64(245)}
2025-05-19 23:18:31,488 - INFO - [src.data_preparation] - Generating 27 synthetic minority samples
2025-05-19 23:18:31,490 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (490, 13, 15), y shape: (490,)
2025-05-19 23:18:31,490 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(245), np.int64(1): np.int64(245)}
2025-05-19 23:18:31,493 - INFO - [src.data_preparation] - Ticker BVS - Final 3D shapes: X_train=(490, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:31,493 - INFO - [__main__] - Using best model for BVS: transformer (F1: 0.5116)
2025-05-19 23:18:31,493 - INFO - [__main__] - Loading transformer model for BVS...
2025-05-19 23:18:31,509 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:18:31,515 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:18:31,515 - INFO - [__main__] - Making predictions for BVS using transformer
2025-05-19 23:18:31,519 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:31,519 - INFO - [__main__] - Successfully got last prediction for BVS
2025-05-19 23:18:31,520 - INFO - [__main__] - 
Processing ticker: BWA
2025-05-19 23:18:31,520 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:31,520 - INFO - [__main__] - Getting last prediction point for ticker: BWA
2025-05-19 23:18:31,520 - INFO - [__main__] - ==================================================
2025-05-19 23:18:31,520 - INFO - [__main__] - Preparing test data for BWA...
2025-05-19 23:18:31,569 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:31,570 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:31,570 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:31,593 - INFO - [src.data_preparation] - Ticker BWA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:31,593 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(111), np.int64(1): np.int64(528)}
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] - Ticker BWA - Selected features:
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   ma14_t: 0.0925
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   vnipc_t: 0.0880
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   ma21_t: 0.0879
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   ma7_t: 0.0700
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   s_d7_t: 0.0679
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   HL: 0.0649
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   ATR: 0.0632
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   Volatility: 0.0607
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   PM: 0.0536
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   TVV: 0.0535
2025-05-19 23:18:31,880 - INFO - [src.data_preparation] -   Median_HL: 0.0492
2025-05-19 23:18:31,881 - INFO - [src.data_preparation] -   variation_t: 0.0483
2025-05-19 23:18:31,881 - INFO - [src.data_preparation] -   SK: 0.0447
2025-05-19 23:18:31,881 - INFO - [src.data_preparation] -   ret: 0.0445
2025-05-19 23:18:31,881 - INFO - [src.data_preparation] -   SR: 0.0423
2025-05-19 23:18:31,884 - INFO - [src.data_preparation] - Ticker BWA - Using features: ['Date', 'ma14_t', 'vnipc_t', 'ma21_t', 'ma7_t', 's_d7_t', 'HL', 'ATR', 'Volatility', 'PM', 'TVV', 'Median_HL', 'variation_t', 'SK', 'ret', 'SR']
2025-05-19 23:18:31,970 - INFO - [src.data_preparation] - Ticker BWA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:31,970 - INFO - [src.data_preparation] - Ticker BWA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:31,972 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BWA
2025-05-19 23:18:31,972 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:31,972 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(79), np.int64(1): np.int64(384)}
2025-05-19 23:18:31,972 - INFO - [src.data_preparation] - Generating 305 synthetic minority samples
2025-05-19 23:18:31,984 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (768, 13, 15), y shape: (768,)
2025-05-19 23:18:31,984 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(384), np.int64(1): np.int64(384)}
2025-05-19 23:18:31,989 - INFO - [src.data_preparation] - Ticker BWA - Final 3D shapes: X_train=(768, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:31,989 - INFO - [__main__] - Using best model for BWA: svm (F1: 0.7188)
2025-05-19 23:18:31,989 - INFO - [__main__] - Loading svm model for BWA...
2025-05-19 23:18:31,991 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:31,991 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:18:31,991 - INFO - [__main__] - Making predictions for BWA using svm
2025-05-19 23:18:31,992 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:31,992 - INFO - [__main__] - Successfully got last prediction for BWA
2025-05-19 23:18:31,992 - INFO - [__main__] - 
Processing ticker: BXH
2025-05-19 23:18:31,992 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:31,993 - INFO - [__main__] - Getting last prediction point for ticker: BXH
2025-05-19 23:18:31,993 - INFO - [__main__] - ==================================================
2025-05-19 23:18:31,993 - INFO - [__main__] - Preparing test data for BXH...
2025-05-19 23:18:32,020 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:32,020 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:32,020 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:32,040 - INFO - [src.data_preparation] - Ticker BXH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:32,040 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(151), np.int64(1): np.int64(488)}
2025-05-19 23:18:32,295 - INFO - [src.data_preparation] - Ticker BXH - Selected features:
2025-05-19 23:18:32,295 - INFO - [src.data_preparation] -   vnipc_t: 0.0801
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   ma21_t: 0.0778
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   ATR: 0.0748
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   TVV: 0.0736
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   Volatility: 0.0729
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   ma14_t: 0.0716
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   ma7_t: 0.0692
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   s_d7_t: 0.0679
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   PM: 0.0598
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   Median_HL: 0.0591
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   SK: 0.0576
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   insec_t: 0.0479
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   ret: 0.0445
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   variation_t: 0.0434
2025-05-19 23:18:32,296 - INFO - [src.data_preparation] -   HL: 0.0393
2025-05-19 23:18:32,300 - INFO - [src.data_preparation] - Ticker BXH - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ATR', 'TVV', 'Volatility', 'ma14_t', 'ma7_t', 's_d7_t', 'PM', 'Median_HL', 'SK', 'insec_t', 'ret', 'variation_t', 'HL']
2025-05-19 23:18:32,394 - INFO - [src.data_preparation] - Ticker BXH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:32,394 - INFO - [src.data_preparation] - Ticker BXH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:32,395 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker BXH
2025-05-19 23:18:32,395 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:32,395 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(106), np.int64(1): np.int64(357)}
2025-05-19 23:18:32,395 - INFO - [src.data_preparation] - Generating 251 synthetic minority samples
2025-05-19 23:18:32,404 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (714, 13, 15), y shape: (714,)
2025-05-19 23:18:32,405 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(357), np.int64(1): np.int64(357)}
2025-05-19 23:18:32,408 - INFO - [src.data_preparation] - Ticker BXH - Final 3D shapes: X_train=(714, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:32,409 - INFO - [__main__] - Using best model for BXH: lstm (F1: 0.6866)
2025-05-19 23:18:32,409 - INFO - [__main__] - Loading lstm model for BXH...
2025-05-19 23:18:32,412 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:32,413 - INFO - [__main__] - Model size: 0.12 MB
2025-05-19 23:18:32,414 - INFO - [__main__] - Making predictions for BXH using lstm
2025-05-19 23:18:32,416 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:32,417 - INFO - [__main__] - Successfully got last prediction for BXH
2025-05-19 23:18:32,417 - INFO - [__main__] - 
Processing ticker: C21
2025-05-19 23:18:32,417 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:32,417 - INFO - [__main__] - Getting last prediction point for ticker: C21
2025-05-19 23:18:32,417 - INFO - [__main__] - ==================================================
2025-05-19 23:18:32,417 - INFO - [__main__] - Preparing test data for C21...
2025-05-19 23:18:32,447 - INFO - [src.data_preparation] - After processing - X shape: (582, 19), y shape: (582,)
2025-05-19 23:18:32,447 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:32,447 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:32,468 - INFO - [src.data_preparation] - Ticker C21 - Original shapes: X=(582, 18), y=(582,)
2025-05-19 23:18:32,468 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(244), np.int64(1): np.int64(338)}
2025-05-19 23:18:32,805 - INFO - [src.data_preparation] - Ticker C21 - Selected features:
2025-05-19 23:18:32,806 - INFO - [src.data_preparation] -   ATR: 0.0758
2025-05-19 23:18:32,806 - INFO - [src.data_preparation] -   insec_t: 0.0753
2025-05-19 23:18:32,806 - INFO - [src.data_preparation] -   vnipc_t: 0.0728
2025-05-19 23:18:32,806 - INFO - [src.data_preparation] -   TVV: 0.0695
2025-05-19 23:18:32,806 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:18:32,806 - INFO - [src.data_preparation] -   SK: 0.0626
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   HL: 0.0604
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   s_d7_t: 0.0597
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   SR: 0.0538
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   Median_HL: 0.0531
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   variation_t: 0.0526
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   ma7_t: 0.0491
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   PM: 0.0486
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   ret: 0.0481
2025-05-19 23:18:32,807 - INFO - [src.data_preparation] -   ma14_t: 0.0472
2025-05-19 23:18:32,811 - INFO - [src.data_preparation] - Ticker C21 - Using features: ['Date', 'ATR', 'insec_t', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'HL', 's_d7_t', 'SR', 'Median_HL', 'variation_t', 'ma7_t', 'PM', 'ret', 'ma14_t']
2025-05-19 23:18:32,898 - INFO - [src.data_preparation] - Ticker C21 - 2D shapes: X_train=(406, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:32,899 - INFO - [src.data_preparation] - Ticker C21 - 3D shapes: X_train=(406, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:32,900 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker C21
2025-05-19 23:18:32,900 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (406, 13, 15), y shape: (406,)
2025-05-19 23:18:32,900 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(180), np.int64(1): np.int64(226)}
2025-05-19 23:18:32,900 - INFO - [src.data_preparation] - Generating 46 synthetic minority samples
2025-05-19 23:18:32,902 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (452, 13, 15), y shape: (452,)
2025-05-19 23:18:32,904 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(226)}
2025-05-19 23:18:32,906 - INFO - [src.data_preparation] - Ticker C21 - Final 3D shapes: X_train=(452, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:32,907 - INFO - [__main__] - Using best model for C21: logistic_regression (F1: 0.7541)
2025-05-19 23:18:32,907 - INFO - [__main__] - Loading logistic_regression model for C21...
2025-05-19 23:18:32,907 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:32,908 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:32,908 - INFO - [__main__] - Making predictions for C21 using logistic_regression
2025-05-19 23:18:32,908 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:32,908 - INFO - [__main__] - Successfully got last prediction for C21
2025-05-19 23:18:32,908 - INFO - [__main__] - 
Processing ticker: C32
2025-05-19 23:18:32,908 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:32,908 - INFO - [__main__] - Getting last prediction point for ticker: C32
2025-05-19 23:18:32,908 - INFO - [__main__] - ==================================================
2025-05-19 23:18:32,908 - INFO - [__main__] - Preparing test data for C32...
2025-05-19 23:18:32,937 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:32,938 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:32,938 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:32,961 - INFO - [src.data_preparation] - Ticker C32 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:32,962 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:18:33,454 - INFO - [src.data_preparation] - Ticker C32 - Selected features:
2025-05-19 23:18:33,454 - INFO - [src.data_preparation] -   s_d7_t: 0.0705
2025-05-19 23:18:33,454 - INFO - [src.data_preparation] -   insec_t: 0.0660
2025-05-19 23:18:33,454 - INFO - [src.data_preparation] -   vnipc_t: 0.0630
2025-05-19 23:18:33,454 - INFO - [src.data_preparation] -   ret: 0.0606
2025-05-19 23:18:33,454 - INFO - [src.data_preparation] -   ma14_t: 0.0603
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   SK: 0.0602
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   Volatility: 0.0591
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   TVV: 0.0587
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   ATR: 0.0581
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   LO: 0.0574
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   variation_t: 0.0554
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   HL: 0.0552
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   SR: 0.0547
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   ma7_t: 0.0542
2025-05-19 23:18:33,455 - INFO - [src.data_preparation] -   ma21_t: 0.0538
2025-05-19 23:18:33,458 - INFO - [src.data_preparation] - Ticker C32 - Using features: ['Date', 's_d7_t', 'insec_t', 'vnipc_t', 'ret', 'ma14_t', 'SK', 'Volatility', 'TVV', 'ATR', 'LO', 'variation_t', 'HL', 'SR', 'ma7_t', 'ma21_t']
2025-05-19 23:18:33,556 - INFO - [src.data_preparation] - Ticker C32 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:33,557 - INFO - [src.data_preparation] - Ticker C32 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:33,558 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker C32
2025-05-19 23:18:33,558 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:33,559 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:18:33,559 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:18:33,560 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:18:33,560 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:18:33,563 - INFO - [src.data_preparation] - Ticker C32 - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:33,564 - INFO - [__main__] - Using best model for C32: logistic_regression (F1: 0.3590)
2025-05-19 23:18:33,564 - INFO - [__main__] - Loading logistic_regression model for C32...
2025-05-19 23:18:33,564 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:33,565 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:33,565 - INFO - [__main__] - Making predictions for C32 using logistic_regression
2025-05-19 23:18:33,565 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:33,565 - INFO - [__main__] - Successfully got last prediction for C32
2025-05-19 23:18:33,565 - INFO - [__main__] - 
Processing ticker: C47
2025-05-19 23:18:33,565 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:33,565 - INFO - [__main__] - Getting last prediction point for ticker: C47
2025-05-19 23:18:33,566 - INFO - [__main__] - ==================================================
2025-05-19 23:18:33,566 - INFO - [__main__] - Preparing test data for C47...
2025-05-19 23:18:33,594 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:33,595 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:33,595 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:33,616 - INFO - [src.data_preparation] - Ticker C47 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:33,616 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:18:34,001 - INFO - [src.data_preparation] - Ticker C47 - Selected features:
2025-05-19 23:18:34,001 - INFO - [src.data_preparation] -   SK: 0.0753
2025-05-19 23:18:34,001 - INFO - [src.data_preparation] -   TVV: 0.0698
2025-05-19 23:18:34,001 - INFO - [src.data_preparation] -   vnipc_t: 0.0646
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   ma14_t: 0.0612
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   Volatility: 0.0597
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   HL: 0.0567
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:18:34,002 - INFO - [src.data_preparation] -   Median_HL: 0.0557
2025-05-19 23:18:34,003 - INFO - [src.data_preparation] -   ATR: 0.0549
2025-05-19 23:18:34,003 - INFO - [src.data_preparation] -   PM: 0.0542
2025-05-19 23:18:34,003 - INFO - [src.data_preparation] -   insec_t: 0.0538
2025-05-19 23:18:34,003 - INFO - [src.data_preparation] -   variation_t: 0.0536
2025-05-19 23:18:34,003 - INFO - [src.data_preparation] -   ma7_t: 0.0506
2025-05-19 23:18:34,008 - INFO - [src.data_preparation] - Ticker C47 - Using features: ['Date', 'SK', 'TVV', 'vnipc_t', 'ma14_t', 's_d7_t', 'Volatility', 'ma21_t', 'HL', 'ret', 'Median_HL', 'ATR', 'PM', 'insec_t', 'variation_t', 'ma7_t']
2025-05-19 23:18:34,120 - INFO - [src.data_preparation] - Ticker C47 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:34,120 - INFO - [src.data_preparation] - Ticker C47 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:34,122 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker C47
2025-05-19 23:18:34,122 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:34,122 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:18:34,122 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:18:34,124 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:18:34,124 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:18:34,127 - INFO - [src.data_preparation] - Ticker C47 - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:34,128 - INFO - [__main__] - Using best model for C47: svm (F1: 0.6545)
2025-05-19 23:18:34,128 - INFO - [__main__] - Loading svm model for C47...
2025-05-19 23:18:34,129 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:34,129 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:18:34,130 - INFO - [__main__] - Making predictions for C47 using svm
2025-05-19 23:18:34,130 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:34,130 - INFO - [__main__] - Successfully got last prediction for C47
2025-05-19 23:18:34,130 - INFO - [__main__] - 
Processing ticker: C92
2025-05-19 23:18:34,130 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:34,131 - INFO - [__main__] - Getting last prediction point for ticker: C92
2025-05-19 23:18:34,131 - INFO - [__main__] - ==================================================
2025-05-19 23:18:34,131 - INFO - [__main__] - Preparing test data for C92...
2025-05-19 23:18:34,160 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:18:34,160 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:34,160 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:34,182 - INFO - [src.data_preparation] - Ticker C92 - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:18:34,182 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(205), np.int64(1): np.int64(432)}
2025-05-19 23:18:34,449 - INFO - [src.data_preparation] - Ticker C92 - Selected features:
2025-05-19 23:18:34,449 - INFO - [src.data_preparation] -   Volatility: 0.0748
2025-05-19 23:18:34,449 - INFO - [src.data_preparation] -   ATR: 0.0744
2025-05-19 23:18:34,449 - INFO - [src.data_preparation] -   TVV: 0.0720
2025-05-19 23:18:34,449 - INFO - [src.data_preparation] -   HL: 0.0693
2025-05-19 23:18:34,449 - INFO - [src.data_preparation] -   vnipc_t: 0.0635
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   SK: 0.0635
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   ma21_t: 0.0625
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   s_d7_t: 0.0602
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   ma14_t: 0.0601
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   Median_HL: 0.0527
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   PM: 0.0520
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   ret: 0.0512
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   variation_t: 0.0506
2025-05-19 23:18:34,450 - INFO - [src.data_preparation] -   insec_t: 0.0500
2025-05-19 23:18:34,453 - INFO - [src.data_preparation] - Ticker C92 - Using features: ['Date', 'Volatility', 'ATR', 'TVV', 'HL', 'vnipc_t', 'SK', 'ma21_t', 's_d7_t', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 'ret', 'variation_t', 'insec_t']
2025-05-19 23:18:34,552 - INFO - [src.data_preparation] - Ticker C92 - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:18:34,552 - INFO - [src.data_preparation] - Ticker C92 - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:34,554 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker C92
2025-05-19 23:18:34,554 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:34,554 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(126), np.int64(1): np.int64(337)}
2025-05-19 23:18:34,554 - INFO - [src.data_preparation] - Generating 211 synthetic minority samples
2025-05-19 23:18:34,562 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (674, 13, 15), y shape: (674,)
2025-05-19 23:18:34,562 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(337), np.int64(1): np.int64(337)}
2025-05-19 23:18:34,565 - INFO - [src.data_preparation] - Ticker C92 - Final 3D shapes: X_train=(674, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:34,566 - INFO - [__main__] - Using best model for C92: svm (F1: 0.7778)
2025-05-19 23:18:34,566 - INFO - [__main__] - Loading svm model for C92...
2025-05-19 23:18:34,567 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:34,567 - INFO - [__main__] - Model size: 0.61 MB
2025-05-19 23:18:34,567 - INFO - [__main__] - Making predictions for C92 using svm
2025-05-19 23:18:34,568 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:34,569 - INFO - [__main__] - Successfully got last prediction for C92
2025-05-19 23:18:34,569 - INFO - [__main__] - 
Processing ticker: CAD
2025-05-19 23:18:34,570 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:34,570 - INFO - [__main__] - Getting last prediction point for ticker: CAD
2025-05-19 23:18:34,570 - INFO - [__main__] - ==================================================
2025-05-19 23:18:34,570 - INFO - [__main__] - Preparing test data for CAD...
2025-05-19 23:18:34,603 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:34,603 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:34,603 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:34,623 - INFO - [src.data_preparation] - Ticker CAD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:34,623 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(185), np.int64(1): np.int64(454)}
2025-05-19 23:18:34,874 - INFO - [src.data_preparation] - Ticker CAD - Selected features:
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   vnipc_t: 0.1020
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   TVV: 0.0884
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   ma21_t: 0.0809
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   insec_t: 0.0797
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   ma14_t: 0.0775
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   ma7_t: 0.0700
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   SK: 0.0593
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   s_d7_t: 0.0550
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   PM: 0.0512
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   ATR: 0.0489
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   Median_HL: 0.0468
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   variation_t: 0.0434
2025-05-19 23:18:34,875 - INFO - [src.data_preparation] -   ret: 0.0402
2025-05-19 23:18:34,876 - INFO - [src.data_preparation] -   HL: 0.0320
2025-05-19 23:18:34,878 - INFO - [src.data_preparation] - Ticker CAD - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'insec_t', 'ma14_t', 'ma7_t', 'Volatility', 'SK', 's_d7_t', 'PM', 'ATR', 'Median_HL', 'variation_t', 'ret', 'HL']
2025-05-19 23:18:34,972 - INFO - [src.data_preparation] - Ticker CAD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:34,972 - INFO - [src.data_preparation] - Ticker CAD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:34,974 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CAD
2025-05-19 23:18:34,974 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:34,974 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(135), np.int64(1): np.int64(328)}
2025-05-19 23:18:34,974 - INFO - [src.data_preparation] - Generating 193 synthetic minority samples
2025-05-19 23:18:34,982 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (656, 13, 15), y shape: (656,)
2025-05-19 23:18:34,982 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(328), np.int64(1): np.int64(328)}
2025-05-19 23:18:34,985 - INFO - [src.data_preparation] - Ticker CAD - Final 3D shapes: X_train=(656, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:34,986 - INFO - [__main__] - Using best model for CAD: lstm (F1: 0.8861)
2025-05-19 23:18:34,986 - INFO - [__main__] - Loading lstm model for CAD...
2025-05-19 23:18:34,990 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:34,991 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:18:34,992 - INFO - [__main__] - Making predictions for CAD using lstm
2025-05-19 23:18:34,995 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:34,996 - INFO - [__main__] - Successfully got last prediction for CAD
2025-05-19 23:18:34,996 - INFO - [__main__] - 
Processing ticker: CAN
2025-05-19 23:18:34,996 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:34,996 - INFO - [__main__] - Getting last prediction point for ticker: CAN
2025-05-19 23:18:34,996 - INFO - [__main__] - ==================================================
2025-05-19 23:18:34,996 - INFO - [__main__] - Preparing test data for CAN...
2025-05-19 23:18:35,050 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:35,050 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:35,051 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:35,075 - INFO - [src.data_preparation] - Ticker CAN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:35,075 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(209), np.int64(1): np.int64(430)}
2025-05-19 23:18:35,445 - INFO - [src.data_preparation] - Ticker CAN - Selected features:
2025-05-19 23:18:35,445 - INFO - [src.data_preparation] -   vnipc_t: 0.0776
2025-05-19 23:18:35,445 - INFO - [src.data_preparation] -   s_d7_t: 0.0753
2025-05-19 23:18:35,445 - INFO - [src.data_preparation] -   ATR: 0.0726
2025-05-19 23:18:35,445 - INFO - [src.data_preparation] -   SK: 0.0694
2025-05-19 23:18:35,445 - INFO - [src.data_preparation] -   Volatility: 0.0678
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   TVV: 0.0658
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   ma14_t: 0.0643
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   ma21_t: 0.0631
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   insec_t: 0.0575
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   ma7_t: 0.0572
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   PM: 0.0540
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   SR: 0.0478
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   variation_t: 0.0412
2025-05-19 23:18:35,446 - INFO - [src.data_preparation] -   ret: 0.0401
2025-05-19 23:18:35,449 - INFO - [src.data_preparation] - Ticker CAN - Using features: ['Date', 'vnipc_t', 's_d7_t', 'ATR', 'SK', 'Volatility', 'TVV', 'ma14_t', 'ma21_t', 'insec_t', 'ma7_t', 'PM', 'Median_HL', 'SR', 'variation_t', 'ret']
2025-05-19 23:18:35,562 - INFO - [src.data_preparation] - Ticker CAN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:35,563 - INFO - [src.data_preparation] - Ticker CAN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:35,565 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CAN
2025-05-19 23:18:35,565 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:35,565 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:18:35,565 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:18:35,575 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:18:35,575 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:18:35,579 - INFO - [src.data_preparation] - Ticker CAN - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:35,579 - INFO - [__main__] - Using best model for CAN: svm (F1: 0.8718)
2025-05-19 23:18:35,579 - INFO - [__main__] - Loading svm model for CAN...
2025-05-19 23:18:35,580 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:35,581 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:18:35,581 - INFO - [__main__] - Making predictions for CAN using svm
2025-05-19 23:18:35,582 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:35,582 - INFO - [__main__] - Successfully got last prediction for CAN
2025-05-19 23:18:35,582 - INFO - [__main__] - 
Processing ticker: CAP
2025-05-19 23:18:35,582 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:35,582 - INFO - [__main__] - Getting last prediction point for ticker: CAP
2025-05-19 23:18:35,582 - INFO - [__main__] - ==================================================
2025-05-19 23:18:35,582 - INFO - [__main__] - Preparing test data for CAP...
2025-05-19 23:18:35,616 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:35,616 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:35,616 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:35,637 - INFO - [src.data_preparation] - Ticker CAP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:35,637 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:18:35,972 - INFO - [src.data_preparation] - Ticker CAP - Selected features:
2025-05-19 23:18:35,972 - INFO - [src.data_preparation] -   vnipc_t: 0.0731
2025-05-19 23:18:35,972 - INFO - [src.data_preparation] -   Volatility: 0.0707
2025-05-19 23:18:35,972 - INFO - [src.data_preparation] -   insec_t: 0.0705
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   s_d7_t: 0.0700
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   ATR: 0.0655
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   TVV: 0.0646
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   SK: 0.0600
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   SR: 0.0586
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   HL: 0.0573
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   ma14_t: 0.0560
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   LO: 0.0549
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   variation_t: 0.0509
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:18:35,973 - INFO - [src.data_preparation] -   PM: 0.0493
2025-05-19 23:18:35,976 - INFO - [src.data_preparation] - Ticker CAP - Using features: ['Date', 'vnipc_t', 'Volatility', 'insec_t', 's_d7_t', 'ATR', 'TVV', 'SK', 'SR', 'HL', 'ma14_t', 'LO', 'ret', 'variation_t', 'ma7_t', 'PM']
2025-05-19 23:18:36,071 - INFO - [src.data_preparation] - Ticker CAP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:36,071 - INFO - [src.data_preparation] - Ticker CAP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:36,073 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CAP
2025-05-19 23:18:36,073 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:36,073 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:18:36,073 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:18:36,076 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:18:36,076 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:18:36,080 - INFO - [src.data_preparation] - Ticker CAP - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:36,080 - INFO - [__main__] - Using best model for CAP: svm (F1: 0.5806)
2025-05-19 23:18:36,080 - INFO - [__main__] - Loading svm model for CAP...
2025-05-19 23:18:36,081 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:36,082 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:18:36,082 - INFO - [__main__] - Making predictions for CAP using svm
2025-05-19 23:18:36,083 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:36,083 - INFO - [__main__] - Successfully got last prediction for CAP
2025-05-19 23:18:36,083 - INFO - [__main__] - 
Processing ticker: CCI
2025-05-19 23:18:36,083 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:36,084 - INFO - [__main__] - Getting last prediction point for ticker: CCI
2025-05-19 23:18:36,084 - INFO - [__main__] - ==================================================
2025-05-19 23:18:36,084 - INFO - [__main__] - Preparing test data for CCI...
2025-05-19 23:18:36,114 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:36,114 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:36,114 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:36,132 - INFO - [src.data_preparation] - Ticker CCI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:36,133 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(265), np.int64(1): np.int64(374)}
2025-05-19 23:18:36,454 - INFO - [src.data_preparation] - Ticker CCI - Selected features:
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   SK: 0.0783
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   insec_t: 0.0683
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   vnipc_t: 0.0682
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   SR: 0.0633
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   TVV: 0.0633
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   s_d7_t: 0.0619
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   LO: 0.0604
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   Volatility: 0.0588
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   variation_t: 0.0571
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   PM: 0.0559
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   HL: 0.0540
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   ma21_t: 0.0525
2025-05-19 23:18:36,455 - INFO - [src.data_preparation] -   ret: 0.0523
2025-05-19 23:18:36,456 - INFO - [src.data_preparation] -   ma14_t: 0.0513
2025-05-19 23:18:36,458 - INFO - [src.data_preparation] - Ticker CCI - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'SR', 'TVV', 's_d7_t', 'LO', 'Volatility', 'ATR', 'variation_t', 'PM', 'HL', 'ma21_t', 'ret', 'ma14_t']
2025-05-19 23:18:36,541 - INFO - [src.data_preparation] - Ticker CCI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:36,541 - INFO - [src.data_preparation] - Ticker CCI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:36,543 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CCI
2025-05-19 23:18:36,543 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:36,543 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(182), np.int64(1): np.int64(281)}
2025-05-19 23:18:36,543 - INFO - [src.data_preparation] - Generating 99 synthetic minority samples
2025-05-19 23:18:36,548 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (562, 13, 15), y shape: (562,)
2025-05-19 23:18:36,548 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(281), np.int64(1): np.int64(281)}
2025-05-19 23:18:36,551 - INFO - [src.data_preparation] - Ticker CCI - Final 3D shapes: X_train=(562, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:36,551 - INFO - [__main__] - Using best model for CCI: svm (F1: 0.7606)
2025-05-19 23:18:36,551 - INFO - [__main__] - Loading svm model for CCI...
2025-05-19 23:18:36,553 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:36,553 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:18:36,553 - INFO - [__main__] - Making predictions for CCI using svm
2025-05-19 23:18:36,554 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:36,554 - INFO - [__main__] - Successfully got last prediction for CCI
2025-05-19 23:18:36,554 - INFO - [__main__] - 
Processing ticker: CCL
2025-05-19 23:18:36,554 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:36,554 - INFO - [__main__] - Getting last prediction point for ticker: CCL
2025-05-19 23:18:36,554 - INFO - [__main__] - ==================================================
2025-05-19 23:18:36,554 - INFO - [__main__] - Preparing test data for CCL...
2025-05-19 23:18:36,580 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:36,580 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:36,580 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:36,598 - INFO - [src.data_preparation] - Ticker CCL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:36,598 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(295), np.int64(1): np.int64(344)}
2025-05-19 23:18:36,946 - INFO - [src.data_preparation] - Ticker CCL - Selected features:
2025-05-19 23:18:36,946 - INFO - [src.data_preparation] -   vnipc_t: 0.0806
2025-05-19 23:18:36,946 - INFO - [src.data_preparation] -   SK: 0.0778
2025-05-19 23:18:36,946 - INFO - [src.data_preparation] -   insec_t: 0.0691
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   s_d7_t: 0.0689
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   TVV: 0.0647
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   ma14_t: 0.0602
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   Volatility: 0.0589
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   LO: 0.0517
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   Median_HL: 0.0515
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   HL: 0.0510
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   SR: 0.0510
2025-05-19 23:18:36,947 - INFO - [src.data_preparation] -   ma7_t: 0.0509
2025-05-19 23:18:36,950 - INFO - [src.data_preparation] - Ticker CCL - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 's_d7_t', 'TVV', 'ma14_t', 'Volatility', 'ma21_t', 'ret', 'variation_t', 'LO', 'Median_HL', 'HL', 'SR', 'ma7_t']
2025-05-19 23:18:37,036 - INFO - [src.data_preparation] - Ticker CCL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:37,037 - INFO - [src.data_preparation] - Ticker CCL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:37,038 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CCL
2025-05-19 23:18:37,038 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:37,038 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:18:37,039 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:18:37,042 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:18:37,042 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:18:37,045 - INFO - [src.data_preparation] - Ticker CCL - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:37,045 - INFO - [__main__] - Using best model for CCL: transformer (F1: 0.5417)
2025-05-19 23:18:37,045 - INFO - [__main__] - Loading transformer model for CCL...
2025-05-19 23:18:37,059 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:37,063 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:18:37,063 - INFO - [__main__] - Making predictions for CCL using transformer
2025-05-19 23:18:37,066 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:37,066 - INFO - [__main__] - Successfully got last prediction for CCL
2025-05-19 23:18:37,067 - INFO - [__main__] - 
Processing ticker: CCM
2025-05-19 23:18:37,067 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:37,067 - INFO - [__main__] - Getting last prediction point for ticker: CCM
2025-05-19 23:18:37,067 - INFO - [__main__] - ==================================================
2025-05-19 23:18:37,067 - INFO - [__main__] - Preparing test data for CCM...
2025-05-19 23:18:37,117 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:37,117 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:37,117 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:37,139 - INFO - [src.data_preparation] - Ticker CCM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:37,140 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(190), np.int64(1): np.int64(449)}
2025-05-19 23:18:37,449 - INFO - [src.data_preparation] - Ticker CCM - Selected features:
2025-05-19 23:18:37,449 - INFO - [src.data_preparation] -   vnipc_t: 0.0887
2025-05-19 23:18:37,449 - INFO - [src.data_preparation] -   ma14_t: 0.0746
2025-05-19 23:18:37,449 - INFO - [src.data_preparation] -   ATR: 0.0711
2025-05-19 23:18:37,449 - INFO - [src.data_preparation] -   ma21_t: 0.0695
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   TVV: 0.0674
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   SK: 0.0654
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   s_d7_t: 0.0608
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   Volatility: 0.0598
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   PM: 0.0592
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   Median_HL: 0.0578
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   HL: 0.0550
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   variation_t: 0.0498
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   SR: 0.0483
2025-05-19 23:18:37,450 - INFO - [src.data_preparation] -   ret: 0.0431
2025-05-19 23:18:37,453 - INFO - [src.data_preparation] - Ticker CCM - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ATR', 'ma21_t', 'TVV', 'SK', 's_d7_t', 'Volatility', 'PM', 'Median_HL', 'HL', 'ma7_t', 'variation_t', 'SR', 'ret']
2025-05-19 23:18:37,532 - INFO - [src.data_preparation] - Ticker CCM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:37,532 - INFO - [src.data_preparation] - Ticker CCM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:37,534 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CCM
2025-05-19 23:18:37,534 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:37,534 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(131), np.int64(1): np.int64(332)}
2025-05-19 23:18:37,534 - INFO - [src.data_preparation] - Generating 201 synthetic minority samples
2025-05-19 23:18:37,542 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (664, 13, 15), y shape: (664,)
2025-05-19 23:18:37,542 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(332), np.int64(1): np.int64(332)}
2025-05-19 23:18:37,546 - INFO - [src.data_preparation] - Ticker CCM - Final 3D shapes: X_train=(664, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:37,546 - INFO - [__main__] - Using best model for CCM: svm (F1: 0.8219)
2025-05-19 23:18:37,546 - INFO - [__main__] - Loading svm model for CCM...
2025-05-19 23:18:37,547 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:37,548 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:18:37,548 - INFO - [__main__] - Making predictions for CCM using svm
2025-05-19 23:18:37,548 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:37,549 - INFO - [__main__] - Successfully got last prediction for CCM
2025-05-19 23:18:37,549 - INFO - [__main__] - 
Processing ticker: CDC
2025-05-19 23:18:37,549 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:37,549 - INFO - [__main__] - Getting last prediction point for ticker: CDC
2025-05-19 23:18:37,549 - INFO - [__main__] - ==================================================
2025-05-19 23:18:37,549 - INFO - [__main__] - Preparing test data for CDC...
2025-05-19 23:18:37,576 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:37,576 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:37,576 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:37,595 - INFO - [src.data_preparation] - Ticker CDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:37,596 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:18:38,091 - INFO - [src.data_preparation] - Ticker CDC - Selected features:
2025-05-19 23:18:38,091 - INFO - [src.data_preparation] -   vnipc_t: 0.0757
2025-05-19 23:18:38,091 - INFO - [src.data_preparation] -   insec_t: 0.0680
2025-05-19 23:18:38,092 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:18:38,092 - INFO - [src.data_preparation] -   SK: 0.0672
2025-05-19 23:18:38,092 - INFO - [src.data_preparation] -   Volatility: 0.0645
2025-05-19 23:18:38,092 - INFO - [src.data_preparation] -   ATR: 0.0639
2025-05-19 23:18:38,092 - INFO - [src.data_preparation] -   s_d7_t: 0.0618
2025-05-19 23:18:38,092 - INFO - [src.data_preparation] -   ma21_t: 0.0554
2025-05-19 23:18:38,093 - INFO - [src.data_preparation] -   ma14_t: 0.0551
2025-05-19 23:18:38,093 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:18:38,093 - INFO - [src.data_preparation] -   ret: 0.0532
2025-05-19 23:18:38,093 - INFO - [src.data_preparation] -   Median_HL: 0.0523
2025-05-19 23:18:38,093 - INFO - [src.data_preparation] -   ma7_t: 0.0522
2025-05-19 23:18:38,094 - INFO - [src.data_preparation] -   variation_t: 0.0518
2025-05-19 23:18:38,094 - INFO - [src.data_preparation] -   HL: 0.0515
2025-05-19 23:18:38,100 - INFO - [src.data_preparation] - Ticker CDC - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'SK', 'Volatility', 'ATR', 's_d7_t', 'ma21_t', 'ma14_t', 'SR', 'ret', 'Median_HL', 'ma7_t', 'variation_t', 'HL']
2025-05-19 23:18:38,242 - INFO - [src.data_preparation] - Ticker CDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:38,242 - INFO - [src.data_preparation] - Ticker CDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:38,245 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CDC
2025-05-19 23:18:38,245 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:38,246 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(194), np.int64(1): np.int64(269)}
2025-05-19 23:18:38,246 - INFO - [src.data_preparation] - Generating 75 synthetic minority samples
2025-05-19 23:18:38,252 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (538, 13, 15), y shape: (538,)
2025-05-19 23:18:38,252 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(269), np.int64(1): np.int64(269)}
2025-05-19 23:18:38,257 - INFO - [src.data_preparation] - Ticker CDC - Final 3D shapes: X_train=(538, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:38,257 - INFO - [__main__] - Using best model for CDC: svm (F1: 0.6032)
2025-05-19 23:18:38,257 - INFO - [__main__] - Loading svm model for CDC...
2025-05-19 23:18:38,258 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:38,259 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:18:38,259 - INFO - [__main__] - Making predictions for CDC using svm
2025-05-19 23:18:38,260 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:38,260 - INFO - [__main__] - Successfully got last prediction for CDC
2025-05-19 23:18:38,260 - INFO - [__main__] - 
Processing ticker: CHP
2025-05-19 23:18:38,260 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:38,260 - INFO - [__main__] - Getting last prediction point for ticker: CHP
2025-05-19 23:18:38,260 - INFO - [__main__] - ==================================================
2025-05-19 23:18:38,260 - INFO - [__main__] - Preparing test data for CHP...
2025-05-19 23:18:38,292 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:38,292 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:38,292 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:38,319 - INFO - [src.data_preparation] - Ticker CHP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:38,319 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(236), np.int64(1): np.int64(403)}
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] - Ticker CHP - Selected features:
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   Volatility: 0.0760
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   s_d7_t: 0.0683
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   vnipc_t: 0.0673
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   SK: 0.0665
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   TVV: 0.0655
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   insec_t: 0.0629
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   ATR: 0.0594
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   ma7_t: 0.0576
2025-05-19 23:18:38,679 - INFO - [src.data_preparation] -   LO: 0.0567
2025-05-19 23:18:38,680 - INFO - [src.data_preparation] -   ma14_t: 0.0565
2025-05-19 23:18:38,680 - INFO - [src.data_preparation] -   HL: 0.0542
2025-05-19 23:18:38,680 - INFO - [src.data_preparation] -   SR: 0.0542
2025-05-19 23:18:38,680 - INFO - [src.data_preparation] -   PM: 0.0535
2025-05-19 23:18:38,680 - INFO - [src.data_preparation] -   ma21_t: 0.0523
2025-05-19 23:18:38,680 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:18:38,683 - INFO - [src.data_preparation] - Ticker CHP - Using features: ['Date', 'Volatility', 's_d7_t', 'vnipc_t', 'SK', 'TVV', 'insec_t', 'ATR', 'ma7_t', 'LO', 'ma14_t', 'HL', 'SR', 'PM', 'ma21_t', 'Median_HL']
2025-05-19 23:18:38,770 - INFO - [src.data_preparation] - Ticker CHP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:38,770 - INFO - [src.data_preparation] - Ticker CHP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:38,772 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CHP
2025-05-19 23:18:38,772 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:38,772 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(176), np.int64(1): np.int64(287)}
2025-05-19 23:18:38,773 - INFO - [src.data_preparation] - Generating 111 synthetic minority samples
2025-05-19 23:18:38,782 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (574, 13, 15), y shape: (574,)
2025-05-19 23:18:38,782 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(287), np.int64(1): np.int64(287)}
2025-05-19 23:18:38,786 - INFO - [src.data_preparation] - Ticker CHP - Final 3D shapes: X_train=(574, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:38,786 - INFO - [__main__] - Using best model for CHP: lstm (F1: 0.7246)
2025-05-19 23:18:38,786 - INFO - [__main__] - Loading lstm model for CHP...
2025-05-19 23:18:38,792 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:38,794 - INFO - [__main__] - Model size: 0.24 MB
2025-05-19 23:18:38,795 - INFO - [__main__] - Making predictions for CHP using lstm
2025-05-19 23:18:38,802 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:18:38,802 - INFO - [__main__] - Successfully got last prediction for CHP
2025-05-19 23:18:38,802 - INFO - [__main__] - 
Processing ticker: CI5
2025-05-19 23:18:38,802 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:38,802 - INFO - [__main__] - Getting last prediction point for ticker: CI5
2025-05-19 23:18:38,803 - INFO - [__main__] - ==================================================
2025-05-19 23:18:38,803 - INFO - [__main__] - Preparing test data for CI5...
2025-05-19 23:18:38,875 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:38,875 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:38,875 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:38,907 - INFO - [src.data_preparation] - Ticker CI5 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:38,908 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(171), np.int64(1): np.int64(468)}
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] - Ticker CI5 - Selected features:
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] -   TVV: 0.0802
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] -   s_d7_t: 0.0727
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] -   ATR: 0.0706
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] -   ma21_t: 0.0697
2025-05-19 23:18:39,227 - INFO - [src.data_preparation] -   ma14_t: 0.0691
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   Volatility: 0.0619
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   ma7_t: 0.0605
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   PM: 0.0574
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   SK: 0.0559
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   Median_HL: 0.0550
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   insec_t: 0.0521
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   ret: 0.0402
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   variation_t: 0.0396
2025-05-19 23:18:39,228 - INFO - [src.data_preparation] -   SR: 0.0376
2025-05-19 23:18:39,231 - INFO - [src.data_preparation] - Ticker CI5 - Using features: ['Date', 'TVV', 'vnipc_t', 's_d7_t', 'ATR', 'ma21_t', 'ma14_t', 'Volatility', 'ma7_t', 'PM', 'SK', 'Median_HL', 'insec_t', 'ret', 'variation_t', 'SR']
2025-05-19 23:18:39,319 - INFO - [src.data_preparation] - Ticker CI5 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:39,319 - INFO - [src.data_preparation] - Ticker CI5 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:39,321 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CI5
2025-05-19 23:18:39,321 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:39,321 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(112), np.int64(1): np.int64(351)}
2025-05-19 23:18:39,321 - INFO - [src.data_preparation] - Generating 239 synthetic minority samples
2025-05-19 23:18:39,331 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (702, 13, 15), y shape: (702,)
2025-05-19 23:18:39,331 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(351), np.int64(1): np.int64(351)}
2025-05-19 23:18:39,335 - INFO - [src.data_preparation] - Ticker CI5 - Final 3D shapes: X_train=(702, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:39,335 - INFO - [__main__] - Using best model for CI5: svm (F1: 0.7059)
2025-05-19 23:18:39,335 - INFO - [__main__] - Loading svm model for CI5...
2025-05-19 23:18:39,337 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:39,338 - INFO - [__main__] - Model size: 1.05 MB
2025-05-19 23:18:39,338 - INFO - [__main__] - Making predictions for CI5 using svm
2025-05-19 23:18:39,339 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:39,339 - INFO - [__main__] - Successfully got last prediction for CI5
2025-05-19 23:18:39,339 - INFO - [__main__] - 
Processing ticker: CID
2025-05-19 23:18:39,339 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:39,339 - INFO - [__main__] - Getting last prediction point for ticker: CID
2025-05-19 23:18:39,339 - INFO - [__main__] - ==================================================
2025-05-19 23:18:39,340 - INFO - [__main__] - Preparing test data for CID...
2025-05-19 23:18:39,375 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:39,375 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:39,376 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:39,396 - INFO - [src.data_preparation] - Ticker CID - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:39,396 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(166), np.int64(1): np.int64(472)}
2025-05-19 23:18:39,666 - INFO - [src.data_preparation] - Ticker CID - Selected features:
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   vnipc_t: 0.0819
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   ma21_t: 0.0793
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   ma14_t: 0.0770
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   s_d7_t: 0.0699
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   ATR: 0.0673
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   HL: 0.0614
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   SK: 0.0571
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   ma7_t: 0.0560
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   TVV: 0.0560
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   PM: 0.0540
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:18:39,667 - INFO - [src.data_preparation] -   insec_t: 0.0522
2025-05-19 23:18:39,668 - INFO - [src.data_preparation] -   ret: 0.0448
2025-05-19 23:18:39,668 - INFO - [src.data_preparation] -   variation_t: 0.0411
2025-05-19 23:18:39,670 - INFO - [src.data_preparation] - Ticker CID - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 's_d7_t', 'ATR', 'Volatility', 'HL', 'SK', 'ma7_t', 'TVV', 'PM', 'Median_HL', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:18:39,753 - INFO - [src.data_preparation] - Ticker CID - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:39,753 - INFO - [src.data_preparation] - Ticker CID - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:39,754 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CID
2025-05-19 23:18:39,754 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:39,754 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(102), np.int64(1): np.int64(360)}
2025-05-19 23:18:39,755 - INFO - [src.data_preparation] - Generating 258 synthetic minority samples
2025-05-19 23:18:39,765 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (720, 13, 15), y shape: (720,)
2025-05-19 23:18:39,765 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(360), np.int64(1): np.int64(360)}
2025-05-19 23:18:39,769 - INFO - [src.data_preparation] - Ticker CID - Final 3D shapes: X_train=(720, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:39,770 - INFO - [__main__] - Using best model for CID: svm (F1: 0.6667)
2025-05-19 23:18:39,770 - INFO - [__main__] - Loading svm model for CID...
2025-05-19 23:18:39,771 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:39,771 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:18:39,771 - INFO - [__main__] - Making predictions for CID using svm
2025-05-19 23:18:39,772 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:39,773 - INFO - [__main__] - Successfully got last prediction for CID
2025-05-19 23:18:39,773 - INFO - [__main__] - 
Processing ticker: CIG
2025-05-19 23:18:39,773 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:39,773 - INFO - [__main__] - Getting last prediction point for ticker: CIG
2025-05-19 23:18:39,773 - INFO - [__main__] - ==================================================
2025-05-19 23:18:39,773 - INFO - [__main__] - Preparing test data for CIG...
2025-05-19 23:18:39,811 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:39,812 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:39,812 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:39,838 - INFO - [src.data_preparation] - Ticker CIG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:39,838 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(312), np.int64(1): np.int64(327)}
2025-05-19 23:18:40,287 - INFO - [src.data_preparation] - Ticker CIG - Selected features:
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   vnipc_t: 0.0736
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   s_d7_t: 0.0711
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   insec_t: 0.0674
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   TVV: 0.0674
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   SK: 0.0649
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   Volatility: 0.0610
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   ret: 0.0588
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   ATR: 0.0576
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:18:40,288 - INFO - [src.data_preparation] -   ma21_t: 0.0557
2025-05-19 23:18:40,289 - INFO - [src.data_preparation] -   ma7_t: 0.0547
2025-05-19 23:18:40,289 - INFO - [src.data_preparation] -   SR: 0.0540
2025-05-19 23:18:40,289 - INFO - [src.data_preparation] -   ma14_t: 0.0535
2025-05-19 23:18:40,289 - INFO - [src.data_preparation] -   HL: 0.0509
2025-05-19 23:18:40,290 - INFO - [src.data_preparation] -   PM: 0.0487
2025-05-19 23:18:40,293 - INFO - [src.data_preparation] - Ticker CIG - Using features: ['Date', 'vnipc_t', 's_d7_t', 'insec_t', 'TVV', 'SK', 'Volatility', 'ret', 'ATR', 'variation_t', 'ma21_t', 'ma7_t', 'SR', 'ma14_t', 'HL', 'PM']
2025-05-19 23:18:40,444 - INFO - [src.data_preparation] - Ticker CIG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:40,444 - INFO - [src.data_preparation] - Ticker CIG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:40,446 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CIG
2025-05-19 23:18:40,446 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:40,446 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(214), np.int64(1): np.int64(249)}
2025-05-19 23:18:40,446 - INFO - [src.data_preparation] - Generating 35 synthetic minority samples
2025-05-19 23:18:40,449 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (498, 13, 15), y shape: (498,)
2025-05-19 23:18:40,449 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(249), np.int64(1): np.int64(249)}
2025-05-19 23:18:40,453 - INFO - [src.data_preparation] - Ticker CIG - Final 3D shapes: X_train=(498, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:40,453 - INFO - [__main__] - Using best model for CIG: logistic_regression (F1: 0.5909)
2025-05-19 23:18:40,453 - INFO - [__main__] - Loading logistic_regression model for CIG...
2025-05-19 23:18:40,454 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:40,454 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:40,454 - INFO - [__main__] - Making predictions for CIG using logistic_regression
2025-05-19 23:18:40,454 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:40,455 - INFO - [__main__] - Successfully got last prediction for CIG
2025-05-19 23:18:40,455 - INFO - [__main__] - 
Processing ticker: CII
2025-05-19 23:18:40,455 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:40,455 - INFO - [__main__] - Getting last prediction point for ticker: CII
2025-05-19 23:18:40,455 - INFO - [__main__] - ==================================================
2025-05-19 23:18:40,455 - INFO - [__main__] - Preparing test data for CII...
2025-05-19 23:18:40,510 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:40,511 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:40,511 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:40,534 - INFO - [src.data_preparation] - Ticker CII - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:40,534 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(323), np.int64(1): np.int64(316)}
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] - Ticker CII - Selected features:
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   ma21_t: 0.0740
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   SK: 0.0683
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   TVV: 0.0650
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   insec_t: 0.0634
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   ret: 0.0600
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   ma14_t: 0.0590
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   vnipc_t: 0.0588
2025-05-19 23:18:40,859 - INFO - [src.data_preparation] -   s_d7_t: 0.0585
2025-05-19 23:18:40,860 - INFO - [src.data_preparation] -   ma7_t: 0.0565
2025-05-19 23:18:40,860 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:18:40,860 - INFO - [src.data_preparation] -   SR: 0.0530
2025-05-19 23:18:40,860 - INFO - [src.data_preparation] -   LO: 0.0516
2025-05-19 23:18:40,860 - INFO - [src.data_preparation] -   HL: 0.0496
2025-05-19 23:18:40,863 - INFO - [src.data_preparation] - Ticker CII - Using features: ['Date', 'ma21_t', 'SK', 'TVV', 'insec_t', 'Volatility', 'ATR', 'ret', 'ma14_t', 'vnipc_t', 's_d7_t', 'ma7_t', 'variation_t', 'SR', 'LO', 'HL']
2025-05-19 23:18:40,941 - INFO - [src.data_preparation] - Ticker CII - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:40,941 - INFO - [src.data_preparation] - Ticker CII - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:40,943 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CII
2025-05-19 23:18:40,943 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:40,943 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:18:40,943 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:18:40,944 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:18:40,944 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:18:40,947 - INFO - [src.data_preparation] - Ticker CII - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:40,947 - INFO - [__main__] - Using best model for CII: transformer (F1: 0.6333)
2025-05-19 23:18:40,947 - INFO - [__main__] - Loading transformer model for CII...
2025-05-19 23:18:40,959 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:40,962 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:18:40,963 - INFO - [__main__] - Making predictions for CII using transformer
2025-05-19 23:18:40,964 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:40,965 - INFO - [__main__] - Successfully got last prediction for CII
2025-05-19 23:18:40,965 - INFO - [__main__] - 
Processing ticker: CJC
2025-05-19 23:18:40,965 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:40,965 - INFO - [__main__] - Getting last prediction point for ticker: CJC
2025-05-19 23:18:40,965 - INFO - [__main__] - ==================================================
2025-05-19 23:18:40,965 - INFO - [__main__] - Preparing test data for CJC...
2025-05-19 23:18:40,996 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:40,996 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:40,996 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:41,024 - INFO - [src.data_preparation] - Ticker CJC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:41,024 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(92), np.int64(1): np.int64(547)}
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] - Ticker CJC - Selected features:
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   vnipc_t: 0.1100
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   TVV: 0.0987
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   ma21_t: 0.0931
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   ma14_t: 0.0852
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   PM: 0.0695
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   Median_HL: 0.0693
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   ma7_t: 0.0653
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   Volatility: 0.0597
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   s_d7_t: 0.0580
2025-05-19 23:18:41,272 - INFO - [src.data_preparation] -   ATR: 0.0501
2025-05-19 23:18:41,273 - INFO - [src.data_preparation] -   SK: 0.0479
2025-05-19 23:18:41,273 - INFO - [src.data_preparation] -   variation_t: 0.0454
2025-05-19 23:18:41,273 - INFO - [src.data_preparation] -   HL: 0.0356
2025-05-19 23:18:41,273 - INFO - [src.data_preparation] -   insec_t: 0.0343
2025-05-19 23:18:41,273 - INFO - [src.data_preparation] -   ret: 0.0324
2025-05-19 23:18:41,276 - INFO - [src.data_preparation] - Ticker CJC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'PM', 'Median_HL', 'ma7_t', 'Volatility', 's_d7_t', 'ATR', 'SK', 'variation_t', 'HL', 'insec_t', 'ret']
2025-05-19 23:18:41,364 - INFO - [src.data_preparation] - Ticker CJC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:41,364 - INFO - [src.data_preparation] - Ticker CJC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:41,366 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CJC
2025-05-19 23:18:41,366 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:41,366 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(81), np.int64(1): np.int64(382)}
2025-05-19 23:18:41,366 - INFO - [src.data_preparation] - Generating 301 synthetic minority samples
2025-05-19 23:18:41,376 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (764, 13, 15), y shape: (764,)
2025-05-19 23:18:41,376 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(382), np.int64(1): np.int64(382)}
2025-05-19 23:18:41,380 - INFO - [src.data_preparation] - Ticker CJC - Final 3D shapes: X_train=(764, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:41,381 - INFO - [__main__] - Using best model for CJC: lstm (F1: 0.9885)
2025-05-19 23:18:41,381 - INFO - [__main__] - Loading lstm model for CJC...
2025-05-19 23:18:41,386 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:41,387 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:18:41,387 - INFO - [__main__] - Making predictions for CJC using lstm
2025-05-19 23:18:41,391 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:41,392 - INFO - [__main__] - Successfully got last prediction for CJC
2025-05-19 23:18:41,392 - INFO - [__main__] - 
Processing ticker: CKV
2025-05-19 23:18:41,392 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:41,392 - INFO - [__main__] - Getting last prediction point for ticker: CKV
2025-05-19 23:18:41,392 - INFO - [__main__] - ==================================================
2025-05-19 23:18:41,392 - INFO - [__main__] - Preparing test data for CKV...
2025-05-19 23:18:41,422 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:41,422 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:41,422 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:41,441 - INFO - [src.data_preparation] - Ticker CKV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:41,442 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(186), np.int64(1): np.int64(453)}
2025-05-19 23:18:41,758 - INFO - [src.data_preparation] - Ticker CKV - Selected features:
2025-05-19 23:18:41,758 - INFO - [src.data_preparation] -   vnipc_t: 0.0916
2025-05-19 23:18:41,758 - INFO - [src.data_preparation] -   ma14_t: 0.0748
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   TVV: 0.0697
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   ma21_t: 0.0692
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   ATR: 0.0681
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   ma7_t: 0.0651
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   s_d7_t: 0.0642
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   SK: 0.0612
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   Volatility: 0.0599
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   insec_t: 0.0582
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   PM: 0.0541
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   HL: 0.0529
2025-05-19 23:18:41,759 - INFO - [src.data_preparation] -   ret: 0.0425
2025-05-19 23:18:41,760 - INFO - [src.data_preparation] -   SR: 0.0414
2025-05-19 23:18:41,762 - INFO - [src.data_preparation] - Ticker CKV - Using features: ['Date', 'vnipc_t', 'ma14_t', 'TVV', 'ma21_t', 'ATR', 'ma7_t', 's_d7_t', 'SK', 'Volatility', 'insec_t', 'PM', 'Median_HL', 'HL', 'ret', 'SR']
2025-05-19 23:18:41,856 - INFO - [src.data_preparation] - Ticker CKV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:41,856 - INFO - [src.data_preparation] - Ticker CKV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:41,858 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CKV
2025-05-19 23:18:41,858 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:41,858 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(143), np.int64(1): np.int64(320)}
2025-05-19 23:18:41,859 - INFO - [src.data_preparation] - Generating 177 synthetic minority samples
2025-05-19 23:18:41,866 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (640, 13, 15), y shape: (640,)
2025-05-19 23:18:41,866 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(320), np.int64(1): np.int64(320)}
2025-05-19 23:18:41,870 - INFO - [src.data_preparation] - Ticker CKV - Final 3D shapes: X_train=(640, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:41,870 - INFO - [__main__] - Using best model for CKV: svm (F1: 0.8571)
2025-05-19 23:18:41,870 - INFO - [__main__] - Loading svm model for CKV...
2025-05-19 23:18:41,872 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:41,872 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:18:41,873 - INFO - [__main__] - Making predictions for CKV using svm
2025-05-19 23:18:41,873 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:41,874 - INFO - [__main__] - Successfully got last prediction for CKV
2025-05-19 23:18:41,874 - INFO - [__main__] - 
Processing ticker: CLC
2025-05-19 23:18:41,874 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:41,874 - INFO - [__main__] - Getting last prediction point for ticker: CLC
2025-05-19 23:18:41,874 - INFO - [__main__] - ==================================================
2025-05-19 23:18:41,874 - INFO - [__main__] - Preparing test data for CLC...
2025-05-19 23:18:41,898 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:41,898 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:41,898 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:41,916 - INFO - [src.data_preparation] - Ticker CLC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:41,916 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] - Ticker CLC - Selected features:
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   SK: 0.0760
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   vnipc_t: 0.0717
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   TVV: 0.0711
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   Volatility: 0.0678
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   insec_t: 0.0641
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   ATR: 0.0626
2025-05-19 23:18:42,198 - INFO - [src.data_preparation] -   SR: 0.0617
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   ret: 0.0584
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   s_d7_t: 0.0576
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   LO: 0.0574
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   variation_t: 0.0561
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   HL: 0.0532
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   PM: 0.0500
2025-05-19 23:18:42,199 - INFO - [src.data_preparation] -   ma21_t: 0.0479
2025-05-19 23:18:42,201 - INFO - [src.data_preparation] - Ticker CLC - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'Volatility', 'insec_t', 'ATR', 'SR', 'ret', 's_d7_t', 'LO', 'variation_t', 'HL', 'Median_HL', 'PM', 'ma21_t']
2025-05-19 23:18:42,281 - INFO - [src.data_preparation] - Ticker CLC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:42,281 - INFO - [src.data_preparation] - Ticker CLC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:42,283 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CLC
2025-05-19 23:18:42,283 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:42,283 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:18:42,283 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:18:42,286 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:18:42,286 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:18:42,290 - INFO - [src.data_preparation] - Ticker CLC - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:42,290 - INFO - [__main__] - Using best model for CLC: svm (F1: 0.7945)
2025-05-19 23:18:42,290 - INFO - [__main__] - Loading svm model for CLC...
2025-05-19 23:18:42,291 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:42,292 - INFO - [__main__] - Model size: 0.77 MB
2025-05-19 23:18:42,292 - INFO - [__main__] - Making predictions for CLC using svm
2025-05-19 23:18:42,294 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:42,294 - INFO - [__main__] - Successfully got last prediction for CLC
2025-05-19 23:18:42,294 - INFO - [__main__] - 
Processing ticker: CLG
2025-05-19 23:18:42,294 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:42,295 - INFO - [__main__] - Getting last prediction point for ticker: CLG
2025-05-19 23:18:42,295 - INFO - [__main__] - ==================================================
2025-05-19 23:18:42,295 - INFO - [__main__] - Preparing test data for CLG...
2025-05-19 23:18:42,327 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:42,328 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:42,328 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:42,346 - INFO - [src.data_preparation] - Ticker CLG - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:42,347 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(370)}
2025-05-19 23:18:42,628 - INFO - [src.data_preparation] - Ticker CLG - Selected features:
2025-05-19 23:18:42,628 - INFO - [src.data_preparation] -   vnipc_t: 0.0760
2025-05-19 23:18:42,628 - INFO - [src.data_preparation] -   Median_HL: 0.0723
2025-05-19 23:18:42,628 - INFO - [src.data_preparation] -   PM: 0.0687
2025-05-19 23:18:42,628 - INFO - [src.data_preparation] -   insec_t: 0.0675
2025-05-19 23:18:42,628 - INFO - [src.data_preparation] -   Volatility: 0.0673
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   s_d7_t: 0.0671
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   SK: 0.0629
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   ma7_t: 0.0626
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   ma14_t: 0.0581
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   variation_t: 0.0515
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   ATR: 0.0500
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   ret: 0.0486
2025-05-19 23:18:42,629 - INFO - [src.data_preparation] -   HL: 0.0441
2025-05-19 23:18:42,632 - INFO - [src.data_preparation] - Ticker CLG - Using features: ['Date', 'vnipc_t', 'Median_HL', 'PM', 'insec_t', 'Volatility', 's_d7_t', 'SK', 'ma7_t', 'TVV', 'ma14_t', 'ma21_t', 'variation_t', 'ATR', 'ret', 'HL']
2025-05-19 23:18:42,727 - INFO - [src.data_preparation] - Ticker CLG - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:42,727 - INFO - [src.data_preparation] - Ticker CLG - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:42,729 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CLG
2025-05-19 23:18:42,729 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:42,729 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(242)}
2025-05-19 23:18:42,729 - INFO - [src.data_preparation] - Generating 22 synthetic minority samples
2025-05-19 23:18:42,730 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:18:42,730 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:18:42,733 - INFO - [src.data_preparation] - Ticker CLG - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:42,733 - INFO - [__main__] - Using best model for CLG: transformer (F1: 0.9524)
2025-05-19 23:18:42,734 - INFO - [__main__] - Loading transformer model for CLG...
2025-05-19 23:18:42,748 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:42,754 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:18:42,754 - INFO - [__main__] - Making predictions for CLG using transformer
2025-05-19 23:18:42,756 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:42,756 - INFO - [__main__] - Successfully got last prediction for CLG
2025-05-19 23:18:42,756 - INFO - [__main__] - 
Processing ticker: CLW
2025-05-19 23:18:42,756 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:42,756 - INFO - [__main__] - Getting last prediction point for ticker: CLW
2025-05-19 23:18:42,756 - INFO - [__main__] - ==================================================
2025-05-19 23:18:42,756 - INFO - [__main__] - Preparing test data for CLW...
2025-05-19 23:18:42,795 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:42,796 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:42,796 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:42,827 - INFO - [src.data_preparation] - Ticker CLW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:42,827 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(233), np.int64(1): np.int64(406)}
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] - Ticker CLW - Selected features:
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   vnipc_t: 0.0818
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   Volatility: 0.0711
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   TVV: 0.0685
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   ATR: 0.0684
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   ma21_t: 0.0578
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   insec_t: 0.0565
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   ma14_t: 0.0558
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   PM: 0.0535
2025-05-19 23:18:43,164 - INFO - [src.data_preparation] -   ma7_t: 0.0532
2025-05-19 23:18:43,165 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:18:43,165 - INFO - [src.data_preparation] -   ret: 0.0519
2025-05-19 23:18:43,165 - INFO - [src.data_preparation] -   HL: 0.0514
2025-05-19 23:18:43,165 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:18:43,167 - INFO - [src.data_preparation] - Ticker CLW - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'ATR', 'SK', 's_d7_t', 'ma21_t', 'insec_t', 'ma14_t', 'PM', 'ma7_t', 'variation_t', 'ret', 'HL', 'Median_HL']
2025-05-19 23:18:43,247 - INFO - [src.data_preparation] - Ticker CLW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:43,247 - INFO - [src.data_preparation] - Ticker CLW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:43,249 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CLW
2025-05-19 23:18:43,249 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:43,249 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(175), np.int64(1): np.int64(288)}
2025-05-19 23:18:43,249 - INFO - [src.data_preparation] - Generating 113 synthetic minority samples
2025-05-19 23:18:43,254 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (576, 13, 15), y shape: (576,)
2025-05-19 23:18:43,254 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(288), np.int64(1): np.int64(288)}
2025-05-19 23:18:43,257 - INFO - [src.data_preparation] - Ticker CLW - Final 3D shapes: X_train=(576, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:43,258 - INFO - [__main__] - Using best model for CLW: svm (F1: 0.8267)
2025-05-19 23:18:43,258 - INFO - [__main__] - Loading svm model for CLW...
2025-05-19 23:18:43,259 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:43,260 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:18:43,260 - INFO - [__main__] - Making predictions for CLW using svm
2025-05-19 23:18:43,261 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:43,261 - INFO - [__main__] - Successfully got last prediction for CLW
2025-05-19 23:18:43,261 - INFO - [__main__] - 
Processing ticker: CMC
2025-05-19 23:18:43,261 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:43,261 - INFO - [__main__] - Getting last prediction point for ticker: CMC
2025-05-19 23:18:43,261 - INFO - [__main__] - ==================================================
2025-05-19 23:18:43,261 - INFO - [__main__] - Preparing test data for CMC...
2025-05-19 23:18:43,289 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:43,289 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:43,289 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:43,308 - INFO - [src.data_preparation] - Ticker CMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:43,308 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(213), np.int64(1): np.int64(426)}
2025-05-19 23:18:43,577 - INFO - [src.data_preparation] - Ticker CMC - Selected features:
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   vnipc_t: 0.0750
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   TVV: 0.0745
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   s_d7_t: 0.0708
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   SK: 0.0706
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   ma21_t: 0.0690
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   ma14_t: 0.0648
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   ma7_t: 0.0639
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   ATR: 0.0636
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   PM: 0.0593
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   Volatility: 0.0591
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   insec_t: 0.0559
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:18:43,578 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:18:43,579 - INFO - [src.data_preparation] -   variation_t: 0.0531
2025-05-19 23:18:43,579 - INFO - [src.data_preparation] -   HL: 0.0387
2025-05-19 23:18:43,581 - INFO - [src.data_preparation] - Ticker CMC - Using features: ['Date', 'vnipc_t', 'TVV', 's_d7_t', 'SK', 'ma21_t', 'ma14_t', 'ma7_t', 'ATR', 'PM', 'Volatility', 'insec_t', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:18:43,670 - INFO - [src.data_preparation] - Ticker CMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:43,670 - INFO - [src.data_preparation] - Ticker CMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:43,671 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMC
2025-05-19 23:18:43,671 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:43,671 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(127), np.int64(1): np.int64(336)}
2025-05-19 23:18:43,671 - INFO - [src.data_preparation] - Generating 209 synthetic minority samples
2025-05-19 23:18:43,680 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (672, 13, 15), y shape: (672,)
2025-05-19 23:18:43,680 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(336), np.int64(1): np.int64(336)}
2025-05-19 23:18:43,684 - INFO - [src.data_preparation] - Ticker CMC - Final 3D shapes: X_train=(672, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:43,684 - INFO - [__main__] - Using best model for CMC: svm (F1: 0.4211)
2025-05-19 23:18:43,684 - INFO - [__main__] - Loading svm model for CMC...
2025-05-19 23:18:43,686 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:43,687 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:18:43,687 - INFO - [__main__] - Making predictions for CMC using svm
2025-05-19 23:18:43,687 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:43,688 - INFO - [__main__] - Successfully got last prediction for CMC
2025-05-19 23:18:43,688 - INFO - [__main__] - 
Processing ticker: CMG
2025-05-19 23:18:43,688 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:43,688 - INFO - [__main__] - Getting last prediction point for ticker: CMG
2025-05-19 23:18:43,688 - INFO - [__main__] - ==================================================
2025-05-19 23:18:43,688 - INFO - [__main__] - Preparing test data for CMG...
2025-05-19 23:18:43,716 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:43,716 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:43,716 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:43,735 - INFO - [src.data_preparation] - Ticker CMG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:43,735 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:18:44,065 - INFO - [src.data_preparation] - Ticker CMG - Selected features:
2025-05-19 23:18:44,065 - INFO - [src.data_preparation] -   SR: 0.0704
2025-05-19 23:18:44,065 - INFO - [src.data_preparation] -   TVV: 0.0685
2025-05-19 23:18:44,065 - INFO - [src.data_preparation] -   vnipc_t: 0.0678
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   variation_t: 0.0631
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   insec_t: 0.0628
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   SK: 0.0627
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   ret: 0.0623
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   HL: 0.0593
2025-05-19 23:18:44,066 - INFO - [src.data_preparation] -   LO: 0.0584
2025-05-19 23:18:44,067 - INFO - [src.data_preparation] -   ATR: 0.0540
2025-05-19 23:18:44,067 - INFO - [src.data_preparation] -   PM: 0.0514
2025-05-19 23:18:44,067 - INFO - [src.data_preparation] -   Median_HL: 0.0514
2025-05-19 23:18:44,067 - INFO - [src.data_preparation] -   ma7_t: 0.0484
2025-05-19 23:18:44,070 - INFO - [src.data_preparation] - Ticker CMG - Using features: ['Date', 'SR', 'TVV', 'vnipc_t', 'Volatility', 'variation_t', 'insec_t', 'SK', 'ret', 's_d7_t', 'HL', 'LO', 'ATR', 'PM', 'Median_HL', 'ma7_t']
2025-05-19 23:18:44,161 - INFO - [src.data_preparation] - Ticker CMG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:44,161 - INFO - [src.data_preparation] - Ticker CMG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:44,163 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMG
2025-05-19 23:18:44,163 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:44,163 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:18:44,163 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:18:44,166 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:18:44,166 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:18:44,169 - INFO - [src.data_preparation] - Ticker CMG - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:44,169 - INFO - [__main__] - Using best model for CMG: svm (F1: 0.6000)
2025-05-19 23:18:44,169 - INFO - [__main__] - Loading svm model for CMG...
2025-05-19 23:18:44,170 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:44,170 - INFO - [__main__] - Model size: 0.55 MB
2025-05-19 23:18:44,171 - INFO - [__main__] - Making predictions for CMG using svm
2025-05-19 23:18:44,171 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:44,171 - INFO - [__main__] - Successfully got last prediction for CMG
2025-05-19 23:18:44,171 - INFO - [__main__] - 
Processing ticker: CMI
2025-05-19 23:18:44,171 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:44,172 - INFO - [__main__] - Getting last prediction point for ticker: CMI
2025-05-19 23:18:44,172 - INFO - [__main__] - ==================================================
2025-05-19 23:18:44,172 - INFO - [__main__] - Preparing test data for CMI...
2025-05-19 23:18:44,228 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:44,228 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:44,228 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:44,251 - INFO - [src.data_preparation] - Ticker CMI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:44,251 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(244), np.int64(1): np.int64(395)}
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] - Ticker CMI - Selected features:
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   vnipc_t: 0.0811
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   TVV: 0.0801
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   SK: 0.0703
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   Volatility: 0.0702
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   ma21_t: 0.0683
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   s_d7_t: 0.0669
2025-05-19 23:18:44,536 - INFO - [src.data_preparation] -   ma14_t: 0.0637
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   insec_t: 0.0631
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   ma7_t: 0.0550
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   ret: 0.0504
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   variation_t: 0.0499
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   ATR: 0.0486
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   PM: 0.0485
2025-05-19 23:18:44,537 - INFO - [src.data_preparation] -   HL: 0.0426
2025-05-19 23:18:44,540 - INFO - [src.data_preparation] - Ticker CMI - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'Volatility', 'ma21_t', 's_d7_t', 'ma14_t', 'insec_t', 'ma7_t', 'Median_HL', 'ret', 'variation_t', 'ATR', 'PM', 'HL']
2025-05-19 23:18:44,630 - INFO - [src.data_preparation] - Ticker CMI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:44,631 - INFO - [src.data_preparation] - Ticker CMI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:44,632 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMI
2025-05-19 23:18:44,632 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:44,632 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:18:44,633 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:18:44,636 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:18:44,636 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:18:44,640 - INFO - [src.data_preparation] - Ticker CMI - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:44,640 - INFO - [__main__] - Using best model for CMI: lstm (F1: 0.8571)
2025-05-19 23:18:44,640 - INFO - [__main__] - Loading lstm model for CMI...
2025-05-19 23:18:44,644 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:44,645 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:18:44,645 - INFO - [__main__] - Making predictions for CMI using lstm
2025-05-19 23:18:44,647 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:44,647 - INFO - [__main__] - Successfully got last prediction for CMI
2025-05-19 23:18:44,647 - INFO - [__main__] - 
Processing ticker: CMS
2025-05-19 23:18:44,647 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:44,648 - INFO - [__main__] - Getting last prediction point for ticker: CMS
2025-05-19 23:18:44,648 - INFO - [__main__] - ==================================================
2025-05-19 23:18:44,648 - INFO - [__main__] - Preparing test data for CMS...
2025-05-19 23:18:44,674 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:44,674 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:44,674 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:44,697 - INFO - [src.data_preparation] - Ticker CMS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:44,698 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(310), np.int64(1): np.int64(329)}
2025-05-19 23:18:45,070 - INFO - [src.data_preparation] - Ticker CMS - Selected features:
2025-05-19 23:18:45,070 - INFO - [src.data_preparation] -   vnipc_t: 0.0711
2025-05-19 23:18:45,070 - INFO - [src.data_preparation] -   TVV: 0.0642
2025-05-19 23:18:45,070 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:18:45,070 - INFO - [src.data_preparation] -   s_d7_t: 0.0630
2025-05-19 23:18:45,070 - INFO - [src.data_preparation] -   ATR: 0.0616
2025-05-19 23:18:45,071 - INFO - [src.data_preparation] -   SK: 0.0610
2025-05-19 23:18:45,071 - INFO - [src.data_preparation] -   insec_t: 0.0609
2025-05-19 23:18:45,071 - INFO - [src.data_preparation] -   ma21_t: 0.0577
2025-05-19 23:18:45,071 - INFO - [src.data_preparation] -   HL: 0.0568
2025-05-19 23:18:45,072 - INFO - [src.data_preparation] -   PM: 0.0565
2025-05-19 23:18:45,072 - INFO - [src.data_preparation] -   SR: 0.0555
2025-05-19 23:18:45,072 - INFO - [src.data_preparation] -   LO: 0.0550
2025-05-19 23:18:45,072 - INFO - [src.data_preparation] -   variation_t: 0.0546
2025-05-19 23:18:45,072 - INFO - [src.data_preparation] -   ma14_t: 0.0545
2025-05-19 23:18:45,072 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:18:45,077 - INFO - [src.data_preparation] - Ticker CMS - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'ATR', 'SK', 'insec_t', 'ma21_t', 'HL', 'PM', 'SR', 'LO', 'variation_t', 'ma14_t', 'ret']
2025-05-19 23:18:45,170 - INFO - [src.data_preparation] - Ticker CMS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:45,170 - INFO - [src.data_preparation] - Ticker CMS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:45,172 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMS
2025-05-19 23:18:45,172 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:45,172 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:18:45,172 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:18:45,175 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:18:45,175 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:18:45,178 - INFO - [src.data_preparation] - Ticker CMS - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:45,178 - INFO - [__main__] - Using best model for CMS: svm (F1: 0.1429)
2025-05-19 23:18:45,178 - INFO - [__main__] - Loading svm model for CMS...
2025-05-19 23:18:45,180 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:45,180 - INFO - [__main__] - Model size: 0.66 MB
2025-05-19 23:18:45,181 - INFO - [__main__] - Making predictions for CMS using svm
2025-05-19 23:18:45,181 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:45,181 - INFO - [__main__] - Successfully got last prediction for CMS
2025-05-19 23:18:45,181 - INFO - [__main__] - 
Processing ticker: CMT
2025-05-19 23:18:45,181 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:45,181 - INFO - [__main__] - Getting last prediction point for ticker: CMT
2025-05-19 23:18:45,181 - INFO - [__main__] - ==================================================
2025-05-19 23:18:45,182 - INFO - [__main__] - Preparing test data for CMT...
2025-05-19 23:18:45,207 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:45,207 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:45,207 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:45,226 - INFO - [src.data_preparation] - Ticker CMT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:45,227 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(307), np.int64(1): np.int64(332)}
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] - Ticker CMT - Selected features:
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   vnipc_t: 0.0708
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   s_d7_t: 0.0694
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   SK: 0.0683
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   insec_t: 0.0650
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   ret: 0.0642
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   ATR: 0.0600
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   TVV: 0.0598
2025-05-19 23:18:45,530 - INFO - [src.data_preparation] -   variation_t: 0.0598
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   HL: 0.0580
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   Volatility: 0.0568
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   PM: 0.0550
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   Median_HL: 0.0545
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   SR: 0.0526
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   ma21_t: 0.0524
2025-05-19 23:18:45,531 - INFO - [src.data_preparation] -   LO: 0.0509
2025-05-19 23:18:45,534 - INFO - [src.data_preparation] - Ticker CMT - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'insec_t', 'ret', 'ATR', 'TVV', 'variation_t', 'HL', 'Volatility', 'PM', 'Median_HL', 'SR', 'ma21_t', 'LO']
2025-05-19 23:18:45,621 - INFO - [src.data_preparation] - Ticker CMT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:45,621 - INFO - [src.data_preparation] - Ticker CMT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:45,623 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMT
2025-05-19 23:18:45,623 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:45,623 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(218), np.int64(1): np.int64(245)}
2025-05-19 23:18:45,623 - INFO - [src.data_preparation] - Generating 27 synthetic minority samples
2025-05-19 23:18:45,625 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (490, 13, 15), y shape: (490,)
2025-05-19 23:18:45,625 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(245), np.int64(1): np.int64(245)}
2025-05-19 23:18:45,628 - INFO - [src.data_preparation] - Ticker CMT - Final 3D shapes: X_train=(490, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:45,628 - INFO - [__main__] - Using best model for CMT: transformer (F1: 0.3077)
2025-05-19 23:18:45,628 - INFO - [__main__] - Loading transformer model for CMT...
2025-05-19 23:18:45,641 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:45,646 - INFO - [__main__] - Model size: 0.48 MB
2025-05-19 23:18:45,646 - INFO - [__main__] - Making predictions for CMT using transformer
2025-05-19 23:18:45,648 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:45,648 - INFO - [__main__] - Successfully got last prediction for CMT
2025-05-19 23:18:45,648 - INFO - [__main__] - 
Processing ticker: CMV
2025-05-19 23:18:45,648 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:45,649 - INFO - [__main__] - Getting last prediction point for ticker: CMV
2025-05-19 23:18:45,649 - INFO - [__main__] - ==================================================
2025-05-19 23:18:45,649 - INFO - [__main__] - Preparing test data for CMV...
2025-05-19 23:18:45,689 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:45,689 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:45,689 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:45,712 - INFO - [src.data_preparation] - Ticker CMV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:45,712 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] - Ticker CMV - Selected features:
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   SK: 0.0757
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   TVV: 0.0742
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   vnipc_t: 0.0737
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   ATR: 0.0676
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   s_d7_t: 0.0580
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   SR: 0.0575
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   insec_t: 0.0541
2025-05-19 23:18:46,046 - INFO - [src.data_preparation] -   variation_t: 0.0540
2025-05-19 23:18:46,047 - INFO - [src.data_preparation] -   ma7_t: 0.0536
2025-05-19 23:18:46,047 - INFO - [src.data_preparation] -   HL: 0.0530
2025-05-19 23:18:46,047 - INFO - [src.data_preparation] -   PM: 0.0479
2025-05-19 23:18:46,047 - INFO - [src.data_preparation] -   ret: 0.0473
2025-05-19 23:18:46,049 - INFO - [src.data_preparation] - Ticker CMV - Using features: ['Date', 'SK', 'TVV', 'vnipc_t', 'ATR', 'Volatility', 'ma21_t', 's_d7_t', 'SR', 'ma14_t', 'insec_t', 'variation_t', 'ma7_t', 'HL', 'PM', 'ret']
2025-05-19 23:18:46,130 - INFO - [src.data_preparation] - Ticker CMV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:46,130 - INFO - [src.data_preparation] - Ticker CMV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:46,131 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMV
2025-05-19 23:18:46,131 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:46,131 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:18:46,131 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:18:46,137 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:18:46,137 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:18:46,140 - INFO - [src.data_preparation] - Ticker CMV - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:46,140 - INFO - [__main__] - Using best model for CMV: svm (F1: 0.7059)
2025-05-19 23:18:46,140 - INFO - [__main__] - Loading svm model for CMV...
2025-05-19 23:18:46,141 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:46,142 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:18:46,142 - INFO - [__main__] - Making predictions for CMV using svm
2025-05-19 23:18:46,143 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:46,143 - INFO - [__main__] - Successfully got last prediction for CMV
2025-05-19 23:18:46,143 - INFO - [__main__] - 
Processing ticker: CMX
2025-05-19 23:18:46,143 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:46,143 - INFO - [__main__] - Getting last prediction point for ticker: CMX
2025-05-19 23:18:46,143 - INFO - [__main__] - ==================================================
2025-05-19 23:18:46,143 - INFO - [__main__] - Preparing test data for CMX...
2025-05-19 23:18:46,170 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:46,170 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:46,170 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:46,188 - INFO - [src.data_preparation] - Ticker CMX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:46,188 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] - Ticker CMX - Selected features:
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   vnipc_t: 0.0707
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   ATR: 0.0668
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   TVV: 0.0647
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   Volatility: 0.0612
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   HL: 0.0611
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   insec_t: 0.0593
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   SK: 0.0592
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   LO: 0.0587
2025-05-19 23:18:46,477 - INFO - [src.data_preparation] -   ma21_t: 0.0587
2025-05-19 23:18:46,478 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:18:46,478 - INFO - [src.data_preparation] -   ma14_t: 0.0550
2025-05-19 23:18:46,478 - INFO - [src.data_preparation] -   SR: 0.0545
2025-05-19 23:18:46,478 - INFO - [src.data_preparation] -   ret: 0.0545
2025-05-19 23:18:46,478 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:18:46,480 - INFO - [src.data_preparation] - Ticker CMX - Using features: ['Date', 'vnipc_t', 'ATR', 'TVV', 's_d7_t', 'Volatility', 'HL', 'insec_t', 'SK', 'LO', 'ma21_t', 'ma7_t', 'ma14_t', 'SR', 'ret', 'PM']
2025-05-19 23:18:46,556 - INFO - [src.data_preparation] - Ticker CMX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:46,556 - INFO - [src.data_preparation] - Ticker CMX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:46,557 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CMX
2025-05-19 23:18:46,557 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:46,558 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:18:46,558 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:18:46,560 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:18:46,560 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:18:46,562 - INFO - [src.data_preparation] - Ticker CMX - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:46,563 - INFO - [__main__] - Using best model for CMX: logistic_regression (F1: 0.3871)
2025-05-19 23:18:46,563 - INFO - [__main__] - Loading logistic_regression model for CMX...
2025-05-19 23:18:46,563 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:46,564 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:46,564 - INFO - [__main__] - Making predictions for CMX using logistic_regression
2025-05-19 23:18:46,564 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:46,564 - INFO - [__main__] - Successfully got last prediction for CMX
2025-05-19 23:18:46,564 - INFO - [__main__] - 
Processing ticker: CNG
2025-05-19 23:18:46,564 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:46,565 - INFO - [__main__] - Getting last prediction point for ticker: CNG
2025-05-19 23:18:46,565 - INFO - [__main__] - ==================================================
2025-05-19 23:18:46,565 - INFO - [__main__] - Preparing test data for CNG...
2025-05-19 23:18:46,592 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:46,592 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:46,592 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:46,610 - INFO - [src.data_preparation] - Ticker CNG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:46,610 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(303), np.int64(1): np.int64(336)}
2025-05-19 23:18:46,905 - INFO - [src.data_preparation] - Ticker CNG - Selected features:
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   SK: 0.0666
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   Median_HL: 0.0649
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   insec_t: 0.0625
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   vnipc_t: 0.0618
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   TVV: 0.0614
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   s_d7_t: 0.0614
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   ret: 0.0596
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   HL: 0.0593
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   PM: 0.0589
2025-05-19 23:18:46,906 - INFO - [src.data_preparation] -   variation_t: 0.0577
2025-05-19 23:18:46,907 - INFO - [src.data_preparation] -   LO: 0.0548
2025-05-19 23:18:46,907 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:18:46,907 - INFO - [src.data_preparation] -   Volatility: 0.0535
2025-05-19 23:18:46,907 - INFO - [src.data_preparation] -   ma14_t: 0.0514
2025-05-19 23:18:46,910 - INFO - [src.data_preparation] - Ticker CNG - Using features: ['Date', 'SK', 'Median_HL', 'insec_t', 'vnipc_t', 'TVV', 's_d7_t', 'ret', 'HL', 'ATR', 'PM', 'variation_t', 'LO', 'ma7_t', 'Volatility', 'ma14_t']
2025-05-19 23:18:46,998 - INFO - [src.data_preparation] - Ticker CNG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:46,998 - INFO - [src.data_preparation] - Ticker CNG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:46,999 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CNG
2025-05-19 23:18:47,000 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:47,000 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(243)}
2025-05-19 23:18:47,000 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:18:47,001 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:18:47,002 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:18:47,004 - INFO - [src.data_preparation] - Ticker CNG - Final 3D shapes: X_train=(486, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:47,005 - INFO - [__main__] - Using best model for CNG: logistic_regression (F1: 0.6316)
2025-05-19 23:18:47,005 - INFO - [__main__] - Loading logistic_regression model for CNG...
2025-05-19 23:18:47,006 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:47,006 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:47,006 - INFO - [__main__] - Making predictions for CNG using logistic_regression
2025-05-19 23:18:47,006 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:47,006 - INFO - [__main__] - Successfully got last prediction for CNG
2025-05-19 23:18:47,007 - INFO - [__main__] - 
Processing ticker: CNT
2025-05-19 23:18:47,007 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:47,007 - INFO - [__main__] - Getting last prediction point for ticker: CNT
2025-05-19 23:18:47,007 - INFO - [__main__] - ==================================================
2025-05-19 23:18:47,007 - INFO - [__main__] - Preparing test data for CNT...
2025-05-19 23:18:47,036 - INFO - [src.data_preparation] - After processing - X shape: (597, 19), y shape: (597,)
2025-05-19 23:18:47,036 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:47,036 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:47,056 - INFO - [src.data_preparation] - Ticker CNT - Original shapes: X=(597, 18), y=(597,)
2025-05-19 23:18:47,056 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(248), np.int64(1): np.int64(349)}
2025-05-19 23:18:47,357 - INFO - [src.data_preparation] - Ticker CNT - Selected features:
2025-05-19 23:18:47,357 - INFO - [src.data_preparation] -   TVV: 0.0782
2025-05-19 23:18:47,357 - INFO - [src.data_preparation] -   vnipc_t: 0.0722
2025-05-19 23:18:47,357 - INFO - [src.data_preparation] -   insec_t: 0.0718
2025-05-19 23:18:47,357 - INFO - [src.data_preparation] -   SK: 0.0670
2025-05-19 23:18:47,357 - INFO - [src.data_preparation] -   Volatility: 0.0649
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   s_d7_t: 0.0635
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   ma7_t: 0.0554
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   HL: 0.0532
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   ret: 0.0528
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   ma14_t: 0.0514
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:18:47,358 - INFO - [src.data_preparation] -   PM: 0.0497
2025-05-19 23:18:47,361 - INFO - [src.data_preparation] - Ticker CNT - Using features: ['Date', 'TVV', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 's_d7_t', 'ATR', 'ma21_t', 'ma7_t', 'HL', 'ret', 'variation_t', 'ma14_t', 'Median_HL', 'PM']
2025-05-19 23:18:47,473 - INFO - [src.data_preparation] - Ticker CNT - 2D shapes: X_train=(421, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:47,473 - INFO - [src.data_preparation] - Ticker CNT - 3D shapes: X_train=(421, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:47,475 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CNT
2025-05-19 23:18:47,475 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (421, 13, 15), y shape: (421,)
2025-05-19 23:18:47,476 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(158), np.int64(1): np.int64(263)}
2025-05-19 23:18:47,476 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:18:47,484 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:18:47,484 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:18:47,487 - INFO - [src.data_preparation] - Ticker CNT - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:47,488 - INFO - [__main__] - Using best model for CNT: svm (F1: 0.6032)
2025-05-19 23:18:47,488 - INFO - [__main__] - Loading svm model for CNT...
2025-05-19 23:18:47,489 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:47,490 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:18:47,490 - INFO - [__main__] - Making predictions for CNT using svm
2025-05-19 23:18:47,491 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:47,491 - INFO - [__main__] - Successfully got last prediction for CNT
2025-05-19 23:18:47,491 - INFO - [__main__] - 
Processing ticker: COM
2025-05-19 23:18:47,491 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:47,491 - INFO - [__main__] - Getting last prediction point for ticker: COM
2025-05-19 23:18:47,491 - INFO - [__main__] - ==================================================
2025-05-19 23:18:47,491 - INFO - [__main__] - Preparing test data for COM...
2025-05-19 23:18:47,540 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:47,540 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:47,540 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:47,560 - INFO - [src.data_preparation] - Ticker COM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:47,560 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(279), np.int64(1): np.int64(360)}
2025-05-19 23:18:47,892 - INFO - [src.data_preparation] - Ticker COM - Selected features:
2025-05-19 23:18:47,892 - INFO - [src.data_preparation] -   SK: 0.0687
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   ATR: 0.0671
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   s_d7_t: 0.0668
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   TVV: 0.0640
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   ret: 0.0627
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   variation_t: 0.0619
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   SR: 0.0598
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   vnipc_t: 0.0588
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   insec_t: 0.0585
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   PM: 0.0569
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   Median_HL: 0.0555
2025-05-19 23:18:47,893 - INFO - [src.data_preparation] -   ma14_t: 0.0548
2025-05-19 23:18:47,894 - INFO - [src.data_preparation] -   HL: 0.0521
2025-05-19 23:18:47,894 - INFO - [src.data_preparation] -   ma7_t: 0.0499
2025-05-19 23:18:47,897 - INFO - [src.data_preparation] - Ticker COM - Using features: ['Date', 'SK', 'ATR', 's_d7_t', 'TVV', 'ret', 'variation_t', 'Volatility', 'SR', 'vnipc_t', 'insec_t', 'PM', 'Median_HL', 'ma14_t', 'HL', 'ma7_t']
2025-05-19 23:18:48,039 - INFO - [src.data_preparation] - Ticker COM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:48,039 - INFO - [src.data_preparation] - Ticker COM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:48,040 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker COM
2025-05-19 23:18:48,040 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:48,040 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:18:48,041 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:18:48,044 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:18:48,044 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:18:48,047 - INFO - [src.data_preparation] - Ticker COM - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:48,047 - INFO - [__main__] - Using best model for COM: svm (F1: 0.7059)
2025-05-19 23:18:48,047 - INFO - [__main__] - Loading svm model for COM...
2025-05-19 23:18:48,049 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:48,050 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:18:48,050 - INFO - [__main__] - Making predictions for COM using svm
2025-05-19 23:18:48,050 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:48,051 - INFO - [__main__] - Successfully got last prediction for COM
2025-05-19 23:18:48,051 - INFO - [__main__] - 
Processing ticker: CPC
2025-05-19 23:18:48,051 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:48,051 - INFO - [__main__] - Getting last prediction point for ticker: CPC
2025-05-19 23:18:48,051 - INFO - [__main__] - ==================================================
2025-05-19 23:18:48,051 - INFO - [__main__] - Preparing test data for CPC...
2025-05-19 23:18:48,083 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:48,083 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:48,083 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:48,102 - INFO - [src.data_preparation] - Ticker CPC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:48,102 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(387)}
2025-05-19 23:18:48,434 - INFO - [src.data_preparation] - Ticker CPC - Selected features:
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   vnipc_t: 0.0754
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   s_d7_t: 0.0698
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   SK: 0.0686
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   insec_t: 0.0661
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   ATR: 0.0655
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   Volatility: 0.0617
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   TVV: 0.0615
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   HL: 0.0602
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   ret: 0.0590
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   Median_HL: 0.0551
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   SR: 0.0549
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   PM: 0.0543
2025-05-19 23:18:48,435 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:18:48,436 - INFO - [src.data_preparation] -   ma14_t: 0.0505
2025-05-19 23:18:48,436 - INFO - [src.data_preparation] -   LO: 0.0501
2025-05-19 23:18:48,438 - INFO - [src.data_preparation] - Ticker CPC - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'insec_t', 'ATR', 'Volatility', 'TVV', 'HL', 'ret', 'Median_HL', 'SR', 'PM', 'variation_t', 'ma14_t', 'LO']
2025-05-19 23:18:48,522 - INFO - [src.data_preparation] - Ticker CPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:48,522 - INFO - [src.data_preparation] - Ticker CPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:48,523 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CPC
2025-05-19 23:18:48,523 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:48,523 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:18:48,523 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:18:48,527 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:18:48,527 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:18:48,530 - INFO - [src.data_preparation] - Ticker CPC - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:48,530 - INFO - [__main__] - Using best model for CPC: svm (F1: 0.7945)
2025-05-19 23:18:48,530 - INFO - [__main__] - Loading svm model for CPC...
2025-05-19 23:18:48,532 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:48,533 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:18:48,533 - INFO - [__main__] - Making predictions for CPC using svm
2025-05-19 23:18:48,533 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:48,534 - INFO - [__main__] - Successfully got last prediction for CPC
2025-05-19 23:18:48,534 - INFO - [__main__] - 
Processing ticker: CSC
2025-05-19 23:18:48,534 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:48,534 - INFO - [__main__] - Getting last prediction point for ticker: CSC
2025-05-19 23:18:48,534 - INFO - [__main__] - ==================================================
2025-05-19 23:18:48,534 - INFO - [__main__] - Preparing test data for CSC...
2025-05-19 23:18:48,558 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:48,559 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:48,559 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:48,579 - INFO - [src.data_preparation] - Ticker CSC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:48,579 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(337)}
2025-05-19 23:18:48,919 - INFO - [src.data_preparation] - Ticker CSC - Selected features:
2025-05-19 23:18:48,919 - INFO - [src.data_preparation] -   vnipc_t: 0.0774
2025-05-19 23:18:48,919 - INFO - [src.data_preparation] -   SK: 0.0727
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   insec_t: 0.0672
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   Volatility: 0.0599
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   ret: 0.0590
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   ATR: 0.0588
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   HL: 0.0585
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   variation_t: 0.0582
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   SR: 0.0574
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   LO: 0.0526
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   ma21_t: 0.0510
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   PM: 0.0499
2025-05-19 23:18:48,920 - INFO - [src.data_preparation] -   ma14_t: 0.0494
2025-05-19 23:18:48,923 - INFO - [src.data_preparation] - Ticker CSC - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'insec_t', 's_d7_t', 'Volatility', 'ret', 'ATR', 'HL', 'variation_t', 'SR', 'LO', 'ma21_t', 'PM', 'ma14_t']
2025-05-19 23:18:49,013 - INFO - [src.data_preparation] - Ticker CSC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:49,013 - INFO - [src.data_preparation] - Ticker CSC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:49,015 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CSC
2025-05-19 23:18:49,015 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:49,015 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:18:49,015 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:18:49,017 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:18:49,017 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:18:49,020 - INFO - [src.data_preparation] - Ticker CSC - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:49,020 - INFO - [__main__] - Using best model for CSC: svm (F1: 0.4255)
2025-05-19 23:18:49,020 - INFO - [__main__] - Loading svm model for CSC...
2025-05-19 23:18:49,022 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:49,022 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:18:49,022 - INFO - [__main__] - Making predictions for CSC using svm
2025-05-19 23:18:49,023 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:49,023 - INFO - [__main__] - Successfully got last prediction for CSC
2025-05-19 23:18:49,023 - INFO - [__main__] - 
Processing ticker: CSM
2025-05-19 23:18:49,023 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:49,023 - INFO - [__main__] - Getting last prediction point for ticker: CSM
2025-05-19 23:18:49,023 - INFO - [__main__] - ==================================================
2025-05-19 23:18:49,023 - INFO - [__main__] - Preparing test data for CSM...
2025-05-19 23:18:49,054 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:49,054 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:49,054 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:49,076 - INFO - [src.data_preparation] - Ticker CSM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:49,076 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(317), np.int64(1): np.int64(322)}
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] - Ticker CSM - Selected features:
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] -   vnipc_t: 0.0690
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] -   Volatility: 0.0686
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] -   insec_t: 0.0668
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] -   SK: 0.0662
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] -   ATR: 0.0656
2025-05-19 23:18:49,396 - INFO - [src.data_preparation] -   s_d7_t: 0.0615
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   ma7_t: 0.0609
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   ma14_t: 0.0593
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   TVV: 0.0573
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   PM: 0.0565
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   HL: 0.0553
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   Median_HL: 0.0516
2025-05-19 23:18:49,397 - INFO - [src.data_preparation] -   SR: 0.0508
2025-05-19 23:18:49,400 - INFO - [src.data_preparation] - Ticker CSM - Using features: ['Date', 'vnipc_t', 'Volatility', 'insec_t', 'SK', 'ATR', 's_d7_t', 'ma7_t', 'ma21_t', 'ma14_t', 'TVV', 'PM', 'HL', 'ret', 'Median_HL', 'SR']
2025-05-19 23:18:49,483 - INFO - [src.data_preparation] - Ticker CSM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:49,483 - INFO - [src.data_preparation] - Ticker CSM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:49,484 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CSM
2025-05-19 23:18:49,484 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:49,485 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:18:49,485 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:18:49,485 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:18:49,485 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:18:49,488 - INFO - [src.data_preparation] - Ticker CSM - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:49,488 - INFO - [__main__] - Using best model for CSM: lstm (F1: 0.6087)
2025-05-19 23:18:49,488 - INFO - [__main__] - Loading lstm model for CSM...
2025-05-19 23:18:49,492 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:49,493 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:18:49,493 - INFO - [__main__] - Making predictions for CSM using lstm
2025-05-19 23:18:49,496 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:49,496 - INFO - [__main__] - Successfully got last prediction for CSM
2025-05-19 23:18:49,496 - INFO - [__main__] - 
Processing ticker: CT3
2025-05-19 23:18:49,496 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:49,496 - INFO - [__main__] - Getting last prediction point for ticker: CT3
2025-05-19 23:18:49,496 - INFO - [__main__] - ==================================================
2025-05-19 23:18:49,496 - INFO - [__main__] - Preparing test data for CT3...
2025-05-19 23:18:49,525 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:49,525 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:49,525 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:49,550 - INFO - [src.data_preparation] - Ticker CT3 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:49,550 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(107), np.int64(1): np.int64(532)}
2025-05-19 23:18:49,835 - INFO - [src.data_preparation] - Ticker CT3 - Selected features:
2025-05-19 23:18:49,835 - INFO - [src.data_preparation] -   vnipc_t: 0.0915
2025-05-19 23:18:49,836 - INFO - [src.data_preparation] -   TVV: 0.0899
2025-05-19 23:18:49,836 - INFO - [src.data_preparation] -   ma21_t: 0.0820
2025-05-19 23:18:49,836 - INFO - [src.data_preparation] -   ma7_t: 0.0806
2025-05-19 23:18:49,836 - INFO - [src.data_preparation] -   s_d7_t: 0.0790
2025-05-19 23:18:49,836 - INFO - [src.data_preparation] -   ma14_t: 0.0787
2025-05-19 23:18:49,836 - INFO - [src.data_preparation] -   ATR: 0.0667
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   PM: 0.0616
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   SK: 0.0604
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   Median_HL: 0.0558
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   ret: 0.0408
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   variation_t: 0.0378
2025-05-19 23:18:49,837 - INFO - [src.data_preparation] -   insec_t: 0.0314
2025-05-19 23:18:49,838 - INFO - [src.data_preparation] -   SR: 0.0314
2025-05-19 23:18:49,842 - INFO - [src.data_preparation] - Ticker CT3 - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma7_t', 's_d7_t', 'ma14_t', 'ATR', 'Volatility', 'PM', 'SK', 'Median_HL', 'ret', 'variation_t', 'insec_t', 'SR']
2025-05-19 23:18:49,930 - INFO - [src.data_preparation] - Ticker CT3 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:49,930 - INFO - [src.data_preparation] - Ticker CT3 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:49,931 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CT3
2025-05-19 23:18:49,931 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:49,932 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(92), np.int64(1): np.int64(371)}
2025-05-19 23:18:49,932 - INFO - [src.data_preparation] - Generating 279 synthetic minority samples
2025-05-19 23:18:49,942 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (742, 13, 15), y shape: (742,)
2025-05-19 23:18:49,942 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(371), np.int64(1): np.int64(371)}
2025-05-19 23:18:49,946 - INFO - [src.data_preparation] - Ticker CT3 - Final 3D shapes: X_train=(742, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:49,946 - INFO - [__main__] - Using best model for CT3: svm (F1: 0.8333)
2025-05-19 23:18:49,946 - INFO - [__main__] - Loading svm model for CT3...
2025-05-19 23:18:49,948 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:49,948 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:18:49,948 - INFO - [__main__] - Making predictions for CT3 using svm
2025-05-19 23:18:49,949 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:49,949 - INFO - [__main__] - Successfully got last prediction for CT3
2025-05-19 23:18:49,949 - INFO - [__main__] - 
Processing ticker: CT6
2025-05-19 23:18:49,949 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:49,949 - INFO - [__main__] - Getting last prediction point for ticker: CT6
2025-05-19 23:18:49,949 - INFO - [__main__] - ==================================================
2025-05-19 23:18:49,949 - INFO - [__main__] - Preparing test data for CT6...
2025-05-19 23:18:49,977 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:49,977 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:49,977 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:49,999 - INFO - [src.data_preparation] - Ticker CT6 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:49,999 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(152), np.int64(1): np.int64(487)}
2025-05-19 23:18:50,233 - INFO - [src.data_preparation] - Ticker CT6 - Selected features:
2025-05-19 23:18:50,233 - INFO - [src.data_preparation] -   ATR: 0.0957
2025-05-19 23:18:50,233 - INFO - [src.data_preparation] -   vnipc_t: 0.0913
2025-05-19 23:18:50,233 - INFO - [src.data_preparation] -   s_d7_t: 0.0750
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   TVV: 0.0719
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   Volatility: 0.0684
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   ma14_t: 0.0636
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   ma7_t: 0.0628
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   ma21_t: 0.0626
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   HL: 0.0582
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   Median_HL: 0.0561
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   PM: 0.0522
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   insec_t: 0.0494
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   SK: 0.0477
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   SR: 0.0381
2025-05-19 23:18:50,234 - INFO - [src.data_preparation] -   ret: 0.0358
2025-05-19 23:18:50,237 - INFO - [src.data_preparation] - Ticker CT6 - Using features: ['Date', 'ATR', 'vnipc_t', 's_d7_t', 'TVV', 'Volatility', 'ma14_t', 'ma7_t', 'ma21_t', 'HL', 'Median_HL', 'PM', 'insec_t', 'SK', 'SR', 'ret']
2025-05-19 23:18:50,321 - INFO - [src.data_preparation] - Ticker CT6 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:50,321 - INFO - [src.data_preparation] - Ticker CT6 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:50,323 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CT6
2025-05-19 23:18:50,323 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:50,323 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(95), np.int64(1): np.int64(368)}
2025-05-19 23:18:50,323 - INFO - [src.data_preparation] - Generating 273 synthetic minority samples
2025-05-19 23:18:50,332 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (736, 13, 15), y shape: (736,)
2025-05-19 23:18:50,332 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(368), np.int64(1): np.int64(368)}
2025-05-19 23:18:50,337 - INFO - [src.data_preparation] - Ticker CT6 - Final 3D shapes: X_train=(736, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:50,337 - INFO - [__main__] - Using best model for CT6: logistic_regression (F1: 0.3684)
2025-05-19 23:18:50,337 - INFO - [__main__] - Loading logistic_regression model for CT6...
2025-05-19 23:18:50,338 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:50,338 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:50,338 - INFO - [__main__] - Making predictions for CT6 using logistic_regression
2025-05-19 23:18:50,339 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:50,339 - INFO - [__main__] - Successfully got last prediction for CT6
2025-05-19 23:18:50,339 - INFO - [__main__] - 
Processing ticker: CTA
2025-05-19 23:18:50,339 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:50,339 - INFO - [__main__] - Getting last prediction point for ticker: CTA
2025-05-19 23:18:50,340 - INFO - [__main__] - ==================================================
2025-05-19 23:18:50,340 - INFO - [__main__] - Preparing test data for CTA...
2025-05-19 23:18:50,368 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:50,368 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:50,368 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:50,387 - INFO - [src.data_preparation] - Ticker CTA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:50,387 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(146), np.int64(1): np.int64(493)}
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] - Ticker CTA - Selected features:
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   vnipc_t: 0.0936
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   ma14_t: 0.0828
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   ma21_t: 0.0764
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   ma7_t: 0.0737
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   Median_HL: 0.0680
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   TVV: 0.0666
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   PM: 0.0648
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   insec_t: 0.0625
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   s_d7_t: 0.0595
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   ATR: 0.0585
2025-05-19 23:18:50,585 - INFO - [src.data_preparation] -   Volatility: 0.0565
2025-05-19 23:18:50,586 - INFO - [src.data_preparation] -   SK: 0.0486
2025-05-19 23:18:50,586 - INFO - [src.data_preparation] -   variation_t: 0.0419
2025-05-19 23:18:50,586 - INFO - [src.data_preparation] -   ret: 0.0375
2025-05-19 23:18:50,586 - INFO - [src.data_preparation] -   HL: 0.0313
2025-05-19 23:18:50,588 - INFO - [src.data_preparation] - Ticker CTA - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'ma7_t', 'Median_HL', 'TVV', 'PM', 'insec_t', 's_d7_t', 'ATR', 'Volatility', 'SK', 'variation_t', 'ret', 'HL']
2025-05-19 23:18:50,675 - INFO - [src.data_preparation] - Ticker CTA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:50,675 - INFO - [src.data_preparation] - Ticker CTA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:50,676 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTA
2025-05-19 23:18:50,676 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:50,676 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(123), np.int64(1): np.int64(340)}
2025-05-19 23:18:50,676 - INFO - [src.data_preparation] - Generating 217 synthetic minority samples
2025-05-19 23:18:50,684 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (680, 13, 15), y shape: (680,)
2025-05-19 23:18:50,684 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(340), np.int64(1): np.int64(340)}
2025-05-19 23:18:50,688 - INFO - [src.data_preparation] - Ticker CTA - Final 3D shapes: X_train=(680, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:50,688 - INFO - [__main__] - Using best model for CTA: lstm (F1: 0.9885)
2025-05-19 23:18:50,688 - INFO - [__main__] - Loading lstm model for CTA...
2025-05-19 23:18:50,692 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:50,694 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:18:50,694 - INFO - [__main__] - Making predictions for CTA using lstm
2025-05-19 23:18:50,696 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:50,696 - INFO - [__main__] - Successfully got last prediction for CTA
2025-05-19 23:18:50,697 - INFO - [__main__] - 
Processing ticker: CTB
2025-05-19 23:18:50,697 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:50,697 - INFO - [__main__] - Getting last prediction point for ticker: CTB
2025-05-19 23:18:50,697 - INFO - [__main__] - ==================================================
2025-05-19 23:18:50,697 - INFO - [__main__] - Preparing test data for CTB...
2025-05-19 23:18:50,724 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:50,724 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:50,724 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:50,750 - INFO - [src.data_preparation] - Ticker CTB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:50,751 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(220), np.int64(1): np.int64(419)}
2025-05-19 23:18:51,068 - INFO - [src.data_preparation] - Ticker CTB - Selected features:
2025-05-19 23:18:51,068 - INFO - [src.data_preparation] -   vnipc_t: 0.0901
2025-05-19 23:18:51,068 - INFO - [src.data_preparation] -   TVV: 0.0786
2025-05-19 23:18:51,068 - INFO - [src.data_preparation] -   ATR: 0.0717
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   Median_HL: 0.0667
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   SK: 0.0626
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   ma14_t: 0.0607
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   PM: 0.0598
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   ma7_t: 0.0593
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   Volatility: 0.0587
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   ma21_t: 0.0567
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   insec_t: 0.0528
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   HL: 0.0484
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   ret: 0.0430
2025-05-19 23:18:51,069 - INFO - [src.data_preparation] -   variation_t: 0.0420
2025-05-19 23:18:51,072 - INFO - [src.data_preparation] - Ticker CTB - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'Median_HL', 's_d7_t', 'SK', 'ma14_t', 'PM', 'ma7_t', 'Volatility', 'ma21_t', 'insec_t', 'HL', 'ret', 'variation_t']
2025-05-19 23:18:51,152 - INFO - [src.data_preparation] - Ticker CTB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:51,152 - INFO - [src.data_preparation] - Ticker CTB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:51,154 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTB
2025-05-19 23:18:51,154 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:51,154 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(151), np.int64(1): np.int64(312)}
2025-05-19 23:18:51,154 - INFO - [src.data_preparation] - Generating 161 synthetic minority samples
2025-05-19 23:18:51,161 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (624, 13, 15), y shape: (624,)
2025-05-19 23:18:51,161 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(312), np.int64(1): np.int64(312)}
2025-05-19 23:18:51,164 - INFO - [src.data_preparation] - Ticker CTB - Final 3D shapes: X_train=(624, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:51,164 - INFO - [__main__] - Using best model for CTB: svm (F1: 0.7059)
2025-05-19 23:18:51,164 - INFO - [__main__] - Loading svm model for CTB...
2025-05-19 23:18:51,165 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:51,166 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:18:51,166 - INFO - [__main__] - Making predictions for CTB using svm
2025-05-19 23:18:51,167 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:51,167 - INFO - [__main__] - Successfully got last prediction for CTB
2025-05-19 23:18:51,167 - INFO - [__main__] - 
Processing ticker: CTD
2025-05-19 23:18:51,167 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:51,167 - INFO - [__main__] - Getting last prediction point for ticker: CTD
2025-05-19 23:18:51,167 - INFO - [__main__] - ==================================================
2025-05-19 23:18:51,167 - INFO - [__main__] - Preparing test data for CTD...
2025-05-19 23:18:51,194 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:51,194 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:51,194 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:51,212 - INFO - [src.data_preparation] - Ticker CTD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:51,212 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] - Ticker CTD - Selected features:
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   SK: 0.0772
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   s_d7_t: 0.0704
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   HL: 0.0695
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   vnipc_t: 0.0662
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   TVV: 0.0658
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   insec_t: 0.0650
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   ATR: 0.0610
2025-05-19 23:18:51,504 - INFO - [src.data_preparation] -   Volatility: 0.0580
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   SR: 0.0541
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   ma14_t: 0.0522
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   ma21_t: 0.0500
2025-05-19 23:18:51,505 - INFO - [src.data_preparation] -   Median_HL: 0.0484
2025-05-19 23:18:51,507 - INFO - [src.data_preparation] - Ticker CTD - Using features: ['Date', 'SK', 's_d7_t', 'HL', 'vnipc_t', 'TVV', 'insec_t', 'ATR', 'Volatility', 'ret', 'SR', 'PM', 'ma14_t', 'variation_t', 'ma21_t', 'Median_HL']
2025-05-19 23:18:51,585 - INFO - [src.data_preparation] - Ticker CTD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:51,585 - INFO - [src.data_preparation] - Ticker CTD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:51,587 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTD
2025-05-19 23:18:51,587 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:51,587 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:18:51,587 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:18:51,589 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:18:51,589 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:18:51,592 - INFO - [src.data_preparation] - Ticker CTD - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:51,592 - INFO - [__main__] - Using best model for CTD: svm (F1: 0.7059)
2025-05-19 23:18:51,592 - INFO - [__main__] - Loading svm model for CTD...
2025-05-19 23:18:51,593 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:51,594 - INFO - [__main__] - Model size: 0.76 MB
2025-05-19 23:18:51,594 - INFO - [__main__] - Making predictions for CTD using svm
2025-05-19 23:18:51,594 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:51,595 - INFO - [__main__] - Successfully got last prediction for CTD
2025-05-19 23:18:51,595 - INFO - [__main__] - 
Processing ticker: CTG
2025-05-19 23:18:51,595 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:51,595 - INFO - [__main__] - Getting last prediction point for ticker: CTG
2025-05-19 23:18:51,595 - INFO - [__main__] - ==================================================
2025-05-19 23:18:51,595 - INFO - [__main__] - Preparing test data for CTG...
2025-05-19 23:18:51,627 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:51,627 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:51,627 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:51,645 - INFO - [src.data_preparation] - Ticker CTG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:51,645 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(309), np.int64(1): np.int64(330)}
2025-05-19 23:18:51,958 - INFO - [src.data_preparation] - Ticker CTG - Selected features:
2025-05-19 23:18:51,958 - INFO - [src.data_preparation] -   SK: 0.0734
2025-05-19 23:18:51,958 - INFO - [src.data_preparation] -   Volatility: 0.0708
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   TVV: 0.0703
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   vnipc_t: 0.0696
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   insec_t: 0.0690
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   variation_t: 0.0657
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   ret: 0.0611
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   s_d7_t: 0.0608
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   HL: 0.0590
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   ATR: 0.0568
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   LO: 0.0540
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   ma7_t: 0.0497
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   SR: 0.0487
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   ma14_t: 0.0478
2025-05-19 23:18:51,959 - INFO - [src.data_preparation] -   PM: 0.0463
2025-05-19 23:18:51,962 - INFO - [src.data_preparation] - Ticker CTG - Using features: ['Date', 'SK', 'Volatility', 'TVV', 'vnipc_t', 'insec_t', 'variation_t', 'ret', 's_d7_t', 'HL', 'ATR', 'LO', 'ma7_t', 'SR', 'ma14_t', 'PM']
2025-05-19 23:18:52,061 - INFO - [src.data_preparation] - Ticker CTG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:52,062 - INFO - [src.data_preparation] - Ticker CTG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:52,063 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTG
2025-05-19 23:18:52,063 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:52,063 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:18:52,063 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:18:52,065 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:18:52,065 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:18:52,068 - INFO - [src.data_preparation] - Ticker CTG - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:52,068 - INFO - [__main__] - Using best model for CTG: transformer (F1: 0.5882)
2025-05-19 23:18:52,068 - INFO - [__main__] - Loading transformer model for CTG...
2025-05-19 23:18:52,078 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:52,081 - INFO - [__main__] - Model size: 0.24 MB
2025-05-19 23:18:52,081 - INFO - [__main__] - Making predictions for CTG using transformer
2025-05-19 23:18:52,083 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:52,083 - INFO - [__main__] - Successfully got last prediction for CTG
2025-05-19 23:18:52,083 - INFO - [__main__] - 
Processing ticker: CTI
2025-05-19 23:18:52,083 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:52,083 - INFO - [__main__] - Getting last prediction point for ticker: CTI
2025-05-19 23:18:52,083 - INFO - [__main__] - ==================================================
2025-05-19 23:18:52,084 - INFO - [__main__] - Preparing test data for CTI...
2025-05-19 23:18:52,129 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:52,129 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:52,129 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:52,159 - INFO - [src.data_preparation] - Ticker CTI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:52,160 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:18:52,491 - INFO - [src.data_preparation] - Ticker CTI - Selected features:
2025-05-19 23:18:52,491 - INFO - [src.data_preparation] -   vnipc_t: 0.0722
2025-05-19 23:18:52,491 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   insec_t: 0.0650
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   SK: 0.0647
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   s_d7_t: 0.0625
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   ret: 0.0610
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   Volatility: 0.0601
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   SR: 0.0593
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   HL: 0.0571
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   LO: 0.0569
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   variation_t: 0.0568
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   ma7_t: 0.0567
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   ATR: 0.0555
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   ma14_t: 0.0529
2025-05-19 23:18:52,492 - INFO - [src.data_preparation] -   Median_HL: 0.0526
2025-05-19 23:18:52,494 - INFO - [src.data_preparation] - Ticker CTI - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'SK', 's_d7_t', 'ret', 'Volatility', 'SR', 'HL', 'LO', 'variation_t', 'ma7_t', 'ATR', 'ma14_t', 'Median_HL']
2025-05-19 23:18:52,573 - INFO - [src.data_preparation] - Ticker CTI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:52,573 - INFO - [src.data_preparation] - Ticker CTI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:52,575 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTI
2025-05-19 23:18:52,575 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:52,575 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(217), np.int64(1): np.int64(246)}
2025-05-19 23:18:52,575 - INFO - [src.data_preparation] - Generating 29 synthetic minority samples
2025-05-19 23:18:52,576 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (492, 13, 15), y shape: (492,)
2025-05-19 23:18:52,577 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(246), np.int64(1): np.int64(246)}
2025-05-19 23:18:52,579 - INFO - [src.data_preparation] - Ticker CTI - Final 3D shapes: X_train=(492, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:52,579 - INFO - [__main__] - Using best model for CTI: svm (F1: 0.5238)
2025-05-19 23:18:52,579 - INFO - [__main__] - Loading svm model for CTI...
2025-05-19 23:18:52,581 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:52,581 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:18:52,581 - INFO - [__main__] - Making predictions for CTI using svm
2025-05-19 23:18:52,581 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:52,582 - INFO - [__main__] - Successfully got last prediction for CTI
2025-05-19 23:18:52,582 - INFO - [__main__] - 
Processing ticker: CTN
2025-05-19 23:18:52,582 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:52,582 - INFO - [__main__] - Getting last prediction point for ticker: CTN
2025-05-19 23:18:52,582 - INFO - [__main__] - ==================================================
2025-05-19 23:18:52,582 - INFO - [__main__] - Preparing test data for CTN...
2025-05-19 23:18:52,609 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:52,609 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:52,609 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:52,627 - INFO - [src.data_preparation] - Ticker CTN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:52,627 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(130), np.int64(1): np.int64(509)}
2025-05-19 23:18:52,836 - INFO - [src.data_preparation] - Ticker CTN - Selected features:
2025-05-19 23:18:52,836 - INFO - [src.data_preparation] -   vnipc_t: 0.1126
2025-05-19 23:18:52,836 - INFO - [src.data_preparation] -   ma14_t: 0.0955
2025-05-19 23:18:52,836 - INFO - [src.data_preparation] -   ma21_t: 0.0953
2025-05-19 23:18:52,836 - INFO - [src.data_preparation] -   TVV: 0.0768
2025-05-19 23:18:52,836 - INFO - [src.data_preparation] -   ma7_t: 0.0694
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   s_d7_t: 0.0657
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   Volatility: 0.0607
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   ATR: 0.0516
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   PM: 0.0515
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   SK: 0.0508
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   insec_t: 0.0486
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   ret: 0.0377
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   variation_t: 0.0341
2025-05-19 23:18:52,837 - INFO - [src.data_preparation] -   SR: 0.0302
2025-05-19 23:18:52,839 - INFO - [src.data_preparation] - Ticker CTN - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'TVV', 'ma7_t', 's_d7_t', 'Volatility', 'Median_HL', 'ATR', 'PM', 'SK', 'insec_t', 'ret', 'variation_t', 'SR']
2025-05-19 23:18:52,924 - INFO - [src.data_preparation] - Ticker CTN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:52,924 - INFO - [src.data_preparation] - Ticker CTN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:52,926 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTN
2025-05-19 23:18:52,926 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:52,926 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(97), np.int64(1): np.int64(366)}
2025-05-19 23:18:52,926 - INFO - [src.data_preparation] - Generating 269 synthetic minority samples
2025-05-19 23:18:52,935 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (732, 13, 15), y shape: (732,)
2025-05-19 23:18:52,935 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(366), np.int64(1): np.int64(366)}
2025-05-19 23:18:52,939 - INFO - [src.data_preparation] - Ticker CTN - Final 3D shapes: X_train=(732, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:52,940 - INFO - [__main__] - Using best model for CTN: lstm (F1: 0.9885)
2025-05-19 23:18:52,940 - INFO - [__main__] - Loading lstm model for CTN...
2025-05-19 23:18:52,943 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:52,944 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:18:52,944 - INFO - [__main__] - Making predictions for CTN using lstm
2025-05-19 23:18:52,947 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:52,947 - INFO - [__main__] - Successfully got last prediction for CTN
2025-05-19 23:18:52,948 - INFO - [__main__] - 
Processing ticker: CTS
2025-05-19 23:18:52,948 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:52,948 - INFO - [__main__] - Getting last prediction point for ticker: CTS
2025-05-19 23:18:52,948 - INFO - [__main__] - ==================================================
2025-05-19 23:18:52,948 - INFO - [__main__] - Preparing test data for CTS...
2025-05-19 23:18:52,977 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:52,977 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:52,977 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:52,996 - INFO - [src.data_preparation] - Ticker CTS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:52,997 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:18:53,329 - INFO - [src.data_preparation] - Ticker CTS - Selected features:
2025-05-19 23:18:53,329 - INFO - [src.data_preparation] -   TVV: 0.0731
2025-05-19 23:18:53,329 - INFO - [src.data_preparation] -   s_d7_t: 0.0706
2025-05-19 23:18:53,329 - INFO - [src.data_preparation] -   Volatility: 0.0677
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   LO: 0.0648
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   ma14_t: 0.0635
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   SK: 0.0615
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   insec_t: 0.0606
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   vnipc_t: 0.0589
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   ma21_t: 0.0589
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:18:53,330 - INFO - [src.data_preparation] -   Median_HL: 0.0557
2025-05-19 23:18:53,331 - INFO - [src.data_preparation] -   ma7_t: 0.0550
2025-05-19 23:18:53,331 - INFO - [src.data_preparation] -   HL: 0.0535
2025-05-19 23:18:53,331 - INFO - [src.data_preparation] -   PM: 0.0514
2025-05-19 23:18:53,331 - INFO - [src.data_preparation] -   ret: 0.0498
2025-05-19 23:18:53,335 - INFO - [src.data_preparation] - Ticker CTS - Using features: ['Date', 'TVV', 's_d7_t', 'Volatility', 'LO', 'ma14_t', 'SK', 'insec_t', 'vnipc_t', 'ma21_t', 'ATR', 'Median_HL', 'ma7_t', 'HL', 'PM', 'ret']
2025-05-19 23:18:53,424 - INFO - [src.data_preparation] - Ticker CTS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:53,424 - INFO - [src.data_preparation] - Ticker CTS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:53,426 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTS
2025-05-19 23:18:53,426 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:53,426 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:18:53,426 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:18:53,429 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:18:53,429 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:18:53,432 - INFO - [src.data_preparation] - Ticker CTS - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:53,432 - INFO - [__main__] - Using best model for CTS: lstm (F1: 0.6866)
2025-05-19 23:18:53,432 - INFO - [__main__] - Loading lstm model for CTS...
2025-05-19 23:18:53,435 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:53,436 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:18:53,436 - INFO - [__main__] - Making predictions for CTS using lstm
2025-05-19 23:18:53,438 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:53,438 - INFO - [__main__] - Successfully got last prediction for CTS
2025-05-19 23:18:53,438 - INFO - [__main__] - 
Processing ticker: CTX
2025-05-19 23:18:53,438 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:53,438 - INFO - [__main__] - Getting last prediction point for ticker: CTX
2025-05-19 23:18:53,438 - INFO - [__main__] - ==================================================
2025-05-19 23:18:53,438 - INFO - [__main__] - Preparing test data for CTX...
2025-05-19 23:18:53,470 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:53,471 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:53,471 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:53,489 - INFO - [src.data_preparation] - Ticker CTX - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:53,489 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(203), np.int64(1): np.int64(435)}
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] - Ticker CTX - Selected features:
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   ATR: 0.0998
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   TVV: 0.0921
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   Volatility: 0.0744
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   s_d7_t: 0.0643
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   HL: 0.0634
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   SK: 0.0625
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   vnipc_t: 0.0587
2025-05-19 23:18:53,774 - INFO - [src.data_preparation] -   ma21_t: 0.0559
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   ma7_t: 0.0536
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   PM: 0.0496
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   insec_t: 0.0494
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   ma14_t: 0.0478
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   Median_HL: 0.0474
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   ret: 0.0462
2025-05-19 23:18:53,775 - INFO - [src.data_preparation] -   SR: 0.0425
2025-05-19 23:18:53,777 - INFO - [src.data_preparation] - Ticker CTX - Using features: ['Date', 'ATR', 'TVV', 'Volatility', 's_d7_t', 'HL', 'SK', 'vnipc_t', 'ma21_t', 'ma7_t', 'PM', 'insec_t', 'ma14_t', 'Median_HL', 'ret', 'SR']
2025-05-19 23:18:53,857 - INFO - [src.data_preparation] - Ticker CTX - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:18:53,857 - INFO - [src.data_preparation] - Ticker CTX - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:53,858 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CTX
2025-05-19 23:18:53,858 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:53,858 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(274)}
2025-05-19 23:18:53,859 - INFO - [src.data_preparation] - Generating 85 synthetic minority samples
2025-05-19 23:18:53,863 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (548, 13, 15), y shape: (548,)
2025-05-19 23:18:53,863 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(274), np.int64(1): np.int64(274)}
2025-05-19 23:18:53,868 - INFO - [src.data_preparation] - Ticker CTX - Final 3D shapes: X_train=(548, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:53,868 - INFO - [__main__] - Using best model for CTX: svm (F1: 0.9885)
2025-05-19 23:18:53,868 - INFO - [__main__] - Loading svm model for CTX...
2025-05-19 23:18:53,870 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:53,870 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:18:53,871 - INFO - [__main__] - Making predictions for CTX using svm
2025-05-19 23:18:53,871 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:53,871 - INFO - [__main__] - Successfully got last prediction for CTX
2025-05-19 23:18:53,872 - INFO - [__main__] - 
Processing ticker: CVN
2025-05-19 23:18:53,872 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:53,872 - INFO - [__main__] - Getting last prediction point for ticker: CVN
2025-05-19 23:18:53,872 - INFO - [__main__] - ==================================================
2025-05-19 23:18:53,872 - INFO - [__main__] - Preparing test data for CVN...
2025-05-19 23:18:53,899 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:53,899 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:53,899 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:53,918 - INFO - [src.data_preparation] - Ticker CVN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:53,918 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(366)}
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] - Ticker CVN - Selected features:
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   vnipc_t: 0.0835
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   SK: 0.0795
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   s_d7_t: 0.0751
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   ATR: 0.0694
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   Volatility: 0.0632
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:18:54,188 - INFO - [src.data_preparation] -   insec_t: 0.0593
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   ma21_t: 0.0576
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   ma7_t: 0.0556
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   HL: 0.0539
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   Median_HL: 0.0538
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   ma14_t: 0.0532
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   PM: 0.0495
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   variation_t: 0.0494
2025-05-19 23:18:54,189 - INFO - [src.data_preparation] -   ret: 0.0485
2025-05-19 23:18:54,191 - INFO - [src.data_preparation] - Ticker CVN - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'ATR', 'Volatility', 'TVV', 'insec_t', 'ma21_t', 'ma7_t', 'HL', 'Median_HL', 'ma14_t', 'PM', 'variation_t', 'ret']
2025-05-19 23:18:54,296 - INFO - [src.data_preparation] - Ticker CVN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:54,296 - INFO - [src.data_preparation] - Ticker CVN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:54,297 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CVN
2025-05-19 23:18:54,297 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:54,297 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(259)}
2025-05-19 23:18:54,298 - INFO - [src.data_preparation] - Generating 55 synthetic minority samples
2025-05-19 23:18:54,301 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:18:54,301 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:18:54,304 - INFO - [src.data_preparation] - Ticker CVN - Final 3D shapes: X_train=(518, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:54,305 - INFO - [__main__] - Using best model for CVN: svm (F1: 0.9268)
2025-05-19 23:18:54,305 - INFO - [__main__] - Loading svm model for CVN...
2025-05-19 23:18:54,306 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:54,307 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:18:54,307 - INFO - [__main__] - Making predictions for CVN using svm
2025-05-19 23:18:54,308 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:54,308 - INFO - [__main__] - Successfully got last prediction for CVN
2025-05-19 23:18:54,308 - INFO - [__main__] - 
Processing ticker: CVT
2025-05-19 23:18:54,308 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:54,308 - INFO - [__main__] - Getting last prediction point for ticker: CVT
2025-05-19 23:18:54,308 - INFO - [__main__] - ==================================================
2025-05-19 23:18:54,308 - INFO - [__main__] - Preparing test data for CVT...
2025-05-19 23:18:54,338 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:54,339 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:54,339 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:54,362 - INFO - [src.data_preparation] - Ticker CVT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:54,362 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:18:54,681 - INFO - [src.data_preparation] - Ticker CVT - Selected features:
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   insec_t: 0.0688
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   s_d7_t: 0.0663
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   TVV: 0.0655
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   SK: 0.0640
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   SR: 0.0632
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   ATR: 0.0624
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   ma14_t: 0.0578
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   variation_t: 0.0559
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   PM: 0.0556
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   HL: 0.0549
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   ret: 0.0544
2025-05-19 23:18:54,682 - INFO - [src.data_preparation] -   ma7_t: 0.0510
2025-05-19 23:18:54,683 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:18:54,685 - INFO - [src.data_preparation] - Ticker CVT - Using features: ['Date', 'insec_t', 'vnipc_t', 's_d7_t', 'TVV', 'Volatility', 'SK', 'SR', 'ATR', 'ma14_t', 'variation_t', 'PM', 'HL', 'ret', 'ma7_t', 'Median_HL']
2025-05-19 23:18:54,766 - INFO - [src.data_preparation] - Ticker CVT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:54,766 - INFO - [src.data_preparation] - Ticker CVT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:54,768 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CVT
2025-05-19 23:18:54,768 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:54,768 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:18:54,768 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:18:54,770 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:18:54,770 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:18:54,773 - INFO - [src.data_preparation] - Ticker CVT - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:54,773 - INFO - [__main__] - Using best model for CVT: logistic_regression (F1: 0.7761)
2025-05-19 23:18:54,773 - INFO - [__main__] - Loading logistic_regression model for CVT...
2025-05-19 23:18:54,774 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:54,774 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:18:54,774 - INFO - [__main__] - Making predictions for CVT using logistic_regression
2025-05-19 23:18:54,774 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:54,775 - INFO - [__main__] - Successfully got last prediction for CVT
2025-05-19 23:18:54,775 - INFO - [__main__] - 
Processing ticker: CX8
2025-05-19 23:18:54,775 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:54,775 - INFO - [__main__] - Getting last prediction point for ticker: CX8
2025-05-19 23:18:54,775 - INFO - [__main__] - ==================================================
2025-05-19 23:18:54,775 - INFO - [__main__] - Preparing test data for CX8...
2025-05-19 23:18:54,802 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:54,802 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:54,802 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:54,822 - INFO - [src.data_preparation] - Ticker CX8 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:54,822 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(188), np.int64(1): np.int64(451)}
2025-05-19 23:18:55,075 - INFO - [src.data_preparation] - Ticker CX8 - Selected features:
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   vnipc_t: 0.0854
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   Volatility: 0.0765
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   ATR: 0.0696
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   ma21_t: 0.0691
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   TVV: 0.0690
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   ma14_t: 0.0656
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   s_d7_t: 0.0636
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   insec_t: 0.0610
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   HL: 0.0599
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   SK: 0.0561
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   ma7_t: 0.0561
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   variation_t: 0.0492
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   PM: 0.0478
2025-05-19 23:18:55,076 - INFO - [src.data_preparation] -   ret: 0.0471
2025-05-19 23:18:55,077 - INFO - [src.data_preparation] -   Median_HL: 0.0470
2025-05-19 23:18:55,079 - INFO - [src.data_preparation] - Ticker CX8 - Using features: ['Date', 'vnipc_t', 'Volatility', 'ATR', 'ma21_t', 'TVV', 'ma14_t', 's_d7_t', 'insec_t', 'HL', 'SK', 'ma7_t', 'variation_t', 'PM', 'ret', 'Median_HL']
2025-05-19 23:18:55,156 - INFO - [src.data_preparation] - Ticker CX8 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:55,156 - INFO - [src.data_preparation] - Ticker CX8 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:55,158 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CX8
2025-05-19 23:18:55,158 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:55,158 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(121), np.int64(1): np.int64(342)}
2025-05-19 23:18:55,158 - INFO - [src.data_preparation] - Generating 221 synthetic minority samples
2025-05-19 23:18:55,166 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (684, 13, 15), y shape: (684,)
2025-05-19 23:18:55,166 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(342), np.int64(1): np.int64(342)}
2025-05-19 23:18:55,169 - INFO - [src.data_preparation] - Ticker CX8 - Final 3D shapes: X_train=(684, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:55,170 - INFO - [__main__] - Using best model for CX8: svm (F1: 0.7463)
2025-05-19 23:18:55,170 - INFO - [__main__] - Loading svm model for CX8...
2025-05-19 23:18:55,171 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:55,171 - INFO - [__main__] - Model size: 0.61 MB
2025-05-19 23:18:55,171 - INFO - [__main__] - Making predictions for CX8 using svm
2025-05-19 23:18:55,172 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:55,172 - INFO - [__main__] - Successfully got last prediction for CX8
2025-05-19 23:18:55,172 - INFO - [__main__] - 
Processing ticker: CYC
2025-05-19 23:18:55,172 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:55,172 - INFO - [__main__] - Getting last prediction point for ticker: CYC
2025-05-19 23:18:55,173 - INFO - [__main__] - ==================================================
2025-05-19 23:18:55,173 - INFO - [__main__] - Preparing test data for CYC...
2025-05-19 23:18:55,198 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:18:55,198 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:55,198 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:55,216 - INFO - [src.data_preparation] - Ticker CYC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:18:55,217 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(167), np.int64(1): np.int64(471)}
2025-05-19 23:18:55,444 - INFO - [src.data_preparation] - Ticker CYC - Selected features:
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   vnipc_t: 0.0908
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   TVV: 0.0794
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   Volatility: 0.0716
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   ma21_t: 0.0686
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   ATR: 0.0636
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   ma14_t: 0.0622
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   s_d7_t: 0.0617
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   insec_t: 0.0599
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   ma7_t: 0.0555
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   ret: 0.0501
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   MDD: 0.0487
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   Median_HL: 0.0468
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   variation_t: 0.0431
2025-05-19 23:18:55,445 - INFO - [src.data_preparation] -   PM: 0.0388
2025-05-19 23:18:55,448 - INFO - [src.data_preparation] - Ticker CYC - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'ma21_t', 'SK', 'ATR', 'ma14_t', 's_d7_t', 'insec_t', 'ma7_t', 'ret', 'MDD', 'Median_HL', 'variation_t', 'PM']
2025-05-19 23:18:55,524 - INFO - [src.data_preparation] - Ticker CYC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:55,524 - INFO - [src.data_preparation] - Ticker CYC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:55,526 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker CYC
2025-05-19 23:18:55,526 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:18:55,526 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(142), np.int64(1): np.int64(320)}
2025-05-19 23:18:55,526 - INFO - [src.data_preparation] - Generating 178 synthetic minority samples
2025-05-19 23:18:55,534 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (640, 13, 15), y shape: (640,)
2025-05-19 23:18:55,534 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(320), np.int64(1): np.int64(320)}
2025-05-19 23:18:55,537 - INFO - [src.data_preparation] - Ticker CYC - Final 3D shapes: X_train=(640, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:55,537 - INFO - [__main__] - Using best model for CYC: svm (F1: 0.9268)
2025-05-19 23:18:55,537 - INFO - [__main__] - Loading svm model for CYC...
2025-05-19 23:18:55,538 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:55,539 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:18:55,539 - INFO - [__main__] - Making predictions for CYC using svm
2025-05-19 23:18:55,540 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:55,540 - INFO - [__main__] - Successfully got last prediction for CYC
2025-05-19 23:18:55,540 - INFO - [__main__] - 
Processing ticker: D11
2025-05-19 23:18:55,540 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:55,540 - INFO - [__main__] - Getting last prediction point for ticker: D11
2025-05-19 23:18:55,540 - INFO - [__main__] - ==================================================
2025-05-19 23:18:55,540 - INFO - [__main__] - Preparing test data for D11...
2025-05-19 23:18:55,564 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:55,564 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:55,564 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:55,581 - INFO - [src.data_preparation] - Ticker D11 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:55,581 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(253), np.int64(1): np.int64(386)}
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] - Ticker D11 - Selected features:
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   vnipc_t: 0.0919
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   s_d7_t: 0.0655
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   insec_t: 0.0642
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   SK: 0.0635
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   ATR: 0.0635
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   ma14_t: 0.0614
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   TVV: 0.0613
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   Volatility: 0.0599
2025-05-19 23:18:55,849 - INFO - [src.data_preparation] -   Median_HL: 0.0577
2025-05-19 23:18:55,850 - INFO - [src.data_preparation] -   ma21_t: 0.0561
2025-05-19 23:18:55,850 - INFO - [src.data_preparation] -   HL: 0.0551
2025-05-19 23:18:55,850 - INFO - [src.data_preparation] -   ma7_t: 0.0550
2025-05-19 23:18:55,850 - INFO - [src.data_preparation] -   PM: 0.0538
2025-05-19 23:18:55,850 - INFO - [src.data_preparation] -   ret: 0.0519
2025-05-19 23:18:55,850 - INFO - [src.data_preparation] -   SR: 0.0515
2025-05-19 23:18:55,852 - INFO - [src.data_preparation] - Ticker D11 - Using features: ['Date', 'vnipc_t', 's_d7_t', 'insec_t', 'SK', 'ATR', 'ma14_t', 'TVV', 'Volatility', 'Median_HL', 'ma21_t', 'HL', 'ma7_t', 'PM', 'ret', 'SR']
2025-05-19 23:18:55,941 - INFO - [src.data_preparation] - Ticker D11 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:55,941 - INFO - [src.data_preparation] - Ticker D11 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:55,942 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker D11
2025-05-19 23:18:55,942 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:55,942 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:18:55,942 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:18:55,947 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:18:55,947 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:18:55,950 - INFO - [src.data_preparation] - Ticker D11 - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:55,951 - INFO - [__main__] - Using best model for D11: lstm (F1: 0.6667)
2025-05-19 23:18:55,951 - INFO - [__main__] - Loading lstm model for D11...
2025-05-19 23:18:55,954 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:55,955 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:18:55,955 - INFO - [__main__] - Making predictions for D11 using lstm
2025-05-19 23:18:55,956 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:55,957 - INFO - [__main__] - Successfully got last prediction for D11
2025-05-19 23:18:55,957 - INFO - [__main__] - 
Processing ticker: D2D
2025-05-19 23:18:55,957 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:55,957 - INFO - [__main__] - Getting last prediction point for ticker: D2D
2025-05-19 23:18:55,957 - INFO - [__main__] - ==================================================
2025-05-19 23:18:55,957 - INFO - [__main__] - Preparing test data for D2D...
2025-05-19 23:18:55,990 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:55,990 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:55,990 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:56,008 - INFO - [src.data_preparation] - Ticker D2D - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:56,008 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:18:56,325 - INFO - [src.data_preparation] - Ticker D2D - Selected features:
2025-05-19 23:18:56,325 - INFO - [src.data_preparation] -   insec_t: 0.0792
2025-05-19 23:18:56,325 - INFO - [src.data_preparation] -   Volatility: 0.0741
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   vnipc_t: 0.0689
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   SK: 0.0658
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   TVV: 0.0641
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   HL: 0.0636
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   s_d7_t: 0.0582
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   SR: 0.0579
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   LO: 0.0557
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   PM: 0.0537
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   ma14_t: 0.0529
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   variation_t: 0.0507
2025-05-19 23:18:56,326 - INFO - [src.data_preparation] -   ma7_t: 0.0500
2025-05-19 23:18:56,329 - INFO - [src.data_preparation] - Ticker D2D - Using features: ['Date', 'insec_t', 'Volatility', 'vnipc_t', 'SK', 'TVV', 'HL', 's_d7_t', 'SR', 'ATR', 'LO', 'Median_HL', 'PM', 'ma14_t', 'variation_t', 'ma7_t']
2025-05-19 23:18:56,416 - INFO - [src.data_preparation] - Ticker D2D - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:56,417 - INFO - [src.data_preparation] - Ticker D2D - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:56,418 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker D2D
2025-05-19 23:18:56,418 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:56,418 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:18:56,418 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:18:56,421 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:18:56,421 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:18:56,425 - INFO - [src.data_preparation] - Ticker D2D - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:56,425 - INFO - [__main__] - Using best model for D2D: svm (F1: 0.4118)
2025-05-19 23:18:56,425 - INFO - [__main__] - Loading svm model for D2D...
2025-05-19 23:18:56,426 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:56,427 - INFO - [__main__] - Model size: 0.60 MB
2025-05-19 23:18:56,427 - INFO - [__main__] - Making predictions for D2D using svm
2025-05-19 23:18:56,427 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:56,428 - INFO - [__main__] - Successfully got last prediction for D2D
2025-05-19 23:18:56,428 - INFO - [__main__] - 
Processing ticker: DAC
2025-05-19 23:18:56,428 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:56,428 - INFO - [__main__] - Getting last prediction point for ticker: DAC
2025-05-19 23:18:56,428 - INFO - [__main__] - ==================================================
2025-05-19 23:18:56,428 - INFO - [__main__] - Preparing test data for DAC...
2025-05-19 23:18:56,459 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:56,459 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:56,459 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:56,478 - INFO - [src.data_preparation] - Ticker DAC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:56,479 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(79), np.int64(1): np.int64(560)}
2025-05-19 23:18:56,733 - INFO - [src.data_preparation] - Ticker DAC - Selected features:
2025-05-19 23:18:56,733 - INFO - [src.data_preparation] -   vnipc_t: 0.1527
2025-05-19 23:18:56,733 - INFO - [src.data_preparation] -   ma21_t: 0.1103
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   ma14_t: 0.0840
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   Volatility: 0.0822
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   ma7_t: 0.0770
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   s_d7_t: 0.0709
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   TVV: 0.0703
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   ATR: 0.0545
2025-05-19 23:18:56,734 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:18:56,735 - INFO - [src.data_preparation] -   PM: 0.0510
2025-05-19 23:18:56,735 - INFO - [src.data_preparation] -   insec_t: 0.0369
2025-05-19 23:18:56,735 - INFO - [src.data_preparation] -   SK: 0.0360
2025-05-19 23:18:56,735 - INFO - [src.data_preparation] -   HL: 0.0284
2025-05-19 23:18:56,735 - INFO - [src.data_preparation] -   variation_t: 0.0229
2025-05-19 23:18:56,735 - INFO - [src.data_preparation] -   SR: 0.0207
2025-05-19 23:18:56,738 - INFO - [src.data_preparation] - Ticker DAC - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'Volatility', 'ma7_t', 's_d7_t', 'TVV', 'ATR', 'Median_HL', 'PM', 'insec_t', 'SK', 'HL', 'variation_t', 'SR']
2025-05-19 23:18:56,833 - INFO - [src.data_preparation] - Ticker DAC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:56,833 - INFO - [src.data_preparation] - Ticker DAC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:56,834 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DAC
2025-05-19 23:18:56,835 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:56,835 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(67), np.int64(1): np.int64(396)}
2025-05-19 23:18:56,835 - INFO - [src.data_preparation] - Generating 329 synthetic minority samples
2025-05-19 23:18:56,848 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (792, 13, 15), y shape: (792,)
2025-05-19 23:18:56,848 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(396), np.int64(1): np.int64(396)}
2025-05-19 23:18:56,856 - INFO - [src.data_preparation] - Ticker DAC - Final 3D shapes: X_train=(792, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:56,856 - INFO - [__main__] - Using best model for DAC: lstm (F1: 0.7945)
2025-05-19 23:18:56,856 - INFO - [__main__] - Loading lstm model for DAC...
2025-05-19 23:18:56,861 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:56,864 - INFO - [__main__] - Model size: 0.26 MB
2025-05-19 23:18:56,865 - INFO - [__main__] - Making predictions for DAC using lstm
2025-05-19 23:18:56,868 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:56,869 - INFO - [__main__] - Successfully got last prediction for DAC
2025-05-19 23:18:56,869 - INFO - [__main__] - 
Processing ticker: DAD
2025-05-19 23:18:56,869 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:56,869 - INFO - [__main__] - Getting last prediction point for ticker: DAD
2025-05-19 23:18:56,869 - INFO - [__main__] - ==================================================
2025-05-19 23:18:56,870 - INFO - [__main__] - Preparing test data for DAD...
2025-05-19 23:18:56,924 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:56,924 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:56,925 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:56,952 - INFO - [src.data_preparation] - Ticker DAD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:56,952 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:18:57,338 - INFO - [src.data_preparation] - Ticker DAD - Selected features:
2025-05-19 23:18:57,338 - INFO - [src.data_preparation] -   SK: 0.0768
2025-05-19 23:18:57,338 - INFO - [src.data_preparation] -   Volatility: 0.0763
2025-05-19 23:18:57,338 - INFO - [src.data_preparation] -   vnipc_t: 0.0719
2025-05-19 23:18:57,338 - INFO - [src.data_preparation] -   insec_t: 0.0652
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   ret: 0.0623
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   TVV: 0.0599
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   ATR: 0.0594
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   HL: 0.0587
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   s_d7_t: 0.0585
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   variation_t: 0.0581
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   SR: 0.0573
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   LO: 0.0528
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   ma7_t: 0.0488
2025-05-19 23:18:57,339 - INFO - [src.data_preparation] -   ma14_t: 0.0486
2025-05-19 23:18:57,342 - INFO - [src.data_preparation] - Ticker DAD - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'insec_t', 'ret', 'TVV', 'ATR', 'HL', 's_d7_t', 'variation_t', 'SR', 'LO', 'PM', 'ma7_t', 'ma14_t']
2025-05-19 23:18:57,426 - INFO - [src.data_preparation] - Ticker DAD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:57,427 - INFO - [src.data_preparation] - Ticker DAD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:57,428 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DAD
2025-05-19 23:18:57,428 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:57,428 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(186), np.int64(1): np.int64(277)}
2025-05-19 23:18:57,428 - INFO - [src.data_preparation] - Generating 91 synthetic minority samples
2025-05-19 23:18:57,433 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (554, 13, 15), y shape: (554,)
2025-05-19 23:18:57,433 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(277), np.int64(1): np.int64(277)}
2025-05-19 23:18:57,436 - INFO - [src.data_preparation] - Ticker DAD - Final 3D shapes: X_train=(554, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:57,436 - INFO - [__main__] - Using best model for DAD: svm (F1: 0.7429)
2025-05-19 23:18:57,436 - INFO - [__main__] - Loading svm model for DAD...
2025-05-19 23:18:57,437 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:57,437 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:18:57,437 - INFO - [__main__] - Making predictions for DAD using svm
2025-05-19 23:18:57,438 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:57,438 - INFO - [__main__] - Successfully got last prediction for DAD
2025-05-19 23:18:57,438 - INFO - [__main__] - 
Processing ticker: DAE
2025-05-19 23:18:57,438 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:57,438 - INFO - [__main__] - Getting last prediction point for ticker: DAE
2025-05-19 23:18:57,438 - INFO - [__main__] - ==================================================
2025-05-19 23:18:57,438 - INFO - [__main__] - Preparing test data for DAE...
2025-05-19 23:18:57,470 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:57,470 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:57,470 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:57,488 - INFO - [src.data_preparation] - Ticker DAE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:57,488 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(209), np.int64(1): np.int64(430)}
2025-05-19 23:18:57,768 - INFO - [src.data_preparation] - Ticker DAE - Selected features:
2025-05-19 23:18:57,768 - INFO - [src.data_preparation] -   vnipc_t: 0.0848
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   TVV: 0.0684
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   SK: 0.0664
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   s_d7_t: 0.0652
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   Volatility: 0.0650
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   ATR: 0.0649
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   ma21_t: 0.0620
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   ma14_t: 0.0617
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   ma7_t: 0.0550
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   insec_t: 0.0540
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   PM: 0.0520
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   Median_HL: 0.0516
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   ret: 0.0510
2025-05-19 23:18:57,769 - INFO - [src.data_preparation] -   SR: 0.0506
2025-05-19 23:18:57,772 - INFO - [src.data_preparation] - Ticker DAE - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 's_d7_t', 'Volatility', 'ATR', 'ma21_t', 'ma14_t', 'ma7_t', 'insec_t', 'PM', 'variation_t', 'Median_HL', 'ret', 'SR']
2025-05-19 23:18:57,874 - INFO - [src.data_preparation] - Ticker DAE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:57,874 - INFO - [src.data_preparation] - Ticker DAE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:57,876 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DAE
2025-05-19 23:18:57,876 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:57,876 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(154), np.int64(1): np.int64(309)}
2025-05-19 23:18:57,876 - INFO - [src.data_preparation] - Generating 155 synthetic minority samples
2025-05-19 23:18:57,885 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (618, 13, 15), y shape: (618,)
2025-05-19 23:18:57,885 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(309), np.int64(1): np.int64(309)}
2025-05-19 23:18:57,889 - INFO - [src.data_preparation] - Ticker DAE - Final 3D shapes: X_train=(618, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:57,889 - INFO - [__main__] - Using best model for DAE: transformer (F1: 0.8108)
2025-05-19 23:18:57,889 - INFO - [__main__] - Loading transformer model for DAE...
2025-05-19 23:18:57,904 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:18:57,907 - INFO - [__main__] - Model size: 0.20 MB
2025-05-19 23:18:57,907 - INFO - [__main__] - Making predictions for DAE using transformer
2025-05-19 23:18:57,910 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:57,910 - INFO - [__main__] - Successfully got last prediction for DAE
2025-05-19 23:18:57,911 - INFO - [__main__] - 
Processing ticker: DAG
2025-05-19 23:18:57,911 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:57,911 - INFO - [__main__] - Getting last prediction point for ticker: DAG
2025-05-19 23:18:57,911 - INFO - [__main__] - ==================================================
2025-05-19 23:18:57,911 - INFO - [__main__] - Preparing test data for DAG...
2025-05-19 23:18:57,967 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:57,967 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:57,967 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:58,000 - INFO - [src.data_preparation] - Ticker DAG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:58,001 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(303), np.int64(1): np.int64(336)}
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] - Ticker DAG - Selected features:
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   vnipc_t: 0.0793
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   SK: 0.0699
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   insec_t: 0.0690
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   ma14_t: 0.0676
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   Volatility: 0.0655
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   HL: 0.0611
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   ma21_t: 0.0566
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   ATR: 0.0560
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   Median_HL: 0.0553
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   s_d7_t: 0.0534
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   SR: 0.0481
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] -   variation_t: 0.0460
2025-05-19 23:18:58,405 - INFO - [src.data_preparation] - Ticker DAG - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'ma14_t', 'Volatility', 'TVV', 'HL', 'ma21_t', 'ATR', 'Median_HL', 'ma7_t', 's_d7_t', 'PM', 'SR', 'variation_t']
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Ticker DAG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Ticker DAG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DAG
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:18:58,531 - INFO - [src.data_preparation] - Ticker DAG - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:58,531 - INFO - [__main__] - Using best model for DAG: lstm (F1: 0.9136)
2025-05-19 23:18:58,531 - INFO - [__main__] - Loading lstm model for DAG...
2025-05-19 23:18:58,546 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:18:58,546 - INFO - [__main__] - Model size: 0.28 MB
2025-05-19 23:18:58,546 - INFO - [__main__] - Making predictions for DAG using lstm
2025-05-19 23:18:58,546 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:58,546 - INFO - [__main__] - Successfully got last prediction for DAG
2025-05-19 23:18:58,546 - INFO - [__main__] - 
Processing ticker: DBC
2025-05-19 23:18:58,546 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:58,546 - INFO - [__main__] - Getting last prediction point for ticker: DBC
2025-05-19 23:18:58,546 - INFO - [__main__] - ==================================================
2025-05-19 23:18:58,546 - INFO - [__main__] - Preparing test data for DBC...
2025-05-19 23:18:58,609 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:58,609 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:58,609 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:58,640 - INFO - [src.data_preparation] - Ticker DBC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:58,640 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(300), np.int64(1): np.int64(339)}
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] - Ticker DBC - Selected features:
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   insec_t: 0.0802
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   Volatility: 0.0668
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   s_d7_t: 0.0662
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   ret: 0.0653
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   vnipc_t: 0.0637
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   SK: 0.0632
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   TVV: 0.0618
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   ATR: 0.0613
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   SR: 0.0583
2025-05-19 23:18:59,039 - INFO - [src.data_preparation] -   ma14_t: 0.0565
2025-05-19 23:18:59,040 - INFO - [src.data_preparation] -   variation_t: 0.0538
2025-05-19 23:18:59,040 - INFO - [src.data_preparation] -   ma21_t: 0.0531
2025-05-19 23:18:59,040 - INFO - [src.data_preparation] -   HL: 0.0517
2025-05-19 23:18:59,040 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:18:59,040 - INFO - [src.data_preparation] -   ma7_t: 0.0499
2025-05-19 23:18:59,043 - INFO - [src.data_preparation] - Ticker DBC - Using features: ['Date', 'insec_t', 'Volatility', 's_d7_t', 'ret', 'vnipc_t', 'SK', 'TVV', 'ATR', 'SR', 'ma14_t', 'variation_t', 'ma21_t', 'HL', 'Median_HL', 'ma7_t']
2025-05-19 23:18:59,147 - INFO - [src.data_preparation] - Ticker DBC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:59,147 - INFO - [src.data_preparation] - Ticker DBC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:59,150 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DBC
2025-05-19 23:18:59,150 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:59,150 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:18:59,150 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:18:59,152 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:18:59,152 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:18:59,155 - INFO - [src.data_preparation] - Ticker DBC - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:59,156 - INFO - [__main__] - Using best model for DBC: svm (F1: 0.5862)
2025-05-19 23:18:59,156 - INFO - [__main__] - Loading svm model for DBC...
2025-05-19 23:18:59,157 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:59,157 - INFO - [__main__] - Model size: 0.47 MB
2025-05-19 23:18:59,157 - INFO - [__main__] - Making predictions for DBC using svm
2025-05-19 23:18:59,158 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:59,158 - INFO - [__main__] - Successfully got last prediction for DBC
2025-05-19 23:18:59,158 - INFO - [__main__] - 
Processing ticker: DBM
2025-05-19 23:18:59,158 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:59,159 - INFO - [__main__] - Getting last prediction point for ticker: DBM
2025-05-19 23:18:59,159 - INFO - [__main__] - ==================================================
2025-05-19 23:18:59,159 - INFO - [__main__] - Preparing test data for DBM...
2025-05-19 23:18:59,186 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:59,186 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:59,186 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:59,218 - INFO - [src.data_preparation] - Ticker DBM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:59,218 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(195), np.int64(1): np.int64(444)}
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] - Ticker DBM - Selected features:
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   vnipc_t: 0.0873
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   s_d7_t: 0.0766
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   ma14_t: 0.0691
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   Volatility: 0.0667
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   ma21_t: 0.0658
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   ma7_t: 0.0652
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   SK: 0.0632
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   TVV: 0.0607
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   PM: 0.0569
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   insec_t: 0.0510
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   HL: 0.0509
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   SR: 0.0462
2025-05-19 23:18:59,484 - INFO - [src.data_preparation] -   variation_t: 0.0436
2025-05-19 23:18:59,500 - INFO - [src.data_preparation] - Ticker DBM - Using features: ['Date', 'vnipc_t', 's_d7_t', 'ma14_t', 'Volatility', 'ma21_t', 'ATR', 'ma7_t', 'SK', 'TVV', 'PM', 'insec_t', 'HL', 'Median_HL', 'SR', 'variation_t']
2025-05-19 23:18:59,563 - INFO - [src.data_preparation] - Ticker DBM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:18:59,563 - INFO - [src.data_preparation] - Ticker DBM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DBM
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(145), np.int64(1): np.int64(318)}
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - Generating 173 synthetic minority samples
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (636, 13, 15), y shape: (636,)
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(318), np.int64(1): np.int64(318)}
2025-05-19 23:18:59,578 - INFO - [src.data_preparation] - Ticker DBM - Final 3D shapes: X_train=(636, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:18:59,578 - INFO - [__main__] - Using best model for DBM: svm (F1: 0.7606)
2025-05-19 23:18:59,578 - INFO - [__main__] - Loading svm model for DBM...
2025-05-19 23:18:59,578 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:18:59,578 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:18:59,578 - INFO - [__main__] - Making predictions for DBM using svm
2025-05-19 23:18:59,578 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:18:59,578 - INFO - [__main__] - Successfully got last prediction for DBM
2025-05-19 23:18:59,578 - INFO - [__main__] - 
Processing ticker: DBT
2025-05-19 23:18:59,578 - INFO - [__main__] - 
==================================================
2025-05-19 23:18:59,578 - INFO - [__main__] - Getting last prediction point for ticker: DBT
2025-05-19 23:18:59,578 - INFO - [__main__] - ==================================================
2025-05-19 23:18:59,578 - INFO - [__main__] - Preparing test data for DBT...
2025-05-19 23:18:59,610 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:18:59,610 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:18:59,610 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:18:59,626 - INFO - [src.data_preparation] - Ticker DBT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:18:59,626 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] - Ticker DBT - Selected features:
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   vnipc_t: 0.0709
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   s_d7_t: 0.0642
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   SK: 0.0633
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   ATR: 0.0609
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   insec_t: 0.0607
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   ret: 0.0594
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   ma7_t: 0.0588
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   HL: 0.0585
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   ma21_t: 0.0568
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   SR: 0.0547
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   ma14_t: 0.0542
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] -   variation_t: 0.0541
2025-05-19 23:18:59,923 - INFO - [src.data_preparation] - Ticker DBT - Using features: ['Date', 'vnipc_t', 's_d7_t', 'Volatility', 'SK', 'TVV', 'ATR', 'insec_t', 'ret', 'ma7_t', 'HL', 'ma21_t', 'PM', 'SR', 'ma14_t', 'variation_t']
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Ticker DBT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Ticker DBT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DBT
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:19:00,033 - INFO - [src.data_preparation] - Ticker DBT - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:00,033 - INFO - [__main__] - Using best model for DBT: logistic_regression (F1: 0.1739)
2025-05-19 23:19:00,033 - INFO - [__main__] - Loading logistic_regression model for DBT...
2025-05-19 23:19:00,033 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:00,033 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:00,033 - INFO - [__main__] - Making predictions for DBT using logistic_regression
2025-05-19 23:19:00,033 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:00,033 - INFO - [__main__] - Successfully got last prediction for DBT
2025-05-19 23:19:00,033 - INFO - [__main__] - 
Processing ticker: DC2
2025-05-19 23:19:00,033 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:00,033 - INFO - [__main__] - Getting last prediction point for ticker: DC2
2025-05-19 23:19:00,033 - INFO - [__main__] - ==================================================
2025-05-19 23:19:00,033 - INFO - [__main__] - Preparing test data for DC2...
2025-05-19 23:19:00,096 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:00,096 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:00,096 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:00,112 - INFO - [src.data_preparation] - Ticker DC2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:00,112 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(231), np.int64(1): np.int64(408)}
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] - Ticker DC2 - Selected features:
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   ATR: 0.0808
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   vnipc_t: 0.0806
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   HL: 0.0704
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   Volatility: 0.0650
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   s_d7_t: 0.0625
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   TVV: 0.0602
2025-05-19 23:19:00,363 - INFO - [src.data_preparation] -   insec_t: 0.0599
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   ma14_t: 0.0573
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   Median_HL: 0.0563
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   SK: 0.0535
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   ma7_t: 0.0522
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   ma21_t: 0.0497
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] -   variation_t: 0.0473
2025-05-19 23:19:00,378 - INFO - [src.data_preparation] - Ticker DC2 - Using features: ['Date', 'ATR', 'vnipc_t', 'HL', 'Volatility', 's_d7_t', 'TVV', 'insec_t', 'ma14_t', 'Median_HL', 'SK', 'ret', 'ma7_t', 'PM', 'ma21_t', 'variation_t']
2025-05-19 23:19:00,457 - INFO - [src.data_preparation] - Ticker DC2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:00,457 - INFO - [src.data_preparation] - Ticker DC2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:00,457 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DC2
2025-05-19 23:19:00,457 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:00,457 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(151), np.int64(1): np.int64(312)}
2025-05-19 23:19:00,457 - INFO - [src.data_preparation] - Generating 161 synthetic minority samples
2025-05-19 23:19:00,473 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (624, 13, 15), y shape: (624,)
2025-05-19 23:19:00,473 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(312), np.int64(1): np.int64(312)}
2025-05-19 23:19:00,473 - INFO - [src.data_preparation] - Ticker DC2 - Final 3D shapes: X_train=(624, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:00,473 - INFO - [__main__] - Using best model for DC2: svm (F1: 0.7606)
2025-05-19 23:19:00,473 - INFO - [__main__] - Loading svm model for DC2...
2025-05-19 23:19:00,473 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:00,473 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:19:00,473 - INFO - [__main__] - Making predictions for DC2 using svm
2025-05-19 23:19:00,473 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:00,473 - INFO - [__main__] - Successfully got last prediction for DC2
2025-05-19 23:19:00,473 - INFO - [__main__] - 
Processing ticker: DC4
2025-05-19 23:19:00,473 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:00,473 - INFO - [__main__] - Getting last prediction point for ticker: DC4
2025-05-19 23:19:00,473 - INFO - [__main__] - ==================================================
2025-05-19 23:19:00,473 - INFO - [__main__] - Preparing test data for DC4...
2025-05-19 23:19:00,505 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:00,505 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:00,505 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:00,520 - INFO - [src.data_preparation] - Ticker DC4 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:00,520 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(266), np.int64(1): np.int64(372)}
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] - Ticker DC4 - Selected features:
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   vnipc_t: 0.0724
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   HL: 0.0689
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   SK: 0.0653
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   variation_t: 0.0632
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   TVV: 0.0625
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   ATR: 0.0618
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   ma14_t: 0.0611
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   ret: 0.0599
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   LO: 0.0568
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   Volatility: 0.0568
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   Median_HL: 0.0550
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   insec_t: 0.0538
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   SR: 0.0523
2025-05-19 23:19:00,818 - INFO - [src.data_preparation] -   ma21_t: 0.0519
2025-05-19 23:19:00,834 - INFO - [src.data_preparation] - Ticker DC4 - Using features: ['Date', 'vnipc_t', 'HL', 'SK', 'variation_t', 'TVV', 'ATR', 'ma14_t', 'ret', 's_d7_t', 'LO', 'Volatility', 'Median_HL', 'insec_t', 'SR', 'ma21_t']
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Ticker DC4 - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Ticker DC4 - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DC4
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(183), np.int64(1): np.int64(279)}
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Generating 96 synthetic minority samples
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (558, 13, 15), y shape: (558,)
2025-05-19 23:19:00,912 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(279), np.int64(1): np.int64(279)}
2025-05-19 23:19:00,928 - INFO - [src.data_preparation] - Ticker DC4 - Final 3D shapes: X_train=(558, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:00,928 - INFO - [__main__] - Using best model for DC4: svm (F1: 0.7246)
2025-05-19 23:19:00,928 - INFO - [__main__] - Loading svm model for DC4...
2025-05-19 23:19:00,928 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:00,928 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:19:00,928 - INFO - [__main__] - Making predictions for DC4 using svm
2025-05-19 23:19:00,928 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:00,928 - INFO - [__main__] - Successfully got last prediction for DC4
2025-05-19 23:19:00,928 - INFO - [__main__] - 
Processing ticker: DCL
2025-05-19 23:19:00,928 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:00,928 - INFO - [__main__] - Getting last prediction point for ticker: DCL
2025-05-19 23:19:00,928 - INFO - [__main__] - ==================================================
2025-05-19 23:19:00,928 - INFO - [__main__] - Preparing test data for DCL...
2025-05-19 23:19:00,944 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:00,944 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:00,944 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:00,975 - INFO - [src.data_preparation] - Ticker DCL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:00,975 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(320), np.int64(1): np.int64(319)}
2025-05-19 23:19:01,329 - INFO - [src.data_preparation] - Ticker DCL - Selected features:
2025-05-19 23:19:01,329 - INFO - [src.data_preparation] -   insec_t: 0.0817
2025-05-19 23:19:01,329 - INFO - [src.data_preparation] -   vnipc_t: 0.0713
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   SK: 0.0680
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   TVV: 0.0642
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   Volatility: 0.0617
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   ret: 0.0602
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   s_d7_t: 0.0586
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   variation_t: 0.0584
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   HL: 0.0575
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   LO: 0.0572
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   ATR: 0.0566
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   SR: 0.0540
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   ma21_t: 0.0539
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:19:01,330 - INFO - [src.data_preparation] -   PM: 0.0511
2025-05-19 23:19:01,334 - INFO - [src.data_preparation] - Ticker DCL - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 'TVV', 'Volatility', 'ret', 's_d7_t', 'variation_t', 'HL', 'LO', 'ATR', 'SR', 'ma21_t', 'ma7_t', 'PM']
2025-05-19 23:19:01,479 - INFO - [src.data_preparation] - Ticker DCL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:01,479 - INFO - [src.data_preparation] - Ticker DCL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:01,480 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DCL
2025-05-19 23:19:01,480 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:01,481 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(228)}
2025-05-19 23:19:01,481 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:19:01,482 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:19:01,482 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:19:01,485 - INFO - [src.data_preparation] - Ticker DCL - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:01,485 - INFO - [__main__] - Using best model for DCL: logistic_regression (F1: 0.6970)
2025-05-19 23:19:01,485 - INFO - [__main__] - Loading logistic_regression model for DCL...
2025-05-19 23:19:01,486 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:01,486 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:01,486 - INFO - [__main__] - Making predictions for DCL using logistic_regression
2025-05-19 23:19:01,487 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:01,487 - INFO - [__main__] - Successfully got last prediction for DCL
2025-05-19 23:19:01,488 - INFO - [__main__] - 
Processing ticker: DCS
2025-05-19 23:19:01,488 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:01,488 - INFO - [__main__] - Getting last prediction point for ticker: DCS
2025-05-19 23:19:01,488 - INFO - [__main__] - ==================================================
2025-05-19 23:19:01,488 - INFO - [__main__] - Preparing test data for DCS...
2025-05-19 23:19:01,524 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:01,525 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:01,525 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:01,537 - INFO - [src.data_preparation] - Ticker DCS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:01,537 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(223), np.int64(1): np.int64(416)}
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] - Ticker DCS - Selected features:
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   vnipc_t: 0.0871
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   insec_t: 0.0865
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   ma21_t: 0.0748
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   TVV: 0.0729
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   Volatility: 0.0728
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   SK: 0.0661
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   s_d7_t: 0.0647
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   ma14_t: 0.0646
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   ma7_t: 0.0602
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   PM: 0.0563
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   ATR: 0.0524
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   Median_HL: 0.0518
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   variation_t: 0.0460
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   ret: 0.0433
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] -   SR: 0.0300
2025-05-19 23:19:01,788 - INFO - [src.data_preparation] - Ticker DCS - Using features: ['Date', 'vnipc_t', 'insec_t', 'ma21_t', 'TVV', 'Volatility', 'SK', 's_d7_t', 'ma14_t', 'ma7_t', 'PM', 'ATR', 'Median_HL', 'variation_t', 'ret', 'SR']
2025-05-19 23:19:01,867 - INFO - [src.data_preparation] - Ticker DCS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:01,867 - INFO - [src.data_preparation] - Ticker DCS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:01,867 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DCS
2025-05-19 23:19:01,867 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:01,867 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:19:01,867 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:19:01,882 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:19:01,882 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:19:01,882 - INFO - [src.data_preparation] - Ticker DCS - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:01,882 - INFO - [__main__] - Using best model for DCS: svm (F1: 0.8718)
2025-05-19 23:19:01,882 - INFO - [__main__] - Loading svm model for DCS...
2025-05-19 23:19:01,882 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:01,882 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:19:01,882 - INFO - [__main__] - Making predictions for DCS using svm
2025-05-19 23:19:01,882 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:01,882 - INFO - [__main__] - Successfully got last prediction for DCS
2025-05-19 23:19:01,882 - INFO - [__main__] - 
Processing ticker: DCT
2025-05-19 23:19:01,882 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:01,882 - INFO - [__main__] - Getting last prediction point for ticker: DCT
2025-05-19 23:19:01,882 - INFO - [__main__] - ==================================================
2025-05-19 23:19:01,882 - INFO - [__main__] - Preparing test data for DCT...
2025-05-19 23:19:01,914 - INFO - [src.data_preparation] - After processing - X shape: (593, 19), y shape: (593,)
2025-05-19 23:19:01,914 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:01,914 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:01,945 - INFO - [src.data_preparation] - Ticker DCT - Original shapes: X=(593, 18), y=(593,)
2025-05-19 23:19:01,945 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(194), np.int64(1): np.int64(399)}
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] - Ticker DCT - Selected features:
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   vnipc_t: 0.0856
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   Volatility: 0.0813
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   TVV: 0.0800
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   ma21_t: 0.0800
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   ma14_t: 0.0779
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   insec_t: 0.0731
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   ma7_t: 0.0682
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   s_d7_t: 0.0622
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   ATR: 0.0553
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   PM: 0.0514
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   ret: 0.0443
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   variation_t: 0.0417
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] -   HL: 0.0270
2025-05-19 23:19:02,165 - INFO - [src.data_preparation] - Ticker DCT - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'ma21_t', 'ma14_t', 'insec_t', 'ma7_t', 'SK', 's_d7_t', 'ATR', 'Median_HL', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Ticker DCT - 2D shapes: X_train=(417, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Ticker DCT - 3D shapes: X_train=(417, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DCT
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (417, 13, 15), y shape: (417,)
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(135), np.int64(1): np.int64(282)}
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Generating 147 synthetic minority samples
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:19:02,322 - INFO - [src.data_preparation] - Ticker DCT - Final 3D shapes: X_train=(564, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:02,322 - INFO - [__main__] - Using best model for DCT: lstm (F1: 0.8571)
2025-05-19 23:19:02,322 - INFO - [__main__] - Loading lstm model for DCT...
2025-05-19 23:19:02,338 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:19:02,338 - INFO - [__main__] - Model size: 0.23 MB
2025-05-19 23:19:02,338 - INFO - [__main__] - Making predictions for DCT using lstm
2025-05-19 23:19:02,338 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:02,338 - INFO - [__main__] - Successfully got last prediction for DCT
2025-05-19 23:19:02,338 - INFO - [__main__] - 
Processing ticker: DDM
2025-05-19 23:19:02,338 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:02,338 - INFO - [__main__] - Getting last prediction point for ticker: DDM
2025-05-19 23:19:02,338 - INFO - [__main__] - ==================================================
2025-05-19 23:19:02,338 - INFO - [__main__] - Preparing test data for DDM...
2025-05-19 23:19:02,401 - INFO - [src.data_preparation] - After processing - X shape: (552, 19), y shape: (552,)
2025-05-19 23:19:02,401 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:02,401 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:02,417 - INFO - [src.data_preparation] - Ticker DDM - Original shapes: X=(552, 18), y=(552,)
2025-05-19 23:19:02,417 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(172), np.int64(1): np.int64(380)}
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] - Ticker DDM - Selected features:
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   vnipc_t: 0.0959
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   TVV: 0.0791
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   ma21_t: 0.0737
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   SK: 0.0719
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   ma7_t: 0.0711
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   ma14_t: 0.0681
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   Volatility: 0.0671
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   PM: 0.0650
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   Median_HL: 0.0603
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   insec_t: 0.0543
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   ATR: 0.0520
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   variation_t: 0.0477
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   ret: 0.0442
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] -   HL: 0.0334
2025-05-19 23:19:02,683 - INFO - [src.data_preparation] - Ticker DDM - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'SK', 'ma7_t', 'ma14_t', 'Volatility', 'PM', 's_d7_t', 'Median_HL', 'insec_t', 'ATR', 'variation_t', 'ret', 'HL']
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Ticker DDM - 2D shapes: X_train=(376, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Ticker DDM - 3D shapes: X_train=(376, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DDM
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (376, 13, 15), y shape: (376,)
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(103), np.int64(1): np.int64(273)}
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Generating 170 synthetic minority samples
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:19:02,762 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:19:02,777 - INFO - [src.data_preparation] - Ticker DDM - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:02,777 - INFO - [__main__] - Using best model for DDM: svm (F1: 0.7778)
2025-05-19 23:19:02,777 - INFO - [__main__] - Loading svm model for DDM...
2025-05-19 23:19:02,777 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:02,777 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:19:02,777 - INFO - [__main__] - Making predictions for DDM using svm
2025-05-19 23:19:02,777 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:02,777 - INFO - [__main__] - Successfully got last prediction for DDM
2025-05-19 23:19:02,777 - INFO - [__main__] - 
Processing ticker: DDN
2025-05-19 23:19:02,777 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:02,777 - INFO - [__main__] - Getting last prediction point for ticker: DDN
2025-05-19 23:19:02,777 - INFO - [__main__] - ==================================================
2025-05-19 23:19:02,777 - INFO - [__main__] - Preparing test data for DDN...
2025-05-19 23:19:02,810 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:02,810 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:02,810 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:02,824 - INFO - [src.data_preparation] - Ticker DDN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:02,824 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(248), np.int64(1): np.int64(391)}
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] - Ticker DDN - Selected features:
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   ATR: 0.0785
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   vnipc_t: 0.0744
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   TVV: 0.0743
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   ma14_t: 0.0628
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   SK: 0.0616
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   PM: 0.0603
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   insec_t: 0.0575
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   ma7_t: 0.0571
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   Volatility: 0.0571
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   Median_HL: 0.0565
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   variation_t: 0.0538
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   ma21_t: 0.0537
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   HL: 0.0524
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] -   SR: 0.0510
2025-05-19 23:19:03,111 - INFO - [src.data_preparation] - Ticker DDN - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'ma14_t', 'SK', 'PM', 'insec_t', 'ma7_t', 'Volatility', 'Median_HL', 'variation_t', 'ma21_t', 'HL', 'SR']
2025-05-19 23:19:03,185 - INFO - [src.data_preparation] - Ticker DDN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:03,185 - INFO - [src.data_preparation] - Ticker DDN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DDN
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(171), np.int64(1): np.int64(292)}
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - Generating 121 synthetic minority samples
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (584, 13, 15), y shape: (584,)
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(292), np.int64(1): np.int64(292)}
2025-05-19 23:19:03,201 - INFO - [src.data_preparation] - Ticker DDN - Final 3D shapes: X_train=(584, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:03,201 - INFO - [__main__] - Using best model for DDN: svm (F1: 0.8108)
2025-05-19 23:19:03,201 - INFO - [__main__] - Loading svm model for DDN...
2025-05-19 23:19:03,211 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:03,211 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:19:03,211 - INFO - [__main__] - Making predictions for DDN using svm
2025-05-19 23:19:03,211 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:03,211 - INFO - [__main__] - Successfully got last prediction for DDN
2025-05-19 23:19:03,211 - INFO - [__main__] - 
Processing ticker: DGT
2025-05-19 23:19:03,211 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:03,211 - INFO - [__main__] - Getting last prediction point for ticker: DGT
2025-05-19 23:19:03,211 - INFO - [__main__] - ==================================================
2025-05-19 23:19:03,211 - INFO - [__main__] - Preparing test data for DGT...
2025-05-19 23:19:03,233 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:03,233 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:03,233 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:03,248 - INFO - [src.data_preparation] - Ticker DGT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:03,248 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(224), np.int64(1): np.int64(415)}
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] - Ticker DGT - Selected features:
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   TVV: 0.0878
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   vnipc_t: 0.0788
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   ma21_t: 0.0747
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   HL: 0.0719
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   SK: 0.0601
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   ma14_t: 0.0598
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   s_d7_t: 0.0596
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   ma7_t: 0.0568
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   ATR: 0.0567
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   PM: 0.0499
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   insec_t: 0.0498
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   Median_HL: 0.0485
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   SR: 0.0485
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] -   variation_t: 0.0475
2025-05-19 23:19:03,515 - INFO - [src.data_preparation] - Ticker DGT - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'HL', 'Volatility', 'SK', 'ma14_t', 's_d7_t', 'ma7_t', 'ATR', 'PM', 'insec_t', 'Median_HL', 'SR', 'variation_t']
2025-05-19 23:19:03,609 - INFO - [src.data_preparation] - Ticker DGT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:03,609 - INFO - [src.data_preparation] - Ticker DGT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:03,612 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DGT
2025-05-19 23:19:03,612 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:03,612 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(135), np.int64(1): np.int64(328)}
2025-05-19 23:19:03,612 - INFO - [src.data_preparation] - Generating 193 synthetic minority samples
2025-05-19 23:19:03,612 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (656, 13, 15), y shape: (656,)
2025-05-19 23:19:03,612 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(328), np.int64(1): np.int64(328)}
2025-05-19 23:19:03,625 - INFO - [src.data_preparation] - Ticker DGT - Final 3D shapes: X_train=(656, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:03,625 - INFO - [__main__] - Using best model for DGT: svm (F1: 0.6462)
2025-05-19 23:19:03,625 - INFO - [__main__] - Loading svm model for DGT...
2025-05-19 23:19:03,625 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:03,625 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:19:03,625 - INFO - [__main__] - Making predictions for DGT using svm
2025-05-19 23:19:03,625 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:03,625 - INFO - [__main__] - Successfully got last prediction for DGT
2025-05-19 23:19:03,625 - INFO - [__main__] - 
Processing ticker: DHA
2025-05-19 23:19:03,625 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:03,625 - INFO - [__main__] - Getting last prediction point for ticker: DHA
2025-05-19 23:19:03,625 - INFO - [__main__] - ==================================================
2025-05-19 23:19:03,625 - INFO - [__main__] - Preparing test data for DHA...
2025-05-19 23:19:03,669 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:03,669 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:03,669 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:03,692 - INFO - [src.data_preparation] - Ticker DHA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:03,692 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(294), np.int64(1): np.int64(345)}
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] - Ticker DHA - Selected features:
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   vnipc_t: 0.0778
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   SK: 0.0772
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   insec_t: 0.0669
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   Volatility: 0.0637
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   LO: 0.0611
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   ATR: 0.0598
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   variation_t: 0.0591
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   TVV: 0.0575
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   Median_HL: 0.0563
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   SR: 0.0546
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   PM: 0.0501
2025-05-19 23:19:04,173 - INFO - [src.data_preparation] -   ma14_t: 0.0499
2025-05-19 23:19:04,178 - INFO - [src.data_preparation] - Ticker DHA - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 's_d7_t', 'Volatility', 'LO', 'ATR', 'variation_t', 'TVV', 'Median_HL', 'SR', 'HL', 'ret', 'PM', 'ma14_t']
2025-05-19 23:19:04,320 - INFO - [src.data_preparation] - Ticker DHA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:04,320 - INFO - [src.data_preparation] - Ticker DHA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:04,320 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DHA
2025-05-19 23:19:04,320 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:04,320 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(258)}
2025-05-19 23:19:04,320 - INFO - [src.data_preparation] - Generating 53 synthetic minority samples
2025-05-19 23:19:04,325 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:19:04,325 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:19:04,330 - INFO - [src.data_preparation] - Ticker DHA - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:04,335 - INFO - [__main__] - Using best model for DHA: svm (F1: 0.2400)
2025-05-19 23:19:04,335 - INFO - [__main__] - Loading svm model for DHA...
2025-05-19 23:19:04,335 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:04,335 - INFO - [__main__] - Model size: 0.49 MB
2025-05-19 23:19:04,335 - INFO - [__main__] - Making predictions for DHA using svm
2025-05-19 23:19:04,335 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:04,335 - INFO - [__main__] - Successfully got last prediction for DHA
2025-05-19 23:19:04,335 - INFO - [__main__] - 
Processing ticker: DHC
2025-05-19 23:19:04,335 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:04,335 - INFO - [__main__] - Getting last prediction point for ticker: DHC
2025-05-19 23:19:04,335 - INFO - [__main__] - ==================================================
2025-05-19 23:19:04,335 - INFO - [__main__] - Preparing test data for DHC...
2025-05-19 23:19:04,390 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:04,390 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:04,390 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:04,425 - INFO - [src.data_preparation] - Ticker DHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:04,425 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] - Ticker DHC - Selected features:
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   vnipc_t: 0.0727
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   Volatility: 0.0704
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   SK: 0.0690
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   insec_t: 0.0641
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   HL: 0.0640
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   LO: 0.0564
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   ma14_t: 0.0563
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   ATR: 0.0556
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   ret: 0.0556
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   ma21_t: 0.0543
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   SR: 0.0533
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   variation_t: 0.0521
2025-05-19 23:19:04,810 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:19:04,815 - INFO - [src.data_preparation] - Ticker DHC - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'TVV', 'insec_t', 's_d7_t', 'HL', 'LO', 'ma14_t', 'ATR', 'ret', 'ma21_t', 'SR', 'variation_t', 'ma7_t']
2025-05-19 23:19:04,915 - INFO - [src.data_preparation] - Ticker DHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:04,915 - INFO - [src.data_preparation] - Ticker DHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:04,920 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DHC
2025-05-19 23:19:04,920 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:04,920 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:19:04,920 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:19:04,920 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:19:04,920 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:19:04,925 - INFO - [src.data_preparation] - Ticker DHC - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:04,925 - INFO - [__main__] - Using best model for DHC: svm (F1: 0.5965)
2025-05-19 23:19:04,925 - INFO - [__main__] - Loading svm model for DHC...
2025-05-19 23:19:04,925 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:04,925 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:19:04,925 - INFO - [__main__] - Making predictions for DHC using svm
2025-05-19 23:19:04,930 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:19:04,930 - INFO - [__main__] - Successfully got last prediction for DHC
2025-05-19 23:19:04,930 - INFO - [__main__] - 
Processing ticker: DHG
2025-05-19 23:19:04,930 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:04,930 - INFO - [__main__] - Getting last prediction point for ticker: DHG
2025-05-19 23:19:04,930 - INFO - [__main__] - ==================================================
2025-05-19 23:19:04,930 - INFO - [__main__] - Preparing test data for DHG...
2025-05-19 23:19:04,970 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:04,970 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:04,970 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:05,000 - INFO - [src.data_preparation] - Ticker DHG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:05,000 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(319), np.int64(1): np.int64(320)}
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] - Ticker DHG - Selected features:
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   SK: 0.0730
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   vnipc_t: 0.0669
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   insec_t: 0.0669
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   ATR: 0.0580
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   PM: 0.0574
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   ma14_t: 0.0572
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   LO: 0.0571
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   SR: 0.0565
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   TVV: 0.0540
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   ma7_t: 0.0536
2025-05-19 23:19:05,431 - INFO - [src.data_preparation] -   Median_HL: 0.0522
2025-05-19 23:19:05,436 - INFO - [src.data_preparation] - Ticker DHG - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'HL', 'ATR', 'PM', 'ma14_t', 'LO', 'SR', 'ret', 'TVV', 'ma7_t', 'Median_HL']
2025-05-19 23:19:05,567 - INFO - [src.data_preparation] - Ticker DHG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:05,568 - INFO - [src.data_preparation] - Ticker DHG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:05,570 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DHG
2025-05-19 23:19:05,570 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:05,570 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:19:05,570 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:19:05,571 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:19:05,572 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:19:05,576 - INFO - [src.data_preparation] - Ticker DHG - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:05,576 - INFO - [__main__] - Using best model for DHG: svm (F1: 0.4375)
2025-05-19 23:19:05,576 - INFO - [__main__] - Loading svm model for DHG...
2025-05-19 23:19:05,579 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:05,580 - INFO - [__main__] - Model size: 0.44 MB
2025-05-19 23:19:05,580 - INFO - [__main__] - Making predictions for DHG using svm
2025-05-19 23:19:05,582 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:05,583 - INFO - [__main__] - Successfully got last prediction for DHG
2025-05-19 23:19:05,583 - INFO - [__main__] - 
Processing ticker: DHM
2025-05-19 23:19:05,583 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:05,583 - INFO - [__main__] - Getting last prediction point for ticker: DHM
2025-05-19 23:19:05,584 - INFO - [__main__] - ==================================================
2025-05-19 23:19:05,584 - INFO - [__main__] - Preparing test data for DHM...
2025-05-19 23:19:05,627 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:05,627 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:05,627 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:05,657 - INFO - [src.data_preparation] - Ticker DHM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:05,658 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(327), np.int64(1): np.int64(312)}
2025-05-19 23:19:06,090 - INFO - [src.data_preparation] - Ticker DHM - Selected features:
2025-05-19 23:19:06,091 - INFO - [src.data_preparation] -   TVV: 0.0714
2025-05-19 23:19:06,091 - INFO - [src.data_preparation] -   Volatility: 0.0694
2025-05-19 23:19:06,091 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:19:06,091 - INFO - [src.data_preparation] -   insec_t: 0.0632
2025-05-19 23:19:06,091 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   ret: 0.0579
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   s_d7_t: 0.0575
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   ma7_t: 0.0569
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   Median_HL: 0.0565
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   vnipc_t: 0.0556
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   ma14_t: 0.0546
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   PM: 0.0536
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:19:06,092 - INFO - [src.data_preparation] -   LO: 0.0507
2025-05-19 23:19:06,095 - INFO - [src.data_preparation] - Ticker DHM - Using features: ['Date', 'TVV', 'Volatility', 'SK', 'insec_t', 'ATR', 'ma21_t', 'ret', 's_d7_t', 'ma7_t', 'Median_HL', 'vnipc_t', 'ma14_t', 'PM', 'variation_t', 'LO']
2025-05-19 23:19:06,233 - INFO - [src.data_preparation] - Ticker DHM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:06,233 - INFO - [src.data_preparation] - Ticker DHM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:06,237 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DHM
2025-05-19 23:19:06,238 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:06,238 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(218), np.int64(1): np.int64(245)}
2025-05-19 23:19:06,238 - INFO - [src.data_preparation] - Generating 27 synthetic minority samples
2025-05-19 23:19:06,241 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (490, 13, 15), y shape: (490,)
2025-05-19 23:19:06,242 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(245), np.int64(1): np.int64(245)}
2025-05-19 23:19:06,247 - INFO - [src.data_preparation] - Ticker DHM - Final 3D shapes: X_train=(490, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:06,247 - INFO - [__main__] - Using best model for DHM: logistic_regression (F1: 0.5641)
2025-05-19 23:19:06,247 - INFO - [__main__] - Loading logistic_regression model for DHM...
2025-05-19 23:19:06,248 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:06,249 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:06,249 - INFO - [__main__] - Making predictions for DHM using logistic_regression
2025-05-19 23:19:06,249 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:06,250 - INFO - [__main__] - Successfully got last prediction for DHM
2025-05-19 23:19:06,250 - INFO - [__main__] - 
Processing ticker: DHT
2025-05-19 23:19:06,250 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:06,250 - INFO - [__main__] - Getting last prediction point for ticker: DHT
2025-05-19 23:19:06,250 - INFO - [__main__] - ==================================================
2025-05-19 23:19:06,250 - INFO - [__main__] - Preparing test data for DHT...
2025-05-19 23:19:06,305 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:06,305 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:06,305 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:06,329 - INFO - [src.data_preparation] - Ticker DHT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:06,329 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:19:06,712 - INFO - [src.data_preparation] - Ticker DHT - Selected features:
2025-05-19 23:19:06,712 - INFO - [src.data_preparation] -   SK: 0.0761
2025-05-19 23:19:06,712 - INFO - [src.data_preparation] -   vnipc_t: 0.0696
2025-05-19 23:19:06,712 - INFO - [src.data_preparation] -   insec_t: 0.0673
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   TVV: 0.0648
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   SR: 0.0588
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   ma7_t: 0.0574
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   s_d7_t: 0.0571
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   LO: 0.0571
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   ATR: 0.0568
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   Volatility: 0.0559
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   ma14_t: 0.0556
2025-05-19 23:19:06,713 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:19:06,714 - INFO - [src.data_preparation] -   variation_t: 0.0541
2025-05-19 23:19:06,714 - INFO - [src.data_preparation] -   ret: 0.0526
2025-05-19 23:19:06,716 - INFO - [src.data_preparation] - Ticker DHT - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'TVV', 'SR', 'PM', 'ma7_t', 's_d7_t', 'LO', 'ATR', 'Volatility', 'ma14_t', 'HL', 'variation_t', 'ret']
2025-05-19 23:19:06,848 - INFO - [src.data_preparation] - Ticker DHT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:06,848 - INFO - [src.data_preparation] - Ticker DHT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:06,851 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DHT
2025-05-19 23:19:06,851 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:06,851 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:19:06,851 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:19:06,853 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:19:06,853 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:19:06,857 - INFO - [src.data_preparation] - Ticker DHT - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:06,858 - INFO - [__main__] - Using best model for DHT: logistic_regression (F1: 0.1481)
2025-05-19 23:19:06,858 - INFO - [__main__] - Loading logistic_regression model for DHT...
2025-05-19 23:19:06,859 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:06,859 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:06,859 - INFO - [__main__] - Making predictions for DHT using logistic_regression
2025-05-19 23:19:06,860 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:06,861 - INFO - [__main__] - Successfully got last prediction for DHT
2025-05-19 23:19:06,861 - INFO - [__main__] - 
Processing ticker: DIC
2025-05-19 23:19:06,861 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:06,861 - INFO - [__main__] - Getting last prediction point for ticker: DIC
2025-05-19 23:19:06,861 - INFO - [__main__] - ==================================================
2025-05-19 23:19:06,861 - INFO - [__main__] - Preparing test data for DIC...
2025-05-19 23:19:06,890 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:06,891 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:06,891 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:06,918 - INFO - [src.data_preparation] - Ticker DIC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:06,918 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(351)}
2025-05-19 23:19:07,257 - INFO - [src.data_preparation] - Ticker DIC - Selected features:
2025-05-19 23:19:07,257 - INFO - [src.data_preparation] -   vnipc_t: 0.0707
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   Volatility: 0.0700
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   TVV: 0.0693
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   ma21_t: 0.0676
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   Median_HL: 0.0649
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   SK: 0.0639
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   s_d7_t: 0.0625
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   insec_t: 0.0619
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   ma14_t: 0.0617
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   ma7_t: 0.0596
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   ATR: 0.0562
2025-05-19 23:19:07,258 - INFO - [src.data_preparation] -   PM: 0.0556
2025-05-19 23:19:07,259 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:19:07,259 - INFO - [src.data_preparation] -   ret: 0.0499
2025-05-19 23:19:07,259 - INFO - [src.data_preparation] -   HL: 0.0469
2025-05-19 23:19:07,262 - INFO - [src.data_preparation] - Ticker DIC - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'ma21_t', 'Median_HL', 'SK', 's_d7_t', 'insec_t', 'ma14_t', 'ma7_t', 'ATR', 'PM', 'variation_t', 'ret', 'HL']
2025-05-19 23:19:07,376 - INFO - [src.data_preparation] - Ticker DIC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:07,377 - INFO - [src.data_preparation] - Ticker DIC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:07,379 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DIC
2025-05-19 23:19:07,379 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:07,379 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(224), np.int64(1): np.int64(238)}
2025-05-19 23:19:07,379 - INFO - [src.data_preparation] - Generating 14 synthetic minority samples
2025-05-19 23:19:07,381 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (476, 13, 15), y shape: (476,)
2025-05-19 23:19:07,381 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(238)}
2025-05-19 23:19:07,386 - INFO - [src.data_preparation] - Ticker DIC - Final 3D shapes: X_train=(476, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:07,386 - INFO - [__main__] - Using best model for DIC: logistic_regression (F1: 0.7541)
2025-05-19 23:19:07,386 - INFO - [__main__] - Loading logistic_regression model for DIC...
2025-05-19 23:19:07,387 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:07,388 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:07,388 - INFO - [__main__] - Making predictions for DIC using logistic_regression
2025-05-19 23:19:07,388 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:07,388 - INFO - [__main__] - Successfully got last prediction for DIC
2025-05-19 23:19:07,389 - INFO - [__main__] - 
Processing ticker: DID
2025-05-19 23:19:07,389 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:07,389 - INFO - [__main__] - Getting last prediction point for ticker: DID
2025-05-19 23:19:07,389 - INFO - [__main__] - ==================================================
2025-05-19 23:19:07,389 - INFO - [__main__] - Preparing test data for DID...
2025-05-19 23:19:07,441 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:07,441 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:07,441 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:07,464 - INFO - [src.data_preparation] - Ticker DID - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:07,464 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(185), np.int64(1): np.int64(454)}
2025-05-19 23:19:07,727 - INFO - [src.data_preparation] - Ticker DID - Selected features:
2025-05-19 23:19:07,727 - INFO - [src.data_preparation] -   TVV: 0.1072
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   HL: 0.0734
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   ATR: 0.0685
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   vnipc_t: 0.0680
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   ma14_t: 0.0678
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   ma21_t: 0.0620
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   Volatility: 0.0592
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   insec_t: 0.0536
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   s_d7_t: 0.0534
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   PM: 0.0515
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   SK: 0.0499
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   ret: 0.0480
2025-05-19 23:19:07,728 - INFO - [src.data_preparation] -   ma7_t: 0.0479
2025-05-19 23:19:07,729 - INFO - [src.data_preparation] -   Median_HL: 0.0451
2025-05-19 23:19:07,729 - INFO - [src.data_preparation] -   variation_t: 0.0442
2025-05-19 23:19:07,731 - INFO - [src.data_preparation] - Ticker DID - Using features: ['Date', 'TVV', 'HL', 'ATR', 'vnipc_t', 'ma14_t', 'ma21_t', 'Volatility', 'insec_t', 's_d7_t', 'PM', 'SK', 'ret', 'ma7_t', 'Median_HL', 'variation_t']
2025-05-19 23:19:07,829 - INFO - [src.data_preparation] - Ticker DID - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:07,830 - INFO - [src.data_preparation] - Ticker DID - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:07,831 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DID
2025-05-19 23:19:07,831 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:07,831 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(104), np.int64(1): np.int64(359)}
2025-05-19 23:19:07,831 - INFO - [src.data_preparation] - Generating 255 synthetic minority samples
2025-05-19 23:19:07,840 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (718, 13, 15), y shape: (718,)
2025-05-19 23:19:07,840 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(359), np.int64(1): np.int64(359)}
2025-05-19 23:19:07,844 - INFO - [src.data_preparation] - Ticker DID - Final 3D shapes: X_train=(718, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:07,845 - INFO - [__main__] - Using best model for DID: lstm (F1: 0.7419)
2025-05-19 23:19:07,845 - INFO - [__main__] - Loading lstm model for DID...
2025-05-19 23:19:07,848 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:07,849 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:19:07,850 - INFO - [__main__] - Making predictions for DID using lstm
2025-05-19 23:19:07,851 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:07,851 - INFO - [__main__] - Successfully got last prediction for DID
2025-05-19 23:19:07,851 - INFO - [__main__] - 
Processing ticker: DIG
2025-05-19 23:19:07,851 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:07,851 - INFO - [__main__] - Getting last prediction point for ticker: DIG
2025-05-19 23:19:07,851 - INFO - [__main__] - ==================================================
2025-05-19 23:19:07,851 - INFO - [__main__] - Preparing test data for DIG...
2025-05-19 23:19:07,889 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:07,889 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:07,889 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:07,925 - INFO - [src.data_preparation] - Ticker DIG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:07,925 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:19:08,307 - INFO - [src.data_preparation] - Ticker DIG - Selected features:
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   SK: 0.0810
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   Volatility: 0.0734
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   vnipc_t: 0.0668
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   s_d7_t: 0.0656
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   TVV: 0.0629
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   insec_t: 0.0619
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   LO: 0.0589
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   HL: 0.0563
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   Median_HL: 0.0537
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   ret: 0.0532
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   ATR: 0.0532
2025-05-19 23:19:08,308 - INFO - [src.data_preparation] -   variation_t: 0.0530
2025-05-19 23:19:08,309 - INFO - [src.data_preparation] -   PM: 0.0527
2025-05-19 23:19:08,309 - INFO - [src.data_preparation] -   ma21_t: 0.0526
2025-05-19 23:19:08,309 - INFO - [src.data_preparation] -   ma14_t: 0.0517
2025-05-19 23:19:08,311 - INFO - [src.data_preparation] - Ticker DIG - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 's_d7_t', 'TVV', 'insec_t', 'LO', 'HL', 'Median_HL', 'ret', 'ATR', 'variation_t', 'PM', 'ma21_t', 'ma14_t']
2025-05-19 23:19:08,427 - INFO - [src.data_preparation] - Ticker DIG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:08,427 - INFO - [src.data_preparation] - Ticker DIG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:08,429 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DIG
2025-05-19 23:19:08,429 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:08,429 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:19:08,429 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:19:08,432 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:19:08,433 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:19:08,436 - INFO - [src.data_preparation] - Ticker DIG - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:08,437 - INFO - [__main__] - Using best model for DIG: lstm (F1: 0.6230)
2025-05-19 23:19:08,437 - INFO - [__main__] - Loading lstm model for DIG...
2025-05-19 23:19:08,442 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:08,444 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:19:08,444 - INFO - [__main__] - Making predictions for DIG using lstm
2025-05-19 23:19:08,446 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:08,447 - INFO - [__main__] - Successfully got last prediction for DIG
2025-05-19 23:19:08,448 - INFO - [__main__] - 
Processing ticker: DIH
2025-05-19 23:19:08,448 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:08,448 - INFO - [__main__] - Getting last prediction point for ticker: DIH
2025-05-19 23:19:08,448 - INFO - [__main__] - ==================================================
2025-05-19 23:19:08,448 - INFO - [__main__] - Preparing test data for DIH...
2025-05-19 23:19:08,511 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:08,511 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:08,511 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:08,538 - INFO - [src.data_preparation] - Ticker DIH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:08,538 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(271), np.int64(1): np.int64(368)}
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] - Ticker DIH - Selected features:
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   vnipc_t: 0.0764
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   SK: 0.0728
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   Volatility: 0.0668
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   TVV: 0.0625
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   s_d7_t: 0.0619
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   insec_t: 0.0619
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   ma21_t: 0.0605
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:19:08,896 - INFO - [src.data_preparation] -   ma7_t: 0.0545
2025-05-19 23:19:08,897 - INFO - [src.data_preparation] -   SR: 0.0541
2025-05-19 23:19:08,897 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:19:08,897 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:19:08,897 - INFO - [src.data_preparation] -   ma14_t: 0.0512
2025-05-19 23:19:08,897 - INFO - [src.data_preparation] -   Median_HL: 0.0511
2025-05-19 23:19:08,897 - INFO - [src.data_preparation] -   LO: 0.0508
2025-05-19 23:19:08,902 - INFO - [src.data_preparation] - Ticker DIH - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'TVV', 's_d7_t', 'insec_t', 'ma21_t', 'ATR', 'ma7_t', 'SR', 'variation_t', 'PM', 'ma14_t', 'Median_HL', 'LO']
2025-05-19 23:19:08,986 - INFO - [src.data_preparation] - Ticker DIH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:08,986 - INFO - [src.data_preparation] - Ticker DIH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:08,988 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DIH
2025-05-19 23:19:08,988 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:08,988 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(184), np.int64(1): np.int64(279)}
2025-05-19 23:19:08,988 - INFO - [src.data_preparation] - Generating 95 synthetic minority samples
2025-05-19 23:19:08,992 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (558, 13, 15), y shape: (558,)
2025-05-19 23:19:08,992 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(279), np.int64(1): np.int64(279)}
2025-05-19 23:19:08,995 - INFO - [src.data_preparation] - Ticker DIH - Final 3D shapes: X_train=(558, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:08,995 - INFO - [__main__] - Using best model for DIH: transformer (F1: 0.5000)
2025-05-19 23:19:08,995 - INFO - [__main__] - Loading transformer model for DIH...
2025-05-19 23:19:09,009 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:09,012 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:19:09,012 - INFO - [__main__] - Making predictions for DIH using transformer
2025-05-19 23:19:09,014 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:09,015 - INFO - [__main__] - Successfully got last prediction for DIH
2025-05-19 23:19:09,015 - INFO - [__main__] - 
Processing ticker: DL1
2025-05-19 23:19:09,015 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:09,015 - INFO - [__main__] - Getting last prediction point for ticker: DL1
2025-05-19 23:19:09,015 - INFO - [__main__] - ==================================================
2025-05-19 23:19:09,015 - INFO - [__main__] - Preparing test data for DL1...
2025-05-19 23:19:09,056 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:09,056 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:09,056 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:09,081 - INFO - [src.data_preparation] - Ticker DL1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:09,081 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(271), np.int64(1): np.int64(368)}
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] - Ticker DL1 - Selected features:
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   vnipc_t: 0.0832
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   insec_t: 0.0770
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   TVV: 0.0670
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   Median_HL: 0.0618
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   ma14_t: 0.0570
2025-05-19 23:19:09,429 - INFO - [src.data_preparation] -   PM: 0.0559
2025-05-19 23:19:09,430 - INFO - [src.data_preparation] -   ma7_t: 0.0557
2025-05-19 23:19:09,430 - INFO - [src.data_preparation] -   ATR: 0.0547
2025-05-19 23:19:09,430 - INFO - [src.data_preparation] -   HL: 0.0510
2025-05-19 23:19:09,430 - INFO - [src.data_preparation] -   ret: 0.0481
2025-05-19 23:19:09,430 - INFO - [src.data_preparation] -   variation_t: 0.0444
2025-05-19 23:19:09,433 - INFO - [src.data_preparation] - Ticker DL1 - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'Volatility', 's_d7_t', 'SK', 'Median_HL', 'ma21_t', 'ma14_t', 'PM', 'ma7_t', 'ATR', 'HL', 'ret', 'variation_t']
2025-05-19 23:19:09,517 - INFO - [src.data_preparation] - Ticker DL1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:09,517 - INFO - [src.data_preparation] - Ticker DL1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:09,518 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DL1
2025-05-19 23:19:09,518 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:09,519 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:19:09,519 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:19:09,523 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:19:09,523 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:19:09,526 - INFO - [src.data_preparation] - Ticker DL1 - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:09,526 - INFO - [__main__] - Using best model for DL1: logistic_regression (F1: 0.6230)
2025-05-19 23:19:09,526 - INFO - [__main__] - Loading logistic_regression model for DL1...
2025-05-19 23:19:09,526 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:09,527 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:09,527 - INFO - [__main__] - Making predictions for DL1 using logistic_regression
2025-05-19 23:19:09,527 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:09,527 - INFO - [__main__] - Successfully got last prediction for DL1
2025-05-19 23:19:09,527 - INFO - [__main__] - 
Processing ticker: DLD
2025-05-19 23:19:09,527 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:09,528 - INFO - [__main__] - Getting last prediction point for ticker: DLD
2025-05-19 23:19:09,528 - INFO - [__main__] - ==================================================
2025-05-19 23:19:09,528 - INFO - [__main__] - Preparing test data for DLD...
2025-05-19 23:19:09,557 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:09,557 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:09,557 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:09,575 - INFO - [src.data_preparation] - Ticker DLD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:09,576 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(50), np.int64(1): np.int64(589)}
2025-05-19 23:19:09,737 - INFO - [src.data_preparation] - Ticker DLD - Selected features:
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   vnipc_t: 0.1996
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   ma21_t: 0.1611
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   ma14_t: 0.1062
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   SR: 0.0799
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   ma7_t: 0.0736
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   LO: 0.0659
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   ATR: 0.0659
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   s_d7_t: 0.0365
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   Median_HL: 0.0342
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   Volatility: 0.0290
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   PM: 0.0289
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   TVV: 0.0240
2025-05-19 23:19:09,738 - INFO - [src.data_preparation] -   ret: 0.0235
2025-05-19 23:19:09,739 - INFO - [src.data_preparation] -   variation_t: 0.0232
2025-05-19 23:19:09,739 - INFO - [src.data_preparation] -   SK: 0.0201
2025-05-19 23:19:09,741 - INFO - [src.data_preparation] - Ticker DLD - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'SR', 'ma7_t', 'LO', 'ATR', 's_d7_t', 'Median_HL', 'Volatility', 'PM', 'TVV', 'ret', 'variation_t', 'SK']
2025-05-19 23:19:09,821 - INFO - [src.data_preparation] - Ticker DLD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:09,821 - INFO - [src.data_preparation] - Ticker DLD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:09,822 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DLD
2025-05-19 23:19:09,822 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:09,822 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(20), np.int64(1): np.int64(443)}
2025-05-19 23:19:09,822 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:19:09,825 - INFO - [src.data_preparation] - Ticker DLD - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:09,826 - INFO - [__main__] - Using best model for DLD: lstm (F1: 0.9000)
2025-05-19 23:19:09,826 - INFO - [__main__] - Loading lstm model for DLD...
2025-05-19 23:19:09,829 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:09,830 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:09,830 - INFO - [__main__] - Making predictions for DLD using lstm
2025-05-19 23:19:09,831 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:09,831 - INFO - [__main__] - Successfully got last prediction for DLD
2025-05-19 23:19:09,832 - INFO - [__main__] - 
Processing ticker: DLG
2025-05-19 23:19:09,832 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:09,832 - INFO - [__main__] - Getting last prediction point for ticker: DLG
2025-05-19 23:19:09,832 - INFO - [__main__] - ==================================================
2025-05-19 23:19:09,832 - INFO - [__main__] - Preparing test data for DLG...
2025-05-19 23:19:09,866 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:09,866 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:09,867 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:09,884 - INFO - [src.data_preparation] - Ticker DLG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:09,885 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(322), np.int64(1): np.int64(317)}
2025-05-19 23:19:10,203 - INFO - [src.data_preparation] - Ticker DLG - Selected features:
2025-05-19 23:19:10,203 - INFO - [src.data_preparation] -   vnipc_t: 0.0772
2025-05-19 23:19:10,203 - INFO - [src.data_preparation] -   insec_t: 0.0738
2025-05-19 23:19:10,203 - INFO - [src.data_preparation] -   SK: 0.0710
2025-05-19 23:19:10,203 - INFO - [src.data_preparation] -   Volatility: 0.0644
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   TVV: 0.0641
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   ma21_t: 0.0587
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   ATR: 0.0583
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   s_d7_t: 0.0578
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   Median_HL: 0.0555
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   ma14_t: 0.0540
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   ret: 0.0532
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   variation_t: 0.0521
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   ma7_t: 0.0513
2025-05-19 23:19:10,204 - INFO - [src.data_preparation] -   HL: 0.0475
2025-05-19 23:19:10,207 - INFO - [src.data_preparation] - Ticker DLG - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 'TVV', 'ma21_t', 'ATR', 's_d7_t', 'PM', 'Median_HL', 'ma14_t', 'ret', 'variation_t', 'ma7_t', 'HL']
2025-05-19 23:19:10,287 - INFO - [src.data_preparation] - Ticker DLG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:10,287 - INFO - [src.data_preparation] - Ticker DLG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:10,289 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DLG
2025-05-19 23:19:10,289 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:10,289 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:19:10,289 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:19:10,290 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:19:10,290 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:19:10,292 - INFO - [src.data_preparation] - Ticker DLG - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:10,293 - INFO - [__main__] - Using best model for DLG: lstm (F1: 0.6275)
2025-05-19 23:19:10,293 - INFO - [__main__] - Loading lstm model for DLG...
2025-05-19 23:19:10,297 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:10,298 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:10,298 - INFO - [__main__] - Making predictions for DLG using lstm
2025-05-19 23:19:10,300 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:10,300 - INFO - [__main__] - Successfully got last prediction for DLG
2025-05-19 23:19:10,300 - INFO - [__main__] - 
Processing ticker: DLR
2025-05-19 23:19:10,300 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:10,301 - INFO - [__main__] - Getting last prediction point for ticker: DLR
2025-05-19 23:19:10,301 - INFO - [__main__] - ==================================================
2025-05-19 23:19:10,301 - INFO - [__main__] - Preparing test data for DLR...
2025-05-19 23:19:10,330 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:10,330 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:10,330 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:10,354 - INFO - [src.data_preparation] - Ticker DLR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:10,354 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(96), np.int64(1): np.int64(543)}
2025-05-19 23:19:10,604 - INFO - [src.data_preparation] - Ticker DLR - Selected features:
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   vnipc_t: 0.1014
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   ma21_t: 0.0824
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   TVV: 0.0804
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   ma14_t: 0.0765
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   ATR: 0.0698
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   ma7_t: 0.0676
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   s_d7_t: 0.0548
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   ret: 0.0496
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   variation_t: 0.0465
2025-05-19 23:19:10,605 - INFO - [src.data_preparation] -   SK: 0.0465
2025-05-19 23:19:10,606 - INFO - [src.data_preparation] -   HL: 0.0422
2025-05-19 23:19:10,606 - INFO - [src.data_preparation] -   insec_t: 0.0351
2025-05-19 23:19:10,608 - INFO - [src.data_preparation] - Ticker DLR - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ma14_t', 'ATR', 'Volatility', 'ma7_t', 's_d7_t', 'Median_HL', 'PM', 'ret', 'variation_t', 'SK', 'HL', 'insec_t']
2025-05-19 23:19:10,689 - INFO - [src.data_preparation] - Ticker DLR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:10,689 - INFO - [src.data_preparation] - Ticker DLR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:10,690 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DLR
2025-05-19 23:19:10,690 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:10,690 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(85), np.int64(1): np.int64(378)}
2025-05-19 23:19:10,691 - INFO - [src.data_preparation] - Generating 293 synthetic minority samples
2025-05-19 23:19:10,701 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (756, 13, 15), y shape: (756,)
2025-05-19 23:19:10,701 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(378), np.int64(1): np.int64(378)}
2025-05-19 23:19:10,705 - INFO - [src.data_preparation] - Ticker DLR - Final 3D shapes: X_train=(756, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:10,705 - INFO - [__main__] - Using best model for DLR: transformer (F1: 0.9647)
2025-05-19 23:19:10,705 - INFO - [__main__] - Loading transformer model for DLR...
2025-05-19 23:19:10,719 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:10,723 - INFO - [__main__] - Model size: 0.21 MB
2025-05-19 23:19:10,723 - INFO - [__main__] - Making predictions for DLR using transformer
2025-05-19 23:19:10,725 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:10,726 - INFO - [__main__] - Successfully got last prediction for DLR
2025-05-19 23:19:10,726 - INFO - [__main__] - 
Processing ticker: DMC
2025-05-19 23:19:10,726 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:10,726 - INFO - [__main__] - Getting last prediction point for ticker: DMC
2025-05-19 23:19:10,726 - INFO - [__main__] - ==================================================
2025-05-19 23:19:10,727 - INFO - [__main__] - Preparing test data for DMC...
2025-05-19 23:19:10,778 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:10,778 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:10,778 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:10,808 - INFO - [src.data_preparation] - Ticker DMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:10,808 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(317), np.int64(1): np.int64(322)}
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] - Ticker DMC - Selected features:
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   HL: 0.0736
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   vnipc_t: 0.0673
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   SK: 0.0672
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   s_d7_t: 0.0655
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   Volatility: 0.0651
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   ATR: 0.0630
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   LO: 0.0609
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   insec_t: 0.0568
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   ma7_t: 0.0544
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   SR: 0.0515
2025-05-19 23:19:11,221 - INFO - [src.data_preparation] -   ma14_t: 0.0499
2025-05-19 23:19:11,226 - INFO - [src.data_preparation] - Ticker DMC - Using features: ['Date', 'HL', 'vnipc_t', 'SK', 'TVV', 's_d7_t', 'Volatility', 'ATR', 'LO', 'insec_t', 'variation_t', 'ma21_t', 'ma7_t', 'ret', 'SR', 'ma14_t']
2025-05-19 23:19:11,316 - INFO - [src.data_preparation] - Ticker DMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:11,316 - INFO - [src.data_preparation] - Ticker DMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:11,318 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DMC
2025-05-19 23:19:11,318 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:11,318 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:19:11,318 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:19:11,318 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:19:11,318 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:19:11,321 - INFO - [src.data_preparation] - Ticker DMC - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:11,321 - INFO - [__main__] - Using best model for DMC: lstm (F1: 0.5600)
2025-05-19 23:19:11,321 - INFO - [__main__] - Loading lstm model for DMC...
2025-05-19 23:19:11,326 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:11,326 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:19:11,326 - INFO - [__main__] - Making predictions for DMC using lstm
2025-05-19 23:19:11,326 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:11,326 - INFO - [__main__] - Successfully got last prediction for DMC
2025-05-19 23:19:11,331 - INFO - [__main__] - 
Processing ticker: DNC
2025-05-19 23:19:11,331 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:11,331 - INFO - [__main__] - Getting last prediction point for ticker: DNC
2025-05-19 23:19:11,331 - INFO - [__main__] - ==================================================
2025-05-19 23:19:11,331 - INFO - [__main__] - Preparing test data for DNC...
2025-05-19 23:19:11,391 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:11,391 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:11,391 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:11,421 - INFO - [src.data_preparation] - Ticker DNC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:11,421 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(134), np.int64(1): np.int64(505)}
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] - Ticker DNC - Selected features:
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   vnipc_t: 0.0998
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   ATR: 0.0766
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   TVV: 0.0747
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   s_d7_t: 0.0733
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   ma14_t: 0.0727
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   SK: 0.0635
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   ma21_t: 0.0625
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   Volatility: 0.0621
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   ma7_t: 0.0616
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   Median_HL: 0.0572
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   PM: 0.0560
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   HL: 0.0517
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   insec_t: 0.0433
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   ret: 0.0424
2025-05-19 23:19:11,746 - INFO - [src.data_preparation] -   variation_t: 0.0408
2025-05-19 23:19:11,751 - INFO - [src.data_preparation] - Ticker DNC - Using features: ['Date', 'vnipc_t', 'ATR', 'TVV', 's_d7_t', 'ma14_t', 'SK', 'ma21_t', 'Volatility', 'ma7_t', 'Median_HL', 'PM', 'HL', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:19:11,851 - INFO - [src.data_preparation] - Ticker DNC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:11,851 - INFO - [src.data_preparation] - Ticker DNC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:11,851 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DNC
2025-05-19 23:19:11,851 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:11,851 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(92), np.int64(1): np.int64(371)}
2025-05-19 23:19:11,851 - INFO - [src.data_preparation] - Generating 279 synthetic minority samples
2025-05-19 23:19:11,861 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (742, 13, 15), y shape: (742,)
2025-05-19 23:19:11,866 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(371), np.int64(1): np.int64(371)}
2025-05-19 23:19:11,871 - INFO - [src.data_preparation] - Ticker DNC - Final 3D shapes: X_train=(742, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:11,871 - INFO - [__main__] - Using best model for DNC: svm (F1: 0.8267)
2025-05-19 23:19:11,871 - INFO - [__main__] - Loading svm model for DNC...
2025-05-19 23:19:11,871 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:11,871 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:19:11,871 - INFO - [__main__] - Making predictions for DNC using svm
2025-05-19 23:19:11,871 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:11,871 - INFO - [__main__] - Successfully got last prediction for DNC
2025-05-19 23:19:11,871 - INFO - [__main__] - 
Processing ticker: DNL
2025-05-19 23:19:11,871 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:11,871 - INFO - [__main__] - Getting last prediction point for ticker: DNL
2025-05-19 23:19:11,871 - INFO - [__main__] - ==================================================
2025-05-19 23:19:11,871 - INFO - [__main__] - Preparing test data for DNL...
2025-05-19 23:19:11,918 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:11,918 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:11,918 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:11,941 - INFO - [src.data_preparation] - Ticker DNL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:11,941 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(169), np.int64(1): np.int64(470)}
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] - Ticker DNL - Selected features:
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   vnipc_t: 0.0952
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   ATR: 0.0806
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   ma14_t: 0.0793
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   ma21_t: 0.0746
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   Volatility: 0.0681
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   ma7_t: 0.0666
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   TVV: 0.0640
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   SK: 0.0618
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   s_d7_t: 0.0609
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   LO: 0.0487
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   variation_t: 0.0446
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   PM: 0.0443
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   ret: 0.0425
2025-05-19 23:19:12,236 - INFO - [src.data_preparation] -   Median_HL: 0.0425
2025-05-19 23:19:12,241 - INFO - [src.data_preparation] - Ticker DNL - Using features: ['Date', 'vnipc_t', 'ATR', 'ma14_t', 'ma21_t', 'Volatility', 'ma7_t', 'TVV', 'SK', 's_d7_t', 'SR', 'LO', 'variation_t', 'PM', 'ret', 'Median_HL']
2025-05-19 23:19:12,326 - INFO - [src.data_preparation] - Ticker DNL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:12,326 - INFO - [src.data_preparation] - Ticker DNL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:12,331 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DNL
2025-05-19 23:19:12,331 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:12,331 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(116), np.int64(1): np.int64(347)}
2025-05-19 23:19:12,331 - INFO - [src.data_preparation] - Generating 231 synthetic minority samples
2025-05-19 23:19:12,341 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (694, 13, 15), y shape: (694,)
2025-05-19 23:19:12,341 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(347), np.int64(1): np.int64(347)}
2025-05-19 23:19:12,341 - INFO - [src.data_preparation] - Ticker DNL - Final 3D shapes: X_train=(694, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:12,341 - INFO - [__main__] - Using best model for DNL: svm (F1: 0.9136)
2025-05-19 23:19:12,341 - INFO - [__main__] - Loading svm model for DNL...
2025-05-19 23:19:12,346 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:12,346 - INFO - [__main__] - Model size: 1.05 MB
2025-05-19 23:19:12,346 - INFO - [__main__] - Making predictions for DNL using svm
2025-05-19 23:19:12,346 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:12,346 - INFO - [__main__] - Successfully got last prediction for DNL
2025-05-19 23:19:12,346 - INFO - [__main__] - 
Processing ticker: DNM
2025-05-19 23:19:12,346 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:12,346 - INFO - [__main__] - Getting last prediction point for ticker: DNM
2025-05-19 23:19:12,346 - INFO - [__main__] - ==================================================
2025-05-19 23:19:12,346 - INFO - [__main__] - Preparing test data for DNM...
2025-05-19 23:19:12,376 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:19:12,376 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:12,376 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:12,396 - INFO - [src.data_preparation] - Ticker DNM - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:19:12,396 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(369)}
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] - Ticker DNM - Selected features:
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   SK: 0.0746
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   vnipc_t: 0.0687
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   ATR: 0.0634
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   Volatility: 0.0618
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   Median_HL: 0.0612
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   ma14_t: 0.0597
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   PM: 0.0594
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   insec_t: 0.0590
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   ma21_t: 0.0588
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   ma7_t: 0.0533
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   HL: 0.0532
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:19:12,712 - INFO - [src.data_preparation] -   ret: 0.0490
2025-05-19 23:19:12,717 - INFO - [src.data_preparation] - Ticker DNM - Using features: ['Date', 'SK', 'vnipc_t', 'ATR', 'Volatility', 'Median_HL', 'ma14_t', 'PM', 's_d7_t', 'TVV', 'insec_t', 'ma21_t', 'ma7_t', 'HL', 'SR', 'ret']
2025-05-19 23:19:12,797 - INFO - [src.data_preparation] - Ticker DNM - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:19:12,797 - INFO - [src.data_preparation] - Ticker DNM - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:12,802 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DNM
2025-05-19 23:19:12,802 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:12,802 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(194), np.int64(1): np.int64(269)}
2025-05-19 23:19:12,802 - INFO - [src.data_preparation] - Generating 75 synthetic minority samples
2025-05-19 23:19:12,802 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (538, 13, 15), y shape: (538,)
2025-05-19 23:19:12,802 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(269), np.int64(1): np.int64(269)}
2025-05-19 23:19:12,807 - INFO - [src.data_preparation] - Ticker DNM - Final 3D shapes: X_train=(538, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:12,807 - INFO - [__main__] - Using best model for DNM: svm (F1: 0.7429)
2025-05-19 23:19:12,807 - INFO - [__main__] - Loading svm model for DNM...
2025-05-19 23:19:12,812 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:12,812 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:19:12,812 - INFO - [__main__] - Making predictions for DNM using svm
2025-05-19 23:19:12,812 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:12,812 - INFO - [__main__] - Successfully got last prediction for DNM
2025-05-19 23:19:12,812 - INFO - [__main__] - 
Processing ticker: DNP
2025-05-19 23:19:12,812 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:12,812 - INFO - [__main__] - Getting last prediction point for ticker: DNP
2025-05-19 23:19:12,812 - INFO - [__main__] - ==================================================
2025-05-19 23:19:12,812 - INFO - [__main__] - Preparing test data for DNP...
2025-05-19 23:19:12,842 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:12,842 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:12,842 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:12,862 - INFO - [src.data_preparation] - Ticker DNP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:12,862 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(274), np.int64(1): np.int64(365)}
2025-05-19 23:19:13,170 - INFO - [src.data_preparation] - Ticker DNP - Selected features:
2025-05-19 23:19:13,170 - INFO - [src.data_preparation] -   insec_t: 0.0772
2025-05-19 23:19:13,170 - INFO - [src.data_preparation] -   vnipc_t: 0.0740
2025-05-19 23:19:13,170 - INFO - [src.data_preparation] -   TVV: 0.0689
2025-05-19 23:19:13,170 - INFO - [src.data_preparation] -   ATR: 0.0668
2025-05-19 23:19:13,170 - INFO - [src.data_preparation] -   HL: 0.0643
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   s_d7_t: 0.0643
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   SK: 0.0631
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   SR: 0.0622
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   Volatility: 0.0600
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   ma7_t: 0.0533
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   Median_HL: 0.0510
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   PM: 0.0510
2025-05-19 23:19:13,171 - INFO - [src.data_preparation] -   ma21_t: 0.0477
2025-05-19 23:19:13,174 - INFO - [src.data_preparation] - Ticker DNP - Using features: ['Date', 'insec_t', 'vnipc_t', 'TVV', 'ATR', 'HL', 's_d7_t', 'SK', 'SR', 'Volatility', 'ma7_t', 'ret', 'variation_t', 'Median_HL', 'PM', 'ma21_t']
2025-05-19 23:19:13,270 - INFO - [src.data_preparation] - Ticker DNP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:13,270 - INFO - [src.data_preparation] - Ticker DNP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:13,272 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DNP
2025-05-19 23:19:13,272 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:13,272 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(183), np.int64(1): np.int64(280)}
2025-05-19 23:19:13,272 - INFO - [src.data_preparation] - Generating 97 synthetic minority samples
2025-05-19 23:19:13,277 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (560, 13, 15), y shape: (560,)
2025-05-19 23:19:13,278 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(280), np.int64(1): np.int64(280)}
2025-05-19 23:19:13,285 - INFO - [src.data_preparation] - Ticker DNP - Final 3D shapes: X_train=(560, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:13,285 - INFO - [__main__] - Using best model for DNP: svm (F1: 0.6250)
2025-05-19 23:19:13,285 - INFO - [__main__] - Loading svm model for DNP...
2025-05-19 23:19:13,286 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:13,287 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:19:13,288 - INFO - [__main__] - Making predictions for DNP using svm
2025-05-19 23:19:13,288 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:13,288 - INFO - [__main__] - Successfully got last prediction for DNP
2025-05-19 23:19:13,288 - INFO - [__main__] - 
Processing ticker: DNT
2025-05-19 23:19:13,289 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:13,289 - INFO - [__main__] - Getting last prediction point for ticker: DNT
2025-05-19 23:19:13,289 - INFO - [__main__] - ==================================================
2025-05-19 23:19:13,289 - INFO - [__main__] - Preparing test data for DNT...
2025-05-19 23:19:13,327 - INFO - [src.data_preparation] - After processing - X shape: (358, 19), y shape: (358,)
2025-05-19 23:19:13,327 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:13,327 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:13,346 - INFO - [src.data_preparation] - Ticker DNT - Original shapes: X=(358, 18), y=(358,)
2025-05-19 23:19:13,347 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(36), np.int64(1): np.int64(322)}
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] - Ticker DNT - Selected features:
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   ma21_t: 0.1253
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   vnipc_t: 0.1131
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   ma14_t: 0.0894
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   ATR: 0.0804
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   s_d7_t: 0.0732
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   SK: 0.0700
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   PM: 0.0644
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   Median_HL: 0.0627
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   ma7_t: 0.0596
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   TVV: 0.0550
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   Volatility: 0.0462
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   SR: 0.0408
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   ret: 0.0300
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   variation_t: 0.0286
2025-05-19 23:19:13,510 - INFO - [src.data_preparation] -   HL: 0.0267
2025-05-19 23:19:13,515 - INFO - [src.data_preparation] - Ticker DNT - Using features: ['Date', 'ma21_t', 'vnipc_t', 'ma14_t', 'ATR', 's_d7_t', 'SK', 'PM', 'Median_HL', 'ma7_t', 'TVV', 'Volatility', 'SR', 'ret', 'variation_t', 'HL']
2025-05-19 23:19:13,565 - INFO - [src.data_preparation] - Ticker DNT - 2D shapes: X_train=(182, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:13,565 - INFO - [src.data_preparation] - Ticker DNT - 3D shapes: X_train=(182, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:13,565 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE for ticker DNT - insufficient samples per class or only one class
2025-05-19 23:19:13,565 - INFO - [src.data_preparation] - Ticker DNT - Final 3D shapes: X_train=(182, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:13,565 - INFO - [__main__] - Using best model for DNT: lstm (F1: 0.9000)
2025-05-19 23:19:13,565 - INFO - [__main__] - Loading lstm model for DNT...
2025-05-19 23:19:13,570 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:13,570 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:19:13,570 - INFO - [__main__] - Making predictions for DNT using lstm
2025-05-19 23:19:13,575 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:13,575 - INFO - [__main__] - Successfully got last prediction for DNT
2025-05-19 23:19:13,575 - INFO - [__main__] - 
Processing ticker: DPC
2025-05-19 23:19:13,575 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:13,575 - INFO - [__main__] - Getting last prediction point for ticker: DPC
2025-05-19 23:19:13,575 - INFO - [__main__] - ==================================================
2025-05-19 23:19:13,575 - INFO - [__main__] - Preparing test data for DPC...
2025-05-19 23:19:13,611 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:13,611 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:13,611 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:13,631 - INFO - [src.data_preparation] - Ticker DPC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:13,631 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(214), np.int64(1): np.int64(424)}
2025-05-19 23:19:13,951 - INFO - [src.data_preparation] - Ticker DPC - Selected features:
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   vnipc_t: 0.0760
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   TVV: 0.0735
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   HL: 0.0631
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   Volatility: 0.0625
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   ATR: 0.0610
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   SK: 0.0599
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   s_d7_t: 0.0599
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   ma14_t: 0.0597
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   ma21_t: 0.0593
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   ma7_t: 0.0579
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   insec_t: 0.0532
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   ret: 0.0515
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] -   variation_t: 0.0500
2025-05-19 23:19:13,956 - INFO - [src.data_preparation] - Ticker DPC - Using features: ['Date', 'vnipc_t', 'TVV', 'HL', 'Volatility', 'ATR', 'SK', 's_d7_t', 'ma14_t', 'ma21_t', 'ma7_t', 'insec_t', 'Median_HL', 'PM', 'ret', 'variation_t']
2025-05-19 23:19:14,051 - INFO - [src.data_preparation] - Ticker DPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:19:14,051 - INFO - [src.data_preparation] - Ticker DPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:14,056 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DPC
2025-05-19 23:19:14,056 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:14,056 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(164), np.int64(1): np.int64(299)}
2025-05-19 23:19:14,056 - INFO - [src.data_preparation] - Generating 135 synthetic minority samples
2025-05-19 23:19:14,061 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (598, 13, 15), y shape: (598,)
2025-05-19 23:19:14,061 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(299), np.int64(1): np.int64(299)}
2025-05-19 23:19:14,066 - INFO - [src.data_preparation] - Ticker DPC - Final 3D shapes: X_train=(598, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:14,066 - INFO - [__main__] - Using best model for DPC: svm (F1: 0.8974)
2025-05-19 23:19:14,066 - INFO - [__main__] - Loading svm model for DPC...
2025-05-19 23:19:14,066 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:14,066 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:19:14,066 - INFO - [__main__] - Making predictions for DPC using svm
2025-05-19 23:19:14,066 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:14,066 - INFO - [__main__] - Successfully got last prediction for DPC
2025-05-19 23:19:14,066 - INFO - [__main__] - 
Processing ticker: DPM
2025-05-19 23:19:14,066 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:14,066 - INFO - [__main__] - Getting last prediction point for ticker: DPM
2025-05-19 23:19:14,066 - INFO - [__main__] - ==================================================
2025-05-19 23:19:14,066 - INFO - [__main__] - Preparing test data for DPM...
2025-05-19 23:19:14,096 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:14,096 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:14,096 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:14,111 - INFO - [src.data_preparation] - Ticker DPM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:14,116 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(306), np.int64(1): np.int64(333)}
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] - Ticker DPM - Selected features:
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   vnipc_t: 0.0734
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   SK: 0.0640
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   TVV: 0.0631
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   HL: 0.0617
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   insec_t: 0.0613
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   SR: 0.0611
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   LO: 0.0588
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   PM: 0.0578
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   ret: 0.0572
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   Median_HL: 0.0561
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   ma7_t: 0.0546
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   ma21_t: 0.0529
2025-05-19 23:19:14,416 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:19:14,420 - INFO - [src.data_preparation] - Ticker DPM - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'TVV', 's_d7_t', 'HL', 'insec_t', 'SR', 'LO', 'PM', 'ret', 'Median_HL', 'ma7_t', 'ma21_t', 'variation_t']
2025-05-19 23:19:14,501 - INFO - [src.data_preparation] - Ticker DPM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:14,501 - INFO - [src.data_preparation] - Ticker DPM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:14,501 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DPM
2025-05-19 23:19:14,501 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:14,501 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(217), np.int64(1): np.int64(246)}
2025-05-19 23:19:14,501 - INFO - [src.data_preparation] - Generating 29 synthetic minority samples
2025-05-19 23:19:14,506 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (492, 13, 15), y shape: (492,)
2025-05-19 23:19:14,506 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(246), np.int64(1): np.int64(246)}
2025-05-19 23:19:14,506 - INFO - [src.data_preparation] - Ticker DPM - Final 3D shapes: X_train=(492, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:14,506 - INFO - [__main__] - Using best model for DPM: lstm (F1: 0.6875)
2025-05-19 23:19:14,506 - INFO - [__main__] - Loading lstm model for DPM...
2025-05-19 23:19:14,512 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:14,512 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:19:14,512 - INFO - [__main__] - Making predictions for DPM using lstm
2025-05-19 23:19:14,517 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:14,517 - INFO - [__main__] - Successfully got last prediction for DPM
2025-05-19 23:19:14,517 - INFO - [__main__] - 
Processing ticker: DPP
2025-05-19 23:19:14,517 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:14,517 - INFO - [__main__] - Getting last prediction point for ticker: DPP
2025-05-19 23:19:14,517 - INFO - [__main__] - ==================================================
2025-05-19 23:19:14,517 - INFO - [__main__] - Preparing test data for DPP...
2025-05-19 23:19:14,552 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:14,552 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:14,552 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:14,567 - INFO - [src.data_preparation] - Ticker DPP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:14,567 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(95), np.int64(1): np.int64(544)}
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] - Ticker DPP - Selected features:
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   vnipc_t: 0.1051
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   ma21_t: 0.1017
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   ma14_t: 0.0846
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   ma7_t: 0.0698
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   s_d7_t: 0.0696
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   TVV: 0.0646
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   PM: 0.0638
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   ATR: 0.0636
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   Volatility: 0.0606
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   Median_HL: 0.0570
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   ret: 0.0496
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   SK: 0.0492
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   variation_t: 0.0433
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   insec_t: 0.0313
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] -   LO: 0.0292
2025-05-19 23:19:14,842 - INFO - [src.data_preparation] - Ticker DPP - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'TVV', 'PM', 'ATR', 'Volatility', 'Median_HL', 'ret', 'SK', 'variation_t', 'insec_t', 'LO']
2025-05-19 23:19:14,932 - INFO - [src.data_preparation] - Ticker DPP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:14,932 - INFO - [src.data_preparation] - Ticker DPP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:14,937 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DPP
2025-05-19 23:19:14,937 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:14,937 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(78), np.int64(1): np.int64(385)}
2025-05-19 23:19:14,937 - INFO - [src.data_preparation] - Generating 307 synthetic minority samples
2025-05-19 23:19:14,947 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (770, 13, 15), y shape: (770,)
2025-05-19 23:19:14,947 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(385), np.int64(1): np.int64(385)}
2025-05-19 23:19:14,952 - INFO - [src.data_preparation] - Ticker DPP - Final 3D shapes: X_train=(770, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:14,952 - INFO - [__main__] - Using best model for DPP: svm (F1: 0.9647)
2025-05-19 23:19:14,952 - INFO - [__main__] - Loading svm model for DPP...
2025-05-19 23:19:14,952 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:14,957 - INFO - [__main__] - Model size: 1.16 MB
2025-05-19 23:19:14,957 - INFO - [__main__] - Making predictions for DPP using svm
2025-05-19 23:19:14,957 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:14,957 - INFO - [__main__] - Successfully got last prediction for DPP
2025-05-19 23:19:14,957 - INFO - [__main__] - 
Processing ticker: DPR
2025-05-19 23:19:14,957 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:14,957 - INFO - [__main__] - Getting last prediction point for ticker: DPR
2025-05-19 23:19:14,957 - INFO - [__main__] - ==================================================
2025-05-19 23:19:14,957 - INFO - [__main__] - Preparing test data for DPR...
2025-05-19 23:19:14,987 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:14,987 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:14,987 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:15,007 - INFO - [src.data_preparation] - Ticker DPR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:15,007 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] - Ticker DPR - Selected features:
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   vnipc_t: 0.0754
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   TVV: 0.0718
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   Volatility: 0.0709
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   SK: 0.0698
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   ATR: 0.0617
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   ret: 0.0611
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   s_d7_t: 0.0608
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   LO: 0.0569
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   variation_t: 0.0569
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   SR: 0.0549
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   HL: 0.0517
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   ma7_t: 0.0502
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   PM: 0.0490
2025-05-19 23:19:15,303 - INFO - [src.data_preparation] -   ma14_t: 0.0481
2025-05-19 23:19:15,308 - INFO - [src.data_preparation] - Ticker DPR - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'insec_t', 'ATR', 'ret', 's_d7_t', 'LO', 'variation_t', 'SR', 'HL', 'ma7_t', 'PM', 'ma14_t']
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Ticker DPR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Ticker DPR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DPR
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:19:15,398 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:19:15,403 - INFO - [src.data_preparation] - Ticker DPR - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:15,403 - INFO - [__main__] - Using best model for DPR: logistic_regression (F1: 0.7143)
2025-05-19 23:19:15,403 - INFO - [__main__] - Loading logistic_regression model for DPR...
2025-05-19 23:19:15,403 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:15,403 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:15,403 - INFO - [__main__] - Making predictions for DPR using logistic_regression
2025-05-19 23:19:15,403 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:15,403 - INFO - [__main__] - Successfully got last prediction for DPR
2025-05-19 23:19:15,403 - INFO - [__main__] - 
Processing ticker: DQC
2025-05-19 23:19:15,403 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:15,403 - INFO - [__main__] - Getting last prediction point for ticker: DQC
2025-05-19 23:19:15,403 - INFO - [__main__] - ==================================================
2025-05-19 23:19:15,403 - INFO - [__main__] - Preparing test data for DQC...
2025-05-19 23:19:15,443 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:15,443 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:15,443 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:15,473 - INFO - [src.data_preparation] - Ticker DQC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:15,473 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(323), np.int64(1): np.int64(316)}
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] - Ticker DQC - Selected features:
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   vnipc_t: 0.0718
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   TVV: 0.0701
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   SK: 0.0683
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   Volatility: 0.0680
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   ATR: 0.0625
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   insec_t: 0.0616
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   HL: 0.0573
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   ma14_t: 0.0560
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   LO: 0.0552
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   ma21_t: 0.0550
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   SR: 0.0537
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:19:15,808 - INFO - [src.data_preparation] -   variation_t: 0.0511
2025-05-19 23:19:15,813 - INFO - [src.data_preparation] - Ticker DQC - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'Volatility', 's_d7_t', 'ATR', 'insec_t', 'HL', 'ma14_t', 'LO', 'ma21_t', 'ma7_t', 'SR', 'ret', 'variation_t']
2025-05-19 23:19:15,893 - INFO - [src.data_preparation] - Ticker DQC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:15,893 - INFO - [src.data_preparation] - Ticker DQC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:15,893 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DQC
2025-05-19 23:19:15,893 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:15,898 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(229), np.int64(1): np.int64(234)}
2025-05-19 23:19:15,898 - INFO - [src.data_preparation] - Generating 5 synthetic minority samples
2025-05-19 23:19:15,898 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (468, 13, 15), y shape: (468,)
2025-05-19 23:19:15,898 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(234), np.int64(1): np.int64(234)}
2025-05-19 23:19:15,898 - INFO - [src.data_preparation] - Ticker DQC - Final 3D shapes: X_train=(468, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:15,898 - INFO - [__main__] - Using best model for DQC: lstm (F1: 0.4828)
2025-05-19 23:19:15,898 - INFO - [__main__] - Loading lstm model for DQC...
2025-05-19 23:19:15,903 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:15,903 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:19:15,903 - INFO - [__main__] - Making predictions for DQC using lstm
2025-05-19 23:19:15,908 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:15,908 - INFO - [__main__] - Successfully got last prediction for DQC
2025-05-19 23:19:15,908 - INFO - [__main__] - 
Processing ticker: DRC
2025-05-19 23:19:15,908 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:15,908 - INFO - [__main__] - Getting last prediction point for ticker: DRC
2025-05-19 23:19:15,908 - INFO - [__main__] - ==================================================
2025-05-19 23:19:15,908 - INFO - [__main__] - Preparing test data for DRC...
2025-05-19 23:19:15,953 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:15,953 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:15,953 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:15,973 - INFO - [src.data_preparation] - Ticker DRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:15,978 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(293), np.int64(1): np.int64(346)}
2025-05-19 23:19:16,319 - INFO - [src.data_preparation] - Ticker DRC - Selected features:
2025-05-19 23:19:16,319 - INFO - [src.data_preparation] -   vnipc_t: 0.0696
2025-05-19 23:19:16,319 - INFO - [src.data_preparation] -   SK: 0.0665
2025-05-19 23:19:16,319 - INFO - [src.data_preparation] -   ATR: 0.0655
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   Volatility: 0.0636
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   insec_t: 0.0628
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   TVV: 0.0625
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   HL: 0.0582
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   Median_HL: 0.0579
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   ma21_t: 0.0569
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   variation_t: 0.0549
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   LO: 0.0528
2025-05-19 23:19:16,322 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:19:16,324 - INFO - [src.data_preparation] - Ticker DRC - Using features: ['Date', 'vnipc_t', 'SK', 'ATR', 'Volatility', 's_d7_t', 'insec_t', 'TVV', 'HL', 'Median_HL', 'ma21_t', 'PM', 'variation_t', 'ma7_t', 'LO', 'SR']
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Ticker DRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Ticker DRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DRC
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:19:16,414 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:19:16,422 - INFO - [src.data_preparation] - Ticker DRC - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:16,422 - INFO - [__main__] - Using best model for DRC: logistic_regression (F1: 0.1053)
2025-05-19 23:19:16,424 - INFO - [__main__] - Loading logistic_regression model for DRC...
2025-05-19 23:19:16,424 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:16,424 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:16,424 - INFO - [__main__] - Making predictions for DRC using logistic_regression
2025-05-19 23:19:16,424 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:16,424 - INFO - [__main__] - Successfully got last prediction for DRC
2025-05-19 23:19:16,424 - INFO - [__main__] - 
Processing ticker: DRH
2025-05-19 23:19:16,424 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:16,424 - INFO - [__main__] - Getting last prediction point for ticker: DRH
2025-05-19 23:19:16,424 - INFO - [__main__] - ==================================================
2025-05-19 23:19:16,424 - INFO - [__main__] - Preparing test data for DRH...
2025-05-19 23:19:16,459 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:16,459 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:16,459 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:16,479 - INFO - [src.data_preparation] - Ticker DRH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:16,479 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(306), np.int64(1): np.int64(333)}
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] - Ticker DRH - Selected features:
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   vnipc_t: 0.0766
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   SK: 0.0751
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   Volatility: 0.0677
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   TVV: 0.0632
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   s_d7_t: 0.0625
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   SR: 0.0581
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   ret: 0.0555
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   ma21_t: 0.0552
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   PM: 0.0549
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   insec_t: 0.0543
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   ma14_t: 0.0542
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   HL: 0.0533
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   ma7_t: 0.0527
2025-05-19 23:19:16,779 - INFO - [src.data_preparation] -   variation_t: 0.0510
2025-05-19 23:19:16,784 - INFO - [src.data_preparation] - Ticker DRH - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'TVV', 's_d7_t', 'ATR', 'SR', 'ret', 'ma21_t', 'PM', 'insec_t', 'ma14_t', 'HL', 'ma7_t', 'variation_t']
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Ticker DRH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Ticker DRH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DRH
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:19:16,869 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:19:16,874 - INFO - [src.data_preparation] - Ticker DRH - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:16,874 - INFO - [__main__] - Using best model for DRH: svm (F1: 0.8421)
2025-05-19 23:19:16,874 - INFO - [__main__] - Loading svm model for DRH...
2025-05-19 23:19:16,874 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:16,874 - INFO - [__main__] - Model size: 0.74 MB
2025-05-19 23:19:16,874 - INFO - [__main__] - Making predictions for DRH using svm
2025-05-19 23:19:16,874 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:16,874 - INFO - [__main__] - Successfully got last prediction for DRH
2025-05-19 23:19:16,874 - INFO - [__main__] - 
Processing ticker: DRL
2025-05-19 23:19:16,874 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:16,874 - INFO - [__main__] - Getting last prediction point for ticker: DRL
2025-05-19 23:19:16,874 - INFO - [__main__] - ==================================================
2025-05-19 23:19:16,874 - INFO - [__main__] - Preparing test data for DRL...
2025-05-19 23:19:16,909 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:16,909 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:16,909 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:16,929 - INFO - [src.data_preparation] - Ticker DRL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:16,929 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(239), np.int64(1): np.int64(400)}
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] - Ticker DRL - Selected features:
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   vnipc_t: 0.0779
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   s_d7_t: 0.0734
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   insec_t: 0.0723
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   TVV: 0.0698
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   SK: 0.0678
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   ATR: 0.0603
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   ret: 0.0558
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   SR: 0.0557
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   HL: 0.0538
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   variation_t: 0.0528
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   LO: 0.0511
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   ma21_t: 0.0511
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] -   Median_HL: 0.0476
2025-05-19 23:19:17,244 - INFO - [src.data_preparation] - Ticker DRL - Using features: ['Date', 'vnipc_t', 's_d7_t', 'insec_t', 'TVV', 'SK', 'Volatility', 'ATR', 'ret', 'SR', 'HL', 'variation_t', 'LO', 'ma21_t', 'ma7_t', 'Median_HL']
2025-05-19 23:19:17,324 - INFO - [src.data_preparation] - Ticker DRL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:17,324 - INFO - [src.data_preparation] - Ticker DRL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:17,324 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DRL
2025-05-19 23:19:17,324 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:17,324 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(161), np.int64(1): np.int64(302)}
2025-05-19 23:19:17,324 - INFO - [src.data_preparation] - Generating 141 synthetic minority samples
2025-05-19 23:19:17,329 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (604, 13, 15), y shape: (604,)
2025-05-19 23:19:17,334 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(302), np.int64(1): np.int64(302)}
2025-05-19 23:19:17,334 - INFO - [src.data_preparation] - Ticker DRL - Final 3D shapes: X_train=(604, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:17,334 - INFO - [__main__] - Using best model for DRL: lstm (F1: 0.6032)
2025-05-19 23:19:17,334 - INFO - [__main__] - Loading lstm model for DRL...
2025-05-19 23:19:17,339 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:17,339 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:19:17,339 - INFO - [__main__] - Making predictions for DRL using lstm
2025-05-19 23:19:17,344 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:19:17,344 - INFO - [__main__] - Successfully got last prediction for DRL
2025-05-19 23:19:17,344 - INFO - [__main__] - 
Processing ticker: DSN
2025-05-19 23:19:17,344 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:17,344 - INFO - [__main__] - Getting last prediction point for ticker: DSN
2025-05-19 23:19:17,344 - INFO - [__main__] - ==================================================
2025-05-19 23:19:17,344 - INFO - [__main__] - Preparing test data for DSN...
2025-05-19 23:19:17,384 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:17,384 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:17,384 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:17,409 - INFO - [src.data_preparation] - Ticker DSN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:17,409 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(279), np.int64(1): np.int64(360)}
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] - Ticker DSN - Selected features:
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   SK: 0.0735
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   vnipc_t: 0.0700
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   TVV: 0.0699
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   insec_t: 0.0692
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   s_d7_t: 0.0656
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   Volatility: 0.0630
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   SR: 0.0600
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   HL: 0.0589
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   LO: 0.0555
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   ma14_t: 0.0549
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   variation_t: 0.0501
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   ret: 0.0499
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   ma21_t: 0.0499
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] -   ma7_t: 0.0492
2025-05-19 23:19:17,735 - INFO - [src.data_preparation] - Ticker DSN - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'insec_t', 's_d7_t', 'Volatility', 'SR', 'HL', 'ATR', 'LO', 'ma14_t', 'variation_t', 'ret', 'ma21_t', 'ma7_t']
2025-05-19 23:19:17,845 - INFO - [src.data_preparation] - Ticker DSN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:17,845 - INFO - [src.data_preparation] - Ticker DSN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:17,850 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DSN
2025-05-19 23:19:17,850 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:17,850 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:19:17,850 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:19:17,855 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:19:17,855 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:19:17,860 - INFO - [src.data_preparation] - Ticker DSN - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:17,860 - INFO - [__main__] - Using best model for DSN: logistic_regression (F1: 0.2143)
2025-05-19 23:19:17,860 - INFO - [__main__] - Loading logistic_regression model for DSN...
2025-05-19 23:19:17,860 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:17,860 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:17,860 - INFO - [__main__] - Making predictions for DSN using logistic_regression
2025-05-19 23:19:17,860 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:17,860 - INFO - [__main__] - Successfully got last prediction for DSN
2025-05-19 23:19:17,860 - INFO - [__main__] - 
Processing ticker: DST
2025-05-19 23:19:17,860 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:17,860 - INFO - [__main__] - Getting last prediction point for ticker: DST
2025-05-19 23:19:17,860 - INFO - [__main__] - ==================================================
2025-05-19 23:19:17,860 - INFO - [__main__] - Preparing test data for DST...
2025-05-19 23:19:17,902 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:17,902 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:17,902 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:17,925 - INFO - [src.data_preparation] - Ticker DST - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:17,925 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(261), np.int64(1): np.int64(378)}
2025-05-19 23:19:18,225 - INFO - [src.data_preparation] - Ticker DST - Selected features:
2025-05-19 23:19:18,225 - INFO - [src.data_preparation] -   vnipc_t: 0.0741
2025-05-19 23:19:18,225 - INFO - [src.data_preparation] -   TVV: 0.0683
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   insec_t: 0.0638
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   s_d7_t: 0.0633
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   ATR: 0.0632
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   SK: 0.0629
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   ma21_t: 0.0619
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   ma7_t: 0.0611
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   ma14_t: 0.0590
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   ret: 0.0538
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   HL: 0.0492
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] -   PM: 0.0490
2025-05-19 23:19:18,230 - INFO - [src.data_preparation] - Ticker DST - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'insec_t', 's_d7_t', 'ATR', 'SK', 'ma21_t', 'ma7_t', 'ma14_t', 'ret', 'variation_t', 'Median_HL', 'HL', 'PM']
2025-05-19 23:19:18,320 - INFO - [src.data_preparation] - Ticker DST - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:18,320 - INFO - [src.data_preparation] - Ticker DST - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:18,324 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DST
2025-05-19 23:19:18,324 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:18,324 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(186), np.int64(1): np.int64(277)}
2025-05-19 23:19:18,325 - INFO - [src.data_preparation] - Generating 91 synthetic minority samples
2025-05-19 23:19:18,325 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (554, 13, 15), y shape: (554,)
2025-05-19 23:19:18,325 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(277), np.int64(1): np.int64(277)}
2025-05-19 23:19:18,330 - INFO - [src.data_preparation] - Ticker DST - Final 3D shapes: X_train=(554, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:18,330 - INFO - [__main__] - Using best model for DST: lstm (F1: 0.7778)
2025-05-19 23:19:18,330 - INFO - [__main__] - Loading lstm model for DST...
2025-05-19 23:19:18,335 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:18,335 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:19:18,335 - INFO - [__main__] - Making predictions for DST using lstm
2025-05-19 23:19:18,340 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:18,340 - INFO - [__main__] - Successfully got last prediction for DST
2025-05-19 23:19:18,340 - INFO - [__main__] - 
Processing ticker: DTA
2025-05-19 23:19:18,340 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:18,340 - INFO - [__main__] - Getting last prediction point for ticker: DTA
2025-05-19 23:19:18,340 - INFO - [__main__] - ==================================================
2025-05-19 23:19:18,340 - INFO - [__main__] - Preparing test data for DTA...
2025-05-19 23:19:18,390 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:18,390 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:18,390 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:18,410 - INFO - [src.data_preparation] - Ticker DTA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:18,410 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(323), np.int64(1): np.int64(316)}
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] - Ticker DTA - Selected features:
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   insec_t: 0.0712
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   s_d7_t: 0.0679
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   vnipc_t: 0.0652
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   HL: 0.0610
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   TVV: 0.0603
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   ma14_t: 0.0597
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   SK: 0.0588
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   ma21_t: 0.0580
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   ATR: 0.0561
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   ret: 0.0546
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   ma7_t: 0.0545
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   SR: 0.0545
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:19:18,766 - INFO - [src.data_preparation] -   variation_t: 0.0518
2025-05-19 23:19:18,771 - INFO - [src.data_preparation] - Ticker DTA - Using features: ['Date', 'insec_t', 's_d7_t', 'vnipc_t', 'Volatility', 'HL', 'TVV', 'ma14_t', 'SK', 'ma21_t', 'ATR', 'ret', 'ma7_t', 'SR', 'Median_HL', 'variation_t']
2025-05-19 23:19:18,861 - INFO - [src.data_preparation] - Ticker DTA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:18,861 - INFO - [src.data_preparation] - Ticker DTA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DTA
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:19:18,866 - INFO - [src.data_preparation] - Ticker DTA - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:18,866 - INFO - [__main__] - Using best model for DTA: transformer (F1: 0.6341)
2025-05-19 23:19:18,866 - INFO - [__main__] - Loading transformer model for DTA...
2025-05-19 23:19:18,881 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:18,881 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:19:18,881 - INFO - [__main__] - Making predictions for DTA using transformer
2025-05-19 23:19:18,886 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:18,886 - INFO - [__main__] - Successfully got last prediction for DTA
2025-05-19 23:19:18,886 - INFO - [__main__] - 
Processing ticker: DTC
2025-05-19 23:19:18,886 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:18,886 - INFO - [__main__] - Getting last prediction point for ticker: DTC
2025-05-19 23:19:18,886 - INFO - [__main__] - ==================================================
2025-05-19 23:19:18,886 - INFO - [__main__] - Preparing test data for DTC...
2025-05-19 23:19:18,936 - INFO - [src.data_preparation] - After processing - X shape: (635, 19), y shape: (635,)
2025-05-19 23:19:18,936 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:18,936 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:18,961 - INFO - [src.data_preparation] - Ticker DTC - Original shapes: X=(635, 18), y=(635,)
2025-05-19 23:19:18,966 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(378)}
2025-05-19 23:19:19,361 - INFO - [src.data_preparation] - Ticker DTC - Selected features:
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   TVV: 0.0763
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   SK: 0.0716
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   Volatility: 0.0632
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   ret: 0.0610
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   ATR: 0.0607
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   insec_t: 0.0589
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   ma7_t: 0.0587
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   ma21_t: 0.0584
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   ma14_t: 0.0583
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   HL: 0.0557
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   variation_t: 0.0543
2025-05-19 23:19:19,362 - INFO - [src.data_preparation] -   SR: 0.0523
2025-05-19 23:19:19,363 - INFO - [src.data_preparation] -   PM: 0.0448
2025-05-19 23:19:19,366 - INFO - [src.data_preparation] - Ticker DTC - Using features: ['Date', 'TVV', 'vnipc_t', 'SK', 'Volatility', 's_d7_t', 'ret', 'ATR', 'insec_t', 'ma7_t', 'ma21_t', 'ma14_t', 'HL', 'variation_t', 'SR', 'PM']
2025-05-19 23:19:19,464 - INFO - [src.data_preparation] - Ticker DTC - 2D shapes: X_train=(459, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:19,464 - INFO - [src.data_preparation] - Ticker DTC - 3D shapes: X_train=(459, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:19,465 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DTC
2025-05-19 23:19:19,465 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (459, 13, 15), y shape: (459,)
2025-05-19 23:19:19,466 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(174), np.int64(1): np.int64(285)}
2025-05-19 23:19:19,466 - INFO - [src.data_preparation] - Generating 111 synthetic minority samples
2025-05-19 23:19:19,471 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (570, 13, 15), y shape: (570,)
2025-05-19 23:19:19,471 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(285), np.int64(1): np.int64(285)}
2025-05-19 23:19:19,476 - INFO - [src.data_preparation] - Ticker DTC - Final 3D shapes: X_train=(570, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:19,476 - INFO - [__main__] - Using best model for DTC: lstm (F1: 0.6667)
2025-05-19 23:19:19,476 - INFO - [__main__] - Loading lstm model for DTC...
2025-05-19 23:19:19,480 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:19,481 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:19,481 - INFO - [__main__] - Making predictions for DTC using lstm
2025-05-19 23:19:19,482 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:19,483 - INFO - [__main__] - Successfully got last prediction for DTC
2025-05-19 23:19:19,483 - INFO - [__main__] - 
Processing ticker: DTL
2025-05-19 23:19:19,483 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:19,483 - INFO - [__main__] - Getting last prediction point for ticker: DTL
2025-05-19 23:19:19,483 - INFO - [__main__] - ==================================================
2025-05-19 23:19:19,483 - INFO - [__main__] - Preparing test data for DTL...
2025-05-19 23:19:19,528 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:19,528 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:19,529 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:19,551 - INFO - [src.data_preparation] - Ticker DTL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:19,551 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(264), np.int64(1): np.int64(375)}
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] - Ticker DTL - Selected features:
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   ma21_t: 0.0685
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   vnipc_t: 0.0683
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   SK: 0.0649
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   ret: 0.0648
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   Volatility: 0.0643
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   ATR: 0.0639
2025-05-19 23:19:19,875 - INFO - [src.data_preparation] -   variation_t: 0.0611
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   s_d7_t: 0.0609
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   insec_t: 0.0576
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   ma14_t: 0.0568
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   SR: 0.0534
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   Median_HL: 0.0501
2025-05-19 23:19:19,876 - INFO - [src.data_preparation] -   HL: 0.0487
2025-05-19 23:19:19,879 - INFO - [src.data_preparation] - Ticker DTL - Using features: ['Date', 'ma21_t', 'vnipc_t', 'SK', 'ret', 'Volatility', 'ATR', 'variation_t', 's_d7_t', 'TVV', 'ma7_t', 'insec_t', 'ma14_t', 'SR', 'Median_HL', 'HL']
2025-05-19 23:19:19,978 - INFO - [src.data_preparation] - Ticker DTL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:19,978 - INFO - [src.data_preparation] - Ticker DTL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:19,981 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DTL
2025-05-19 23:19:19,981 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:19,982 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(175), np.int64(1): np.int64(288)}
2025-05-19 23:19:19,982 - INFO - [src.data_preparation] - Generating 113 synthetic minority samples
2025-05-19 23:19:19,986 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (576, 13, 15), y shape: (576,)
2025-05-19 23:19:19,987 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(288), np.int64(1): np.int64(288)}
2025-05-19 23:19:19,991 - INFO - [src.data_preparation] - Ticker DTL - Final 3D shapes: X_train=(576, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:19,991 - INFO - [__main__] - Using best model for DTL: svm (F1: 0.7246)
2025-05-19 23:19:19,991 - INFO - [__main__] - Loading svm model for DTL...
2025-05-19 23:19:19,992 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:19,993 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:19:19,993 - INFO - [__main__] - Making predictions for DTL using svm
2025-05-19 23:19:19,993 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:19,994 - INFO - [__main__] - Successfully got last prediction for DTL
2025-05-19 23:19:19,994 - INFO - [__main__] - 
Processing ticker: DTT
2025-05-19 23:19:19,994 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:19,994 - INFO - [__main__] - Getting last prediction point for ticker: DTT
2025-05-19 23:19:19,994 - INFO - [__main__] - ==================================================
2025-05-19 23:19:19,994 - INFO - [__main__] - Preparing test data for DTT...
2025-05-19 23:19:20,033 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:20,033 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:20,033 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:20,058 - INFO - [src.data_preparation] - Ticker DTT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:20,058 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(191), np.int64(1): np.int64(448)}
2025-05-19 23:19:20,353 - INFO - [src.data_preparation] - Ticker DTT - Selected features:
2025-05-19 23:19:20,353 - INFO - [src.data_preparation] -   vnipc_t: 0.0759
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   Volatility: 0.0741
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   ATR: 0.0705
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   insec_t: 0.0704
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   ma21_t: 0.0685
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   s_d7_t: 0.0645
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   ma14_t: 0.0640
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   TVV: 0.0638
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   SK: 0.0607
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   ma7_t: 0.0569
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   Median_HL: 0.0553
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   HL: 0.0489
2025-05-19 23:19:20,354 - INFO - [src.data_preparation] -   SR: 0.0465
2025-05-19 23:19:20,355 - INFO - [src.data_preparation] -   variation_t: 0.0441
2025-05-19 23:19:20,358 - INFO - [src.data_preparation] - Ticker DTT - Using features: ['Date', 'vnipc_t', 'Volatility', 'ATR', 'insec_t', 'ma21_t', 's_d7_t', 'ma14_t', 'TVV', 'SK', 'ma7_t', 'Median_HL', 'PM', 'HL', 'SR', 'variation_t']
2025-05-19 23:19:20,467 - INFO - [src.data_preparation] - Ticker DTT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:20,467 - INFO - [src.data_preparation] - Ticker DTT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:20,469 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DTT
2025-05-19 23:19:20,469 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:20,470 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(143), np.int64(1): np.int64(320)}
2025-05-19 23:19:20,470 - INFO - [src.data_preparation] - Generating 177 synthetic minority samples
2025-05-19 23:19:20,482 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (640, 13, 15), y shape: (640,)
2025-05-19 23:19:20,482 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(320), np.int64(1): np.int64(320)}
2025-05-19 23:19:20,486 - INFO - [src.data_preparation] - Ticker DTT - Final 3D shapes: X_train=(640, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:20,486 - INFO - [__main__] - Using best model for DTT: svm (F1: 0.7606)
2025-05-19 23:19:20,486 - INFO - [__main__] - Loading svm model for DTT...
2025-05-19 23:19:20,488 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:20,489 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:19:20,489 - INFO - [__main__] - Making predictions for DTT using svm
2025-05-19 23:19:20,490 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:20,491 - INFO - [__main__] - Successfully got last prediction for DTT
2025-05-19 23:19:20,491 - INFO - [__main__] - 
Processing ticker: DVP
2025-05-19 23:19:20,491 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:20,491 - INFO - [__main__] - Getting last prediction point for ticker: DVP
2025-05-19 23:19:20,491 - INFO - [__main__] - ==================================================
2025-05-19 23:19:20,491 - INFO - [__main__] - Preparing test data for DVP...
2025-05-19 23:19:20,532 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:20,532 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:20,532 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:20,552 - INFO - [src.data_preparation] - Ticker DVP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:20,552 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(295), np.int64(1): np.int64(344)}
2025-05-19 23:19:20,861 - INFO - [src.data_preparation] - Ticker DVP - Selected features:
2025-05-19 23:19:20,861 - INFO - [src.data_preparation] -   vnipc_t: 0.0677
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   TVV: 0.0647
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   ATR: 0.0646
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   LO: 0.0643
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   insec_t: 0.0622
2025-05-19 23:19:20,862 - INFO - [src.data_preparation] -   HL: 0.0597
2025-05-19 23:19:20,863 - INFO - [src.data_preparation] -   SR: 0.0557
2025-05-19 23:19:20,863 - INFO - [src.data_preparation] -   ret: 0.0556
2025-05-19 23:19:20,863 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:19:20,863 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:19:20,863 - INFO - [src.data_preparation] -   ma21_t: 0.0500
2025-05-19 23:19:20,863 - INFO - [src.data_preparation] -   PM: 0.0489
2025-05-19 23:19:20,866 - INFO - [src.data_preparation] - Ticker DVP - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'ATR', 'LO', 'Volatility', 's_d7_t', 'insec_t', 'HL', 'SR', 'ret', 'Median_HL', 'variation_t', 'ma21_t', 'PM']
2025-05-19 23:19:20,968 - INFO - [src.data_preparation] - Ticker DVP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:20,969 - INFO - [src.data_preparation] - Ticker DVP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:20,971 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DVP
2025-05-19 23:19:20,971 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:20,971 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:19:20,972 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:19:20,974 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:19:20,974 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:19:20,978 - INFO - [src.data_preparation] - Ticker DVP - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:20,979 - INFO - [__main__] - Using best model for DVP: logistic_regression (F1: 0.6415)
2025-05-19 23:19:20,979 - INFO - [__main__] - Loading logistic_regression model for DVP...
2025-05-19 23:19:20,980 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:20,980 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:20,980 - INFO - [__main__] - Making predictions for DVP using logistic_regression
2025-05-19 23:19:20,981 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:20,981 - INFO - [__main__] - Successfully got last prediction for DVP
2025-05-19 23:19:20,981 - INFO - [__main__] - 
Processing ticker: DXG
2025-05-19 23:19:20,981 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:20,981 - INFO - [__main__] - Getting last prediction point for ticker: DXG
2025-05-19 23:19:20,981 - INFO - [__main__] - ==================================================
2025-05-19 23:19:20,981 - INFO - [__main__] - Preparing test data for DXG...
2025-05-19 23:19:21,028 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:21,028 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:21,028 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:21,059 - INFO - [src.data_preparation] - Ticker DXG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:21,059 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(292), np.int64(1): np.int64(347)}
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] - Ticker DXG - Selected features:
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   insec_t: 0.0739
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   Volatility: 0.0659
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   LO: 0.0636
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   SK: 0.0629
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   TVV: 0.0606
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   HL: 0.0569
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   ma7_t: 0.0556
2025-05-19 23:19:21,363 - INFO - [src.data_preparation] -   variation_t: 0.0551
2025-05-19 23:19:21,364 - INFO - [src.data_preparation] -   ret: 0.0534
2025-05-19 23:19:21,364 - INFO - [src.data_preparation] -   SR: 0.0532
2025-05-19 23:19:21,364 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:19:21,364 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:19:21,364 - INFO - [src.data_preparation] -   ma14_t: 0.0520
2025-05-19 23:19:21,367 - INFO - [src.data_preparation] - Ticker DXG - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'LO', 'SK', 'TVV', 'HL', 'ma7_t', 'variation_t', 'ret', 'SR', 'Median_HL', 'PM', 'ma14_t']
2025-05-19 23:19:21,448 - INFO - [src.data_preparation] - Ticker DXG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:21,448 - INFO - [src.data_preparation] - Ticker DXG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:21,450 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DXG
2025-05-19 23:19:21,450 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:21,450 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:19:21,450 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:19:21,452 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:19:21,453 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:19:21,456 - INFO - [src.data_preparation] - Ticker DXG - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:21,456 - INFO - [__main__] - Using best model for DXG: svm (F1: 0.8065)
2025-05-19 23:19:21,456 - INFO - [__main__] - Loading svm model for DXG...
2025-05-19 23:19:21,458 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:21,458 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:19:21,458 - INFO - [__main__] - Making predictions for DXG using svm
2025-05-19 23:19:21,459 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:21,459 - INFO - [__main__] - Successfully got last prediction for DXG
2025-05-19 23:19:21,459 - INFO - [__main__] - 
Processing ticker: DXL
2025-05-19 23:19:21,459 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:21,459 - INFO - [__main__] - Getting last prediction point for ticker: DXL
2025-05-19 23:19:21,460 - INFO - [__main__] - ==================================================
2025-05-19 23:19:21,460 - INFO - [__main__] - Preparing test data for DXL...
2025-05-19 23:19:21,484 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:21,484 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:21,484 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:21,501 - INFO - [src.data_preparation] - Ticker DXL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:21,501 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(60), np.int64(1): np.int64(579)}
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] - Ticker DXL - Selected features:
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   vnipc_t: 0.1380
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   HL: 0.1026
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   ma21_t: 0.0932
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   ma14_t: 0.0810
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   ma7_t: 0.0655
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   Median_HL: 0.0646
2025-05-19 23:19:21,675 - INFO - [src.data_preparation] -   PM: 0.0612
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   ATR: 0.0542
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   s_d7_t: 0.0526
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   SR: 0.0496
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   ret: 0.0405
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   Volatility: 0.0395
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   SK: 0.0357
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   LO: 0.0320
2025-05-19 23:19:21,676 - INFO - [src.data_preparation] -   TVV: 0.0315
2025-05-19 23:19:21,678 - INFO - [src.data_preparation] - Ticker DXL - Using features: ['Date', 'vnipc_t', 'HL', 'ma21_t', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 'ATR', 's_d7_t', 'SR', 'ret', 'Volatility', 'SK', 'LO', 'TVV']
2025-05-19 23:19:21,755 - INFO - [src.data_preparation] - Ticker DXL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:21,755 - INFO - [src.data_preparation] - Ticker DXL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:21,757 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DXL
2025-05-19 23:19:21,757 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:21,757 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(15), np.int64(1): np.int64(448)}
2025-05-19 23:19:21,757 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:19:21,760 - INFO - [src.data_preparation] - Ticker DXL - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:21,760 - INFO - [__main__] - Using best model for DXL: lstm (F1: 0.8718)
2025-05-19 23:19:21,760 - INFO - [__main__] - Loading lstm model for DXL...
2025-05-19 23:19:21,765 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:21,767 - INFO - [__main__] - Model size: 0.36 MB
2025-05-19 23:19:21,767 - INFO - [__main__] - Making predictions for DXL using lstm
2025-05-19 23:19:21,771 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:21,771 - INFO - [__main__] - Successfully got last prediction for DXL
2025-05-19 23:19:21,771 - INFO - [__main__] - 
Processing ticker: DXP
2025-05-19 23:19:21,771 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:21,771 - INFO - [__main__] - Getting last prediction point for ticker: DXP
2025-05-19 23:19:21,771 - INFO - [__main__] - ==================================================
2025-05-19 23:19:21,771 - INFO - [__main__] - Preparing test data for DXP...
2025-05-19 23:19:21,799 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:21,799 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:21,799 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:21,829 - INFO - [src.data_preparation] - Ticker DXP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:21,829 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:19:22,157 - INFO - [src.data_preparation] - Ticker DXP - Selected features:
2025-05-19 23:19:22,157 - INFO - [src.data_preparation] -   s_d7_t: 0.0694
2025-05-19 23:19:22,157 - INFO - [src.data_preparation] -   vnipc_t: 0.0677
2025-05-19 23:19:22,157 - INFO - [src.data_preparation] -   Volatility: 0.0662
2025-05-19 23:19:22,157 - INFO - [src.data_preparation] -   ma14_t: 0.0640
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   insec_t: 0.0635
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   PM: 0.0630
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   TVV: 0.0607
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   SK: 0.0599
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   ma21_t: 0.0591
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   ma7_t: 0.0575
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   Median_HL: 0.0552
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   ret: 0.0522
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   HL: 0.0483
2025-05-19 23:19:22,158 - INFO - [src.data_preparation] -   SR: 0.0481
2025-05-19 23:19:22,161 - INFO - [src.data_preparation] - Ticker DXP - Using features: ['Date', 's_d7_t', 'vnipc_t', 'Volatility', 'ma14_t', 'insec_t', 'PM', 'TVV', 'SK', 'ma21_t', 'ATR', 'ma7_t', 'Median_HL', 'ret', 'HL', 'SR']
2025-05-19 23:19:22,240 - INFO - [src.data_preparation] - Ticker DXP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:22,240 - INFO - [src.data_preparation] - Ticker DXP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:22,241 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DXP
2025-05-19 23:19:22,242 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:22,242 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:19:22,242 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:19:22,243 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:19:22,243 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:19:22,246 - INFO - [src.data_preparation] - Ticker DXP - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:22,246 - INFO - [__main__] - Using best model for DXP: logistic_regression (F1: 0.6349)
2025-05-19 23:19:22,246 - INFO - [__main__] - Loading logistic_regression model for DXP...
2025-05-19 23:19:22,247 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:22,247 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:22,247 - INFO - [__main__] - Making predictions for DXP using logistic_regression
2025-05-19 23:19:22,247 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:22,247 - INFO - [__main__] - Successfully got last prediction for DXP
2025-05-19 23:19:22,247 - INFO - [__main__] - 
Processing ticker: DXV
2025-05-19 23:19:22,248 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:22,248 - INFO - [__main__] - Getting last prediction point for ticker: DXV
2025-05-19 23:19:22,248 - INFO - [__main__] - ==================================================
2025-05-19 23:19:22,248 - INFO - [__main__] - Preparing test data for DXV...
2025-05-19 23:19:22,273 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:22,273 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:22,273 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:22,290 - INFO - [src.data_preparation] - Ticker DXV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:22,291 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(293), np.int64(1): np.int64(346)}
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] - Ticker DXV - Selected features:
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] -   Volatility: 0.0767
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] -   vnipc_t: 0.0748
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] -   insec_t: 0.0716
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] -   s_d7_t: 0.0652
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] -   ATR: 0.0639
2025-05-19 23:19:22,592 - INFO - [src.data_preparation] -   SK: 0.0602
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   TVV: 0.0596
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   ma14_t: 0.0565
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   HL: 0.0556
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   Median_HL: 0.0548
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   ma7_t: 0.0521
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   PM: 0.0511
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   LO: 0.0490
2025-05-19 23:19:22,593 - INFO - [src.data_preparation] -   variation_t: 0.0483
2025-05-19 23:19:22,596 - INFO - [src.data_preparation] - Ticker DXV - Using features: ['Date', 'Volatility', 'vnipc_t', 'insec_t', 's_d7_t', 'ATR', 'SK', 'TVV', 'ma14_t', 'HL', 'Median_HL', 'ret', 'ma7_t', 'PM', 'LO', 'variation_t']
2025-05-19 23:19:22,687 - INFO - [src.data_preparation] - Ticker DXV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:22,687 - INFO - [src.data_preparation] - Ticker DXV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:22,689 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DXV
2025-05-19 23:19:22,689 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:22,689 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:19:22,689 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:19:22,693 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:19:22,693 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:19:22,696 - INFO - [src.data_preparation] - Ticker DXV - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:22,696 - INFO - [__main__] - Using best model for DXV: transformer (F1: 0.6222)
2025-05-19 23:19:22,696 - INFO - [__main__] - Loading transformer model for DXV...
2025-05-19 23:19:22,708 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:22,711 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:22,711 - INFO - [__main__] - Making predictions for DXV using transformer
2025-05-19 23:19:22,712 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:22,712 - INFO - [__main__] - Successfully got last prediction for DXV
2025-05-19 23:19:22,713 - INFO - [__main__] - 
Processing ticker: DZM
2025-05-19 23:19:22,713 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:22,713 - INFO - [__main__] - Getting last prediction point for ticker: DZM
2025-05-19 23:19:22,713 - INFO - [__main__] - ==================================================
2025-05-19 23:19:22,713 - INFO - [__main__] - Preparing test data for DZM...
2025-05-19 23:19:22,763 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:19:22,763 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:22,764 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:22,794 - INFO - [src.data_preparation] - Ticker DZM - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:19:22,795 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(222), np.int64(1): np.int64(415)}
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] - Ticker DZM - Selected features:
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   HL: 0.0797
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   ATR: 0.0760
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   vnipc_t: 0.0743
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   TVV: 0.0686
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   insec_t: 0.0589
2025-05-19 23:19:23,089 - INFO - [src.data_preparation] -   ma14_t: 0.0578
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   SK: 0.0548
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   ma21_t: 0.0524
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   Median_HL: 0.0511
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   ma7_t: 0.0507
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   LO: 0.0488
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   SR: 0.0482
2025-05-19 23:19:23,090 - INFO - [src.data_preparation] -   ret: 0.0466
2025-05-19 23:19:23,095 - INFO - [src.data_preparation] - Ticker DZM - Using features: ['Date', 'HL', 'ATR', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'insec_t', 'ma14_t', 'SK', 'ma21_t', 'Median_HL', 'ma7_t', 'LO', 'SR', 'ret']
2025-05-19 23:19:23,201 - INFO - [src.data_preparation] - Ticker DZM - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:19:23,201 - INFO - [src.data_preparation] - Ticker DZM - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:23,203 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker DZM
2025-05-19 23:19:23,203 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:23,203 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:19:23,203 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:19:23,207 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:19:23,207 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:19:23,210 - INFO - [src.data_preparation] - Ticker DZM - Final 3D shapes: X_train=(540, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:23,210 - INFO - [__main__] - Using best model for DZM: lstm (F1: 0.9885)
2025-05-19 23:19:23,210 - INFO - [__main__] - Loading lstm model for DZM...
2025-05-19 23:19:23,215 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:23,215 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:19:23,216 - INFO - [__main__] - Making predictions for DZM using lstm
2025-05-19 23:19:23,218 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:23,218 - INFO - [__main__] - Successfully got last prediction for DZM
2025-05-19 23:19:23,218 - INFO - [__main__] - 
Processing ticker: EBS
2025-05-19 23:19:23,218 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:23,218 - INFO - [__main__] - Getting last prediction point for ticker: EBS
2025-05-19 23:19:23,219 - INFO - [__main__] - ==================================================
2025-05-19 23:19:23,219 - INFO - [__main__] - Preparing test data for EBS...
2025-05-19 23:19:23,257 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:23,257 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:23,257 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:23,280 - INFO - [src.data_preparation] - Ticker EBS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:23,280 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(227), np.int64(1): np.int64(412)}
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] - Ticker EBS - Selected features:
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   s_d7_t: 0.0754
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   TVV: 0.0681
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   SK: 0.0623
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   ATR: 0.0619
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   HL: 0.0604
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   ma14_t: 0.0567
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   insec_t: 0.0562
2025-05-19 23:19:23,609 - INFO - [src.data_preparation] -   SR: 0.0551
2025-05-19 23:19:23,610 - INFO - [src.data_preparation] -   ma21_t: 0.0550
2025-05-19 23:19:23,610 - INFO - [src.data_preparation] -   variation_t: 0.0546
2025-05-19 23:19:23,610 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:19:23,610 - INFO - [src.data_preparation] -   ret: 0.0528
2025-05-19 23:19:23,610 - INFO - [src.data_preparation] -   Median_HL: 0.0525
2025-05-19 23:19:23,612 - INFO - [src.data_preparation] - Ticker EBS - Using features: ['Date', 's_d7_t', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'ATR', 'HL', 'ma14_t', 'insec_t', 'SR', 'ma21_t', 'variation_t', 'PM', 'ret', 'Median_HL']
2025-05-19 23:19:23,693 - INFO - [src.data_preparation] - Ticker EBS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:23,693 - INFO - [src.data_preparation] - Ticker EBS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:23,695 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker EBS
2025-05-19 23:19:23,695 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:23,695 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:19:23,695 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:19:23,701 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:19:23,701 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:19:23,704 - INFO - [src.data_preparation] - Ticker EBS - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:23,704 - INFO - [__main__] - Using best model for EBS: svm (F1: 0.6769)
2025-05-19 23:19:23,705 - INFO - [__main__] - Loading svm model for EBS...
2025-05-19 23:19:23,706 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:23,706 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:19:23,706 - INFO - [__main__] - Making predictions for EBS using svm
2025-05-19 23:19:23,707 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:23,707 - INFO - [__main__] - Successfully got last prediction for EBS
2025-05-19 23:19:23,707 - INFO - [__main__] - 
Processing ticker: ECI
2025-05-19 23:19:23,707 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:23,707 - INFO - [__main__] - Getting last prediction point for ticker: ECI
2025-05-19 23:19:23,707 - INFO - [__main__] - ==================================================
2025-05-19 23:19:23,707 - INFO - [__main__] - Preparing test data for ECI...
2025-05-19 23:19:23,732 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:23,732 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:23,732 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:23,749 - INFO - [src.data_preparation] - Ticker ECI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:23,749 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(99), np.int64(1): np.int64(540)}
2025-05-19 23:19:23,964 - INFO - [src.data_preparation] - Ticker ECI - Selected features:
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   vnipc_t: 0.1159
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   ma21_t: 0.0971
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   ma14_t: 0.0840
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   TVV: 0.0731
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   ATR: 0.0679
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   ma7_t: 0.0646
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   s_d7_t: 0.0611
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   Volatility: 0.0601
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   PM: 0.0559
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   SK: 0.0550
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   Median_HL: 0.0487
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   HL: 0.0428
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   insec_t: 0.0388
2025-05-19 23:19:23,965 - INFO - [src.data_preparation] -   ret: 0.0377
2025-05-19 23:19:23,966 - INFO - [src.data_preparation] -   variation_t: 0.0350
2025-05-19 23:19:23,968 - INFO - [src.data_preparation] - Ticker ECI - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'TVV', 'ATR', 'ma7_t', 's_d7_t', 'Volatility', 'PM', 'SK', 'Median_HL', 'HL', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:19:24,057 - INFO - [src.data_preparation] - Ticker ECI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:24,057 - INFO - [src.data_preparation] - Ticker ECI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:24,058 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ECI
2025-05-19 23:19:24,058 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:24,058 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(87), np.int64(1): np.int64(376)}
2025-05-19 23:19:24,059 - INFO - [src.data_preparation] - Generating 289 synthetic minority samples
2025-05-19 23:19:24,069 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (752, 13, 15), y shape: (752,)
2025-05-19 23:19:24,069 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(376), np.int64(1): np.int64(376)}
2025-05-19 23:19:24,073 - INFO - [src.data_preparation] - Ticker ECI - Final 3D shapes: X_train=(752, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:24,073 - INFO - [__main__] - Using best model for ECI: svm (F1: 0.9268)
2025-05-19 23:19:24,073 - INFO - [__main__] - Loading svm model for ECI...
2025-05-19 23:19:24,075 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:24,075 - INFO - [__main__] - Model size: 0.60 MB
2025-05-19 23:19:24,075 - INFO - [__main__] - Making predictions for ECI using svm
2025-05-19 23:19:24,076 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:24,076 - INFO - [__main__] - Successfully got last prediction for ECI
2025-05-19 23:19:24,076 - INFO - [__main__] - 
Processing ticker: EFI
2025-05-19 23:19:24,076 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:24,076 - INFO - [__main__] - Getting last prediction point for ticker: EFI
2025-05-19 23:19:24,076 - INFO - [__main__] - ==================================================
2025-05-19 23:19:24,076 - INFO - [__main__] - Preparing test data for EFI...
2025-05-19 23:19:24,102 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:24,102 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:24,103 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:24,120 - INFO - [src.data_preparation] - Ticker EFI - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:24,121 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(206), np.int64(1): np.int64(432)}
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] - Ticker EFI - Selected features:
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   vnipc_t: 0.0846
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   TVV: 0.0845
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   s_d7_t: 0.0763
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   Volatility: 0.0752
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   SK: 0.0726
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   ATR: 0.0713
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   insec_t: 0.0687
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   ma21_t: 0.0587
2025-05-19 23:19:24,369 - INFO - [src.data_preparation] -   ma14_t: 0.0583
2025-05-19 23:19:24,370 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:19:24,370 - INFO - [src.data_preparation] -   ret: 0.0504
2025-05-19 23:19:24,370 - INFO - [src.data_preparation] -   variation_t: 0.0482
2025-05-19 23:19:24,370 - INFO - [src.data_preparation] -   PM: 0.0445
2025-05-19 23:19:24,370 - INFO - [src.data_preparation] -   Median_HL: 0.0431
2025-05-19 23:19:24,370 - INFO - [src.data_preparation] -   HL: 0.0398
2025-05-19 23:19:24,372 - INFO - [src.data_preparation] - Ticker EFI - Using features: ['Date', 'vnipc_t', 'TVV', 's_d7_t', 'Volatility', 'SK', 'ATR', 'insec_t', 'ma21_t', 'ma14_t', 'ma7_t', 'ret', 'variation_t', 'PM', 'Median_HL', 'HL']
2025-05-19 23:19:24,459 - INFO - [src.data_preparation] - Ticker EFI - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:24,460 - INFO - [src.data_preparation] - Ticker EFI - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:24,461 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker EFI
2025-05-19 23:19:24,461 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:24,461 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(135), np.int64(1): np.int64(327)}
2025-05-19 23:19:24,461 - INFO - [src.data_preparation] - Generating 192 synthetic minority samples
2025-05-19 23:19:24,468 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (654, 13, 15), y shape: (654,)
2025-05-19 23:19:24,468 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(327), np.int64(1): np.int64(327)}
2025-05-19 23:19:24,472 - INFO - [src.data_preparation] - Ticker EFI - Final 3D shapes: X_train=(654, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:24,472 - INFO - [__main__] - Using best model for EFI: lstm (F1: 0.7887)
2025-05-19 23:19:24,472 - INFO - [__main__] - Loading lstm model for EFI...
2025-05-19 23:19:24,476 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:24,478 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:19:24,478 - INFO - [__main__] - Making predictions for EFI using lstm
2025-05-19 23:19:24,481 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:24,481 - INFO - [__main__] - Successfully got last prediction for EFI
2025-05-19 23:19:24,481 - INFO - [__main__] - 
Processing ticker: EIB
2025-05-19 23:19:24,481 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:24,482 - INFO - [__main__] - Getting last prediction point for ticker: EIB
2025-05-19 23:19:24,482 - INFO - [__main__] - ==================================================
2025-05-19 23:19:24,482 - INFO - [__main__] - Preparing test data for EIB...
2025-05-19 23:19:24,512 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:24,512 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:24,512 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:24,534 - INFO - [src.data_preparation] - Ticker EIB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:24,534 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] - Ticker EIB - Selected features:
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] -   insec_t: 0.0718
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] -   vnipc_t: 0.0713
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] -   s_d7_t: 0.0660
2025-05-19 23:19:24,868 - INFO - [src.data_preparation] -   TVV: 0.0643
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   ATR: 0.0614
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   ret: 0.0591
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   Median_HL: 0.0573
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   PM: 0.0548
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   variation_t: 0.0543
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   ma14_t: 0.0542
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   HL: 0.0489
2025-05-19 23:19:24,869 - INFO - [src.data_preparation] -   ma7_t: 0.0486
2025-05-19 23:19:24,872 - INFO - [src.data_preparation] - Ticker EIB - Using features: ['Date', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 's_d7_t', 'TVV', 'ATR', 'ret', 'Median_HL', 'PM', 'ma21_t', 'variation_t', 'ma14_t', 'HL', 'ma7_t']
2025-05-19 23:19:24,985 - INFO - [src.data_preparation] - Ticker EIB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:24,985 - INFO - [src.data_preparation] - Ticker EIB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:24,987 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker EIB
2025-05-19 23:19:24,987 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:24,987 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:19:24,987 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:19:24,989 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:19:24,989 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:19:24,993 - INFO - [src.data_preparation] - Ticker EIB - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:24,993 - INFO - [__main__] - Using best model for EIB: lstm (F1: 0.7059)
2025-05-19 23:19:24,993 - INFO - [__main__] - Loading lstm model for EIB...
2025-05-19 23:19:24,999 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:25,000 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:19:25,000 - INFO - [__main__] - Making predictions for EIB using lstm
2025-05-19 23:19:25,005 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:25,005 - INFO - [__main__] - Successfully got last prediction for EIB
2025-05-19 23:19:25,005 - INFO - [__main__] - 
Processing ticker: EID
2025-05-19 23:19:25,006 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:25,006 - INFO - [__main__] - Getting last prediction point for ticker: EID
2025-05-19 23:19:25,006 - INFO - [__main__] - ==================================================
2025-05-19 23:19:25,006 - INFO - [__main__] - Preparing test data for EID...
2025-05-19 23:19:25,080 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:25,081 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:25,081 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:25,107 - INFO - [src.data_preparation] - Ticker EID - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:25,107 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(385)}
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] - Ticker EID - Selected features:
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] -   vnipc_t: 0.0721
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] -   SK: 0.0699
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] -   HL: 0.0651
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] -   Volatility: 0.0645
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:19:25,462 - INFO - [src.data_preparation] -   insec_t: 0.0638
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   TVV: 0.0618
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   SR: 0.0612
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   LO: 0.0610
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   ret: 0.0581
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   ATR: 0.0579
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   variation_t: 0.0552
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   ma7_t: 0.0514
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   ma14_t: 0.0493
2025-05-19 23:19:25,463 - INFO - [src.data_preparation] -   Median_HL: 0.0488
2025-05-19 23:19:25,466 - INFO - [src.data_preparation] - Ticker EID - Using features: ['Date', 'vnipc_t', 'SK', 'HL', 'Volatility', 's_d7_t', 'insec_t', 'TVV', 'SR', 'LO', 'ret', 'ATR', 'variation_t', 'ma7_t', 'ma14_t', 'Median_HL']
2025-05-19 23:19:25,545 - INFO - [src.data_preparation] - Ticker EID - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:25,545 - INFO - [src.data_preparation] - Ticker EID - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:25,547 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker EID
2025-05-19 23:19:25,547 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:25,547 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(183), np.int64(1): np.int64(280)}
2025-05-19 23:19:25,547 - INFO - [src.data_preparation] - Generating 97 synthetic minority samples
2025-05-19 23:19:25,551 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (560, 13, 15), y shape: (560,)
2025-05-19 23:19:25,551 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(280), np.int64(1): np.int64(280)}
2025-05-19 23:19:25,554 - INFO - [src.data_preparation] - Ticker EID - Final 3D shapes: X_train=(560, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:25,554 - INFO - [__main__] - Using best model for EID: svm (F1: 0.7059)
2025-05-19 23:19:25,554 - INFO - [__main__] - Loading svm model for EID...
2025-05-19 23:19:25,555 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:25,556 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:19:25,556 - INFO - [__main__] - Making predictions for EID using svm
2025-05-19 23:19:25,556 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:25,557 - INFO - [__main__] - Successfully got last prediction for EID
2025-05-19 23:19:25,557 - INFO - [__main__] - 
Processing ticker: ELC
2025-05-19 23:19:25,557 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:25,557 - INFO - [__main__] - Getting last prediction point for ticker: ELC
2025-05-19 23:19:25,557 - INFO - [__main__] - ==================================================
2025-05-19 23:19:25,557 - INFO - [__main__] - Preparing test data for ELC...
2025-05-19 23:19:25,583 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:25,583 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:25,583 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:25,603 - INFO - [src.data_preparation] - Ticker ELC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:25,603 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(301), np.int64(1): np.int64(338)}
2025-05-19 23:19:25,909 - INFO - [src.data_preparation] - Ticker ELC - Selected features:
2025-05-19 23:19:25,909 - INFO - [src.data_preparation] -   vnipc_t: 0.0710
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   insec_t: 0.0706
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   SK: 0.0704
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   Volatility: 0.0669
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   s_d7_t: 0.0635
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   variation_t: 0.0605
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   LO: 0.0570
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   HL: 0.0566
2025-05-19 23:19:25,910 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:19:25,911 - INFO - [src.data_preparation] -   SR: 0.0530
2025-05-19 23:19:25,911 - INFO - [src.data_preparation] -   ATR: 0.0525
2025-05-19 23:19:25,911 - INFO - [src.data_preparation] -   ma14_t: 0.0520
2025-05-19 23:19:25,911 - INFO - [src.data_preparation] -   ma21_t: 0.0505
2025-05-19 23:19:25,911 - INFO - [src.data_preparation] -   ma7_t: 0.0494
2025-05-19 23:19:25,914 - INFO - [src.data_preparation] - Ticker ELC - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 's_d7_t', 'TVV', 'variation_t', 'LO', 'HL', 'ret', 'SR', 'ATR', 'ma14_t', 'ma21_t', 'ma7_t']
2025-05-19 23:19:26,002 - INFO - [src.data_preparation] - Ticker ELC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:26,002 - INFO - [src.data_preparation] - Ticker ELC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:26,004 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ELC
2025-05-19 23:19:26,004 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:26,004 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(243)}
2025-05-19 23:19:26,004 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:19:26,005 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:19:26,005 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:19:26,008 - INFO - [src.data_preparation] - Ticker ELC - Final 3D shapes: X_train=(486, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:26,008 - INFO - [__main__] - Using best model for ELC: svm (F1: 0.5965)
2025-05-19 23:19:26,008 - INFO - [__main__] - Loading svm model for ELC...
2025-05-19 23:19:26,010 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:26,010 - INFO - [__main__] - Model size: 0.63 MB
2025-05-19 23:19:26,010 - INFO - [__main__] - Making predictions for ELC using svm
2025-05-19 23:19:26,011 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:26,011 - INFO - [__main__] - Successfully got last prediction for ELC
2025-05-19 23:19:26,011 - INFO - [__main__] - 
Processing ticker: EVE
2025-05-19 23:19:26,011 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:26,011 - INFO - [__main__] - Getting last prediction point for ticker: EVE
2025-05-19 23:19:26,011 - INFO - [__main__] - ==================================================
2025-05-19 23:19:26,011 - INFO - [__main__] - Preparing test data for EVE...
2025-05-19 23:19:26,040 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:26,040 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:26,040 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:26,059 - INFO - [src.data_preparation] - Ticker EVE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:26,059 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(331), np.int64(1): np.int64(308)}
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] - Ticker EVE - Selected features:
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   Volatility: 0.0687
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   vnipc_t: 0.0686
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   s_d7_t: 0.0672
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   ret: 0.0662
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   variation_t: 0.0626
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   SR: 0.0611
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   LO: 0.0599
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   insec_t: 0.0596
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   HL: 0.0593
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   ATR: 0.0581
2025-05-19 23:19:26,370 - INFO - [src.data_preparation] -   SK: 0.0551
2025-05-19 23:19:26,371 - INFO - [src.data_preparation] -   TVV: 0.0551
2025-05-19 23:19:26,371 - INFO - [src.data_preparation] -   ma21_t: 0.0534
2025-05-19 23:19:26,371 - INFO - [src.data_preparation] -   Median_HL: 0.0515
2025-05-19 23:19:26,371 - INFO - [src.data_preparation] -   ma14_t: 0.0485
2025-05-19 23:19:26,373 - INFO - [src.data_preparation] - Ticker EVE - Using features: ['Date', 'Volatility', 'vnipc_t', 's_d7_t', 'ret', 'variation_t', 'SR', 'LO', 'insec_t', 'HL', 'ATR', 'SK', 'TVV', 'ma21_t', 'Median_HL', 'ma14_t']
2025-05-19 23:19:26,457 - INFO - [src.data_preparation] - Ticker EVE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:26,458 - INFO - [src.data_preparation] - Ticker EVE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:26,459 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker EVE
2025-05-19 23:19:26,459 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:26,459 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(231)}
2025-05-19 23:19:26,459 - INFO - [src.data_preparation] - Generating 1 synthetic minority samples
2025-05-19 23:19:26,460 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:19:26,460 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:19:26,463 - INFO - [src.data_preparation] - Ticker EVE - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:26,463 - INFO - [__main__] - Using best model for EVE: transformer (F1: 0.4800)
2025-05-19 23:19:26,463 - INFO - [__main__] - Loading transformer model for EVE...
2025-05-19 23:19:26,472 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:26,474 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:19:26,474 - INFO - [__main__] - Making predictions for EVE using transformer
2025-05-19 23:19:26,476 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:26,476 - INFO - [__main__] - Successfully got last prediction for EVE
2025-05-19 23:19:26,476 - INFO - [__main__] - 
Processing ticker: FBA
2025-05-19 23:19:26,476 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:26,477 - INFO - [__main__] - Getting last prediction point for ticker: FBA
2025-05-19 23:19:26,477 - INFO - [__main__] - ==================================================
2025-05-19 23:19:26,477 - INFO - [__main__] - Preparing test data for FBA...
2025-05-19 23:19:26,503 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:26,503 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:26,503 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:26,524 - INFO - [src.data_preparation] - Ticker FBA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:26,524 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(78), np.int64(1): np.int64(561)}
2025-05-19 23:19:26,723 - INFO - [src.data_preparation] - Ticker FBA - Selected features:
2025-05-19 23:19:26,723 - INFO - [src.data_preparation] -   vnipc_t: 0.1055
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   Volatility: 0.0888
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   ma21_t: 0.0805
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   ma14_t: 0.0718
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   s_d7_t: 0.0709
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   ATR: 0.0645
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   Median_HL: 0.0616
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   PM: 0.0611
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   TVV: 0.0553
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   ma7_t: 0.0545
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   ret: 0.0456
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   variation_t: 0.0451
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   SK: 0.0445
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   insec_t: 0.0397
2025-05-19 23:19:26,724 - INFO - [src.data_preparation] -   SR: 0.0358
2025-05-19 23:19:26,727 - INFO - [src.data_preparation] - Ticker FBA - Using features: ['Date', 'vnipc_t', 'Volatility', 'ma21_t', 'ma14_t', 's_d7_t', 'ATR', 'Median_HL', 'PM', 'TVV', 'ma7_t', 'ret', 'variation_t', 'SK', 'insec_t', 'SR']
2025-05-19 23:19:26,807 - INFO - [src.data_preparation] - Ticker FBA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:26,807 - INFO - [src.data_preparation] - Ticker FBA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:26,809 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker FBA
2025-05-19 23:19:26,809 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:26,809 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(67), np.int64(1): np.int64(396)}
2025-05-19 23:19:26,809 - INFO - [src.data_preparation] - Generating 329 synthetic minority samples
2025-05-19 23:19:26,820 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (792, 13, 15), y shape: (792,)
2025-05-19 23:19:26,820 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(396), np.int64(1): np.int64(396)}
2025-05-19 23:19:26,824 - INFO - [src.data_preparation] - Ticker FBA - Final 3D shapes: X_train=(792, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:26,824 - INFO - [__main__] - Using best model for FBA: lstm (F1: 0.9885)
2025-05-19 23:19:26,824 - INFO - [__main__] - Loading lstm model for FBA...
2025-05-19 23:19:26,828 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:26,829 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:19:26,829 - INFO - [__main__] - Making predictions for FBA using lstm
2025-05-19 23:19:26,830 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:26,832 - INFO - [__main__] - Successfully got last prediction for FBA
2025-05-19 23:19:26,832 - INFO - [__main__] - 
Processing ticker: FCN
2025-05-19 23:19:26,832 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:26,832 - INFO - [__main__] - Getting last prediction point for ticker: FCN
2025-05-19 23:19:26,832 - INFO - [__main__] - ==================================================
2025-05-19 23:19:26,832 - INFO - [__main__] - Preparing test data for FCN...
2025-05-19 23:19:26,866 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:26,867 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:26,867 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:26,890 - INFO - [src.data_preparation] - Ticker FCN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:26,890 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:19:27,214 - INFO - [src.data_preparation] - Ticker FCN - Selected features:
2025-05-19 23:19:27,214 - INFO - [src.data_preparation] -   SK: 0.0690
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   vnipc_t: 0.0661
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   insec_t: 0.0625
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   ret: 0.0614
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   LO: 0.0596
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   s_d7_t: 0.0592
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   Volatility: 0.0587
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   PM: 0.0572
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   ma7_t: 0.0567
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   TVV: 0.0561
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   ma14_t: 0.0549
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   ma21_t: 0.0540
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   Median_HL: 0.0540
2025-05-19 23:19:27,215 - INFO - [src.data_preparation] -   variation_t: 0.0523
2025-05-19 23:19:27,219 - INFO - [src.data_preparation] - Ticker FCN - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'ret', 'LO', 's_d7_t', 'Volatility', 'PM', 'ma7_t', 'TVV', 'ma14_t', 'HL', 'ma21_t', 'Median_HL', 'variation_t']
2025-05-19 23:19:27,313 - INFO - [src.data_preparation] - Ticker FCN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:27,313 - INFO - [src.data_preparation] - Ticker FCN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:27,315 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker FCN
2025-05-19 23:19:27,315 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:27,315 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:19:27,315 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:19:27,317 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:19:27,317 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:19:27,321 - INFO - [src.data_preparation] - Ticker FCN - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:27,321 - INFO - [__main__] - Using best model for FCN: svm (F1: 0.5763)
2025-05-19 23:19:27,321 - INFO - [__main__] - Loading svm model for FCN...
2025-05-19 23:19:27,323 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:27,324 - INFO - [__main__] - Model size: 0.75 MB
2025-05-19 23:19:27,324 - INFO - [__main__] - Making predictions for FCN using svm
2025-05-19 23:19:27,325 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:27,326 - INFO - [__main__] - Successfully got last prediction for FCN
2025-05-19 23:19:27,326 - INFO - [__main__] - 
Processing ticker: FDC
2025-05-19 23:19:27,326 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:27,326 - INFO - [__main__] - Getting last prediction point for ticker: FDC
2025-05-19 23:19:27,326 - INFO - [__main__] - ==================================================
2025-05-19 23:19:27,326 - INFO - [__main__] - Preparing test data for FDC...
2025-05-19 23:19:27,357 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:27,357 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:27,357 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:27,381 - INFO - [src.data_preparation] - Ticker FDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:27,382 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(291), np.int64(1): np.int64(348)}
2025-05-19 23:19:27,701 - INFO - [src.data_preparation] - Ticker FDC - Selected features:
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   vnipc_t: 0.0717
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   SK: 0.0675
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   Median_HL: 0.0621
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   ATR: 0.0617
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   Volatility: 0.0610
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   ma7_t: 0.0605
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   ma21_t: 0.0604
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   TVV: 0.0598
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   PM: 0.0576
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   insec_t: 0.0564
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   variation_t: 0.0538
2025-05-19 23:19:27,702 - INFO - [src.data_preparation] -   ma14_t: 0.0527
2025-05-19 23:19:27,703 - INFO - [src.data_preparation] -   SR: 0.0516
2025-05-19 23:19:27,705 - INFO - [src.data_preparation] - Ticker FDC - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'Median_HL', 'ATR', 'Volatility', 'ma7_t', 'ma21_t', 'TVV', 'PM', 'insec_t', 'HL', 'variation_t', 'ma14_t', 'SR']
2025-05-19 23:19:27,785 - INFO - [src.data_preparation] - Ticker FDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:27,785 - INFO - [src.data_preparation] - Ticker FDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:27,787 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker FDC
2025-05-19 23:19:27,787 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:27,787 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:19:27,787 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:19:27,789 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:19:27,789 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:19:27,792 - INFO - [src.data_preparation] - Ticker FDC - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:27,792 - INFO - [__main__] - Using best model for FDC: transformer (F1: 0.8421)
2025-05-19 23:19:27,792 - INFO - [__main__] - Loading transformer model for FDC...
2025-05-19 23:19:27,807 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:19:27,811 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:19:27,811 - INFO - [__main__] - Making predictions for FDC using transformer
2025-05-19 23:19:27,813 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:27,813 - INFO - [__main__] - Successfully got last prediction for FDC
2025-05-19 23:19:27,813 - INFO - [__main__] - 
Processing ticker: FLC
2025-05-19 23:19:27,813 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:27,813 - INFO - [__main__] - Getting last prediction point for ticker: FLC
2025-05-19 23:19:27,813 - INFO - [__main__] - ==================================================
2025-05-19 23:19:27,813 - INFO - [__main__] - Preparing test data for FLC...
2025-05-19 23:19:27,847 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:27,847 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:27,847 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:27,866 - INFO - [src.data_preparation] - Ticker FLC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:27,867 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(386)}
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] - Ticker FLC - Selected features:
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   HL: 0.0930
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   TVV: 0.0785
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   vnipc_t: 0.0712
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   s_d7_t: 0.0665
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   ATR: 0.0637
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   insec_t: 0.0617
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   PM: 0.0606
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   Volatility: 0.0600
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   Median_HL: 0.0560
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   SK: 0.0547
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   ma7_t: 0.0546
2025-05-19 23:19:28,176 - INFO - [src.data_preparation] -   ma21_t: 0.0517
2025-05-19 23:19:28,177 - INFO - [src.data_preparation] -   ma14_t: 0.0475
2025-05-19 23:19:28,177 - INFO - [src.data_preparation] -   ret: 0.0464
2025-05-19 23:19:28,177 - INFO - [src.data_preparation] -   LO: 0.0444
2025-05-19 23:19:28,179 - INFO - [src.data_preparation] - Ticker FLC - Using features: ['Date', 'HL', 'TVV', 'vnipc_t', 's_d7_t', 'ATR', 'insec_t', 'PM', 'Volatility', 'Median_HL', 'SK', 'ma7_t', 'ma21_t', 'ma14_t', 'ret', 'LO']
2025-05-19 23:19:28,259 - INFO - [src.data_preparation] - Ticker FLC - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:19:28,259 - INFO - [src.data_preparation] - Ticker FLC - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:28,260 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker FLC
2025-05-19 23:19:28,261 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:28,261 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(225), np.int64(1): np.int64(238)}
2025-05-19 23:19:28,261 - INFO - [src.data_preparation] - Generating 13 synthetic minority samples
2025-05-19 23:19:28,262 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (476, 13, 15), y shape: (476,)
2025-05-19 23:19:28,262 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(238)}
2025-05-19 23:19:28,264 - INFO - [src.data_preparation] - Ticker FLC - Final 3D shapes: X_train=(476, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:28,264 - INFO - [__main__] - Using best model for FLC: lstm (F1: 0.9885)
2025-05-19 23:19:28,264 - INFO - [__main__] - Loading lstm model for FLC...
2025-05-19 23:19:28,269 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:28,270 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:19:28,270 - INFO - [__main__] - Making predictions for FLC using lstm
2025-05-19 23:19:28,272 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:28,272 - INFO - [__main__] - Successfully got last prediction for FLC
2025-05-19 23:19:28,273 - INFO - [__main__] - 
Processing ticker: FMC
2025-05-19 23:19:28,273 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:28,273 - INFO - [__main__] - Getting last prediction point for ticker: FMC
2025-05-19 23:19:28,273 - INFO - [__main__] - ==================================================
2025-05-19 23:19:28,273 - INFO - [__main__] - Preparing test data for FMC...
2025-05-19 23:19:28,302 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:28,302 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:28,302 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:28,322 - INFO - [src.data_preparation] - Ticker FMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:28,322 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] - Ticker FMC - Selected features:
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   SK: 0.0739
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   TVV: 0.0732
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   insec_t: 0.0729
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   SR: 0.0623
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   Volatility: 0.0617
2025-05-19 23:19:28,653 - INFO - [src.data_preparation] -   HL: 0.0570
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   variation_t: 0.0559
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   ret: 0.0542
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   LO: 0.0538
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   ATR: 0.0529
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   PM: 0.0528
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   ma21_t: 0.0501
2025-05-19 23:19:28,654 - INFO - [src.data_preparation] -   Median_HL: 0.0496
2025-05-19 23:19:28,656 - INFO - [src.data_preparation] - Ticker FMC - Using features: ['Date', 'SK', 'TVV', 'insec_t', 'vnipc_t', 'SR', 's_d7_t', 'Volatility', 'HL', 'variation_t', 'ret', 'LO', 'ATR', 'PM', 'ma21_t', 'Median_HL']
2025-05-19 23:19:28,737 - INFO - [src.data_preparation] - Ticker FMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:28,737 - INFO - [src.data_preparation] - Ticker FMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:28,738 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker FMC
2025-05-19 23:19:28,738 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:28,738 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:19:28,738 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:19:28,741 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:19:28,741 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:19:28,744 - INFO - [src.data_preparation] - Ticker FMC - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:28,744 - INFO - [__main__] - Using best model for FMC: lstm (F1: 0.6667)
2025-05-19 23:19:28,744 - INFO - [__main__] - Loading lstm model for FMC...
2025-05-19 23:19:28,748 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:28,749 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:28,749 - INFO - [__main__] - Making predictions for FMC using lstm
2025-05-19 23:19:28,751 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:28,751 - INFO - [__main__] - Successfully got last prediction for FMC
2025-05-19 23:19:28,751 - INFO - [__main__] - 
Processing ticker: FPT
2025-05-19 23:19:28,751 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:28,752 - INFO - [__main__] - Getting last prediction point for ticker: FPT
2025-05-19 23:19:28,752 - INFO - [__main__] - ==================================================
2025-05-19 23:19:28,752 - INFO - [__main__] - Preparing test data for FPT...
2025-05-19 23:19:28,784 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:28,784 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:28,784 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:28,804 - INFO - [src.data_preparation] - Ticker FPT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:28,805 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(270), np.int64(1): np.int64(369)}
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] - Ticker FPT - Selected features:
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   Volatility: 0.0788
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   insec_t: 0.0748
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   vnipc_t: 0.0745
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   SK: 0.0672
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   TVV: 0.0644
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   ret: 0.0615
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   HL: 0.0577
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   LO: 0.0575
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   SR: 0.0575
2025-05-19 23:19:29,136 - INFO - [src.data_preparation] -   ATR: 0.0556
2025-05-19 23:19:29,137 - INFO - [src.data_preparation] -   s_d7_t: 0.0546
2025-05-19 23:19:29,137 - INFO - [src.data_preparation] -   variation_t: 0.0541
2025-05-19 23:19:29,137 - INFO - [src.data_preparation] -   ma14_t: 0.0536
2025-05-19 23:19:29,137 - INFO - [src.data_preparation] -   Median_HL: 0.0487
2025-05-19 23:19:29,137 - INFO - [src.data_preparation] -   ma21_t: 0.0469
2025-05-19 23:19:29,139 - INFO - [src.data_preparation] - Ticker FPT - Using features: ['Date', 'Volatility', 'insec_t', 'vnipc_t', 'SK', 'TVV', 'ret', 'HL', 'LO', 'SR', 'ATR', 's_d7_t', 'variation_t', 'ma14_t', 'Median_HL', 'ma21_t']
2025-05-19 23:19:29,218 - INFO - [src.data_preparation] - Ticker FPT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:29,218 - INFO - [src.data_preparation] - Ticker FPT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:29,219 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker FPT
2025-05-19 23:19:29,219 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:29,220 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:19:29,220 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:19:29,223 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:19:29,223 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:19:29,226 - INFO - [src.data_preparation] - Ticker FPT - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:29,226 - INFO - [__main__] - Using best model for FPT: lstm (F1: 0.6667)
2025-05-19 23:19:29,226 - INFO - [__main__] - Loading lstm model for FPT...
2025-05-19 23:19:29,230 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:29,231 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:29,231 - INFO - [__main__] - Making predictions for FPT using lstm
2025-05-19 23:19:29,232 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:29,233 - INFO - [__main__] - Successfully got last prediction for FPT
2025-05-19 23:19:29,233 - INFO - [__main__] - 
Processing ticker: GAS
2025-05-19 23:19:29,233 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:29,233 - INFO - [__main__] - Getting last prediction point for ticker: GAS
2025-05-19 23:19:29,233 - INFO - [__main__] - ==================================================
2025-05-19 23:19:29,233 - INFO - [__main__] - Preparing test data for GAS...
2025-05-19 23:19:29,262 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:29,262 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:29,262 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:29,282 - INFO - [src.data_preparation] - Ticker GAS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:29,282 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(337)}
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] - Ticker GAS - Selected features:
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   TVV: 0.0735
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   Volatility: 0.0696
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   insec_t: 0.0690
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   ATR: 0.0661
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   SK: 0.0639
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   vnipc_t: 0.0623
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   HL: 0.0568
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   variation_t: 0.0556
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   LO: 0.0553
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   SR: 0.0551
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   ma14_t: 0.0544
2025-05-19 23:19:29,604 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:19:29,605 - INFO - [src.data_preparation] -   ret: 0.0511
2025-05-19 23:19:29,605 - INFO - [src.data_preparation] -   ma21_t: 0.0508
2025-05-19 23:19:29,605 - INFO - [src.data_preparation] -   s_d7_t: 0.0507
2025-05-19 23:19:29,607 - INFO - [src.data_preparation] - Ticker GAS - Using features: ['Date', 'TVV', 'Volatility', 'insec_t', 'ATR', 'SK', 'vnipc_t', 'HL', 'variation_t', 'LO', 'SR', 'ma14_t', 'PM', 'ret', 'ma21_t', 's_d7_t']
2025-05-19 23:19:29,698 - INFO - [src.data_preparation] - Ticker GAS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:29,698 - INFO - [src.data_preparation] - Ticker GAS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:29,701 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GAS
2025-05-19 23:19:29,701 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:29,702 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:19:29,702 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:19:29,704 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:19:29,704 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:19:29,707 - INFO - [src.data_preparation] - Ticker GAS - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:29,708 - INFO - [__main__] - Using best model for GAS: logistic_regression (F1: 0.6154)
2025-05-19 23:19:29,708 - INFO - [__main__] - Loading logistic_regression model for GAS...
2025-05-19 23:19:29,709 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:29,709 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:29,709 - INFO - [__main__] - Making predictions for GAS using logistic_regression
2025-05-19 23:19:29,709 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:29,710 - INFO - [__main__] - Successfully got last prediction for GAS
2025-05-19 23:19:29,710 - INFO - [__main__] - 
Processing ticker: GDT
2025-05-19 23:19:29,710 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:29,710 - INFO - [__main__] - Getting last prediction point for ticker: GDT
2025-05-19 23:19:29,710 - INFO - [__main__] - ==================================================
2025-05-19 23:19:29,710 - INFO - [__main__] - Preparing test data for GDT...
2025-05-19 23:19:29,740 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:29,740 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:29,740 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:29,761 - INFO - [src.data_preparation] - Ticker GDT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:29,761 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:19:30,080 - INFO - [src.data_preparation] - Ticker GDT - Selected features:
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   LO: 0.0716
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   TVV: 0.0701
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   vnipc_t: 0.0682
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   insec_t: 0.0657
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   SR: 0.0632
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   SK: 0.0627
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   Volatility: 0.0619
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   ATR: 0.0602
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   HL: 0.0594
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   variation_t: 0.0537
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   ma7_t: 0.0536
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   ma21_t: 0.0514
2025-05-19 23:19:30,081 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:19:30,082 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:19:30,084 - INFO - [src.data_preparation] - Ticker GDT - Using features: ['Date', 'LO', 'TVV', 'vnipc_t', 'insec_t', 'SR', 'SK', 'Volatility', 'ATR', 'HL', 's_d7_t', 'variation_t', 'ma7_t', 'ma21_t', 'ret', 'Median_HL']
2025-05-19 23:19:30,164 - INFO - [src.data_preparation] - Ticker GDT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:30,164 - INFO - [src.data_preparation] - Ticker GDT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:30,165 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GDT
2025-05-19 23:19:30,165 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:30,165 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:19:30,166 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:19:30,168 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:19:30,168 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:19:30,171 - INFO - [src.data_preparation] - Ticker GDT - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:30,171 - INFO - [__main__] - Using best model for GDT: logistic_regression (F1: 0.4500)
2025-05-19 23:19:30,171 - INFO - [__main__] - Loading logistic_regression model for GDT...
2025-05-19 23:19:30,172 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:30,172 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:30,172 - INFO - [__main__] - Making predictions for GDT using logistic_regression
2025-05-19 23:19:30,172 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:30,173 - INFO - [__main__] - Successfully got last prediction for GDT
2025-05-19 23:19:30,173 - INFO - [__main__] - 
Processing ticker: GDW
2025-05-19 23:19:30,173 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:30,173 - INFO - [__main__] - Getting last prediction point for ticker: GDW
2025-05-19 23:19:30,173 - INFO - [__main__] - ==================================================
2025-05-19 23:19:30,173 - INFO - [__main__] - Preparing test data for GDW...
2025-05-19 23:19:30,199 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:30,199 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:30,199 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:30,217 - INFO - [src.data_preparation] - Ticker GDW - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:30,217 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(209), np.int64(1): np.int64(429)}
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] - Ticker GDW - Selected features:
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   vnipc_t: 0.0881
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   s_d7_t: 0.0692
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   ma14_t: 0.0670
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   ATR: 0.0655
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   Volatility: 0.0648
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   ma21_t: 0.0638
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   TVV: 0.0634
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   SK: 0.0613
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   HL: 0.0590
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:19:30,505 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:19:30,506 - INFO - [src.data_preparation] -   Median_HL: 0.0518
2025-05-19 23:19:30,506 - INFO - [src.data_preparation] -   SR: 0.0485
2025-05-19 23:19:30,506 - INFO - [src.data_preparation] -   insec_t: 0.0481
2025-05-19 23:19:30,508 - INFO - [src.data_preparation] - Ticker GDW - Using features: ['Date', 'vnipc_t', 's_d7_t', 'ma14_t', 'ATR', 'Volatility', 'ma21_t', 'TVV', 'SK', 'HL', 'ma7_t', 'ret', 'variation_t', 'Median_HL', 'SR', 'insec_t']
2025-05-19 23:19:30,585 - INFO - [src.data_preparation] - Ticker GDW - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:30,585 - INFO - [src.data_preparation] - Ticker GDW - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:30,587 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GDW
2025-05-19 23:19:30,587 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:30,587 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(145), np.int64(1): np.int64(317)}
2025-05-19 23:19:30,587 - INFO - [src.data_preparation] - Generating 172 synthetic minority samples
2025-05-19 23:19:30,593 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (634, 13, 15), y shape: (634,)
2025-05-19 23:19:30,593 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(317), np.int64(1): np.int64(317)}
2025-05-19 23:19:30,596 - INFO - [src.data_preparation] - Ticker GDW - Final 3D shapes: X_train=(634, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:30,596 - INFO - [__main__] - Using best model for GDW: svm (F1: 0.7246)
2025-05-19 23:19:30,597 - INFO - [__main__] - Loading svm model for GDW...
2025-05-19 23:19:30,598 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:30,599 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:19:30,599 - INFO - [__main__] - Making predictions for GDW using svm
2025-05-19 23:19:30,599 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:30,600 - INFO - [__main__] - Successfully got last prediction for GDW
2025-05-19 23:19:30,600 - INFO - [__main__] - 
Processing ticker: GER
2025-05-19 23:19:30,600 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:30,600 - INFO - [__main__] - Getting last prediction point for ticker: GER
2025-05-19 23:19:30,600 - INFO - [__main__] - ==================================================
2025-05-19 23:19:30,600 - INFO - [__main__] - Preparing test data for GER...
2025-05-19 23:19:30,632 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:30,632 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:30,632 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:30,650 - INFO - [src.data_preparation] - Ticker GER - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:30,650 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(67), np.int64(1): np.int64(572)}
2025-05-19 23:19:30,848 - INFO - [src.data_preparation] - Ticker GER - Selected features:
2025-05-19 23:19:30,848 - INFO - [src.data_preparation] -   vnipc_t: 0.1318
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   ma21_t: 0.1208
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   ma14_t: 0.1169
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   ma7_t: 0.0810
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   TVV: 0.0703
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   Median_HL: 0.0683
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   PM: 0.0670
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   s_d7_t: 0.0580
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   ATR: 0.0550
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   Volatility: 0.0484
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   SK: 0.0368
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   HL: 0.0330
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   SR: 0.0252
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   insec_t: 0.0243
2025-05-19 23:19:30,849 - INFO - [src.data_preparation] -   ret: 0.0213
2025-05-19 23:19:30,852 - INFO - [src.data_preparation] - Ticker GER - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'TVV', 'Median_HL', 'PM', 's_d7_t', 'ATR', 'Volatility', 'SK', 'HL', 'SR', 'insec_t', 'ret']
2025-05-19 23:19:30,930 - INFO - [src.data_preparation] - Ticker GER - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:30,930 - INFO - [src.data_preparation] - Ticker GER - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:30,933 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GER
2025-05-19 23:19:30,933 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:30,933 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(39), np.int64(1): np.int64(424)}
2025-05-19 23:19:30,933 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:19:30,936 - INFO - [src.data_preparation] - Ticker GER - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:30,936 - INFO - [__main__] - Using best model for GER: lstm (F1: 0.9398)
2025-05-19 23:19:30,936 - INFO - [__main__] - Loading lstm model for GER...
2025-05-19 23:19:30,941 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:30,942 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:19:30,942 - INFO - [__main__] - Making predictions for GER using lstm
2025-05-19 23:19:30,944 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:30,944 - INFO - [__main__] - Successfully got last prediction for GER
2025-05-19 23:19:30,944 - INFO - [__main__] - 
Processing ticker: GGG
2025-05-19 23:19:30,945 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:30,945 - INFO - [__main__] - Getting last prediction point for ticker: GGG
2025-05-19 23:19:30,945 - INFO - [__main__] - ==================================================
2025-05-19 23:19:30,945 - INFO - [__main__] - Preparing test data for GGG...
2025-05-19 23:19:30,978 - INFO - [src.data_preparation] - After processing - X shape: (628, 19), y shape: (628,)
2025-05-19 23:19:30,978 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:30,978 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:31,002 - INFO - [src.data_preparation] - Ticker GGG - Original shapes: X=(628, 18), y=(628,)
2025-05-19 23:19:31,002 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(218), np.int64(1): np.int64(410)}
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] - Ticker GGG - Selected features:
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   vnipc_t: 0.0854
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   Volatility: 0.0842
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   insec_t: 0.0840
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   TVV: 0.0729
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   ma21_t: 0.0704
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   s_d7_t: 0.0668
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   ma14_t: 0.0629
2025-05-19 23:19:31,263 - INFO - [src.data_preparation] -   SK: 0.0601
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   ret: 0.0515
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   variation_t: 0.0503
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   PM: 0.0490
2025-05-19 23:19:31,264 - INFO - [src.data_preparation] -   SR: 0.0352
2025-05-19 23:19:31,266 - INFO - [src.data_preparation] - Ticker GGG - Using features: ['Date', 'vnipc_t', 'Volatility', 'insec_t', 'TVV', 'ma21_t', 's_d7_t', 'ma14_t', 'SK', 'ATR', 'ma7_t', 'Median_HL', 'ret', 'variation_t', 'PM', 'SR']
2025-05-19 23:19:31,345 - INFO - [src.data_preparation] - Ticker GGG - 2D shapes: X_train=(452, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:31,345 - INFO - [src.data_preparation] - Ticker GGG - 3D shapes: X_train=(452, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:31,346 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GGG
2025-05-19 23:19:31,346 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (452, 13, 15), y shape: (452,)
2025-05-19 23:19:31,346 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(140), np.int64(1): np.int64(312)}
2025-05-19 23:19:31,346 - INFO - [src.data_preparation] - Generating 172 synthetic minority samples
2025-05-19 23:19:31,353 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (624, 13, 15), y shape: (624,)
2025-05-19 23:19:31,353 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(312), np.int64(1): np.int64(312)}
2025-05-19 23:19:31,356 - INFO - [src.data_preparation] - Ticker GGG - Final 3D shapes: X_train=(624, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:31,356 - INFO - [__main__] - Using best model for GGG: svm (F1: 0.6667)
2025-05-19 23:19:31,356 - INFO - [__main__] - Loading svm model for GGG...
2025-05-19 23:19:31,358 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:31,359 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:19:31,359 - INFO - [__main__] - Making predictions for GGG using svm
2025-05-19 23:19:31,360 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:31,360 - INFO - [__main__] - Successfully got last prediction for GGG
2025-05-19 23:19:31,360 - INFO - [__main__] - 
Processing ticker: GHC
2025-05-19 23:19:31,360 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:31,361 - INFO - [__main__] - Getting last prediction point for ticker: GHC
2025-05-19 23:19:31,361 - INFO - [__main__] - ==================================================
2025-05-19 23:19:31,361 - INFO - [__main__] - Preparing test data for GHC...
2025-05-19 23:19:31,388 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:31,388 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:31,389 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:31,408 - INFO - [src.data_preparation] - Ticker GHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:31,408 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(387)}
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] - Ticker GHC - Selected features:
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   vnipc_t: 0.0864
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   s_d7_t: 0.0737
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   SK: 0.0696
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   insec_t: 0.0642
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   TVV: 0.0641
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   ATR: 0.0619
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   SR: 0.0611
2025-05-19 23:19:31,711 - INFO - [src.data_preparation] -   Volatility: 0.0608
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   ret: 0.0607
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   variation_t: 0.0594
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   Median_HL: 0.0511
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   LO: 0.0495
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   ma14_t: 0.0478
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   HL: 0.0476
2025-05-19 23:19:31,712 - INFO - [src.data_preparation] -   ma21_t: 0.0470
2025-05-19 23:19:31,714 - INFO - [src.data_preparation] - Ticker GHC - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'insec_t', 'TVV', 'ATR', 'SR', 'Volatility', 'ret', 'variation_t', 'Median_HL', 'LO', 'ma14_t', 'HL', 'ma21_t']
2025-05-19 23:19:31,792 - INFO - [src.data_preparation] - Ticker GHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:31,792 - INFO - [src.data_preparation] - Ticker GHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:31,793 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GHC
2025-05-19 23:19:31,793 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:31,793 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(182), np.int64(1): np.int64(281)}
2025-05-19 23:19:31,793 - INFO - [src.data_preparation] - Generating 99 synthetic minority samples
2025-05-19 23:19:31,797 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (562, 13, 15), y shape: (562,)
2025-05-19 23:19:31,797 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(281), np.int64(1): np.int64(281)}
2025-05-19 23:19:31,800 - INFO - [src.data_preparation] - Ticker GHC - Final 3D shapes: X_train=(562, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:31,801 - INFO - [__main__] - Using best model for GHC: logistic_regression (F1: 0.6557)
2025-05-19 23:19:31,801 - INFO - [__main__] - Loading logistic_regression model for GHC...
2025-05-19 23:19:31,801 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:31,802 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:31,802 - INFO - [__main__] - Making predictions for GHC using logistic_regression
2025-05-19 23:19:31,802 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:31,802 - INFO - [__main__] - Successfully got last prediction for GHC
2025-05-19 23:19:31,802 - INFO - [__main__] - 
Processing ticker: GIL
2025-05-19 23:19:31,802 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:31,802 - INFO - [__main__] - Getting last prediction point for ticker: GIL
2025-05-19 23:19:31,803 - INFO - [__main__] - ==================================================
2025-05-19 23:19:31,803 - INFO - [__main__] - Preparing test data for GIL...
2025-05-19 23:19:31,834 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:31,834 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:31,834 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:31,852 - INFO - [src.data_preparation] - Ticker GIL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:31,852 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] - Ticker GIL - Selected features:
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   insec_t: 0.0737
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   Volatility: 0.0717
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   SK: 0.0696
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   TVV: 0.0685
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   vnipc_t: 0.0658
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   ATR: 0.0625
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   ret: 0.0588
2025-05-19 23:19:32,172 - INFO - [src.data_preparation] -   HL: 0.0546
2025-05-19 23:19:32,173 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:19:32,173 - INFO - [src.data_preparation] -   variation_t: 0.0537
2025-05-19 23:19:32,173 - INFO - [src.data_preparation] -   SR: 0.0534
2025-05-19 23:19:32,173 - INFO - [src.data_preparation] -   ma7_t: 0.0513
2025-05-19 23:19:32,173 - INFO - [src.data_preparation] -   ma14_t: 0.0510
2025-05-19 23:19:32,173 - INFO - [src.data_preparation] -   PM: 0.0495
2025-05-19 23:19:32,175 - INFO - [src.data_preparation] - Ticker GIL - Using features: ['Date', 'insec_t', 'Volatility', 'SK', 'TVV', 'vnipc_t', 's_d7_t', 'ATR', 'ret', 'HL', 'ma21_t', 'variation_t', 'SR', 'ma7_t', 'ma14_t', 'PM']
2025-05-19 23:19:32,267 - INFO - [src.data_preparation] - Ticker GIL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:32,267 - INFO - [src.data_preparation] - Ticker GIL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:32,269 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GIL
2025-05-19 23:19:32,270 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:32,270 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:19:32,270 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:19:32,271 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:19:32,271 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:19:32,274 - INFO - [src.data_preparation] - Ticker GIL - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:32,274 - INFO - [__main__] - Using best model for GIL: logistic_regression (F1: 0.4390)
2025-05-19 23:19:32,274 - INFO - [__main__] - Loading logistic_regression model for GIL...
2025-05-19 23:19:32,275 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:32,275 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:32,275 - INFO - [__main__] - Making predictions for GIL using logistic_regression
2025-05-19 23:19:32,276 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:32,276 - INFO - [__main__] - Successfully got last prediction for GIL
2025-05-19 23:19:32,276 - INFO - [__main__] - 
Processing ticker: GLT
2025-05-19 23:19:32,276 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:32,276 - INFO - [__main__] - Getting last prediction point for ticker: GLT
2025-05-19 23:19:32,276 - INFO - [__main__] - ==================================================
2025-05-19 23:19:32,276 - INFO - [__main__] - Preparing test data for GLT...
2025-05-19 23:19:32,302 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:32,302 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:32,302 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:32,321 - INFO - [src.data_preparation] - Ticker GLT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:32,321 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] - Ticker GLT - Selected features:
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   vnipc_t: 0.0781
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   Volatility: 0.0698
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   SK: 0.0674
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   ma21_t: 0.0654
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:19:32,604 - INFO - [src.data_preparation] -   insec_t: 0.0608
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   ATR: 0.0595
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   ma14_t: 0.0586
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   SR: 0.0536
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   ret: 0.0522
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   HL: 0.0487
2025-05-19 23:19:32,605 - INFO - [src.data_preparation] -   Median_HL: 0.0484
2025-05-19 23:19:32,607 - INFO - [src.data_preparation] - Ticker GLT - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'SK', 'ma21_t', 's_d7_t', 'insec_t', 'ATR', 'ma14_t', 'ma7_t', 'SR', 'ret', 'variation_t', 'HL', 'Median_HL']
2025-05-19 23:19:32,683 - INFO - [src.data_preparation] - Ticker GLT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:32,683 - INFO - [src.data_preparation] - Ticker GLT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:32,685 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GLT
2025-05-19 23:19:32,685 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:32,685 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(179), np.int64(1): np.int64(284)}
2025-05-19 23:19:32,685 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:19:32,689 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:19:32,689 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:19:32,692 - INFO - [src.data_preparation] - Ticker GLT - Final 3D shapes: X_train=(568, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:32,692 - INFO - [__main__] - Using best model for GLT: logistic_regression (F1: 0.6667)
2025-05-19 23:19:32,693 - INFO - [__main__] - Loading logistic_regression model for GLT...
2025-05-19 23:19:32,693 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:32,693 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:32,693 - INFO - [__main__] - Making predictions for GLT using logistic_regression
2025-05-19 23:19:32,694 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:32,694 - INFO - [__main__] - Successfully got last prediction for GLT
2025-05-19 23:19:32,694 - INFO - [__main__] - 
Processing ticker: GMC
2025-05-19 23:19:32,694 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:32,694 - INFO - [__main__] - Getting last prediction point for ticker: GMC
2025-05-19 23:19:32,694 - INFO - [__main__] - ==================================================
2025-05-19 23:19:32,694 - INFO - [__main__] - Preparing test data for GMC...
2025-05-19 23:19:32,735 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:32,735 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:32,735 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:32,754 - INFO - [src.data_preparation] - Ticker GMC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:32,754 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(340)}
2025-05-19 23:19:33,040 - INFO - [src.data_preparation] - Ticker GMC - Selected features:
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   insec_t: 0.0721
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   SK: 0.0720
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   vnipc_t: 0.0715
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   TVV: 0.0697
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   HL: 0.0627
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   SR: 0.0613
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   variation_t: 0.0579
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   Volatility: 0.0577
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   ATR: 0.0572
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   ret: 0.0545
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   LO: 0.0544
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   ma21_t: 0.0527
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   ma14_t: 0.0510
2025-05-19 23:19:33,041 - INFO - [src.data_preparation] -   Median_HL: 0.0503
2025-05-19 23:19:33,044 - INFO - [src.data_preparation] - Ticker GMC - Using features: ['Date', 'insec_t', 'SK', 'vnipc_t', 'TVV', 's_d7_t', 'HL', 'SR', 'variation_t', 'Volatility', 'ATR', 'ret', 'LO', 'ma21_t', 'ma14_t', 'Median_HL']
2025-05-19 23:19:33,121 - INFO - [src.data_preparation] - Ticker GMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:19:33,121 - INFO - [src.data_preparation] - Ticker GMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:33,123 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GMC
2025-05-19 23:19:33,123 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:33,123 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:19:33,123 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:19:33,125 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:19:33,125 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:19:33,128 - INFO - [src.data_preparation] - Ticker GMC - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:33,128 - INFO - [__main__] - Using best model for GMC: lstm (F1: 0.6562)
2025-05-19 23:19:33,128 - INFO - [__main__] - Loading lstm model for GMC...
2025-05-19 23:19:33,132 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:33,133 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:19:33,133 - INFO - [__main__] - Making predictions for GMC using lstm
2025-05-19 23:19:33,135 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:33,135 - INFO - [__main__] - Successfully got last prediction for GMC
2025-05-19 23:19:33,135 - INFO - [__main__] - 
Processing ticker: GMD
2025-05-19 23:19:33,135 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:33,135 - INFO - [__main__] - Getting last prediction point for ticker: GMD
2025-05-19 23:19:33,136 - INFO - [__main__] - ==================================================
2025-05-19 23:19:33,136 - INFO - [__main__] - Preparing test data for GMD...
2025-05-19 23:19:33,165 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:33,165 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:33,165 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:33,186 - INFO - [src.data_preparation] - Ticker GMD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:33,186 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:19:33,510 - INFO - [src.data_preparation] - Ticker GMD - Selected features:
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   vnipc_t: 0.0764
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   insec_t: 0.0751
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   SK: 0.0727
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   Volatility: 0.0645
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   SR: 0.0618
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   LO: 0.0611
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   ret: 0.0601
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   ATR: 0.0583
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   TVV: 0.0577
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   s_d7_t: 0.0566
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   variation_t: 0.0564
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   PM: 0.0504
2025-05-19 23:19:33,511 - INFO - [src.data_preparation] -   ma14_t: 0.0498
2025-05-19 23:19:33,512 - INFO - [src.data_preparation] -   ma21_t: 0.0483
2025-05-19 23:19:33,514 - INFO - [src.data_preparation] - Ticker GMD - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 'SR', 'LO', 'ret', 'ATR', 'TVV', 'HL', 's_d7_t', 'variation_t', 'PM', 'ma14_t', 'ma21_t']
2025-05-19 23:19:33,593 - INFO - [src.data_preparation] - Ticker GMD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:33,593 - INFO - [src.data_preparation] - Ticker GMD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:33,595 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GMD
2025-05-19 23:19:33,595 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:33,595 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:19:33,595 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:19:33,597 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:19:33,597 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:19:33,599 - INFO - [src.data_preparation] - Ticker GMD - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:33,600 - INFO - [__main__] - Using best model for GMD: svm (F1: 0.6047)
2025-05-19 23:19:33,600 - INFO - [__main__] - Loading svm model for GMD...
2025-05-19 23:19:33,601 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:33,601 - INFO - [__main__] - Model size: 0.50 MB
2025-05-19 23:19:33,602 - INFO - [__main__] - Making predictions for GMD using svm
2025-05-19 23:19:33,602 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:33,602 - INFO - [__main__] - Successfully got last prediction for GMD
2025-05-19 23:19:33,602 - INFO - [__main__] - 
Processing ticker: GMX
2025-05-19 23:19:33,602 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:33,602 - INFO - [__main__] - Getting last prediction point for ticker: GMX
2025-05-19 23:19:33,603 - INFO - [__main__] - ==================================================
2025-05-19 23:19:33,603 - INFO - [__main__] - Preparing test data for GMX...
2025-05-19 23:19:33,629 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:33,629 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:33,629 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:33,647 - INFO - [src.data_preparation] - Ticker GMX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:33,647 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(230), np.int64(1): np.int64(409)}
2025-05-19 23:19:33,933 - INFO - [src.data_preparation] - Ticker GMX - Selected features:
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   ATR: 0.0787
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   s_d7_t: 0.0739
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   Volatility: 0.0681
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   vnipc_t: 0.0680
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   SK: 0.0660
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   ma21_t: 0.0612
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   ma14_t: 0.0573
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   Median_HL: 0.0566
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   ma7_t: 0.0559
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:19:33,934 - INFO - [src.data_preparation] -   insec_t: 0.0531
2025-05-19 23:19:33,935 - INFO - [src.data_preparation] -   HL: 0.0528
2025-05-19 23:19:33,935 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:19:33,935 - INFO - [src.data_preparation] -   variation_t: 0.0482
2025-05-19 23:19:33,937 - INFO - [src.data_preparation] - Ticker GMX - Using features: ['Date', 'ATR', 's_d7_t', 'Volatility', 'vnipc_t', 'TVV', 'SK', 'ma21_t', 'ma14_t', 'Median_HL', 'ma7_t', 'PM', 'insec_t', 'HL', 'ret', 'variation_t']
2025-05-19 23:19:34,018 - INFO - [src.data_preparation] - Ticker GMX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:34,018 - INFO - [src.data_preparation] - Ticker GMX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:34,020 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GMX
2025-05-19 23:19:34,020 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:34,020 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(153), np.int64(1): np.int64(310)}
2025-05-19 23:19:34,020 - INFO - [src.data_preparation] - Generating 157 synthetic minority samples
2025-05-19 23:19:34,026 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (620, 13, 15), y shape: (620,)
2025-05-19 23:19:34,026 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(310), np.int64(1): np.int64(310)}
2025-05-19 23:19:34,029 - INFO - [src.data_preparation] - Ticker GMX - Final 3D shapes: X_train=(620, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:34,030 - INFO - [__main__] - Using best model for GMX: svm (F1: 0.7059)
2025-05-19 23:19:34,031 - INFO - [__main__] - Loading svm model for GMX...
2025-05-19 23:19:34,032 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:34,032 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:19:34,032 - INFO - [__main__] - Making predictions for GMX using svm
2025-05-19 23:19:34,033 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:34,033 - INFO - [__main__] - Successfully got last prediction for GMX
2025-05-19 23:19:34,033 - INFO - [__main__] - 
Processing ticker: GSP
2025-05-19 23:19:34,033 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:34,034 - INFO - [__main__] - Getting last prediction point for ticker: GSP
2025-05-19 23:19:34,034 - INFO - [__main__] - ==================================================
2025-05-19 23:19:34,034 - INFO - [__main__] - Preparing test data for GSP...
2025-05-19 23:19:34,061 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:34,061 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:34,061 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:34,078 - INFO - [src.data_preparation] - Ticker GSP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:34,079 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(271), np.int64(1): np.int64(368)}
2025-05-19 23:19:34,383 - INFO - [src.data_preparation] - Ticker GSP - Selected features:
2025-05-19 23:19:34,383 - INFO - [src.data_preparation] -   s_d7_t: 0.0729
2025-05-19 23:19:34,383 - INFO - [src.data_preparation] -   insec_t: 0.0692
2025-05-19 23:19:34,383 - INFO - [src.data_preparation] -   SK: 0.0673
2025-05-19 23:19:34,384 - INFO - [src.data_preparation] -   vnipc_t: 0.0651
2025-05-19 23:19:34,384 - INFO - [src.data_preparation] -   ret: 0.0642
2025-05-19 23:19:34,384 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:19:34,384 - INFO - [src.data_preparation] -   HL: 0.0625
2025-05-19 23:19:34,384 - INFO - [src.data_preparation] -   TVV: 0.0620
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   variation_t: 0.0616
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   SR: 0.0573
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   ATR: 0.0563
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   LO: 0.0508
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   ma14_t: 0.0506
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   ma21_t: 0.0500
2025-05-19 23:19:34,385 - INFO - [src.data_preparation] -   Median_HL: 0.0482
2025-05-19 23:19:34,388 - INFO - [src.data_preparation] - Ticker GSP - Using features: ['Date', 's_d7_t', 'insec_t', 'SK', 'vnipc_t', 'ret', 'Volatility', 'HL', 'TVV', 'variation_t', 'SR', 'ATR', 'LO', 'ma14_t', 'ma21_t', 'Median_HL']
2025-05-19 23:19:34,498 - INFO - [src.data_preparation] - Ticker GSP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:34,498 - INFO - [src.data_preparation] - Ticker GSP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:34,500 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GSP
2025-05-19 23:19:34,500 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:34,500 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:19:34,500 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:19:34,504 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:19:34,504 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:19:34,507 - INFO - [src.data_preparation] - Ticker GSP - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:34,507 - INFO - [__main__] - Using best model for GSP: svm (F1: 0.5600)
2025-05-19 23:19:34,508 - INFO - [__main__] - Loading svm model for GSP...
2025-05-19 23:19:34,510 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:34,510 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:19:34,510 - INFO - [__main__] - Making predictions for GSP using svm
2025-05-19 23:19:34,511 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:34,511 - INFO - [__main__] - Successfully got last prediction for GSP
2025-05-19 23:19:34,511 - INFO - [__main__] - 
Processing ticker: GTA
2025-05-19 23:19:34,511 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:34,511 - INFO - [__main__] - Getting last prediction point for ticker: GTA
2025-05-19 23:19:34,511 - INFO - [__main__] - ==================================================
2025-05-19 23:19:34,511 - INFO - [__main__] - Preparing test data for GTA...
2025-05-19 23:19:34,540 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:34,540 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:34,540 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:34,561 - INFO - [src.data_preparation] - Ticker GTA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:34,561 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] - Ticker GTA - Selected features:
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   vnipc_t: 0.0754
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   SK: 0.0675
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   TVV: 0.0650
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   s_d7_t: 0.0633
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   ATR: 0.0633
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   HL: 0.0603
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   SR: 0.0582
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   ret: 0.0571
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   Volatility: 0.0569
2025-05-19 23:19:34,840 - INFO - [src.data_preparation] -   LO: 0.0557
2025-05-19 23:19:34,841 - INFO - [src.data_preparation] -   ma14_t: 0.0544
2025-05-19 23:19:34,841 - INFO - [src.data_preparation] -   variation_t: 0.0543
2025-05-19 23:19:34,841 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:19:34,841 - INFO - [src.data_preparation] -   ma21_t: 0.0511
2025-05-19 23:19:34,843 - INFO - [src.data_preparation] - Ticker GTA - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'TVV', 's_d7_t', 'ATR', 'HL', 'SR', 'ret', 'Volatility', 'LO', 'ma14_t', 'variation_t', 'PM', 'ma21_t']
2025-05-19 23:19:34,920 - INFO - [src.data_preparation] - Ticker GTA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:34,920 - INFO - [src.data_preparation] - Ticker GTA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:34,921 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GTA
2025-05-19 23:19:34,921 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:34,922 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:19:34,922 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:19:34,924 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:19:34,924 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:19:34,928 - INFO - [src.data_preparation] - Ticker GTA - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:34,929 - INFO - [__main__] - Using best model for GTA: logistic_regression (F1: 0.3902)
2025-05-19 23:19:34,929 - INFO - [__main__] - Loading logistic_regression model for GTA...
2025-05-19 23:19:34,930 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:34,930 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:19:34,930 - INFO - [__main__] - Making predictions for GTA using logistic_regression
2025-05-19 23:19:34,931 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:34,931 - INFO - [__main__] - Successfully got last prediction for GTA
2025-05-19 23:19:34,931 - INFO - [__main__] - 
Processing ticker: GTT
2025-05-19 23:19:34,931 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:34,931 - INFO - [__main__] - Getting last prediction point for ticker: GTT
2025-05-19 23:19:34,931 - INFO - [__main__] - ==================================================
2025-05-19 23:19:34,931 - INFO - [__main__] - Preparing test data for GTT...
2025-05-19 23:19:34,960 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:34,960 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:34,960 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:34,978 - INFO - [src.data_preparation] - Ticker GTT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:34,979 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(186), np.int64(1): np.int64(452)}
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] - Ticker GTT - Selected features:
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   vnipc_t: 0.1128
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   insec_t: 0.0830
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   TVV: 0.0801
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   ma14_t: 0.0795
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   Volatility: 0.0717
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   ma21_t: 0.0716
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   ma7_t: 0.0696
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   Median_HL: 0.0611
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   s_d7_t: 0.0598
2025-05-19 23:19:35,196 - INFO - [src.data_preparation] -   SK: 0.0565
2025-05-19 23:19:35,197 - INFO - [src.data_preparation] -   PM: 0.0495
2025-05-19 23:19:35,197 - INFO - [src.data_preparation] -   ATR: 0.0486
2025-05-19 23:19:35,197 - INFO - [src.data_preparation] -   variation_t: 0.0386
2025-05-19 23:19:35,197 - INFO - [src.data_preparation] -   ret: 0.0383
2025-05-19 23:19:35,197 - INFO - [src.data_preparation] -   SR: 0.0282
2025-05-19 23:19:35,199 - INFO - [src.data_preparation] - Ticker GTT - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'ma14_t', 'Volatility', 'ma21_t', 'ma7_t', 'Median_HL', 's_d7_t', 'SK', 'PM', 'ATR', 'variation_t', 'ret', 'SR']
2025-05-19 23:19:35,277 - INFO - [src.data_preparation] - Ticker GTT - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:35,277 - INFO - [src.data_preparation] - Ticker GTT - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:35,279 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker GTT
2025-05-19 23:19:35,279 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:35,279 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(148), np.int64(1): np.int64(314)}
2025-05-19 23:19:35,279 - INFO - [src.data_preparation] - Generating 166 synthetic minority samples
2025-05-19 23:19:35,285 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (628, 13, 15), y shape: (628,)
2025-05-19 23:19:35,285 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(314), np.int64(1): np.int64(314)}
2025-05-19 23:19:35,288 - INFO - [src.data_preparation] - Ticker GTT - Final 3D shapes: X_train=(628, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:35,288 - INFO - [__main__] - Using best model for GTT: lstm (F1: 0.9885)
2025-05-19 23:19:35,288 - INFO - [__main__] - Loading lstm model for GTT...
2025-05-19 23:19:35,292 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:35,293 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:19:35,293 - INFO - [__main__] - Making predictions for GTT using lstm
2025-05-19 23:19:35,295 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:35,295 - INFO - [__main__] - Successfully got last prediction for GTT
2025-05-19 23:19:35,295 - INFO - [__main__] - 
Processing ticker: H11
2025-05-19 23:19:35,295 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:35,295 - INFO - [__main__] - Getting last prediction point for ticker: H11
2025-05-19 23:19:35,296 - INFO - [__main__] - ==================================================
2025-05-19 23:19:35,296 - INFO - [__main__] - Preparing test data for H11...
2025-05-19 23:19:35,323 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:35,323 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:35,323 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:35,345 - INFO - [src.data_preparation] - Ticker H11 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:35,345 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(139), np.int64(1): np.int64(500)}
2025-05-19 23:19:35,611 - INFO - [src.data_preparation] - Ticker H11 - Selected features:
2025-05-19 23:19:35,611 - INFO - [src.data_preparation] -   TVV: 0.0988
2025-05-19 23:19:35,611 - INFO - [src.data_preparation] -   vnipc_t: 0.0810
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   ATR: 0.0741
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   ma14_t: 0.0674
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   ma21_t: 0.0653
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   Volatility: 0.0616
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   ma7_t: 0.0595
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   HL: 0.0583
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   PM: 0.0517
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   SK: 0.0484
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   ret: 0.0456
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   variation_t: 0.0423
2025-05-19 23:19:35,612 - INFO - [src.data_preparation] -   insec_t: 0.0399
2025-05-19 23:19:35,615 - INFO - [src.data_preparation] - Ticker H11 - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'ma14_t', 'ma21_t', 's_d7_t', 'Volatility', 'ma7_t', 'HL', 'Median_HL', 'PM', 'SK', 'ret', 'variation_t', 'insec_t']
2025-05-19 23:19:35,693 - INFO - [src.data_preparation] - Ticker H11 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:35,693 - INFO - [src.data_preparation] - Ticker H11 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:35,694 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker H11
2025-05-19 23:19:35,694 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:35,694 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(73), np.int64(1): np.int64(390)}
2025-05-19 23:19:35,694 - INFO - [src.data_preparation] - Generating 317 synthetic minority samples
2025-05-19 23:19:35,706 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (780, 13, 15), y shape: (780,)
2025-05-19 23:19:35,706 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(390), np.int64(1): np.int64(390)}
2025-05-19 23:19:35,710 - INFO - [src.data_preparation] - Ticker H11 - Final 3D shapes: X_train=(780, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:35,710 - INFO - [__main__] - Using best model for H11: svm (F1: 0.8108)
2025-05-19 23:19:35,710 - INFO - [__main__] - Loading svm model for H11...
2025-05-19 23:19:35,711 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:35,712 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:19:35,712 - INFO - [__main__] - Making predictions for H11 using svm
2025-05-19 23:19:35,712 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:35,712 - INFO - [__main__] - Successfully got last prediction for H11
2025-05-19 23:19:35,713 - INFO - [__main__] - 
Processing ticker: HAD
2025-05-19 23:19:35,713 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:35,713 - INFO - [__main__] - Getting last prediction point for ticker: HAD
2025-05-19 23:19:35,713 - INFO - [__main__] - ==================================================
2025-05-19 23:19:35,713 - INFO - [__main__] - Preparing test data for HAD...
2025-05-19 23:19:35,739 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:35,739 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:35,739 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:35,758 - INFO - [src.data_preparation] - Ticker HAD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:35,758 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(279), np.int64(1): np.int64(360)}
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] - Ticker HAD - Selected features:
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   TVV: 0.0758
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   s_d7_t: 0.0714
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   vnipc_t: 0.0703
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   Volatility: 0.0685
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   SK: 0.0631
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   ATR: 0.0617
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   ret: 0.0583
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   ma21_t: 0.0582
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   insec_t: 0.0582
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   SR: 0.0568
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   ma14_t: 0.0552
2025-05-19 23:19:36,060 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:19:36,061 - INFO - [src.data_preparation] -   variation_t: 0.0523
2025-05-19 23:19:36,061 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:19:36,061 - INFO - [src.data_preparation] -   HL: 0.0506
2025-05-19 23:19:36,063 - INFO - [src.data_preparation] - Ticker HAD - Using features: ['Date', 'TVV', 's_d7_t', 'vnipc_t', 'Volatility', 'SK', 'ATR', 'ret', 'ma21_t', 'insec_t', 'SR', 'ma14_t', 'ma7_t', 'variation_t', 'Median_HL', 'HL']
2025-05-19 23:19:36,140 - INFO - [src.data_preparation] - Ticker HAD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:36,140 - INFO - [src.data_preparation] - Ticker HAD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:36,141 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAD
2025-05-19 23:19:36,141 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:36,141 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(214), np.int64(1): np.int64(249)}
2025-05-19 23:19:36,141 - INFO - [src.data_preparation] - Generating 35 synthetic minority samples
2025-05-19 23:19:36,143 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (498, 13, 15), y shape: (498,)
2025-05-19 23:19:36,143 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(249), np.int64(1): np.int64(249)}
2025-05-19 23:19:36,145 - INFO - [src.data_preparation] - Ticker HAD - Final 3D shapes: X_train=(498, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:36,145 - INFO - [__main__] - Using best model for HAD: svm (F1: 0.7945)
2025-05-19 23:19:36,146 - INFO - [__main__] - Loading svm model for HAD...
2025-05-19 23:19:36,147 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:36,147 - INFO - [__main__] - Model size: 0.66 MB
2025-05-19 23:19:36,147 - INFO - [__main__] - Making predictions for HAD using svm
2025-05-19 23:19:36,148 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:36,148 - INFO - [__main__] - Successfully got last prediction for HAD
2025-05-19 23:19:36,148 - INFO - [__main__] - 
Processing ticker: HAG
2025-05-19 23:19:36,148 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:36,148 - INFO - [__main__] - Getting last prediction point for ticker: HAG
2025-05-19 23:19:36,148 - INFO - [__main__] - ==================================================
2025-05-19 23:19:36,148 - INFO - [__main__] - Preparing test data for HAG...
2025-05-19 23:19:36,177 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:36,177 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:36,177 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:36,195 - INFO - [src.data_preparation] - Ticker HAG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:36,196 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(325), np.int64(1): np.int64(314)}
2025-05-19 23:19:36,498 - INFO - [src.data_preparation] - Ticker HAG - Selected features:
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   insec_t: 0.0742
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   vnipc_t: 0.0687
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   TVV: 0.0620
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   ret: 0.0603
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   variation_t: 0.0600
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   Volatility: 0.0565
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   PM: 0.0559
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   ma7_t: 0.0538
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   ATR: 0.0531
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:19:36,499 - INFO - [src.data_preparation] -   ma14_t: 0.0516
2025-05-19 23:19:36,500 - INFO - [src.data_preparation] -   LO: 0.0512
2025-05-19 23:19:36,502 - INFO - [src.data_preparation] - Ticker HAG - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 's_d7_t', 'TVV', 'ret', 'variation_t', 'ma21_t', 'Volatility', 'PM', 'ma7_t', 'ATR', 'SR', 'ma14_t', 'LO']
2025-05-19 23:19:36,579 - INFO - [src.data_preparation] - Ticker HAG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:36,579 - INFO - [src.data_preparation] - Ticker HAG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:36,580 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAG
2025-05-19 23:19:36,580 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:36,580 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(223)}
2025-05-19 23:19:36,580 - INFO - [src.data_preparation] - Generating 17 synthetic minority samples
2025-05-19 23:19:36,581 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (480, 13, 15), y shape: (480,)
2025-05-19 23:19:36,581 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(240)}
2025-05-19 23:19:36,584 - INFO - [src.data_preparation] - Ticker HAG - Final 3D shapes: X_train=(480, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:36,584 - INFO - [__main__] - Using best model for HAG: svm (F1: 0.6957)
2025-05-19 23:19:36,584 - INFO - [__main__] - Loading svm model for HAG...
2025-05-19 23:19:36,585 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:36,585 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:19:36,585 - INFO - [__main__] - Making predictions for HAG using svm
2025-05-19 23:19:36,586 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:36,586 - INFO - [__main__] - Successfully got last prediction for HAG
2025-05-19 23:19:36,586 - INFO - [__main__] - 
Processing ticker: HAI
2025-05-19 23:19:36,586 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:36,586 - INFO - [__main__] - Getting last prediction point for ticker: HAI
2025-05-19 23:19:36,587 - INFO - [__main__] - ==================================================
2025-05-19 23:19:36,587 - INFO - [__main__] - Preparing test data for HAI...
2025-05-19 23:19:36,621 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:36,622 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:36,622 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:36,644 - INFO - [src.data_preparation] - Ticker HAI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:36,644 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:19:36,938 - INFO - [src.data_preparation] - Ticker HAI - Selected features:
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   HL: 0.1003
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   TVV: 0.0868
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   vnipc_t: 0.0730
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   ATR: 0.0686
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   Volatility: 0.0616
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   Median_HL: 0.0612
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   PM: 0.0589
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   s_d7_t: 0.0566
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   SK: 0.0539
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   insec_t: 0.0533
2025-05-19 23:19:36,939 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:19:36,940 - INFO - [src.data_preparation] -   variation_t: 0.0499
2025-05-19 23:19:36,940 - INFO - [src.data_preparation] -   ma14_t: 0.0466
2025-05-19 23:19:36,940 - INFO - [src.data_preparation] -   ret: 0.0464
2025-05-19 23:19:36,940 - INFO - [src.data_preparation] -   ma21_t: 0.0427
2025-05-19 23:19:36,944 - INFO - [src.data_preparation] - Ticker HAI - Using features: ['Date', 'HL', 'TVV', 'vnipc_t', 'ATR', 'Volatility', 'Median_HL', 'PM', 's_d7_t', 'SK', 'insec_t', 'ma7_t', 'variation_t', 'ma14_t', 'ret', 'ma21_t']
2025-05-19 23:19:37,034 - INFO - [src.data_preparation] - Ticker HAI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:37,034 - INFO - [src.data_preparation] - Ticker HAI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:37,036 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAI
2025-05-19 23:19:37,036 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:37,036 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(231), np.int64(1): np.int64(232)}
2025-05-19 23:19:37,036 - INFO - [src.data_preparation] - Generating 1 synthetic minority samples
2025-05-19 23:19:37,037 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:19:37,037 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:19:37,039 - INFO - [src.data_preparation] - Ticker HAI - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:37,039 - INFO - [__main__] - Using best model for HAI: lstm (F1: 0.0000)
2025-05-19 23:19:37,039 - INFO - [__main__] - Loading lstm model for HAI...
2025-05-19 23:19:37,043 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:37,044 - INFO - [__main__] - Model size: 0.12 MB
2025-05-19 23:19:37,046 - INFO - [__main__] - Making predictions for HAI using lstm
2025-05-19 23:19:37,047 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:37,048 - INFO - [__main__] - Successfully got last prediction for HAI
2025-05-19 23:19:37,048 - INFO - [__main__] - 
Processing ticker: HAP
2025-05-19 23:19:37,048 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:37,048 - INFO - [__main__] - Getting last prediction point for ticker: HAP
2025-05-19 23:19:37,048 - INFO - [__main__] - ==================================================
2025-05-19 23:19:37,048 - INFO - [__main__] - Preparing test data for HAP...
2025-05-19 23:19:37,092 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:37,093 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:37,093 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:37,119 - INFO - [src.data_preparation] - Ticker HAP - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:37,120 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(340)}
2025-05-19 23:19:37,471 - INFO - [src.data_preparation] - Ticker HAP - Selected features:
2025-05-19 23:19:37,471 - INFO - [src.data_preparation] -   Volatility: 0.0744
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   vnipc_t: 0.0675
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   s_d7_t: 0.0673
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   insec_t: 0.0655
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   ret: 0.0605
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   ATR: 0.0594
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   HL: 0.0594
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   ma7_t: 0.0582
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   variation_t: 0.0561
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   Median_HL: 0.0546
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   PM: 0.0527
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   SR: 0.0509
2025-05-19 23:19:37,472 - INFO - [src.data_preparation] -   ma14_t: 0.0489
2025-05-19 23:19:37,476 - INFO - [src.data_preparation] - Ticker HAP - Using features: ['Date', 'Volatility', 'vnipc_t', 's_d7_t', 'SK', 'insec_t', 'TVV', 'ret', 'ATR', 'HL', 'ma7_t', 'variation_t', 'Median_HL', 'PM', 'SR', 'ma14_t']
2025-05-19 23:19:37,556 - INFO - [src.data_preparation] - Ticker HAP - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:37,556 - INFO - [src.data_preparation] - Ticker HAP - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:37,558 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAP
2025-05-19 23:19:37,558 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:37,558 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(247)}
2025-05-19 23:19:37,558 - INFO - [src.data_preparation] - Generating 32 synthetic minority samples
2025-05-19 23:19:37,560 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:19:37,560 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:19:37,563 - INFO - [src.data_preparation] - Ticker HAP - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:37,563 - INFO - [__main__] - Using best model for HAP: svm (F1: 0.4762)
2025-05-19 23:19:37,563 - INFO - [__main__] - Loading svm model for HAP...
2025-05-19 23:19:37,564 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:37,564 - INFO - [__main__] - Model size: 0.58 MB
2025-05-19 23:19:37,564 - INFO - [__main__] - Making predictions for HAP using svm
2025-05-19 23:19:37,565 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:37,565 - INFO - [__main__] - Successfully got last prediction for HAP
2025-05-19 23:19:37,565 - INFO - [__main__] - 
Processing ticker: HAS
2025-05-19 23:19:37,565 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:37,565 - INFO - [__main__] - Getting last prediction point for ticker: HAS
2025-05-19 23:19:37,565 - INFO - [__main__] - ==================================================
2025-05-19 23:19:37,566 - INFO - [__main__] - Preparing test data for HAS...
2025-05-19 23:19:37,592 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:37,592 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:37,592 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:37,609 - INFO - [src.data_preparation] - Ticker HAS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:37,609 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(313), np.int64(1): np.int64(326)}
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] - Ticker HAS - Selected features:
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] -   insec_t: 0.0696
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] -   vnipc_t: 0.0677
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] -   ATR: 0.0676
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:19:37,889 - INFO - [src.data_preparation] -   SK: 0.0640
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   s_d7_t: 0.0635
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   variation_t: 0.0585
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   ret: 0.0561
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   SR: 0.0560
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   LO: 0.0537
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   PM: 0.0529
2025-05-19 23:19:37,890 - INFO - [src.data_preparation] -   ma21_t: 0.0517
2025-05-19 23:19:37,892 - INFO - [src.data_preparation] - Ticker HAS - Using features: ['Date', 'insec_t', 'TVV', 'vnipc_t', 'ATR', 'Volatility', 'SK', 's_d7_t', 'variation_t', 'HL', 'ret', 'SR', 'LO', 'ma14_t', 'PM', 'ma21_t']
2025-05-19 23:19:37,977 - INFO - [src.data_preparation] - Ticker HAS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:37,977 - INFO - [src.data_preparation] - Ticker HAS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:37,979 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAS
2025-05-19 23:19:37,979 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:37,979 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:19:37,979 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:19:37,980 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:19:37,980 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:19:37,983 - INFO - [src.data_preparation] - Ticker HAS - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:37,983 - INFO - [__main__] - Using best model for HAS: transformer (F1: 0.6316)
2025-05-19 23:19:37,983 - INFO - [__main__] - Loading transformer model for HAS...
2025-05-19 23:19:37,997 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:38,004 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:19:38,004 - INFO - [__main__] - Making predictions for HAS using transformer
2025-05-19 23:19:38,006 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:38,007 - INFO - [__main__] - Successfully got last prediction for HAS
2025-05-19 23:19:38,007 - INFO - [__main__] - 
Processing ticker: HAT
2025-05-19 23:19:38,007 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:38,007 - INFO - [__main__] - Getting last prediction point for ticker: HAT
2025-05-19 23:19:38,007 - INFO - [__main__] - ==================================================
2025-05-19 23:19:38,007 - INFO - [__main__] - Preparing test data for HAT...
2025-05-19 23:19:38,046 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:38,046 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:38,047 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:38,068 - INFO - [src.data_preparation] - Ticker HAT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:38,069 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:19:38,429 - INFO - [src.data_preparation] - Ticker HAT - Selected features:
2025-05-19 23:19:38,429 - INFO - [src.data_preparation] -   vnipc_t: 0.0700
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   HL: 0.0685
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   SK: 0.0663
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   insec_t: 0.0637
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   TVV: 0.0637
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   ATR: 0.0624
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   Volatility: 0.0606
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   ma21_t: 0.0603
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   LO: 0.0590
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   s_d7_t: 0.0589
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   SR: 0.0544
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   PM: 0.0498
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   Median_HL: 0.0496
2025-05-19 23:19:38,430 - INFO - [src.data_preparation] -   ma14_t: 0.0495
2025-05-19 23:19:38,433 - INFO - [src.data_preparation] - Ticker HAT - Using features: ['Date', 'vnipc_t', 'HL', 'SK', 'insec_t', 'TVV', 'ATR', 'Volatility', 'ma21_t', 'LO', 's_d7_t', 'SR', 'ret', 'PM', 'Median_HL', 'ma14_t']
2025-05-19 23:19:38,520 - INFO - [src.data_preparation] - Ticker HAT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:38,521 - INFO - [src.data_preparation] - Ticker HAT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:38,522 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAT
2025-05-19 23:19:38,522 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:38,522 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(231), np.int64(1): np.int64(232)}
2025-05-19 23:19:38,522 - INFO - [src.data_preparation] - Generating 1 synthetic minority samples
2025-05-19 23:19:38,523 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:19:38,523 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:19:38,526 - INFO - [src.data_preparation] - Ticker HAT - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:38,526 - INFO - [__main__] - Using best model for HAT: transformer (F1: 0.7761)
2025-05-19 23:19:38,526 - INFO - [__main__] - Loading transformer model for HAT...
2025-05-19 23:19:38,540 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:38,543 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:19:38,543 - INFO - [__main__] - Making predictions for HAT using transformer
2025-05-19 23:19:38,545 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:38,546 - INFO - [__main__] - Successfully got last prediction for HAT
2025-05-19 23:19:38,546 - INFO - [__main__] - 
Processing ticker: HAX
2025-05-19 23:19:38,546 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:38,546 - INFO - [__main__] - Getting last prediction point for ticker: HAX
2025-05-19 23:19:38,546 - INFO - [__main__] - ==================================================
2025-05-19 23:19:38,546 - INFO - [__main__] - Preparing test data for HAX...
2025-05-19 23:19:38,577 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:38,577 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:38,577 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:38,600 - INFO - [src.data_preparation] - Ticker HAX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:38,600 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] - Ticker HAX - Selected features:
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   SK: 0.0694
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   Volatility: 0.0636
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   PM: 0.0634
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   ATR: 0.0628
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   TVV: 0.0607
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   HL: 0.0605
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   insec_t: 0.0589
2025-05-19 23:19:38,930 - INFO - [src.data_preparation] -   Median_HL: 0.0567
2025-05-19 23:19:38,931 - INFO - [src.data_preparation] -   ret: 0.0563
2025-05-19 23:19:38,931 - INFO - [src.data_preparation] -   ma14_t: 0.0558
2025-05-19 23:19:38,931 - INFO - [src.data_preparation] -   LO: 0.0544
2025-05-19 23:19:38,931 - INFO - [src.data_preparation] -   variation_t: 0.0544
2025-05-19 23:19:38,931 - INFO - [src.data_preparation] -   ma21_t: 0.0519
2025-05-19 23:19:38,934 - INFO - [src.data_preparation] - Ticker HAX - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'PM', 's_d7_t', 'ATR', 'TVV', 'HL', 'insec_t', 'Median_HL', 'ret', 'ma14_t', 'LO', 'variation_t', 'ma21_t']
2025-05-19 23:19:39,079 - INFO - [src.data_preparation] - Ticker HAX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:39,079 - INFO - [src.data_preparation] - Ticker HAX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:39,083 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HAX
2025-05-19 23:19:39,083 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:39,084 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:19:39,084 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:19:39,092 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:19:39,092 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:19:39,097 - INFO - [src.data_preparation] - Ticker HAX - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:39,097 - INFO - [__main__] - Using best model for HAX: svm (F1: 0.6667)
2025-05-19 23:19:39,097 - INFO - [__main__] - Loading svm model for HAX...
2025-05-19 23:19:39,100 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:39,101 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:19:39,101 - INFO - [__main__] - Making predictions for HAX using svm
2025-05-19 23:19:39,102 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:39,102 - INFO - [__main__] - Successfully got last prediction for HAX
2025-05-19 23:19:39,103 - INFO - [__main__] - 
Processing ticker: HBC
2025-05-19 23:19:39,103 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:39,103 - INFO - [__main__] - Getting last prediction point for ticker: HBC
2025-05-19 23:19:39,103 - INFO - [__main__] - ==================================================
2025-05-19 23:19:39,103 - INFO - [__main__] - Preparing test data for HBC...
2025-05-19 23:19:39,136 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:39,136 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:39,137 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:39,165 - INFO - [src.data_preparation] - Ticker HBC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:39,166 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(336)}
2025-05-19 23:19:39,473 - INFO - [src.data_preparation] - Ticker HBC - Selected features:
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   insec_t: 0.0816
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   SK: 0.0791
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   Volatility: 0.0743
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   TVV: 0.0689
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   vnipc_t: 0.0653
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   s_d7_t: 0.0579
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   HL: 0.0569
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   ATR: 0.0564
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   ma21_t: 0.0558
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   variation_t: 0.0538
2025-05-19 23:19:39,474 - INFO - [src.data_preparation] -   ma14_t: 0.0524
2025-05-19 23:19:39,475 - INFO - [src.data_preparation] -   LO: 0.0519
2025-05-19 23:19:39,475 - INFO - [src.data_preparation] -   SR: 0.0512
2025-05-19 23:19:39,475 - INFO - [src.data_preparation] -   ma7_t: 0.0470
2025-05-19 23:19:39,477 - INFO - [src.data_preparation] - Ticker HBC - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'TVV', 'vnipc_t', 's_d7_t', 'HL', 'ATR', 'ma21_t', 'ret', 'variation_t', 'ma14_t', 'LO', 'SR', 'ma7_t']
2025-05-19 23:19:39,560 - INFO - [src.data_preparation] - Ticker HBC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:19:39,560 - INFO - [src.data_preparation] - Ticker HBC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:39,562 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HBC
2025-05-19 23:19:39,562 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:39,562 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:19:39,562 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:19:39,564 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:19:39,564 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:19:39,566 - INFO - [src.data_preparation] - Ticker HBC - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:39,567 - INFO - [__main__] - Using best model for HBC: lstm (F1: 0.7333)
2025-05-19 23:19:39,567 - INFO - [__main__] - Loading lstm model for HBC...
2025-05-19 23:19:39,570 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:39,571 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:19:39,571 - INFO - [__main__] - Making predictions for HBC using lstm
2025-05-19 23:19:39,575 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:39,575 - INFO - [__main__] - Successfully got last prediction for HBC
2025-05-19 23:19:39,575 - INFO - [__main__] - 
Processing ticker: HBD
2025-05-19 23:19:39,575 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:39,575 - INFO - [__main__] - Getting last prediction point for ticker: HBD
2025-05-19 23:19:39,575 - INFO - [__main__] - ==================================================
2025-05-19 23:19:39,576 - INFO - [__main__] - Preparing test data for HBD...
2025-05-19 23:19:39,604 - INFO - [src.data_preparation] - After processing - X shape: (628, 19), y shape: (628,)
2025-05-19 23:19:39,604 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:39,604 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:39,625 - INFO - [src.data_preparation] - Ticker HBD - Original shapes: X=(628, 18), y=(628,)
2025-05-19 23:19:39,625 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(168), np.int64(1): np.int64(460)}
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] - Ticker HBD - Selected features:
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   vnipc_t: 0.0864
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   ATR: 0.0789
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   TVV: 0.0789
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   s_d7_t: 0.0754
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   Volatility: 0.0700
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   ma14_t: 0.0661
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   SK: 0.0642
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   ma21_t: 0.0605
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   ma7_t: 0.0592
2025-05-19 23:19:39,927 - INFO - [src.data_preparation] -   PM: 0.0582
2025-05-19 23:19:39,928 - INFO - [src.data_preparation] -   Median_HL: 0.0576
2025-05-19 23:19:39,928 - INFO - [src.data_preparation] -   ret: 0.0481
2025-05-19 23:19:39,928 - INFO - [src.data_preparation] -   variation_t: 0.0448
2025-05-19 23:19:39,928 - INFO - [src.data_preparation] -   SR: 0.0406
2025-05-19 23:19:39,928 - INFO - [src.data_preparation] -   insec_t: 0.0387
2025-05-19 23:19:39,931 - INFO - [src.data_preparation] - Ticker HBD - Using features: ['Date', 'vnipc_t', 'ATR', 'TVV', 's_d7_t', 'Volatility', 'ma14_t', 'SK', 'ma21_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'variation_t', 'SR', 'insec_t']
2025-05-19 23:19:40,013 - INFO - [src.data_preparation] - Ticker HBD - 2D shapes: X_train=(452, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:40,014 - INFO - [src.data_preparation] - Ticker HBD - 3D shapes: X_train=(452, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:40,015 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HBD
2025-05-19 23:19:40,015 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (452, 13, 15), y shape: (452,)
2025-05-19 23:19:40,015 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(126), np.int64(1): np.int64(326)}
2025-05-19 23:19:40,015 - INFO - [src.data_preparation] - Generating 200 synthetic minority samples
2025-05-19 23:19:40,023 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (652, 13, 15), y shape: (652,)
2025-05-19 23:19:40,023 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(326), np.int64(1): np.int64(326)}
2025-05-19 23:19:40,027 - INFO - [src.data_preparation] - Ticker HBD - Final 3D shapes: X_train=(652, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:40,027 - INFO - [__main__] - Using best model for HBD: lstm (F1: 0.9136)
2025-05-19 23:19:40,027 - INFO - [__main__] - Loading lstm model for HBD...
2025-05-19 23:19:40,031 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:40,032 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:19:40,032 - INFO - [__main__] - Making predictions for HBD using lstm
2025-05-19 23:19:40,033 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:40,033 - INFO - [__main__] - Successfully got last prediction for HBD
2025-05-19 23:19:40,033 - INFO - [__main__] - 
Processing ticker: HBS
2025-05-19 23:19:40,034 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:40,034 - INFO - [__main__] - Getting last prediction point for ticker: HBS
2025-05-19 23:19:40,034 - INFO - [__main__] - ==================================================
2025-05-19 23:19:40,034 - INFO - [__main__] - Preparing test data for HBS...
2025-05-19 23:19:40,070 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:40,070 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:40,070 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:40,091 - INFO - [src.data_preparation] - Ticker HBS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:40,091 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(241), np.int64(1): np.int64(398)}
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] - Ticker HBS - Selected features:
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   vnipc_t: 0.0777
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   SK: 0.0760
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   s_d7_t: 0.0696
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   TVV: 0.0655
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   ma14_t: 0.0613
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   Median_HL: 0.0587
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   ATR: 0.0571
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   PM: 0.0560
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   Volatility: 0.0558
2025-05-19 23:19:40,389 - INFO - [src.data_preparation] -   ma7_t: 0.0552
2025-05-19 23:19:40,390 - INFO - [src.data_preparation] -   ma21_t: 0.0548
2025-05-19 23:19:40,390 - INFO - [src.data_preparation] -   ret: 0.0519
2025-05-19 23:19:40,390 - INFO - [src.data_preparation] -   variation_t: 0.0510
2025-05-19 23:19:40,390 - INFO - [src.data_preparation] -   HL: 0.0476
2025-05-19 23:19:40,392 - INFO - [src.data_preparation] - Ticker HBS - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'TVV', 'insec_t', 'ma14_t', 'Median_HL', 'ATR', 'PM', 'Volatility', 'ma7_t', 'ma21_t', 'ret', 'variation_t', 'HL']
2025-05-19 23:19:40,473 - INFO - [src.data_preparation] - Ticker HBS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:40,474 - INFO - [src.data_preparation] - Ticker HBS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:40,475 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HBS
2025-05-19 23:19:40,475 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:40,475 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(162), np.int64(1): np.int64(301)}
2025-05-19 23:19:40,475 - INFO - [src.data_preparation] - Generating 139 synthetic minority samples
2025-05-19 23:19:40,480 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (602, 13, 15), y shape: (602,)
2025-05-19 23:19:40,482 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(301), np.int64(1): np.int64(301)}
2025-05-19 23:19:40,485 - INFO - [src.data_preparation] - Ticker HBS - Final 3D shapes: X_train=(602, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:40,486 - INFO - [__main__] - Using best model for HBS: svm (F1: 0.6667)
2025-05-19 23:19:40,486 - INFO - [__main__] - Loading svm model for HBS...
2025-05-19 23:19:40,487 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:40,488 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:19:40,488 - INFO - [__main__] - Making predictions for HBS using svm
2025-05-19 23:19:40,489 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:40,489 - INFO - [__main__] - Successfully got last prediction for HBS
2025-05-19 23:19:40,489 - INFO - [__main__] - 
Processing ticker: HCC
2025-05-19 23:19:40,489 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:40,489 - INFO - [__main__] - Getting last prediction point for ticker: HCC
2025-05-19 23:19:40,489 - INFO - [__main__] - ==================================================
2025-05-19 23:19:40,489 - INFO - [__main__] - Preparing test data for HCC...
2025-05-19 23:19:40,517 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:40,517 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:40,517 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:40,535 - INFO - [src.data_preparation] - Ticker HCC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:40,535 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(264), np.int64(1): np.int64(375)}
2025-05-19 23:19:40,822 - INFO - [src.data_preparation] - Ticker HCC - Selected features:
2025-05-19 23:19:40,822 - INFO - [src.data_preparation] -   TVV: 0.0769
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   HL: 0.0680
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   vnipc_t: 0.0650
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   insec_t: 0.0615
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   ATR: 0.0611
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   Volatility: 0.0609
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   ret: 0.0588
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   s_d7_t: 0.0587
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   ma7_t: 0.0565
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   Median_HL: 0.0548
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   LO: 0.0542
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   SR: 0.0539
2025-05-19 23:19:40,823 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:19:40,824 - INFO - [src.data_preparation] -   ma14_t: 0.0521
2025-05-19 23:19:40,826 - INFO - [src.data_preparation] - Ticker HCC - Using features: ['Date', 'TVV', 'HL', 'vnipc_t', 'SK', 'insec_t', 'ATR', 'Volatility', 'ret', 's_d7_t', 'ma7_t', 'Median_HL', 'LO', 'SR', 'variation_t', 'ma14_t']
2025-05-19 23:19:40,910 - INFO - [src.data_preparation] - Ticker HCC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:40,910 - INFO - [src.data_preparation] - Ticker HCC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:40,911 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HCC
2025-05-19 23:19:40,912 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:40,912 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:19:40,912 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:19:40,915 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:19:40,915 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:19:40,918 - INFO - [src.data_preparation] - Ticker HCC - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:40,918 - INFO - [__main__] - Using best model for HCC: svm (F1: 0.7778)
2025-05-19 23:19:40,918 - INFO - [__main__] - Loading svm model for HCC...
2025-05-19 23:19:40,919 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:40,920 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:19:40,920 - INFO - [__main__] - Making predictions for HCC using svm
2025-05-19 23:19:40,921 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:40,922 - INFO - [__main__] - Successfully got last prediction for HCC
2025-05-19 23:19:40,922 - INFO - [__main__] - 
Processing ticker: HCI
2025-05-19 23:19:40,922 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:40,922 - INFO - [__main__] - Getting last prediction point for ticker: HCI
2025-05-19 23:19:40,922 - INFO - [__main__] - ==================================================
2025-05-19 23:19:40,922 - INFO - [__main__] - Preparing test data for HCI...
2025-05-19 23:19:40,956 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:40,956 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:40,956 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:40,976 - INFO - [src.data_preparation] - Ticker HCI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:40,976 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(54), np.int64(1): np.int64(585)}
2025-05-19 23:19:41,164 - INFO - [src.data_preparation] - Ticker HCI - Selected features:
2025-05-19 23:19:41,164 - INFO - [src.data_preparation] -   vnipc_t: 0.2292
2025-05-19 23:19:41,164 - INFO - [src.data_preparation] -   ma21_t: 0.1415
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   ma14_t: 0.1104
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   ma7_t: 0.0670
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   PM: 0.0601
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   s_d7_t: 0.0520
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   Median_HL: 0.0445
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   Volatility: 0.0385
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   TVV: 0.0381
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   ATR: 0.0344
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   SK: 0.0287
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   variation_t: 0.0283
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   MDD: 0.0268
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   ret: 0.0252
2025-05-19 23:19:41,165 - INFO - [src.data_preparation] -   SR: 0.0239
2025-05-19 23:19:41,168 - INFO - [src.data_preparation] - Ticker HCI - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'PM', 's_d7_t', 'Median_HL', 'Volatility', 'TVV', 'ATR', 'SK', 'variation_t', 'MDD', 'ret', 'SR']
2025-05-19 23:19:41,246 - INFO - [src.data_preparation] - Ticker HCI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:41,246 - INFO - [src.data_preparation] - Ticker HCI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:41,248 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HCI
2025-05-19 23:19:41,248 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:41,248 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(47), np.int64(1): np.int64(416)}
2025-05-19 23:19:41,248 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:19:41,251 - INFO - [src.data_preparation] - Ticker HCI - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:41,252 - INFO - [__main__] - Using best model for HCI: lstm (F1: 0.9885)
2025-05-19 23:19:41,252 - INFO - [__main__] - Loading lstm model for HCI...
2025-05-19 23:19:41,256 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:41,257 - INFO - [__main__] - Model size: 0.37 MB
2025-05-19 23:19:41,257 - INFO - [__main__] - Making predictions for HCI using lstm
2025-05-19 23:19:41,261 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:41,262 - INFO - [__main__] - Successfully got last prediction for HCI
2025-05-19 23:19:41,262 - INFO - [__main__] - 
Processing ticker: HCM
2025-05-19 23:19:41,262 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:41,262 - INFO - [__main__] - Getting last prediction point for ticker: HCM
2025-05-19 23:19:41,262 - INFO - [__main__] - ==================================================
2025-05-19 23:19:41,262 - INFO - [__main__] - Preparing test data for HCM...
2025-05-19 23:19:41,314 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:41,314 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:41,314 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:41,348 - INFO - [src.data_preparation] - Ticker HCM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:41,349 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] - Ticker HCM - Selected features:
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   vnipc_t: 0.0713
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   SK: 0.0710
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   insec_t: 0.0708
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   TVV: 0.0673
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   Volatility: 0.0643
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:19:41,740 - INFO - [src.data_preparation] -   SR: 0.0576
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   ret: 0.0565
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   HL: 0.0554
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   variation_t: 0.0547
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   ma21_t: 0.0528
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:19:41,741 - INFO - [src.data_preparation] -   ma14_t: 0.0518
2025-05-19 23:19:41,743 - INFO - [src.data_preparation] - Ticker HCM - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'TVV', 'Volatility', 's_d7_t', 'SR', 'ret', 'ATR', 'HL', 'ma7_t', 'variation_t', 'ma21_t', 'Median_HL', 'ma14_t']
2025-05-19 23:19:41,825 - INFO - [src.data_preparation] - Ticker HCM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:41,825 - INFO - [src.data_preparation] - Ticker HCM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:41,827 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HCM
2025-05-19 23:19:41,827 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:41,827 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:19:41,827 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:19:41,830 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:19:41,830 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:19:41,832 - INFO - [src.data_preparation] - Ticker HCM - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:41,832 - INFO - [__main__] - Using best model for HCM: svm (F1: 0.7246)
2025-05-19 23:19:41,832 - INFO - [__main__] - Loading svm model for HCM...
2025-05-19 23:19:41,834 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:41,834 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:19:41,834 - INFO - [__main__] - Making predictions for HCM using svm
2025-05-19 23:19:41,834 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:41,835 - INFO - [__main__] - Successfully got last prediction for HCM
2025-05-19 23:19:41,835 - INFO - [__main__] - 
Processing ticker: HCT
2025-05-19 23:19:41,835 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:41,835 - INFO - [__main__] - Getting last prediction point for ticker: HCT
2025-05-19 23:19:41,835 - INFO - [__main__] - ==================================================
2025-05-19 23:19:41,835 - INFO - [__main__] - Preparing test data for HCT...
2025-05-19 23:19:41,864 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:41,864 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:41,865 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:41,883 - INFO - [src.data_preparation] - Ticker HCT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:41,884 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(165), np.int64(1): np.int64(474)}
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] - Ticker HCT - Selected features:
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   ma21_t: 0.0762
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   TVV: 0.0755
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   ma14_t: 0.0708
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   PM: 0.0704
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   Median_HL: 0.0672
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   ma7_t: 0.0666
2025-05-19 23:19:42,119 - INFO - [src.data_preparation] -   SK: 0.0635
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   ATR: 0.0625
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   Volatility: 0.0538
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   HL: 0.0513
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   insec_t: 0.0463
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   LO: 0.0461
2025-05-19 23:19:42,120 - INFO - [src.data_preparation] -   SR: 0.0406
2025-05-19 23:19:42,122 - INFO - [src.data_preparation] - Ticker HCT - Using features: ['Date', 'ma21_t', 'vnipc_t', 'TVV', 'ma14_t', 'PM', 'Median_HL', 'ma7_t', 'SK', 'ATR', 's_d7_t', 'Volatility', 'HL', 'insec_t', 'LO', 'SR']
2025-05-19 23:19:42,207 - INFO - [src.data_preparation] - Ticker HCT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:42,207 - INFO - [src.data_preparation] - Ticker HCT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:42,209 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HCT
2025-05-19 23:19:42,209 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:42,209 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(140), np.int64(1): np.int64(323)}
2025-05-19 23:19:42,209 - INFO - [src.data_preparation] - Generating 183 synthetic minority samples
2025-05-19 23:19:42,216 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (646, 13, 15), y shape: (646,)
2025-05-19 23:19:42,216 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(323), np.int64(1): np.int64(323)}
2025-05-19 23:19:42,220 - INFO - [src.data_preparation] - Ticker HCT - Final 3D shapes: X_train=(646, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:42,221 - INFO - [__main__] - Using best model for HCT: svm (F1: 0.9398)
2025-05-19 23:19:42,221 - INFO - [__main__] - Loading svm model for HCT...
2025-05-19 23:19:42,222 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:42,223 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:19:42,223 - INFO - [__main__] - Making predictions for HCT using svm
2025-05-19 23:19:42,223 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:42,224 - INFO - [__main__] - Successfully got last prediction for HCT
2025-05-19 23:19:42,224 - INFO - [__main__] - 
Processing ticker: HDA
2025-05-19 23:19:42,224 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:42,224 - INFO - [__main__] - Getting last prediction point for ticker: HDA
2025-05-19 23:19:42,224 - INFO - [__main__] - ==================================================
2025-05-19 23:19:42,224 - INFO - [__main__] - Preparing test data for HDA...
2025-05-19 23:19:42,251 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:42,251 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:42,251 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:42,271 - INFO - [src.data_preparation] - Ticker HDA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:42,271 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:19:42,585 - INFO - [src.data_preparation] - Ticker HDA - Selected features:
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   vnipc_t: 0.0772
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   insec_t: 0.0677
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   SK: 0.0664
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   TVV: 0.0651
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   Volatility: 0.0641
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   ATR: 0.0610
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   s_d7_t: 0.0601
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   ma14_t: 0.0587
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   ma21_t: 0.0578
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   variation_t: 0.0571
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   ma7_t: 0.0549
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   ret: 0.0549
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   HL: 0.0535
2025-05-19 23:19:42,586 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:19:42,587 - INFO - [src.data_preparation] -   SR: 0.0482
2025-05-19 23:19:42,589 - INFO - [src.data_preparation] - Ticker HDA - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'TVV', 'Volatility', 'ATR', 's_d7_t', 'ma14_t', 'ma21_t', 'variation_t', 'ma7_t', 'ret', 'HL', 'Median_HL', 'SR']
2025-05-19 23:19:42,690 - INFO - [src.data_preparation] - Ticker HDA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:42,690 - INFO - [src.data_preparation] - Ticker HDA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:42,692 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HDA
2025-05-19 23:19:42,692 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:42,692 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:19:42,692 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:19:42,694 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:19:42,694 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:19:42,697 - INFO - [src.data_preparation] - Ticker HDA - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:42,697 - INFO - [__main__] - Using best model for HDA: lstm (F1: 0.7164)
2025-05-19 23:19:42,697 - INFO - [__main__] - Loading lstm model for HDA...
2025-05-19 23:19:42,701 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:42,702 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:19:42,702 - INFO - [__main__] - Making predictions for HDA using lstm
2025-05-19 23:19:42,704 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:42,704 - INFO - [__main__] - Successfully got last prediction for HDA
2025-05-19 23:19:42,704 - INFO - [__main__] - 
Processing ticker: HDC
2025-05-19 23:19:42,704 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:42,704 - INFO - [__main__] - Getting last prediction point for ticker: HDC
2025-05-19 23:19:42,705 - INFO - [__main__] - ==================================================
2025-05-19 23:19:42,705 - INFO - [__main__] - Preparing test data for HDC...
2025-05-19 23:19:42,740 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:42,740 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:42,740 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:42,765 - INFO - [src.data_preparation] - Ticker HDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:42,765 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:19:43,104 - INFO - [src.data_preparation] - Ticker HDC - Selected features:
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   insec_t: 0.0743
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   TVV: 0.0659
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   Volatility: 0.0651
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   vnipc_t: 0.0651
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   SK: 0.0649
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   SR: 0.0621
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   ret: 0.0614
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   variation_t: 0.0591
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   ATR: 0.0590
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   HL: 0.0554
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   s_d7_t: 0.0544
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   PM: 0.0538
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   ma7_t: 0.0531
2025-05-19 23:19:43,105 - INFO - [src.data_preparation] -   Median_HL: 0.0526
2025-05-19 23:19:43,106 - INFO - [src.data_preparation] -   LO: 0.0524
2025-05-19 23:19:43,108 - INFO - [src.data_preparation] - Ticker HDC - Using features: ['Date', 'insec_t', 'TVV', 'Volatility', 'vnipc_t', 'SK', 'SR', 'ret', 'variation_t', 'ATR', 'HL', 's_d7_t', 'PM', 'ma7_t', 'Median_HL', 'LO']
2025-05-19 23:19:43,191 - INFO - [src.data_preparation] - Ticker HDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:43,191 - INFO - [src.data_preparation] - Ticker HDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:43,193 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HDC
2025-05-19 23:19:43,193 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:43,193 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:19:43,193 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:19:43,196 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:19:43,196 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:19:43,199 - INFO - [src.data_preparation] - Ticker HDC - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:43,199 - INFO - [__main__] - Using best model for HDC: lstm (F1: 0.6667)
2025-05-19 23:19:43,199 - INFO - [__main__] - Loading lstm model for HDC...
2025-05-19 23:19:43,205 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:43,206 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:19:43,206 - INFO - [__main__] - Making predictions for HDC using lstm
2025-05-19 23:19:43,207 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:43,208 - INFO - [__main__] - Successfully got last prediction for HDC
2025-05-19 23:19:43,208 - INFO - [__main__] - 
Processing ticker: HDG
2025-05-19 23:19:43,208 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:43,208 - INFO - [__main__] - Getting last prediction point for ticker: HDG
2025-05-19 23:19:43,208 - INFO - [__main__] - ==================================================
2025-05-19 23:19:43,208 - INFO - [__main__] - Preparing test data for HDG...
2025-05-19 23:19:43,250 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:43,250 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:43,250 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:43,280 - INFO - [src.data_preparation] - Ticker HDG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:43,280 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] - Ticker HDG - Selected features:
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   TVV: 0.0725
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   SK: 0.0680
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   vnipc_t: 0.0679
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   insec_t: 0.0629
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   s_d7_t: 0.0599
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:19:43,628 - INFO - [src.data_preparation] -   HL: 0.0573
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   Median_HL: 0.0568
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   ret: 0.0561
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   ma14_t: 0.0555
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   LO: 0.0554
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   PM: 0.0533
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   ma21_t: 0.0527
2025-05-19 23:19:43,629 - INFO - [src.data_preparation] -   SR: 0.0523
2025-05-19 23:19:43,631 - INFO - [src.data_preparation] - Ticker HDG - Using features: ['Date', 'TVV', 'Volatility', 'SK', 'vnipc_t', 'insec_t', 's_d7_t', 'ATR', 'HL', 'Median_HL', 'ret', 'ma14_t', 'LO', 'PM', 'ma21_t', 'SR']
2025-05-19 23:19:43,743 - INFO - [src.data_preparation] - Ticker HDG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:43,743 - INFO - [src.data_preparation] - Ticker HDG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:43,745 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HDG
2025-05-19 23:19:43,745 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:43,745 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:19:43,745 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:19:43,749 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:19:43,749 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:19:43,753 - INFO - [src.data_preparation] - Ticker HDG - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:43,753 - INFO - [__main__] - Using best model for HDG: transformer (F1: 0.6462)
2025-05-19 23:19:43,753 - INFO - [__main__] - Loading transformer model for HDG...
2025-05-19 23:19:43,771 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:19:43,777 - INFO - [__main__] - Model size: 0.38 MB
2025-05-19 23:19:43,777 - INFO - [__main__] - Making predictions for HDG using transformer
2025-05-19 23:19:43,781 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:43,782 - INFO - [__main__] - Successfully got last prediction for HDG
2025-05-19 23:19:43,782 - INFO - [__main__] - 
Processing ticker: HDM
2025-05-19 23:19:43,782 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:43,783 - INFO - [__main__] - Getting last prediction point for ticker: HDM
2025-05-19 23:19:43,783 - INFO - [__main__] - ==================================================
2025-05-19 23:19:43,783 - INFO - [__main__] - Preparing test data for HDM...
2025-05-19 23:19:43,841 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:43,841 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:43,841 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:43,871 - INFO - [src.data_preparation] - Ticker HDM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:43,871 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(231), np.int64(1): np.int64(408)}
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] - Ticker HDM - Selected features:
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   vnipc_t: 0.0774
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   TVV: 0.0730
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   s_d7_t: 0.0695
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   ma14_t: 0.0650
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   ATR: 0.0631
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   insec_t: 0.0630
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   Volatility: 0.0623
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   ma21_t: 0.0593
2025-05-19 23:19:44,247 - INFO - [src.data_preparation] -   HL: 0.0575
2025-05-19 23:19:44,249 - INFO - [src.data_preparation] -   ma7_t: 0.0539
2025-05-19 23:19:44,249 - INFO - [src.data_preparation] -   SR: 0.0534
2025-05-19 23:19:44,249 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:19:44,249 - INFO - [src.data_preparation] -   PM: 0.0502
2025-05-19 23:19:44,249 - INFO - [src.data_preparation] -   variation_t: 0.0484
2025-05-19 23:19:44,252 - INFO - [src.data_preparation] - Ticker HDM - Using features: ['Date', 'vnipc_t', 'TVV', 's_d7_t', 'SK', 'ma14_t', 'ATR', 'insec_t', 'Volatility', 'ma21_t', 'HL', 'ma7_t', 'SR', 'Median_HL', 'PM', 'variation_t']
2025-05-19 23:19:44,334 - INFO - [src.data_preparation] - Ticker HDM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:44,334 - INFO - [src.data_preparation] - Ticker HDM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:44,335 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HDM
2025-05-19 23:19:44,336 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:44,336 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(161), np.int64(1): np.int64(302)}
2025-05-19 23:19:44,336 - INFO - [src.data_preparation] - Generating 141 synthetic minority samples
2025-05-19 23:19:44,342 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (604, 13, 15), y shape: (604,)
2025-05-19 23:19:44,342 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(302), np.int64(1): np.int64(302)}
2025-05-19 23:19:44,346 - INFO - [src.data_preparation] - Ticker HDM - Final 3D shapes: X_train=(604, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:44,346 - INFO - [__main__] - Using best model for HDM: svm (F1: 0.7429)
2025-05-19 23:19:44,346 - INFO - [__main__] - Loading svm model for HDM...
2025-05-19 23:19:44,347 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:44,348 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:19:44,348 - INFO - [__main__] - Making predictions for HDM using svm
2025-05-19 23:19:44,348 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:44,349 - INFO - [__main__] - Successfully got last prediction for HDM
2025-05-19 23:19:44,349 - INFO - [__main__] - 
Processing ticker: HDO
2025-05-19 23:19:44,349 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:44,349 - INFO - [__main__] - Getting last prediction point for ticker: HDO
2025-05-19 23:19:44,349 - INFO - [__main__] - ==================================================
2025-05-19 23:19:44,349 - INFO - [__main__] - Preparing test data for HDO...
2025-05-19 23:19:44,377 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:44,377 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:44,377 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:44,397 - INFO - [src.data_preparation] - Ticker HDO - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:44,397 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(203), np.int64(1): np.int64(436)}
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] - Ticker HDO - Selected features:
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   vnipc_t: 0.0975
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   TVV: 0.0862
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   insec_t: 0.0707
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   Volatility: 0.0667
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   ma14_t: 0.0650
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   ma21_t: 0.0649
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   s_d7_t: 0.0641
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   Median_HL: 0.0609
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   ma7_t: 0.0601
2025-05-19 23:19:44,634 - INFO - [src.data_preparation] -   SK: 0.0583
2025-05-19 23:19:44,635 - INFO - [src.data_preparation] -   PM: 0.0526
2025-05-19 23:19:44,635 - INFO - [src.data_preparation] -   HL: 0.0465
2025-05-19 23:19:44,635 - INFO - [src.data_preparation] -   ATR: 0.0455
2025-05-19 23:19:44,635 - INFO - [src.data_preparation] -   ret: 0.0435
2025-05-19 23:19:44,635 - INFO - [src.data_preparation] -   variation_t: 0.0403
2025-05-19 23:19:44,637 - INFO - [src.data_preparation] - Ticker HDO - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 'ma14_t', 'ma21_t', 's_d7_t', 'Median_HL', 'ma7_t', 'SK', 'PM', 'HL', 'ATR', 'ret', 'variation_t']
2025-05-19 23:19:44,719 - INFO - [src.data_preparation] - Ticker HDO - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:44,719 - INFO - [src.data_preparation] - Ticker HDO - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:44,721 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HDO
2025-05-19 23:19:44,721 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:44,721 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(162), np.int64(1): np.int64(301)}
2025-05-19 23:19:44,721 - INFO - [src.data_preparation] - Generating 139 synthetic minority samples
2025-05-19 23:19:44,726 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (602, 13, 15), y shape: (602,)
2025-05-19 23:19:44,726 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(301), np.int64(1): np.int64(301)}
2025-05-19 23:19:44,730 - INFO - [src.data_preparation] - Ticker HDO - Final 3D shapes: X_train=(602, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:44,730 - INFO - [__main__] - Using best model for HDO: lstm (F1: 0.9885)
2025-05-19 23:19:44,730 - INFO - [__main__] - Loading lstm model for HDO...
2025-05-19 23:19:44,733 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:44,734 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:19:44,734 - INFO - [__main__] - Making predictions for HDO using lstm
2025-05-19 23:19:44,736 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:44,736 - INFO - [__main__] - Successfully got last prediction for HDO
2025-05-19 23:19:44,736 - INFO - [__main__] - 
Processing ticker: HEV
2025-05-19 23:19:44,736 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:44,736 - INFO - [__main__] - Getting last prediction point for ticker: HEV
2025-05-19 23:19:44,736 - INFO - [__main__] - ==================================================
2025-05-19 23:19:44,736 - INFO - [__main__] - Preparing test data for HEV...
2025-05-19 23:19:44,768 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:44,768 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:44,769 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:44,792 - INFO - [src.data_preparation] - Ticker HEV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:44,792 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(174), np.int64(1): np.int64(465)}
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] - Ticker HEV - Selected features:
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   TVV: 0.0832
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   vnipc_t: 0.0831
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   ma21_t: 0.0691
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   Volatility: 0.0645
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   ma14_t: 0.0641
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   SK: 0.0641
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   ATR: 0.0603
2025-05-19 23:19:45,071 - INFO - [src.data_preparation] -   s_d7_t: 0.0594
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   PM: 0.0590
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   Median_HL: 0.0564
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   HL: 0.0556
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   ma7_t: 0.0517
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   insec_t: 0.0509
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   LO: 0.0479
2025-05-19 23:19:45,072 - INFO - [src.data_preparation] -   SR: 0.0453
2025-05-19 23:19:45,074 - INFO - [src.data_preparation] - Ticker HEV - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'Volatility', 'ma14_t', 'SK', 'ATR', 's_d7_t', 'PM', 'Median_HL', 'HL', 'ma7_t', 'insec_t', 'LO', 'SR']
2025-05-19 23:19:45,156 - INFO - [src.data_preparation] - Ticker HEV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:45,156 - INFO - [src.data_preparation] - Ticker HEV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:45,158 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HEV
2025-05-19 23:19:45,158 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:45,158 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(158), np.int64(1): np.int64(305)}
2025-05-19 23:19:45,158 - INFO - [src.data_preparation] - Generating 147 synthetic minority samples
2025-05-19 23:19:45,165 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (610, 13, 15), y shape: (610,)
2025-05-19 23:19:45,165 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(305), np.int64(1): np.int64(305)}
2025-05-19 23:19:45,169 - INFO - [src.data_preparation] - Ticker HEV - Final 3D shapes: X_train=(610, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:45,169 - INFO - [__main__] - Using best model for HEV: lstm (F1: 0.9767)
2025-05-19 23:19:45,169 - INFO - [__main__] - Loading lstm model for HEV...
2025-05-19 23:19:45,174 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:45,175 - INFO - [__main__] - Model size: 0.31 MB
2025-05-19 23:19:45,175 - INFO - [__main__] - Making predictions for HEV using lstm
2025-05-19 23:19:45,179 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:45,180 - INFO - [__main__] - Successfully got last prediction for HEV
2025-05-19 23:19:45,180 - INFO - [__main__] - 
Processing ticker: HFC
2025-05-19 23:19:45,180 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:45,180 - INFO - [__main__] - Getting last prediction point for ticker: HFC
2025-05-19 23:19:45,180 - INFO - [__main__] - ==================================================
2025-05-19 23:19:45,180 - INFO - [__main__] - Preparing test data for HFC...
2025-05-19 23:19:45,224 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:45,224 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:45,225 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:45,257 - INFO - [src.data_preparation] - Ticker HFC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:45,257 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(115), np.int64(1): np.int64(524)}
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] - Ticker HFC - Selected features:
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   ATR: 0.1099
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   vnipc_t: 0.0851
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   ma21_t: 0.0818
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   TVV: 0.0803
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   Volatility: 0.0699
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   ma14_t: 0.0675
2025-05-19 23:19:45,509 - INFO - [src.data_preparation] -   ma7_t: 0.0633
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   HL: 0.0628
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   Median_HL: 0.0522
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   SK: 0.0496
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   insec_t: 0.0418
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   variation_t: 0.0387
2025-05-19 23:19:45,510 - INFO - [src.data_preparation] -   ret: 0.0366
2025-05-19 23:19:45,513 - INFO - [src.data_preparation] - Ticker HFC - Using features: ['Date', 'ATR', 'vnipc_t', 'ma21_t', 'TVV', 'Volatility', 'ma14_t', 'ma7_t', 'HL', 's_d7_t', 'Median_HL', 'SK', 'PM', 'insec_t', 'variation_t', 'ret']
2025-05-19 23:19:45,594 - INFO - [src.data_preparation] - Ticker HFC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:45,594 - INFO - [src.data_preparation] - Ticker HFC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:45,595 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HFC
2025-05-19 23:19:45,595 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:45,596 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(75), np.int64(1): np.int64(388)}
2025-05-19 23:19:45,596 - INFO - [src.data_preparation] - Generating 313 synthetic minority samples
2025-05-19 23:19:45,606 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (776, 13, 15), y shape: (776,)
2025-05-19 23:19:45,606 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(388), np.int64(1): np.int64(388)}
2025-05-19 23:19:45,611 - INFO - [src.data_preparation] - Ticker HFC - Final 3D shapes: X_train=(776, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:45,611 - INFO - [__main__] - Using best model for HFC: svm (F1: 0.7761)
2025-05-19 23:19:45,611 - INFO - [__main__] - Loading svm model for HFC...
2025-05-19 23:19:45,612 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:45,612 - INFO - [__main__] - Model size: 0.49 MB
2025-05-19 23:19:45,613 - INFO - [__main__] - Making predictions for HFC using svm
2025-05-19 23:19:45,613 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:45,613 - INFO - [__main__] - Successfully got last prediction for HFC
2025-05-19 23:19:45,613 - INFO - [__main__] - 
Processing ticker: HFX
2025-05-19 23:19:45,613 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:45,614 - INFO - [__main__] - Getting last prediction point for ticker: HFX
2025-05-19 23:19:45,614 - INFO - [__main__] - ==================================================
2025-05-19 23:19:45,614 - INFO - [__main__] - Preparing test data for HFX...
2025-05-19 23:19:45,641 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:45,641 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:45,641 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:45,659 - INFO - [src.data_preparation] - Ticker HFX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:45,659 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(25), np.int64(1): np.int64(614)}
2025-05-19 23:19:45,805 - INFO - [src.data_preparation] - Ticker HFX - Selected features:
2025-05-19 23:19:45,805 - INFO - [src.data_preparation] -   vnipc_t: 0.1851
2025-05-19 23:19:45,805 - INFO - [src.data_preparation] -   s_d7_t: 0.0888
2025-05-19 23:19:45,805 - INFO - [src.data_preparation] -   ATR: 0.0863
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   SR: 0.0648
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   Volatility: 0.0590
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   TVV: 0.0563
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   ma7_t: 0.0509
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   PM: 0.0479
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   Median_HL: 0.0476
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   variation_t: 0.0473
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   ma21_t: 0.0449
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   ma14_t: 0.0431
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   HL: 0.0426
2025-05-19 23:19:45,806 - INFO - [src.data_preparation] -   SK: 0.0420
2025-05-19 23:19:45,809 - INFO - [src.data_preparation] - Ticker HFX - Using features: ['Date', 'vnipc_t', 's_d7_t', 'ATR', 'SR', 'Volatility', 'TVV', 'ret', 'ma7_t', 'PM', 'Median_HL', 'variation_t', 'ma21_t', 'ma14_t', 'HL', 'SK']
2025-05-19 23:19:45,890 - INFO - [src.data_preparation] - Ticker HFX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:45,890 - INFO - [src.data_preparation] - Ticker HFX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:45,892 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE for ticker HFX - insufficient samples per class or only one class
2025-05-19 23:19:45,895 - INFO - [src.data_preparation] - Ticker HFX - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:45,895 - INFO - [__main__] - Using best model for HFX: lstm (F1: 0.9000)
2025-05-19 23:19:45,896 - INFO - [__main__] - Loading lstm model for HFX...
2025-05-19 23:19:45,899 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:45,900 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:19:45,900 - INFO - [__main__] - Making predictions for HFX using lstm
2025-05-19 23:19:45,901 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:45,901 - INFO - [__main__] - Successfully got last prediction for HFX
2025-05-19 23:19:45,902 - INFO - [__main__] - 
Processing ticker: HGM
2025-05-19 23:19:45,902 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:45,902 - INFO - [__main__] - Getting last prediction point for ticker: HGM
2025-05-19 23:19:45,902 - INFO - [__main__] - ==================================================
2025-05-19 23:19:45,902 - INFO - [__main__] - Preparing test data for HGM...
2025-05-19 23:19:45,939 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:45,939 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:45,939 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:45,969 - INFO - [src.data_preparation] - Ticker HGM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:45,969 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(178), np.int64(1): np.int64(461)}
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] - Ticker HGM - Selected features:
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   vnipc_t: 0.0771
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   Volatility: 0.0736
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   SK: 0.0732
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   s_d7_t: 0.0715
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   ATR: 0.0700
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   TVV: 0.0687
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   ma14_t: 0.0650
2025-05-19 23:19:46,297 - INFO - [src.data_preparation] -   ma21_t: 0.0622
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   ma7_t: 0.0602
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   Median_HL: 0.0515
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   ret: 0.0468
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   insec_t: 0.0459
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   variation_t: 0.0421
2025-05-19 23:19:46,298 - INFO - [src.data_preparation] -   HL: 0.0419
2025-05-19 23:19:46,301 - INFO - [src.data_preparation] - Ticker HGM - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 's_d7_t', 'ATR', 'TVV', 'ma14_t', 'ma21_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'insec_t', 'variation_t', 'HL']
2025-05-19 23:19:46,402 - INFO - [src.data_preparation] - Ticker HGM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:46,403 - INFO - [src.data_preparation] - Ticker HGM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:46,405 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HGM
2025-05-19 23:19:46,405 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:46,406 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(139), np.int64(1): np.int64(324)}
2025-05-19 23:19:46,406 - INFO - [src.data_preparation] - Generating 185 synthetic minority samples
2025-05-19 23:19:46,415 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (648, 13, 15), y shape: (648,)
2025-05-19 23:19:46,415 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(324), np.int64(1): np.int64(324)}
2025-05-19 23:19:46,419 - INFO - [src.data_preparation] - Ticker HGM - Final 3D shapes: X_train=(648, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:46,420 - INFO - [__main__] - Using best model for HGM: lstm (F1: 0.8108)
2025-05-19 23:19:46,420 - INFO - [__main__] - Loading lstm model for HGM...
2025-05-19 23:19:46,424 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:46,425 - INFO - [__main__] - Model size: 0.15 MB
2025-05-19 23:19:46,425 - INFO - [__main__] - Making predictions for HGM using lstm
2025-05-19 23:19:46,429 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:46,429 - INFO - [__main__] - Successfully got last prediction for HGM
2025-05-19 23:19:46,429 - INFO - [__main__] - 
Processing ticker: HHC
2025-05-19 23:19:46,429 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:46,430 - INFO - [__main__] - Getting last prediction point for ticker: HHC
2025-05-19 23:19:46,430 - INFO - [__main__] - ==================================================
2025-05-19 23:19:46,430 - INFO - [__main__] - Preparing test data for HHC...
2025-05-19 23:19:46,482 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:46,482 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:46,482 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:46,508 - INFO - [src.data_preparation] - Ticker HHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:46,509 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(200), np.int64(1): np.int64(439)}
2025-05-19 23:19:46,783 - INFO - [src.data_preparation] - Ticker HHC - Selected features:
2025-05-19 23:19:46,783 - INFO - [src.data_preparation] -   vnipc_t: 0.0735
2025-05-19 23:19:46,783 - INFO - [src.data_preparation] -   ma7_t: 0.0716
2025-05-19 23:19:46,783 - INFO - [src.data_preparation] -   ma21_t: 0.0707
2025-05-19 23:19:46,783 - INFO - [src.data_preparation] -   ma14_t: 0.0687
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   TVV: 0.0683
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   PM: 0.0662
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   Median_HL: 0.0643
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   ATR: 0.0621
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   s_d7_t: 0.0605
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   Volatility: 0.0581
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   insec_t: 0.0508
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   SR: 0.0487
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   HL: 0.0442
2025-05-19 23:19:46,784 - INFO - [src.data_preparation] -   variation_t: 0.0433
2025-05-19 23:19:46,787 - INFO - [src.data_preparation] - Ticker HHC - Using features: ['Date', 'vnipc_t', 'ma7_t', 'ma21_t', 'ma14_t', 'TVV', 'PM', 'SK', 'Median_HL', 'ATR', 's_d7_t', 'Volatility', 'insec_t', 'SR', 'HL', 'variation_t']
2025-05-19 23:19:46,872 - INFO - [src.data_preparation] - Ticker HHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:46,872 - INFO - [src.data_preparation] - Ticker HHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:46,873 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HHC
2025-05-19 23:19:46,874 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:46,874 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(161), np.int64(1): np.int64(302)}
2025-05-19 23:19:46,874 - INFO - [src.data_preparation] - Generating 141 synthetic minority samples
2025-05-19 23:19:46,880 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (604, 13, 15), y shape: (604,)
2025-05-19 23:19:46,880 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(302), np.int64(1): np.int64(302)}
2025-05-19 23:19:46,883 - INFO - [src.data_preparation] - Ticker HHC - Final 3D shapes: X_train=(604, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:46,883 - INFO - [__main__] - Using best model for HHC: transformer (F1: 0.9091)
2025-05-19 23:19:46,884 - INFO - [__main__] - Loading transformer model for HHC...
2025-05-19 23:19:46,895 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:46,899 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:19:46,900 - INFO - [__main__] - Making predictions for HHC using transformer
2025-05-19 23:19:46,901 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:46,901 - INFO - [__main__] - Successfully got last prediction for HHC
2025-05-19 23:19:46,901 - INFO - [__main__] - 
Processing ticker: HHG
2025-05-19 23:19:46,901 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:46,901 - INFO - [__main__] - Getting last prediction point for ticker: HHG
2025-05-19 23:19:46,901 - INFO - [__main__] - ==================================================
2025-05-19 23:19:46,902 - INFO - [__main__] - Preparing test data for HHG...
2025-05-19 23:19:46,932 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:46,932 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:46,933 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:46,962 - INFO - [src.data_preparation] - Ticker HHG - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:46,962 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(266), np.int64(1): np.int64(372)}
2025-05-19 23:19:47,259 - INFO - [src.data_preparation] - Ticker HHG - Selected features:
2025-05-19 23:19:47,259 - INFO - [src.data_preparation] -   vnipc_t: 0.0812
2025-05-19 23:19:47,259 - INFO - [src.data_preparation] -   insec_t: 0.0764
2025-05-19 23:19:47,259 - INFO - [src.data_preparation] -   SK: 0.0731
2025-05-19 23:19:47,259 - INFO - [src.data_preparation] -   Volatility: 0.0686
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   TVV: 0.0670
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   ma21_t: 0.0635
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   ma14_t: 0.0631
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   s_d7_t: 0.0615
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   ma7_t: 0.0552
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   Median_HL: 0.0523
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   HL: 0.0505
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   variation_t: 0.0492
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   ATR: 0.0488
2025-05-19 23:19:47,260 - INFO - [src.data_preparation] -   ret: 0.0458
2025-05-19 23:19:47,263 - INFO - [src.data_preparation] - Ticker HHG - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 'TVV', 'ma21_t', 'ma14_t', 's_d7_t', 'PM', 'ma7_t', 'Median_HL', 'HL', 'variation_t', 'ATR', 'ret']
2025-05-19 23:19:47,389 - INFO - [src.data_preparation] - Ticker HHG - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:19:47,389 - INFO - [src.data_preparation] - Ticker HHG - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:47,391 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HHG
2025-05-19 23:19:47,391 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:47,391 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:19:47,391 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:19:47,395 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:19:47,395 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:19:47,399 - INFO - [src.data_preparation] - Ticker HHG - Final 3D shapes: X_train=(546, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:47,400 - INFO - [__main__] - Using best model for HHG: lstm (F1: 0.7429)
2025-05-19 23:19:47,400 - INFO - [__main__] - Loading lstm model for HHG...
2025-05-19 23:19:47,404 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:47,405 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:19:47,405 - INFO - [__main__] - Making predictions for HHG using lstm
2025-05-19 23:19:47,406 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:47,407 - INFO - [__main__] - Successfully got last prediction for HHG
2025-05-19 23:19:47,407 - INFO - [__main__] - 
Processing ticker: HHS
2025-05-19 23:19:47,407 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:47,407 - INFO - [__main__] - Getting last prediction point for ticker: HHS
2025-05-19 23:19:47,407 - INFO - [__main__] - ==================================================
2025-05-19 23:19:47,407 - INFO - [__main__] - Preparing test data for HHS...
2025-05-19 23:19:47,467 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:47,468 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:47,468 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:47,510 - INFO - [src.data_preparation] - Ticker HHS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:47,511 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(337)}
2025-05-19 23:19:47,841 - INFO - [src.data_preparation] - Ticker HHS - Selected features:
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   vnipc_t: 0.0698
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   SK: 0.0644
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   insec_t: 0.0632
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   ma21_t: 0.0626
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   Volatility: 0.0620
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   variation_t: 0.0583
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   ret: 0.0573
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   ma14_t: 0.0570
2025-05-19 23:19:47,842 - INFO - [src.data_preparation] -   TVV: 0.0568
2025-05-19 23:19:47,843 - INFO - [src.data_preparation] -   ATR: 0.0558
2025-05-19 23:19:47,843 - INFO - [src.data_preparation] -   SR: 0.0553
2025-05-19 23:19:47,843 - INFO - [src.data_preparation] -   Median_HL: 0.0539
2025-05-19 23:19:47,843 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:19:47,843 - INFO - [src.data_preparation] -   ma7_t: 0.0523
2025-05-19 23:19:47,845 - INFO - [src.data_preparation] - Ticker HHS - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'insec_t', 'ma21_t', 'Volatility', 'variation_t', 'ret', 'ma14_t', 'TVV', 'ATR', 'SR', 'Median_HL', 'PM', 'ma7_t']
2025-05-19 23:19:47,925 - INFO - [src.data_preparation] - Ticker HHS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:47,925 - INFO - [src.data_preparation] - Ticker HHS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:47,927 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HHS
2025-05-19 23:19:47,927 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:47,927 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:19:47,927 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:19:47,929 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:19:47,929 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:19:47,931 - INFO - [src.data_preparation] - Ticker HHS - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:47,931 - INFO - [__main__] - Using best model for HHS: transformer (F1: 0.6923)
2025-05-19 23:19:47,932 - INFO - [__main__] - Loading transformer model for HHS...
2025-05-19 23:19:47,951 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:19:47,958 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:19:47,958 - INFO - [__main__] - Making predictions for HHS using transformer
2025-05-19 23:19:47,961 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:47,962 - INFO - [__main__] - Successfully got last prediction for HHS
2025-05-19 23:19:47,962 - INFO - [__main__] - 
Processing ticker: HIG
2025-05-19 23:19:47,962 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:47,962 - INFO - [__main__] - Getting last prediction point for ticker: HIG
2025-05-19 23:19:47,962 - INFO - [__main__] - ==================================================
2025-05-19 23:19:47,962 - INFO - [__main__] - Preparing test data for HIG...
2025-05-19 23:19:48,016 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:48,016 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:48,016 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:48,046 - INFO - [src.data_preparation] - Ticker HIG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:48,046 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(239), np.int64(1): np.int64(400)}
2025-05-19 23:19:48,370 - INFO - [src.data_preparation] - Ticker HIG - Selected features:
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   vnipc_t: 0.0808
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   SK: 0.0759
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   TVV: 0.0751
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   insec_t: 0.0674
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   Volatility: 0.0667
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   ATR: 0.0616
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   ma14_t: 0.0569
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   SR: 0.0548
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   HL: 0.0521
2025-05-19 23:19:48,371 - INFO - [src.data_preparation] -   variation_t: 0.0514
2025-05-19 23:19:48,372 - INFO - [src.data_preparation] -   ma21_t: 0.0512
2025-05-19 23:19:48,372 - INFO - [src.data_preparation] -   ma7_t: 0.0501
2025-05-19 23:19:48,372 - INFO - [src.data_preparation] -   PM: 0.0482
2025-05-19 23:19:48,375 - INFO - [src.data_preparation] - Ticker HIG - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'insec_t', 'Volatility', 's_d7_t', 'ATR', 'ma14_t', 'SR', 'ret', 'HL', 'variation_t', 'ma21_t', 'ma7_t', 'PM']
2025-05-19 23:19:48,474 - INFO - [src.data_preparation] - Ticker HIG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:48,474 - INFO - [src.data_preparation] - Ticker HIG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:48,476 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HIG
2025-05-19 23:19:48,476 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:48,476 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(169), np.int64(1): np.int64(294)}
2025-05-19 23:19:48,476 - INFO - [src.data_preparation] - Generating 125 synthetic minority samples
2025-05-19 23:19:48,483 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (588, 13, 15), y shape: (588,)
2025-05-19 23:19:48,484 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(294), np.int64(1): np.int64(294)}
2025-05-19 23:19:48,488 - INFO - [src.data_preparation] - Ticker HIG - Final 3D shapes: X_train=(588, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:48,489 - INFO - [__main__] - Using best model for HIG: svm (F1: 0.7606)
2025-05-19 23:19:48,489 - INFO - [__main__] - Loading svm model for HIG...
2025-05-19 23:19:48,491 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:48,491 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:19:48,492 - INFO - [__main__] - Making predictions for HIG using svm
2025-05-19 23:19:48,492 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:48,493 - INFO - [__main__] - Successfully got last prediction for HIG
2025-05-19 23:19:48,493 - INFO - [__main__] - 
Processing ticker: HJS
2025-05-19 23:19:48,493 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:48,493 - INFO - [__main__] - Getting last prediction point for ticker: HJS
2025-05-19 23:19:48,493 - INFO - [__main__] - ==================================================
2025-05-19 23:19:48,493 - INFO - [__main__] - Preparing test data for HJS...
2025-05-19 23:19:48,530 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:48,530 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:48,530 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:48,552 - INFO - [src.data_preparation] - Ticker HJS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:48,552 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(227), np.int64(1): np.int64(412)}
2025-05-19 23:19:48,872 - INFO - [src.data_preparation] - Ticker HJS - Selected features:
2025-05-19 23:19:48,872 - INFO - [src.data_preparation] -   s_d7_t: 0.0700
2025-05-19 23:19:48,872 - INFO - [src.data_preparation] -   ATR: 0.0695
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   insec_t: 0.0669
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   vnipc_t: 0.0662
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   TVV: 0.0636
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   PM: 0.0592
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   Median_HL: 0.0567
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   ma7_t: 0.0566
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   HL: 0.0561
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   ma14_t: 0.0555
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   SR: 0.0538
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   ma21_t: 0.0530
2025-05-19 23:19:48,873 - INFO - [src.data_preparation] -   variation_t: 0.0511
2025-05-19 23:19:48,876 - INFO - [src.data_preparation] - Ticker HJS - Using features: ['Date', 's_d7_t', 'ATR', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 'TVV', 'PM', 'Median_HL', 'ma7_t', 'HL', 'ma14_t', 'SR', 'ma21_t', 'variation_t']
2025-05-19 23:19:48,965 - INFO - [src.data_preparation] - Ticker HJS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:48,965 - INFO - [src.data_preparation] - Ticker HJS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:48,968 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HJS
2025-05-19 23:19:48,968 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:48,968 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:19:48,968 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:19:48,976 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:19:48,976 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:19:48,980 - INFO - [src.data_preparation] - Ticker HJS - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:48,980 - INFO - [__main__] - Using best model for HJS: svm (F1: 0.5806)
2025-05-19 23:19:48,980 - INFO - [__main__] - Loading svm model for HJS...
2025-05-19 23:19:48,984 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:48,984 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:19:48,985 - INFO - [__main__] - Making predictions for HJS using svm
2025-05-19 23:19:48,985 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:48,986 - INFO - [__main__] - Successfully got last prediction for HJS
2025-05-19 23:19:48,986 - INFO - [__main__] - 
Processing ticker: HLA
2025-05-19 23:19:48,986 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:48,986 - INFO - [__main__] - Getting last prediction point for ticker: HLA
2025-05-19 23:19:48,986 - INFO - [__main__] - ==================================================
2025-05-19 23:19:48,986 - INFO - [__main__] - Preparing test data for HLA...
2025-05-19 23:19:49,013 - INFO - [src.data_preparation] - After processing - X shape: (634, 19), y shape: (634,)
2025-05-19 23:19:49,013 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:49,014 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:49,033 - INFO - [src.data_preparation] - Ticker HLA - Original shapes: X=(634, 18), y=(634,)
2025-05-19 23:19:49,033 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(169), np.int64(1): np.int64(465)}
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] - Ticker HLA - Selected features:
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   vnipc_t: 0.1180
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   insec_t: 0.0837
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   ma21_t: 0.0783
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   TVV: 0.0781
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   ma14_t: 0.0761
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   s_d7_t: 0.0702
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   ma7_t: 0.0695
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   Volatility: 0.0599
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   Median_HL: 0.0574
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   SK: 0.0538
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   ATR: 0.0526
2025-05-19 23:19:49,246 - INFO - [src.data_preparation] -   PM: 0.0468
2025-05-19 23:19:49,248 - INFO - [src.data_preparation] -   ret: 0.0411
2025-05-19 23:19:49,248 - INFO - [src.data_preparation] -   variation_t: 0.0392
2025-05-19 23:19:49,248 - INFO - [src.data_preparation] -   SR: 0.0250
2025-05-19 23:19:49,250 - INFO - [src.data_preparation] - Ticker HLA - Using features: ['Date', 'vnipc_t', 'insec_t', 'ma21_t', 'TVV', 'ma14_t', 's_d7_t', 'ma7_t', 'Volatility', 'Median_HL', 'SK', 'ATR', 'PM', 'ret', 'variation_t', 'SR']
2025-05-19 23:19:49,415 - INFO - [src.data_preparation] - Ticker HLA - 2D shapes: X_train=(458, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:49,416 - INFO - [src.data_preparation] - Ticker HLA - 3D shapes: X_train=(458, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:49,416 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HLA
2025-05-19 23:19:49,416 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (458, 13, 15), y shape: (458,)
2025-05-19 23:19:49,418 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(133), np.int64(1): np.int64(325)}
2025-05-19 23:19:49,418 - INFO - [src.data_preparation] - Generating 192 synthetic minority samples
2025-05-19 23:19:49,426 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (650, 13, 15), y shape: (650,)
2025-05-19 23:19:49,426 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(325), np.int64(1): np.int64(325)}
2025-05-19 23:19:49,429 - INFO - [src.data_preparation] - Ticker HLA - Final 3D shapes: X_train=(650, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:49,429 - INFO - [__main__] - Using best model for HLA: lstm (F1: 0.9885)
2025-05-19 23:19:49,429 - INFO - [__main__] - Loading lstm model for HLA...
2025-05-19 23:19:49,433 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:49,435 - INFO - [__main__] - Model size: 0.36 MB
2025-05-19 23:19:49,435 - INFO - [__main__] - Making predictions for HLA using lstm
2025-05-19 23:19:49,436 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:49,436 - INFO - [__main__] - Successfully got last prediction for HLA
2025-05-19 23:19:49,438 - INFO - [__main__] - 
Processing ticker: HLC
2025-05-19 23:19:49,438 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:49,438 - INFO - [__main__] - Getting last prediction point for ticker: HLC
2025-05-19 23:19:49,438 - INFO - [__main__] - ==================================================
2025-05-19 23:19:49,438 - INFO - [__main__] - Preparing test data for HLC...
2025-05-19 23:19:49,480 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:49,481 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:49,481 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:49,503 - INFO - [src.data_preparation] - Ticker HLC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:49,503 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(387)}
2025-05-19 23:19:49,843 - INFO - [src.data_preparation] - Ticker HLC - Selected features:
2025-05-19 23:19:49,843 - INFO - [src.data_preparation] -   vnipc_t: 0.0692
2025-05-19 23:19:49,843 - INFO - [src.data_preparation] -   ATR: 0.0669
2025-05-19 23:19:49,843 - INFO - [src.data_preparation] -   TVV: 0.0668
2025-05-19 23:19:49,843 - INFO - [src.data_preparation] -   ma21_t: 0.0651
2025-05-19 23:19:49,843 - INFO - [src.data_preparation] -   SK: 0.0639
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   ma14_t: 0.0634
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   Volatility: 0.0625
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   HL: 0.0595
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   ma7_t: 0.0588
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   Median_HL: 0.0559
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   SR: 0.0551
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   insec_t: 0.0534
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   PM: 0.0501
2025-05-19 23:19:49,844 - INFO - [src.data_preparation] -   ret: 0.0498
2025-05-19 23:19:49,847 - INFO - [src.data_preparation] - Ticker HLC - Using features: ['Date', 'vnipc_t', 'ATR', 'TVV', 'ma21_t', 'SK', 'ma14_t', 'Volatility', 's_d7_t', 'HL', 'ma7_t', 'Median_HL', 'SR', 'insec_t', 'PM', 'ret']
2025-05-19 23:19:49,929 - INFO - [src.data_preparation] - Ticker HLC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:49,929 - INFO - [src.data_preparation] - Ticker HLC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:49,930 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HLC
2025-05-19 23:19:49,930 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:49,930 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(169), np.int64(1): np.int64(294)}
2025-05-19 23:19:49,930 - INFO - [src.data_preparation] - Generating 125 synthetic minority samples
2025-05-19 23:19:49,936 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (588, 13, 15), y shape: (588,)
2025-05-19 23:19:49,936 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(294), np.int64(1): np.int64(294)}
2025-05-19 23:19:49,941 - INFO - [src.data_preparation] - Ticker HLC - Final 3D shapes: X_train=(588, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:49,941 - INFO - [__main__] - Using best model for HLC: svm (F1: 0.6866)
2025-05-19 23:19:49,942 - INFO - [__main__] - Loading svm model for HLC...
2025-05-19 23:19:49,944 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:49,945 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:19:49,945 - INFO - [__main__] - Making predictions for HLC using svm
2025-05-19 23:19:49,946 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:49,946 - INFO - [__main__] - Successfully got last prediction for HLC
2025-05-19 23:19:49,946 - INFO - [__main__] - 
Processing ticker: HLY
2025-05-19 23:19:49,946 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:49,946 - INFO - [__main__] - Getting last prediction point for ticker: HLY
2025-05-19 23:19:49,946 - INFO - [__main__] - ==================================================
2025-05-19 23:19:49,946 - INFO - [__main__] - Preparing test data for HLY...
2025-05-19 23:19:49,978 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:49,978 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:49,978 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:49,998 - INFO - [src.data_preparation] - Ticker HLY - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:49,999 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(127), np.int64(1): np.int64(511)}
2025-05-19 23:19:50,248 - INFO - [src.data_preparation] - Ticker HLY - Selected features:
2025-05-19 23:19:50,248 - INFO - [src.data_preparation] -   vnipc_t: 0.0911
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   ma21_t: 0.0822
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   ma14_t: 0.0821
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   ATR: 0.0744
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   s_d7_t: 0.0674
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   TVV: 0.0667
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   ma7_t: 0.0653
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   Median_HL: 0.0591
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   PM: 0.0548
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   SK: 0.0487
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   insec_t: 0.0477
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   HL: 0.0439
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   ret: 0.0424
2025-05-19 23:19:50,249 - INFO - [src.data_preparation] -   variation_t: 0.0409
2025-05-19 23:19:50,252 - INFO - [src.data_preparation] - Ticker HLY - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ATR', 's_d7_t', 'TVV', 'ma7_t', 'Volatility', 'Median_HL', 'PM', 'SK', 'insec_t', 'HL', 'ret', 'variation_t']
2025-05-19 23:19:50,334 - INFO - [src.data_preparation] - Ticker HLY - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:50,334 - INFO - [src.data_preparation] - Ticker HLY - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:50,335 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HLY
2025-05-19 23:19:50,335 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:19:50,335 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(97), np.int64(1): np.int64(365)}
2025-05-19 23:19:50,335 - INFO - [src.data_preparation] - Generating 268 synthetic minority samples
2025-05-19 23:19:50,346 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (730, 13, 15), y shape: (730,)
2025-05-19 23:19:50,346 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(365), np.int64(1): np.int64(365)}
2025-05-19 23:19:50,349 - INFO - [src.data_preparation] - Ticker HLY - Final 3D shapes: X_train=(730, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:50,350 - INFO - [__main__] - Using best model for HLY: transformer (F1: 0.8800)
2025-05-19 23:19:50,350 - INFO - [__main__] - Loading transformer model for HLY...
2025-05-19 23:19:50,360 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:50,362 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:19:50,362 - INFO - [__main__] - Making predictions for HLY using transformer
2025-05-19 23:19:50,364 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:50,365 - INFO - [__main__] - Successfully got last prediction for HLY
2025-05-19 23:19:50,365 - INFO - [__main__] - 
Processing ticker: HMC
2025-05-19 23:19:50,365 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:50,365 - INFO - [__main__] - Getting last prediction point for ticker: HMC
2025-05-19 23:19:50,365 - INFO - [__main__] - ==================================================
2025-05-19 23:19:50,365 - INFO - [__main__] - Preparing test data for HMC...
2025-05-19 23:19:50,408 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:50,408 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:50,408 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:50,440 - INFO - [src.data_preparation] - Ticker HMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:50,440 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] - Ticker HMC - Selected features:
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   insec_t: 0.0819
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   vnipc_t: 0.0770
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   SK: 0.0725
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   s_d7_t: 0.0698
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   TVV: 0.0643
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   ret: 0.0591
2025-05-19 23:19:50,766 - INFO - [src.data_preparation] -   ATR: 0.0587
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   HL: 0.0545
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   SR: 0.0541
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   variation_t: 0.0532
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   Volatility: 0.0528
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   ma21_t: 0.0520
2025-05-19 23:19:50,767 - INFO - [src.data_preparation] -   LO: 0.0515
2025-05-19 23:19:50,770 - INFO - [src.data_preparation] - Ticker HMC - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 's_d7_t', 'TVV', 'ret', 'ATR', 'ma14_t', 'HL', 'SR', 'variation_t', 'ma7_t', 'Volatility', 'ma21_t', 'LO']
2025-05-19 23:19:50,874 - INFO - [src.data_preparation] - Ticker HMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:50,874 - INFO - [src.data_preparation] - Ticker HMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:50,875 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HMC
2025-05-19 23:19:50,875 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:50,875 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(260)}
2025-05-19 23:19:50,875 - INFO - [src.data_preparation] - Generating 57 synthetic minority samples
2025-05-19 23:19:50,880 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (520, 13, 15), y shape: (520,)
2025-05-19 23:19:50,880 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(260), np.int64(1): np.int64(260)}
2025-05-19 23:19:50,885 - INFO - [src.data_preparation] - Ticker HMC - Final 3D shapes: X_train=(520, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:50,886 - INFO - [__main__] - Using best model for HMC: svm (F1: 0.4878)
2025-05-19 23:19:50,886 - INFO - [__main__] - Loading svm model for HMC...
2025-05-19 23:19:50,887 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:50,888 - INFO - [__main__] - Model size: 0.53 MB
2025-05-19 23:19:50,888 - INFO - [__main__] - Making predictions for HMC using svm
2025-05-19 23:19:50,889 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:50,889 - INFO - [__main__] - Successfully got last prediction for HMC
2025-05-19 23:19:50,890 - INFO - [__main__] - 
Processing ticker: HMH
2025-05-19 23:19:50,890 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:50,890 - INFO - [__main__] - Getting last prediction point for ticker: HMH
2025-05-19 23:19:50,890 - INFO - [__main__] - ==================================================
2025-05-19 23:19:50,890 - INFO - [__main__] - Preparing test data for HMH...
2025-05-19 23:19:50,921 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:50,921 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:50,921 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:50,946 - INFO - [src.data_preparation] - Ticker HMH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:50,947 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(264), np.int64(1): np.int64(375)}
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] - Ticker HMH - Selected features:
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] -   vnipc_t: 0.0746
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] -   TVV: 0.0723
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] -   insec_t: 0.0690
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] -   ret: 0.0604
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] -   SK: 0.0599
2025-05-19 23:19:51,269 - INFO - [src.data_preparation] -   Volatility: 0.0593
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   LO: 0.0587
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   HL: 0.0579
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   ma21_t: 0.0553
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   ma14_t: 0.0551
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   SR: 0.0548
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   ATR: 0.0546
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   variation_t: 0.0523
2025-05-19 23:19:51,270 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:19:51,273 - INFO - [src.data_preparation] - Ticker HMH - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ret', 'SK', 'Volatility', 's_d7_t', 'LO', 'HL', 'ma21_t', 'ma14_t', 'SR', 'ATR', 'variation_t', 'Median_HL']
2025-05-19 23:19:51,355 - INFO - [src.data_preparation] - Ticker HMH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:51,355 - INFO - [src.data_preparation] - Ticker HMH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:51,356 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HMH
2025-05-19 23:19:51,356 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:51,356 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(186), np.int64(1): np.int64(277)}
2025-05-19 23:19:51,356 - INFO - [src.data_preparation] - Generating 91 synthetic minority samples
2025-05-19 23:19:51,360 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (554, 13, 15), y shape: (554,)
2025-05-19 23:19:51,361 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(277), np.int64(1): np.int64(277)}
2025-05-19 23:19:51,364 - INFO - [src.data_preparation] - Ticker HMH - Final 3D shapes: X_train=(554, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:51,364 - INFO - [__main__] - Using best model for HMH: svm (F1: 0.7945)
2025-05-19 23:19:51,364 - INFO - [__main__] - Loading svm model for HMH...
2025-05-19 23:19:51,366 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:51,366 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:19:51,366 - INFO - [__main__] - Making predictions for HMH using svm
2025-05-19 23:19:51,368 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:51,368 - INFO - [__main__] - Successfully got last prediction for HMH
2025-05-19 23:19:51,368 - INFO - [__main__] - 
Processing ticker: HNM
2025-05-19 23:19:51,368 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:51,368 - INFO - [__main__] - Getting last prediction point for ticker: HNM
2025-05-19 23:19:51,368 - INFO - [__main__] - ==================================================
2025-05-19 23:19:51,368 - INFO - [__main__] - Preparing test data for HNM...
2025-05-19 23:19:51,396 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:51,396 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:51,396 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:51,415 - INFO - [src.data_preparation] - Ticker HNM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:51,415 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(371)}
2025-05-19 23:19:51,696 - INFO - [src.data_preparation] - Ticker HNM - Selected features:
2025-05-19 23:19:51,696 - INFO - [src.data_preparation] -   Volatility: 0.0731
2025-05-19 23:19:51,696 - INFO - [src.data_preparation] -   vnipc_t: 0.0716
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   insec_t: 0.0709
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   ATR: 0.0658
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   SK: 0.0616
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   ma14_t: 0.0598
2025-05-19 23:19:51,697 - INFO - [src.data_preparation] -   PM: 0.0594
2025-05-19 23:19:51,698 - INFO - [src.data_preparation] -   ma7_t: 0.0589
2025-05-19 23:19:51,698 - INFO - [src.data_preparation] -   HL: 0.0559
2025-05-19 23:19:51,698 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:19:51,698 - INFO - [src.data_preparation] -   variation_t: 0.0478
2025-05-19 23:19:51,698 - INFO - [src.data_preparation] -   ret: 0.0460
2025-05-19 23:19:51,700 - INFO - [src.data_preparation] - Ticker HNM - Using features: ['Date', 'Volatility', 'vnipc_t', 'insec_t', 'TVV', 's_d7_t', 'ATR', 'SK', 'ma21_t', 'ma14_t', 'PM', 'ma7_t', 'HL', 'Median_HL', 'variation_t', 'ret']
2025-05-19 23:19:51,780 - INFO - [src.data_preparation] - Ticker HNM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:51,780 - INFO - [src.data_preparation] - Ticker HNM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:51,781 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HNM
2025-05-19 23:19:51,781 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:51,782 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(185), np.int64(1): np.int64(278)}
2025-05-19 23:19:51,782 - INFO - [src.data_preparation] - Generating 93 synthetic minority samples
2025-05-19 23:19:51,786 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (556, 13, 15), y shape: (556,)
2025-05-19 23:19:51,786 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(278), np.int64(1): np.int64(278)}
2025-05-19 23:19:51,789 - INFO - [src.data_preparation] - Ticker HNM - Final 3D shapes: X_train=(556, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:51,789 - INFO - [__main__] - Using best model for HNM: svm (F1: 0.4545)
2025-05-19 23:19:51,790 - INFO - [__main__] - Loading svm model for HNM...
2025-05-19 23:19:51,791 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:51,791 - INFO - [__main__] - Model size: 0.67 MB
2025-05-19 23:19:51,791 - INFO - [__main__] - Making predictions for HNM using svm
2025-05-19 23:19:51,791 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:51,792 - INFO - [__main__] - Successfully got last prediction for HNM
2025-05-19 23:19:51,792 - INFO - [__main__] - 
Processing ticker: HOM
2025-05-19 23:19:51,792 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:51,792 - INFO - [__main__] - Getting last prediction point for ticker: HOM
2025-05-19 23:19:51,792 - INFO - [__main__] - ==================================================
2025-05-19 23:19:51,792 - INFO - [__main__] - Preparing test data for HOM...
2025-05-19 23:19:51,829 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:51,829 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:51,830 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:51,848 - INFO - [src.data_preparation] - Ticker HOM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:51,849 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(260), np.int64(1): np.int64(379)}
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] - Ticker HOM - Selected features:
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] -   vnipc_t: 0.0794
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] -   insec_t: 0.0777
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] -   TVV: 0.0645
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:19:52,124 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   ATR: 0.0583
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   ma14_t: 0.0569
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   ma7_t: 0.0569
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   Median_HL: 0.0556
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   ma21_t: 0.0552
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   LO: 0.0544
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   PM: 0.0540
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   HL: 0.0518
2025-05-19 23:19:52,125 - INFO - [src.data_preparation] -   ret: 0.0484
2025-05-19 23:19:52,127 - INFO - [src.data_preparation] - Ticker HOM - Using features: ['Date', 'vnipc_t', 'insec_t', 's_d7_t', 'TVV', 'Volatility', 'SK', 'ATR', 'ma14_t', 'ma7_t', 'Median_HL', 'ma21_t', 'LO', 'PM', 'HL', 'ret']
2025-05-19 23:19:52,207 - INFO - [src.data_preparation] - Ticker HOM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:52,207 - INFO - [src.data_preparation] - Ticker HOM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:52,209 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HOM
2025-05-19 23:19:52,209 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:52,209 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(186), np.int64(1): np.int64(277)}
2025-05-19 23:19:52,209 - INFO - [src.data_preparation] - Generating 91 synthetic minority samples
2025-05-19 23:19:52,214 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (554, 13, 15), y shape: (554,)
2025-05-19 23:19:52,214 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(277), np.int64(1): np.int64(277)}
2025-05-19 23:19:52,217 - INFO - [src.data_preparation] - Ticker HOM - Final 3D shapes: X_train=(554, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:52,217 - INFO - [__main__] - Using best model for HOM: transformer (F1: 0.6875)
2025-05-19 23:19:52,217 - INFO - [__main__] - Loading transformer model for HOM...
2025-05-19 23:19:52,232 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:52,236 - INFO - [__main__] - Model size: 0.55 MB
2025-05-19 23:19:52,236 - INFO - [__main__] - Making predictions for HOM using transformer
2025-05-19 23:19:52,238 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:52,239 - INFO - [__main__] - Successfully got last prediction for HOM
2025-05-19 23:19:52,239 - INFO - [__main__] - 
Processing ticker: HOT
2025-05-19 23:19:52,239 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:52,239 - INFO - [__main__] - Getting last prediction point for ticker: HOT
2025-05-19 23:19:52,239 - INFO - [__main__] - ==================================================
2025-05-19 23:19:52,239 - INFO - [__main__] - Preparing test data for HOT...
2025-05-19 23:19:52,275 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:52,275 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:52,275 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:52,297 - INFO - [src.data_preparation] - Ticker HOT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:52,298 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(243), np.int64(1): np.int64(395)}
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] - Ticker HOT - Selected features:
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   vnipc_t: 0.0842
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   TVV: 0.0721
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   Volatility: 0.0715
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   ma21_t: 0.0686
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   ATR: 0.0660
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   ma14_t: 0.0659
2025-05-19 23:19:52,608 - INFO - [src.data_preparation] -   SK: 0.0625
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   ma7_t: 0.0573
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   PM: 0.0564
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   HL: 0.0486
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   insec_t: 0.0485
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   variation_t: 0.0438
2025-05-19 23:19:52,609 - INFO - [src.data_preparation] -   SR: 0.0404
2025-05-19 23:19:52,611 - INFO - [src.data_preparation] - Ticker HOT - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'ma21_t', 's_d7_t', 'ATR', 'ma14_t', 'SK', 'ma7_t', 'PM', 'Median_HL', 'HL', 'insec_t', 'variation_t', 'SR']
2025-05-19 23:19:52,690 - INFO - [src.data_preparation] - Ticker HOT - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:19:52,691 - INFO - [src.data_preparation] - Ticker HOT - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:52,692 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HOT
2025-05-19 23:19:52,692 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:52,692 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(179), np.int64(1): np.int64(284)}
2025-05-19 23:19:52,692 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:19:52,696 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:19:52,696 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:19:52,700 - INFO - [src.data_preparation] - Ticker HOT - Final 3D shapes: X_train=(568, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:52,700 - INFO - [__main__] - Using best model for HOT: svm (F1: 0.8718)
2025-05-19 23:19:52,700 - INFO - [__main__] - Loading svm model for HOT...
2025-05-19 23:19:52,701 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:52,702 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:19:52,702 - INFO - [__main__] - Making predictions for HOT using svm
2025-05-19 23:19:52,703 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:52,703 - INFO - [__main__] - Successfully got last prediction for HOT
2025-05-19 23:19:52,703 - INFO - [__main__] - 
Processing ticker: HPB
2025-05-19 23:19:52,703 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:52,703 - INFO - [__main__] - Getting last prediction point for ticker: HPB
2025-05-19 23:19:52,703 - INFO - [__main__] - ==================================================
2025-05-19 23:19:52,703 - INFO - [__main__] - Preparing test data for HPB...
2025-05-19 23:19:52,735 - INFO - [src.data_preparation] - After processing - X shape: (627, 19), y shape: (627,)
2025-05-19 23:19:52,735 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:52,735 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:52,753 - INFO - [src.data_preparation] - Ticker HPB - Original shapes: X=(627, 18), y=(627,)
2025-05-19 23:19:52,753 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(143), np.int64(1): np.int64(484)}
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] - Ticker HPB - Selected features:
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   vnipc_t: 0.0894
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   ATR: 0.0812
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   TVV: 0.0809
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   Volatility: 0.0796
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   ma21_t: 0.0720
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   s_d7_t: 0.0703
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   ma14_t: 0.0698
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   ma7_t: 0.0633
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   SK: 0.0579
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   HL: 0.0531
2025-05-19 23:19:52,997 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:19:52,998 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:19:52,998 - INFO - [src.data_preparation] -   insec_t: 0.0465
2025-05-19 23:19:52,998 - INFO - [src.data_preparation] -   variation_t: 0.0369
2025-05-19 23:19:52,998 - INFO - [src.data_preparation] -   SR: 0.0352
2025-05-19 23:19:53,000 - INFO - [src.data_preparation] - Ticker HPB - Using features: ['Date', 'vnipc_t', 'ATR', 'TVV', 'Volatility', 'ma21_t', 's_d7_t', 'ma14_t', 'ma7_t', 'SK', 'HL', 'Median_HL', 'PM', 'insec_t', 'variation_t', 'SR']
2025-05-19 23:19:53,084 - INFO - [src.data_preparation] - Ticker HPB - 2D shapes: X_train=(451, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:53,084 - INFO - [src.data_preparation] - Ticker HPB - 3D shapes: X_train=(451, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:53,085 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HPB
2025-05-19 23:19:53,085 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (451, 13, 15), y shape: (451,)
2025-05-19 23:19:53,085 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(116), np.int64(1): np.int64(335)}
2025-05-19 23:19:53,086 - INFO - [src.data_preparation] - Generating 219 synthetic minority samples
2025-05-19 23:19:53,094 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (670, 13, 15), y shape: (670,)
2025-05-19 23:19:53,094 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(335), np.int64(1): np.int64(335)}
2025-05-19 23:19:53,097 - INFO - [src.data_preparation] - Ticker HPB - Final 3D shapes: X_train=(670, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:53,098 - INFO - [__main__] - Using best model for HPB: svm (F1: 0.9524)
2025-05-19 23:19:53,098 - INFO - [__main__] - Loading svm model for HPB...
2025-05-19 23:19:53,099 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:53,100 - INFO - [__main__] - Model size: 1.01 MB
2025-05-19 23:19:53,100 - INFO - [__main__] - Making predictions for HPB using svm
2025-05-19 23:19:53,101 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:53,101 - INFO - [__main__] - Successfully got last prediction for HPB
2025-05-19 23:19:53,101 - INFO - [__main__] - 
Processing ticker: HPG
2025-05-19 23:19:53,101 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:53,101 - INFO - [__main__] - Getting last prediction point for ticker: HPG
2025-05-19 23:19:53,101 - INFO - [__main__] - ==================================================
2025-05-19 23:19:53,101 - INFO - [__main__] - Preparing test data for HPG...
2025-05-19 23:19:53,129 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:53,129 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:53,129 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:53,152 - INFO - [src.data_preparation] - Ticker HPG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:53,153 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:19:53,501 - INFO - [src.data_preparation] - Ticker HPG - Selected features:
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   vnipc_t: 0.0705
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   SK: 0.0703
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   TVV: 0.0672
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   ma21_t: 0.0644
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   Volatility: 0.0636
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   ma14_t: 0.0635
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   HL: 0.0601
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   insec_t: 0.0588
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   SR: 0.0585
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   s_d7_t: 0.0569
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   ret: 0.0552
2025-05-19 23:19:53,502 - INFO - [src.data_preparation] -   variation_t: 0.0549
2025-05-19 23:19:53,503 - INFO - [src.data_preparation] -   ma7_t: 0.0539
2025-05-19 23:19:53,503 - INFO - [src.data_preparation] -   LO: 0.0499
2025-05-19 23:19:53,505 - INFO - [src.data_preparation] - Ticker HPG - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'ma21_t', 'Volatility', 'ma14_t', 'HL', 'insec_t', 'SR', 'ATR', 's_d7_t', 'ret', 'variation_t', 'ma7_t', 'LO']
2025-05-19 23:19:53,592 - INFO - [src.data_preparation] - Ticker HPG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:53,592 - INFO - [src.data_preparation] - Ticker HPG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:53,593 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HPG
2025-05-19 23:19:53,594 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:53,594 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(196), np.int64(1): np.int64(267)}
2025-05-19 23:19:53,594 - INFO - [src.data_preparation] - Generating 71 synthetic minority samples
2025-05-19 23:19:53,597 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (534, 13, 15), y shape: (534,)
2025-05-19 23:19:53,597 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(267), np.int64(1): np.int64(267)}
2025-05-19 23:19:53,600 - INFO - [src.data_preparation] - Ticker HPG - Final 3D shapes: X_train=(534, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:53,600 - INFO - [__main__] - Using best model for HPG: svm (F1: 0.5862)
2025-05-19 23:19:53,600 - INFO - [__main__] - Loading svm model for HPG...
2025-05-19 23:19:53,601 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:53,602 - INFO - [__main__] - Model size: 0.68 MB
2025-05-19 23:19:53,602 - INFO - [__main__] - Making predictions for HPG using svm
2025-05-19 23:19:53,602 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:53,603 - INFO - [__main__] - Successfully got last prediction for HPG
2025-05-19 23:19:53,603 - INFO - [__main__] - 
Processing ticker: HPP
2025-05-19 23:19:53,603 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:53,603 - INFO - [__main__] - Getting last prediction point for ticker: HPP
2025-05-19 23:19:53,603 - INFO - [__main__] - ==================================================
2025-05-19 23:19:53,603 - INFO - [__main__] - Preparing test data for HPP...
2025-05-19 23:19:53,632 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:53,632 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:53,632 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:53,651 - INFO - [src.data_preparation] - Ticker HPP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:53,652 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(240), np.int64(1): np.int64(399)}
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] - Ticker HPP - Selected features:
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   vnipc_t: 0.0784
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   ATR: 0.0717
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   s_d7_t: 0.0706
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   ma21_t: 0.0664
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   ma14_t: 0.0638
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   SK: 0.0633
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   TVV: 0.0620
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   ma7_t: 0.0585
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   HL: 0.0583
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   Volatility: 0.0578
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   Median_HL: 0.0510
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   insec_t: 0.0508
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   PM: 0.0503
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   SR: 0.0502
2025-05-19 23:19:53,929 - INFO - [src.data_preparation] -   LO: 0.0492
2025-05-19 23:19:53,932 - INFO - [src.data_preparation] - Ticker HPP - Using features: ['Date', 'vnipc_t', 'ATR', 's_d7_t', 'ma21_t', 'ma14_t', 'SK', 'TVV', 'ma7_t', 'HL', 'Volatility', 'Median_HL', 'insec_t', 'PM', 'SR', 'LO']
2025-05-19 23:19:54,021 - INFO - [src.data_preparation] - Ticker HPP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:54,021 - INFO - [src.data_preparation] - Ticker HPP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:54,023 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HPP
2025-05-19 23:19:54,023 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:54,023 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(156), np.int64(1): np.int64(307)}
2025-05-19 23:19:54,023 - INFO - [src.data_preparation] - Generating 151 synthetic minority samples
2025-05-19 23:19:54,029 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (614, 13, 15), y shape: (614,)
2025-05-19 23:19:54,029 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(307), np.int64(1): np.int64(307)}
2025-05-19 23:19:54,033 - INFO - [src.data_preparation] - Ticker HPP - Final 3D shapes: X_train=(614, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:54,033 - INFO - [__main__] - Using best model for HPP: svm (F1: 0.6866)
2025-05-19 23:19:54,033 - INFO - [__main__] - Loading svm model for HPP...
2025-05-19 23:19:54,035 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:54,035 - INFO - [__main__] - Model size: 0.93 MB
2025-05-19 23:19:54,035 - INFO - [__main__] - Making predictions for HPP using svm
2025-05-19 23:19:54,036 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:54,036 - INFO - [__main__] - Successfully got last prediction for HPP
2025-05-19 23:19:54,036 - INFO - [__main__] - 
Processing ticker: HPT
2025-05-19 23:19:54,037 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:54,037 - INFO - [__main__] - Getting last prediction point for ticker: HPT
2025-05-19 23:19:54,037 - INFO - [__main__] - ==================================================
2025-05-19 23:19:54,037 - INFO - [__main__] - Preparing test data for HPT...
2025-05-19 23:19:54,065 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:54,065 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:54,065 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:54,084 - INFO - [src.data_preparation] - Ticker HPT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:54,084 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(183), np.int64(1): np.int64(456)}
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] - Ticker HPT - Selected features:
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   vnipc_t: 0.0761
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   SK: 0.0692
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   ATR: 0.0690
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   ma14_t: 0.0675
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   TVV: 0.0669
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   Volatility: 0.0665
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   s_d7_t: 0.0649
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   ma7_t: 0.0648
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   PM: 0.0586
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   Median_HL: 0.0584
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   insec_t: 0.0548
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   variation_t: 0.0479
2025-05-19 23:19:54,348 - INFO - [src.data_preparation] -   ret: 0.0476
2025-05-19 23:19:54,349 - INFO - [src.data_preparation] -   HL: 0.0454
2025-05-19 23:19:54,351 - INFO - [src.data_preparation] - Ticker HPT - Using features: ['Date', 'vnipc_t', 'SK', 'ATR', 'ma14_t', 'TVV', 'Volatility', 's_d7_t', 'ma7_t', 'ma21_t', 'PM', 'Median_HL', 'insec_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:19:54,521 - INFO - [src.data_preparation] - Ticker HPT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:54,521 - INFO - [src.data_preparation] - Ticker HPT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:54,524 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HPT
2025-05-19 23:19:54,524 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:54,524 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(121), np.int64(1): np.int64(342)}
2025-05-19 23:19:54,524 - INFO - [src.data_preparation] - Generating 221 synthetic minority samples
2025-05-19 23:19:54,543 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (684, 13, 15), y shape: (684,)
2025-05-19 23:19:54,543 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(342), np.int64(1): np.int64(342)}
2025-05-19 23:19:54,548 - INFO - [src.data_preparation] - Ticker HPT - Final 3D shapes: X_train=(684, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:54,548 - INFO - [__main__] - Using best model for HPT: svm (F1: 0.7246)
2025-05-19 23:19:54,548 - INFO - [__main__] - Loading svm model for HPT...
2025-05-19 23:19:54,549 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:54,550 - INFO - [__main__] - Model size: 1.03 MB
2025-05-19 23:19:54,550 - INFO - [__main__] - Making predictions for HPT using svm
2025-05-19 23:19:54,551 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:54,552 - INFO - [__main__] - Successfully got last prediction for HPT
2025-05-19 23:19:54,552 - INFO - [__main__] - 
Processing ticker: HQC
2025-05-19 23:19:54,552 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:54,552 - INFO - [__main__] - Getting last prediction point for ticker: HQC
2025-05-19 23:19:54,553 - INFO - [__main__] - ==================================================
2025-05-19 23:19:54,553 - INFO - [__main__] - Preparing test data for HQC...
2025-05-19 23:19:54,603 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:54,603 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:54,603 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:54,622 - INFO - [src.data_preparation] - Ticker HQC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:54,622 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:19:54,914 - INFO - [src.data_preparation] - Ticker HQC - Selected features:
2025-05-19 23:19:54,914 - INFO - [src.data_preparation] -   vnipc_t: 0.0792
2025-05-19 23:19:54,914 - INFO - [src.data_preparation] -   insec_t: 0.0723
2025-05-19 23:19:54,914 - INFO - [src.data_preparation] -   SK: 0.0716
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   TVV: 0.0633
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   ma21_t: 0.0598
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   ret: 0.0585
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   s_d7_t: 0.0581
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   variation_t: 0.0562
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   ma14_t: 0.0559
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   ATR: 0.0553
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   HL: 0.0545
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   Median_HL: 0.0512
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   PM: 0.0484
2025-05-19 23:19:54,915 - INFO - [src.data_preparation] -   SR: 0.0472
2025-05-19 23:19:54,917 - INFO - [src.data_preparation] - Ticker HQC - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 'TVV', 'ma21_t', 'ret', 's_d7_t', 'variation_t', 'ma14_t', 'ATR', 'HL', 'Median_HL', 'PM', 'SR']
2025-05-19 23:19:55,000 - INFO - [src.data_preparation] - Ticker HQC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:55,000 - INFO - [src.data_preparation] - Ticker HQC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:55,002 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HQC
2025-05-19 23:19:55,002 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:55,002 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(243)}
2025-05-19 23:19:55,002 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:19:55,003 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:19:55,003 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:19:55,006 - INFO - [src.data_preparation] - Ticker HQC - Final 3D shapes: X_train=(486, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:55,006 - INFO - [__main__] - Using best model for HQC: svm (F1: 0.6538)
2025-05-19 23:19:55,006 - INFO - [__main__] - Loading svm model for HQC...
2025-05-19 23:19:55,007 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:55,008 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:19:55,008 - INFO - [__main__] - Making predictions for HQC using svm
2025-05-19 23:19:55,009 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:55,009 - INFO - [__main__] - Successfully got last prediction for HQC
2025-05-19 23:19:55,009 - INFO - [__main__] - 
Processing ticker: HRC
2025-05-19 23:19:55,009 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:55,009 - INFO - [__main__] - Getting last prediction point for ticker: HRC
2025-05-19 23:19:55,009 - INFO - [__main__] - ==================================================
2025-05-19 23:19:55,009 - INFO - [__main__] - Preparing test data for HRC...
2025-05-19 23:19:55,036 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:55,036 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:55,036 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:55,054 - INFO - [src.data_preparation] - Ticker HRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:55,055 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(274), np.int64(1): np.int64(365)}
2025-05-19 23:19:55,337 - INFO - [src.data_preparation] - Ticker HRC - Selected features:
2025-05-19 23:19:55,337 - INFO - [src.data_preparation] -   vnipc_t: 0.0776
2025-05-19 23:19:55,337 - INFO - [src.data_preparation] -   TVV: 0.0743
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   ATR: 0.0703
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   SK: 0.0646
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   s_d7_t: 0.0636
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   insec_t: 0.0618
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   ma21_t: 0.0593
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   ma14_t: 0.0561
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   ret: 0.0553
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   PM: 0.0538
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   ma7_t: 0.0531
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   HL: 0.0502
2025-05-19 23:19:55,338 - INFO - [src.data_preparation] -   variation_t: 0.0491
2025-05-19 23:19:55,341 - INFO - [src.data_preparation] - Ticker HRC - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'SK', 'Volatility', 's_d7_t', 'insec_t', 'ma21_t', 'ma14_t', 'ret', 'PM', 'ma7_t', 'SR', 'HL', 'variation_t']
2025-05-19 23:19:55,424 - INFO - [src.data_preparation] - Ticker HRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:55,424 - INFO - [src.data_preparation] - Ticker HRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:55,425 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HRC
2025-05-19 23:19:55,426 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:55,426 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:19:55,426 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:19:55,428 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:19:55,429 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:19:55,431 - INFO - [src.data_preparation] - Ticker HRC - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:55,431 - INFO - [__main__] - Using best model for HRC: svm (F1: 0.7429)
2025-05-19 23:19:55,431 - INFO - [__main__] - Loading svm model for HRC...
2025-05-19 23:19:55,433 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:55,433 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:19:55,433 - INFO - [__main__] - Making predictions for HRC using svm
2025-05-19 23:19:55,434 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:55,434 - INFO - [__main__] - Successfully got last prediction for HRC
2025-05-19 23:19:55,434 - INFO - [__main__] - 
Processing ticker: HSG
2025-05-19 23:19:55,434 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:55,434 - INFO - [__main__] - Getting last prediction point for ticker: HSG
2025-05-19 23:19:55,435 - INFO - [__main__] - ==================================================
2025-05-19 23:19:55,435 - INFO - [__main__] - Preparing test data for HSG...
2025-05-19 23:19:55,462 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:55,462 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:55,463 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:55,485 - INFO - [src.data_preparation] - Ticker HSG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:55,485 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:19:55,844 - INFO - [src.data_preparation] - Ticker HSG - Selected features:
2025-05-19 23:19:55,844 - INFO - [src.data_preparation] -   vnipc_t: 0.0774
2025-05-19 23:19:55,844 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:19:55,844 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:19:55,844 - INFO - [src.data_preparation] -   TVV: 0.0638
2025-05-19 23:19:55,844 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   SK: 0.0618
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   LO: 0.0596
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   SR: 0.0575
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   ma21_t: 0.0570
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   HL: 0.0555
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   ma14_t: 0.0553
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   variation_t: 0.0549
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   ret: 0.0543
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:19:55,845 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:19:55,848 - INFO - [src.data_preparation] - Ticker HSG - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'TVV', 's_d7_t', 'SK', 'LO', 'SR', 'ma21_t', 'HL', 'ma14_t', 'variation_t', 'ret', 'ma7_t', 'PM']
2025-05-19 23:19:55,932 - INFO - [src.data_preparation] - Ticker HSG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:55,933 - INFO - [src.data_preparation] - Ticker HSG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:55,934 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HSG
2025-05-19 23:19:55,934 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:55,934 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(210), np.int64(1): np.int64(253)}
2025-05-19 23:19:55,934 - INFO - [src.data_preparation] - Generating 43 synthetic minority samples
2025-05-19 23:19:55,937 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (506, 13, 15), y shape: (506,)
2025-05-19 23:19:55,937 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(253), np.int64(1): np.int64(253)}
2025-05-19 23:19:55,940 - INFO - [src.data_preparation] - Ticker HSG - Final 3D shapes: X_train=(506, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:55,940 - INFO - [__main__] - Using best model for HSG: transformer (F1: 0.5172)
2025-05-19 23:19:55,940 - INFO - [__main__] - Loading transformer model for HSG...
2025-05-19 23:19:55,952 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:55,957 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:19:55,957 - INFO - [__main__] - Making predictions for HSG using transformer
2025-05-19 23:19:55,959 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:55,959 - INFO - [__main__] - Successfully got last prediction for HSG
2025-05-19 23:19:55,959 - INFO - [__main__] - 
Processing ticker: HSI
2025-05-19 23:19:55,959 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:55,959 - INFO - [__main__] - Getting last prediction point for ticker: HSI
2025-05-19 23:19:55,959 - INFO - [__main__] - ==================================================
2025-05-19 23:19:55,959 - INFO - [__main__] - Preparing test data for HSI...
2025-05-19 23:19:56,018 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:19:56,018 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:56,018 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:56,045 - INFO - [src.data_preparation] - Ticker HSI - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:19:56,046 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(229), np.int64(1): np.int64(408)}
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] - Ticker HSI - Selected features:
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   vnipc_t: 0.0854
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   insec_t: 0.0750
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   TVV: 0.0734
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   Volatility: 0.0722
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   ma14_t: 0.0707
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   ma21_t: 0.0661
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   ma7_t: 0.0644
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   s_d7_t: 0.0642
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   SK: 0.0628
2025-05-19 23:19:56,372 - INFO - [src.data_preparation] -   ATR: 0.0577
2025-05-19 23:19:56,373 - INFO - [src.data_preparation] -   PM: 0.0564
2025-05-19 23:19:56,373 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:19:56,373 - INFO - [src.data_preparation] -   variation_t: 0.0462
2025-05-19 23:19:56,373 - INFO - [src.data_preparation] -   ret: 0.0458
2025-05-19 23:19:56,373 - INFO - [src.data_preparation] -   HL: 0.0333
2025-05-19 23:19:56,375 - INFO - [src.data_preparation] - Ticker HSI - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'Volatility', 'ma14_t', 'ma21_t', 'ma7_t', 's_d7_t', 'SK', 'ATR', 'PM', 'Median_HL', 'variation_t', 'ret', 'HL']
2025-05-19 23:19:56,466 - INFO - [src.data_preparation] - Ticker HSI - 2D shapes: X_train=(461, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:56,466 - INFO - [src.data_preparation] - Ticker HSI - 3D shapes: X_train=(461, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:56,467 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HSI
2025-05-19 23:19:56,467 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (461, 13, 15), y shape: (461,)
2025-05-19 23:19:56,468 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(165), np.int64(1): np.int64(296)}
2025-05-19 23:19:56,468 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:19:56,475 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:19:56,475 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:19:56,479 - INFO - [src.data_preparation] - Ticker HSI - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:56,479 - INFO - [__main__] - Using best model for HSI: lstm (F1: 0.8267)
2025-05-19 23:19:56,479 - INFO - [__main__] - Loading lstm model for HSI...
2025-05-19 23:19:56,486 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:19:56,488 - INFO - [__main__] - Model size: 0.18 MB
2025-05-19 23:19:56,488 - INFO - [__main__] - Making predictions for HSI using lstm
2025-05-19 23:19:56,494 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:19:56,494 - INFO - [__main__] - Successfully got last prediction for HSI
2025-05-19 23:19:56,494 - INFO - [__main__] - 
Processing ticker: HT1
2025-05-19 23:19:56,495 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:56,495 - INFO - [__main__] - Getting last prediction point for ticker: HT1
2025-05-19 23:19:56,495 - INFO - [__main__] - ==================================================
2025-05-19 23:19:56,495 - INFO - [__main__] - Preparing test data for HT1...
2025-05-19 23:19:56,528 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:56,529 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:56,529 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:56,551 - INFO - [src.data_preparation] - Ticker HT1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:56,551 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] - Ticker HT1 - Selected features:
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   insec_t: 0.0671
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   Volatility: 0.0653
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   vnipc_t: 0.0649
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   TVV: 0.0645
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   LO: 0.0627
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   ma14_t: 0.0589
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   ma21_t: 0.0580
2025-05-19 23:19:56,908 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:19:56,909 - INFO - [src.data_preparation] -   Median_HL: 0.0568
2025-05-19 23:19:56,909 - INFO - [src.data_preparation] -   ma7_t: 0.0551
2025-05-19 23:19:56,909 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:19:56,909 - INFO - [src.data_preparation] -   ATR: 0.0523
2025-05-19 23:19:56,909 - INFO - [src.data_preparation] -   HL: 0.0508
2025-05-19 23:19:56,911 - INFO - [src.data_preparation] - Ticker HT1 - Using features: ['Date', 'insec_t', 'SK', 's_d7_t', 'Volatility', 'vnipc_t', 'TVV', 'LO', 'ma14_t', 'ma21_t', 'PM', 'Median_HL', 'ma7_t', 'ret', 'ATR', 'HL']
2025-05-19 23:19:56,995 - INFO - [src.data_preparation] - Ticker HT1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:56,995 - INFO - [src.data_preparation] - Ticker HT1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:56,997 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HT1
2025-05-19 23:19:56,997 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:56,997 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:19:56,997 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:19:56,998 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:19:56,998 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:19:57,001 - INFO - [src.data_preparation] - Ticker HT1 - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:57,001 - INFO - [__main__] - Using best model for HT1: svm (F1: 0.4615)
2025-05-19 23:19:57,001 - INFO - [__main__] - Loading svm model for HT1...
2025-05-19 23:19:57,003 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:57,003 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:19:57,003 - INFO - [__main__] - Making predictions for HT1 using svm
2025-05-19 23:19:57,004 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:57,004 - INFO - [__main__] - Successfully got last prediction for HT1
2025-05-19 23:19:57,004 - INFO - [__main__] - 
Processing ticker: HTC
2025-05-19 23:19:57,004 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:57,004 - INFO - [__main__] - Getting last prediction point for ticker: HTC
2025-05-19 23:19:57,004 - INFO - [__main__] - ==================================================
2025-05-19 23:19:57,004 - INFO - [__main__] - Preparing test data for HTC...
2025-05-19 23:19:57,034 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:57,034 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:57,034 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:57,052 - INFO - [src.data_preparation] - Ticker HTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:57,052 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(221), np.int64(1): np.int64(418)}
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] - Ticker HTC - Selected features:
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   SK: 0.0712
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   TVV: 0.0642
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   HL: 0.0627
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   ATR: 0.0624
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   ma21_t: 0.0603
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   insec_t: 0.0585
2025-05-19 23:19:57,335 - INFO - [src.data_preparation] -   Median_HL: 0.0559
2025-05-19 23:19:57,337 - INFO - [src.data_preparation] -   ma14_t: 0.0553
2025-05-19 23:19:57,337 - INFO - [src.data_preparation] -   SR: 0.0530
2025-05-19 23:19:57,337 - INFO - [src.data_preparation] -   ret: 0.0529
2025-05-19 23:19:57,337 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:19:57,337 - INFO - [src.data_preparation] -   ma7_t: 0.0513
2025-05-19 23:19:57,339 - INFO - [src.data_preparation] - Ticker HTC - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 's_d7_t', 'TVV', 'HL', 'ATR', 'ma21_t', 'insec_t', 'Median_HL', 'ma14_t', 'SR', 'ret', 'PM', 'ma7_t']
2025-05-19 23:19:57,421 - INFO - [src.data_preparation] - Ticker HTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:57,422 - INFO - [src.data_preparation] - Ticker HTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:57,424 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HTC
2025-05-19 23:19:57,424 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:57,424 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(159), np.int64(1): np.int64(304)}
2025-05-19 23:19:57,424 - INFO - [src.data_preparation] - Generating 145 synthetic minority samples
2025-05-19 23:19:57,431 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (608, 13, 15), y shape: (608,)
2025-05-19 23:19:57,431 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(304), np.int64(1): np.int64(304)}
2025-05-19 23:19:57,435 - INFO - [src.data_preparation] - Ticker HTC - Final 3D shapes: X_train=(608, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:57,435 - INFO - [__main__] - Using best model for HTC: svm (F1: 0.7606)
2025-05-19 23:19:57,435 - INFO - [__main__] - Loading svm model for HTC...
2025-05-19 23:19:57,438 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:57,440 - INFO - [__main__] - Model size: 0.92 MB
2025-05-19 23:19:57,440 - INFO - [__main__] - Making predictions for HTC using svm
2025-05-19 23:19:57,440 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:57,441 - INFO - [__main__] - Successfully got last prediction for HTC
2025-05-19 23:19:57,441 - INFO - [__main__] - 
Processing ticker: HTI
2025-05-19 23:19:57,441 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:57,441 - INFO - [__main__] - Getting last prediction point for ticker: HTI
2025-05-19 23:19:57,441 - INFO - [__main__] - ==================================================
2025-05-19 23:19:57,441 - INFO - [__main__] - Preparing test data for HTI...
2025-05-19 23:19:57,479 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:57,479 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:57,479 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:57,501 - INFO - [src.data_preparation] - Ticker HTI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:57,502 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:19:57,805 - INFO - [src.data_preparation] - Ticker HTI - Selected features:
2025-05-19 23:19:57,805 - INFO - [src.data_preparation] -   SK: 0.0810
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   vnipc_t: 0.0705
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   insec_t: 0.0695
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   TVV: 0.0691
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   Volatility: 0.0667
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   ATR: 0.0629
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   HL: 0.0618
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   ret: 0.0583
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   SR: 0.0573
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   variation_t: 0.0524
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   LO: 0.0512
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   ma21_t: 0.0484
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   ma14_t: 0.0480
2025-05-19 23:19:57,807 - INFO - [src.data_preparation] -   PM: 0.0474
2025-05-19 23:19:57,810 - INFO - [src.data_preparation] - Ticker HTI - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'TVV', 's_d7_t', 'Volatility', 'ATR', 'HL', 'ret', 'SR', 'variation_t', 'LO', 'ma21_t', 'ma14_t', 'PM']
2025-05-19 23:19:57,905 - INFO - [src.data_preparation] - Ticker HTI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:57,906 - INFO - [src.data_preparation] - Ticker HTI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:57,907 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HTI
2025-05-19 23:19:57,907 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:57,907 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(274)}
2025-05-19 23:19:57,907 - INFO - [src.data_preparation] - Generating 85 synthetic minority samples
2025-05-19 23:19:57,912 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (548, 13, 15), y shape: (548,)
2025-05-19 23:19:57,912 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(274), np.int64(1): np.int64(274)}
2025-05-19 23:19:57,916 - INFO - [src.data_preparation] - Ticker HTI - Final 3D shapes: X_train=(548, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:57,917 - INFO - [__main__] - Using best model for HTI: svm (F1: 0.5652)
2025-05-19 23:19:57,917 - INFO - [__main__] - Loading svm model for HTI...
2025-05-19 23:19:57,918 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:57,919 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:19:57,919 - INFO - [__main__] - Making predictions for HTI using svm
2025-05-19 23:19:57,919 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:57,919 - INFO - [__main__] - Successfully got last prediction for HTI
2025-05-19 23:19:57,919 - INFO - [__main__] - 
Processing ticker: HTL
2025-05-19 23:19:57,919 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:57,919 - INFO - [__main__] - Getting last prediction point for ticker: HTL
2025-05-19 23:19:57,920 - INFO - [__main__] - ==================================================
2025-05-19 23:19:57,920 - INFO - [__main__] - Preparing test data for HTL...
2025-05-19 23:19:57,981 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:57,981 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:57,981 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:58,013 - INFO - [src.data_preparation] - Ticker HTL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:58,014 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:19:58,349 - INFO - [src.data_preparation] - Ticker HTL - Selected features:
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   vnipc_t: 0.0677
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   TVV: 0.0659
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   HL: 0.0649
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   insec_t: 0.0640
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   SK: 0.0615
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   ma21_t: 0.0601
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   PM: 0.0601
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   s_d7_t: 0.0575
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   Volatility: 0.0574
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   ma14_t: 0.0560
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   ret: 0.0558
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   Median_HL: 0.0545
2025-05-19 23:19:58,350 - INFO - [src.data_preparation] -   ma7_t: 0.0534
2025-05-19 23:19:58,351 - INFO - [src.data_preparation] -   variation_t: 0.0531
2025-05-19 23:19:58,353 - INFO - [src.data_preparation] - Ticker HTL - Using features: ['Date', 'vnipc_t', 'TVV', 'HL', 'insec_t', 'SK', 'ma21_t', 'PM', 'ATR', 's_d7_t', 'Volatility', 'ma14_t', 'ret', 'Median_HL', 'ma7_t', 'variation_t']
2025-05-19 23:19:58,436 - INFO - [src.data_preparation] - Ticker HTL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:58,436 - INFO - [src.data_preparation] - Ticker HTL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:58,437 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HTL
2025-05-19 23:19:58,437 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:58,437 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:19:58,437 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:19:58,441 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:19:58,441 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:19:58,444 - INFO - [src.data_preparation] - Ticker HTL - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:58,445 - INFO - [__main__] - Using best model for HTL: svm (F1: 0.7606)
2025-05-19 23:19:58,445 - INFO - [__main__] - Loading svm model for HTL...
2025-05-19 23:19:58,446 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:58,447 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:19:58,447 - INFO - [__main__] - Making predictions for HTL using svm
2025-05-19 23:19:58,447 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:58,447 - INFO - [__main__] - Successfully got last prediction for HTL
2025-05-19 23:19:58,448 - INFO - [__main__] - 
Processing ticker: HTP
2025-05-19 23:19:58,448 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:58,448 - INFO - [__main__] - Getting last prediction point for ticker: HTP
2025-05-19 23:19:58,448 - INFO - [__main__] - ==================================================
2025-05-19 23:19:58,448 - INFO - [__main__] - Preparing test data for HTP...
2025-05-19 23:19:58,475 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:58,475 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:58,475 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:58,498 - INFO - [src.data_preparation] - Ticker HTP - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:58,498 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(199), np.int64(1): np.int64(439)}
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] - Ticker HTP - Selected features:
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   TVV: 0.1127
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   vnipc_t: 0.0768
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   HL: 0.0717
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   ma14_t: 0.0684
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   ATR: 0.0666
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   ma21_t: 0.0639
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   Volatility: 0.0566
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   s_d7_t: 0.0561
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   insec_t: 0.0551
2025-05-19 23:19:58,748 - INFO - [src.data_preparation] -   PM: 0.0545
2025-05-19 23:19:58,749 - INFO - [src.data_preparation] -   ma7_t: 0.0522
2025-05-19 23:19:58,749 - INFO - [src.data_preparation] -   SK: 0.0505
2025-05-19 23:19:58,749 - INFO - [src.data_preparation] -   Median_HL: 0.0490
2025-05-19 23:19:58,749 - INFO - [src.data_preparation] -   ret: 0.0419
2025-05-19 23:19:58,749 - INFO - [src.data_preparation] -   SR: 0.0406
2025-05-19 23:19:58,751 - INFO - [src.data_preparation] - Ticker HTP - Using features: ['Date', 'TVV', 'vnipc_t', 'HL', 'ma14_t', 'ATR', 'ma21_t', 'Volatility', 's_d7_t', 'insec_t', 'PM', 'ma7_t', 'SK', 'Median_HL', 'ret', 'SR']
2025-05-19 23:19:58,838 - INFO - [src.data_preparation] - Ticker HTP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:19:58,838 - INFO - [src.data_preparation] - Ticker HTP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:58,839 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HTP
2025-05-19 23:19:58,839 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:58,839 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(100), np.int64(1): np.int64(363)}
2025-05-19 23:19:58,840 - INFO - [src.data_preparation] - Generating 263 synthetic minority samples
2025-05-19 23:19:58,848 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (726, 13, 15), y shape: (726,)
2025-05-19 23:19:58,849 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(363), np.int64(1): np.int64(363)}
2025-05-19 23:19:58,852 - INFO - [src.data_preparation] - Ticker HTP - Final 3D shapes: X_train=(726, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:19:58,853 - INFO - [__main__] - Using best model for HTP: svm (F1: 0.5902)
2025-05-19 23:19:58,853 - INFO - [__main__] - Loading svm model for HTP...
2025-05-19 23:19:58,854 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:58,854 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:19:58,856 - INFO - [__main__] - Making predictions for HTP using svm
2025-05-19 23:19:58,856 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:58,856 - INFO - [__main__] - Successfully got last prediction for HTP
2025-05-19 23:19:58,856 - INFO - [__main__] - 
Processing ticker: HTV
2025-05-19 23:19:58,857 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:58,857 - INFO - [__main__] - Getting last prediction point for ticker: HTV
2025-05-19 23:19:58,857 - INFO - [__main__] - ==================================================
2025-05-19 23:19:58,857 - INFO - [__main__] - Preparing test data for HTV...
2025-05-19 23:19:58,882 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:58,882 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:58,882 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:58,900 - INFO - [src.data_preparation] - Ticker HTV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:58,900 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] - Ticker HTV - Selected features:
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   vnipc_t: 0.0686
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   Volatility: 0.0683
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   SR: 0.0676
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   TVV: 0.0668
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   s_d7_t: 0.0643
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   HL: 0.0642
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   insec_t: 0.0624
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   SK: 0.0611
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   ATR: 0.0611
2025-05-19 23:19:59,189 - INFO - [src.data_preparation] -   LO: 0.0586
2025-05-19 23:19:59,190 - INFO - [src.data_preparation] -   ret: 0.0571
2025-05-19 23:19:59,190 - INFO - [src.data_preparation] -   ma14_t: 0.0548
2025-05-19 23:19:59,190 - INFO - [src.data_preparation] -   PM: 0.0502
2025-05-19 23:19:59,190 - INFO - [src.data_preparation] -   ma21_t: 0.0500
2025-05-19 23:19:59,190 - INFO - [src.data_preparation] -   variation_t: 0.0496
2025-05-19 23:19:59,192 - INFO - [src.data_preparation] - Ticker HTV - Using features: ['Date', 'vnipc_t', 'Volatility', 'SR', 'TVV', 's_d7_t', 'HL', 'insec_t', 'SK', 'ATR', 'LO', 'ret', 'ma14_t', 'PM', 'ma21_t', 'variation_t']
2025-05-19 23:19:59,274 - INFO - [src.data_preparation] - Ticker HTV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:59,274 - INFO - [src.data_preparation] - Ticker HTV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:59,276 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HTV
2025-05-19 23:19:59,276 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:59,276 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:19:59,276 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:19:59,279 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:19:59,279 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:19:59,282 - INFO - [src.data_preparation] - Ticker HTV - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:59,282 - INFO - [__main__] - Using best model for HTV: svm (F1: 0.7213)
2025-05-19 23:19:59,282 - INFO - [__main__] - Loading svm model for HTV...
2025-05-19 23:19:59,283 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:59,284 - INFO - [__main__] - Model size: 0.69 MB
2025-05-19 23:19:59,284 - INFO - [__main__] - Making predictions for HTV using svm
2025-05-19 23:19:59,284 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:59,284 - INFO - [__main__] - Successfully got last prediction for HTV
2025-05-19 23:19:59,284 - INFO - [__main__] - 
Processing ticker: HU1
2025-05-19 23:19:59,285 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:59,285 - INFO - [__main__] - Getting last prediction point for ticker: HU1
2025-05-19 23:19:59,285 - INFO - [__main__] - ==================================================
2025-05-19 23:19:59,285 - INFO - [__main__] - Preparing test data for HU1...
2025-05-19 23:19:59,309 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:19:59,309 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:59,309 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:59,327 - INFO - [src.data_preparation] - Ticker HU1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:19:59,328 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] - Ticker HU1 - Selected features:
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   vnipc_t: 0.0712
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   ATR: 0.0663
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   SK: 0.0660
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   insec_t: 0.0646
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   s_d7_t: 0.0636
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   Volatility: 0.0633
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   TVV: 0.0632
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   ma14_t: 0.0623
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   ma21_t: 0.0610
2025-05-19 23:19:59,632 - INFO - [src.data_preparation] -   ma7_t: 0.0566
2025-05-19 23:19:59,633 - INFO - [src.data_preparation] -   HL: 0.0543
2025-05-19 23:19:59,633 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:19:59,633 - INFO - [src.data_preparation] -   SR: 0.0514
2025-05-19 23:19:59,633 - INFO - [src.data_preparation] -   ret: 0.0484
2025-05-19 23:19:59,633 - INFO - [src.data_preparation] -   Median_HL: 0.0480
2025-05-19 23:19:59,635 - INFO - [src.data_preparation] - Ticker HU1 - Using features: ['Date', 'vnipc_t', 'ATR', 'SK', 'insec_t', 's_d7_t', 'Volatility', 'TVV', 'ma14_t', 'ma21_t', 'ma7_t', 'HL', 'PM', 'SR', 'ret', 'Median_HL']
2025-05-19 23:19:59,715 - INFO - [src.data_preparation] - Ticker HU1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:19:59,715 - INFO - [src.data_preparation] - Ticker HU1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:59,717 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HU1
2025-05-19 23:19:59,718 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:19:59,718 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:19:59,718 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:19:59,720 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:19:59,720 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:19:59,724 - INFO - [src.data_preparation] - Ticker HU1 - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:19:59,725 - INFO - [__main__] - Using best model for HU1: svm (F1: 0.5806)
2025-05-19 23:19:59,725 - INFO - [__main__] - Loading svm model for HU1...
2025-05-19 23:19:59,726 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:19:59,726 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:19:59,726 - INFO - [__main__] - Making predictions for HU1 using svm
2025-05-19 23:19:59,727 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:19:59,727 - INFO - [__main__] - Successfully got last prediction for HU1
2025-05-19 23:19:59,728 - INFO - [__main__] - 
Processing ticker: HU3
2025-05-19 23:19:59,728 - INFO - [__main__] - 
==================================================
2025-05-19 23:19:59,728 - INFO - [__main__] - Getting last prediction point for ticker: HU3
2025-05-19 23:19:59,728 - INFO - [__main__] - ==================================================
2025-05-19 23:19:59,728 - INFO - [__main__] - Preparing test data for HU3...
2025-05-19 23:19:59,762 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:19:59,762 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:19:59,762 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:19:59,781 - INFO - [src.data_preparation] - Ticker HU3 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:19:59,781 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(280), np.int64(1): np.int64(358)}
2025-05-19 23:20:00,077 - INFO - [src.data_preparation] - Ticker HU3 - Selected features:
2025-05-19 23:20:00,077 - INFO - [src.data_preparation] -   insec_t: 0.0784
2025-05-19 23:20:00,077 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:20:00,077 - INFO - [src.data_preparation] -   vnipc_t: 0.0691
2025-05-19 23:20:00,077 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   s_d7_t: 0.0656
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   HL: 0.0615
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   SR: 0.0615
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   ATR: 0.0611
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   variation_t: 0.0590
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   SK: 0.0545
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   ma14_t: 0.0525
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   LO: 0.0522
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   ma21_t: 0.0513
2025-05-19 23:20:00,078 - INFO - [src.data_preparation] -   Median_HL: 0.0486
2025-05-19 23:20:00,081 - INFO - [src.data_preparation] - Ticker HU3 - Using features: ['Date', 'insec_t', 'TVV', 'vnipc_t', 'Volatility', 's_d7_t', 'HL', 'SR', 'ATR', 'variation_t', 'SK', 'ma14_t', 'LO', 'ret', 'ma21_t', 'Median_HL']
2025-05-19 23:20:00,164 - INFO - [src.data_preparation] - Ticker HU3 - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:20:00,164 - INFO - [src.data_preparation] - Ticker HU3 - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:00,166 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HU3
2025-05-19 23:20:00,166 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:00,166 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:20:00,166 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:20:00,169 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:20:00,169 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:20:00,172 - INFO - [src.data_preparation] - Ticker HU3 - Final 3D shapes: X_train=(532, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:00,172 - INFO - [__main__] - Using best model for HU3: svm (F1: 0.7059)
2025-05-19 23:20:00,172 - INFO - [__main__] - Loading svm model for HU3...
2025-05-19 23:20:00,174 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:00,174 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:20:00,175 - INFO - [__main__] - Making predictions for HU3 using svm
2025-05-19 23:20:00,175 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:00,175 - INFO - [__main__] - Successfully got last prediction for HU3
2025-05-19 23:20:00,176 - INFO - [__main__] - 
Processing ticker: HUT
2025-05-19 23:20:00,176 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:00,176 - INFO - [__main__] - Getting last prediction point for ticker: HUT
2025-05-19 23:20:00,176 - INFO - [__main__] - ==================================================
2025-05-19 23:20:00,176 - INFO - [__main__] - Preparing test data for HUT...
2025-05-19 23:20:00,202 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:00,202 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:00,202 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:00,221 - INFO - [src.data_preparation] - Ticker HUT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:00,221 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:20:00,565 - INFO - [src.data_preparation] - Ticker HUT - Selected features:
2025-05-19 23:20:00,565 - INFO - [src.data_preparation] -   vnipc_t: 0.0783
2025-05-19 23:20:00,565 - INFO - [src.data_preparation] -   Volatility: 0.0752
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   TVV: 0.0675
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   SK: 0.0658
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   insec_t: 0.0651
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   ma21_t: 0.0576
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   ret: 0.0568
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   HL: 0.0551
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   ATR: 0.0529
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   LO: 0.0513
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:20:00,566 - INFO - [src.data_preparation] -   SR: 0.0506
2025-05-19 23:20:00,569 - INFO - [src.data_preparation] - Ticker HUT - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'SK', 'insec_t', 's_d7_t', 'ma21_t', 'ret', 'ma7_t', 'HL', 'variation_t', 'ATR', 'LO', 'PM', 'SR']
2025-05-19 23:20:00,656 - INFO - [src.data_preparation] - Ticker HUT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:00,656 - INFO - [src.data_preparation] - Ticker HUT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:00,658 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HUT
2025-05-19 23:20:00,658 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:00,658 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:20:00,658 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:20:00,660 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:20:00,661 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:20:00,664 - INFO - [src.data_preparation] - Ticker HUT - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:00,664 - INFO - [__main__] - Using best model for HUT: svm (F1: 0.2667)
2025-05-19 23:20:00,664 - INFO - [__main__] - Loading svm model for HUT...
2025-05-19 23:20:00,665 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:00,665 - INFO - [__main__] - Model size: 0.58 MB
2025-05-19 23:20:00,665 - INFO - [__main__] - Making predictions for HUT using svm
2025-05-19 23:20:00,667 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:00,667 - INFO - [__main__] - Successfully got last prediction for HUT
2025-05-19 23:20:00,667 - INFO - [__main__] - 
Processing ticker: HVG
2025-05-19 23:20:00,667 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:00,667 - INFO - [__main__] - Getting last prediction point for ticker: HVG
2025-05-19 23:20:00,667 - INFO - [__main__] - ==================================================
2025-05-19 23:20:00,667 - INFO - [__main__] - Preparing test data for HVG...
2025-05-19 23:20:00,695 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:00,695 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:00,695 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:00,713 - INFO - [src.data_preparation] - Ticker HVG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:00,713 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(266), np.int64(1): np.int64(373)}
2025-05-19 23:20:00,989 - INFO - [src.data_preparation] - Ticker HVG - Selected features:
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   Median_HL: 0.0798
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   PM: 0.0742
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   Volatility: 0.0700
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   s_d7_t: 0.0647
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   ATR: 0.0611
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   SK: 0.0609
2025-05-19 23:20:00,990 - INFO - [src.data_preparation] -   insec_t: 0.0565
2025-05-19 23:20:00,991 - INFO - [src.data_preparation] -   ma21_t: 0.0556
2025-05-19 23:20:00,991 - INFO - [src.data_preparation] -   HL: 0.0550
2025-05-19 23:20:00,991 - INFO - [src.data_preparation] -   ma14_t: 0.0534
2025-05-19 23:20:00,991 - INFO - [src.data_preparation] -   ma7_t: 0.0480
2025-05-19 23:20:00,991 - INFO - [src.data_preparation] -   ret: 0.0467
2025-05-19 23:20:00,991 - INFO - [src.data_preparation] -   variation_t: 0.0446
2025-05-19 23:20:00,994 - INFO - [src.data_preparation] - Ticker HVG - Using features: ['Date', 'Median_HL', 'PM', 'Volatility', 'vnipc_t', 'TVV', 's_d7_t', 'ATR', 'SK', 'insec_t', 'ma21_t', 'HL', 'ma14_t', 'ma7_t', 'ret', 'variation_t']
2025-05-19 23:20:01,076 - INFO - [src.data_preparation] - Ticker HVG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:01,076 - INFO - [src.data_preparation] - Ticker HVG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:01,078 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HVG
2025-05-19 23:20:01,078 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:01,078 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(226)}
2025-05-19 23:20:01,079 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:20:01,079 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:20:01,079 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:20:01,082 - INFO - [src.data_preparation] - Ticker HVG - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:01,082 - INFO - [__main__] - Using best model for HVG: transformer (F1: 0.9885)
2025-05-19 23:20:01,082 - INFO - [__main__] - Loading transformer model for HVG...
2025-05-19 23:20:01,092 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:01,094 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:20:01,095 - INFO - [__main__] - Making predictions for HVG using transformer
2025-05-19 23:20:01,096 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:01,096 - INFO - [__main__] - Successfully got last prediction for HVG
2025-05-19 23:20:01,096 - INFO - [__main__] - 
Processing ticker: HVT
2025-05-19 23:20:01,097 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:01,097 - INFO - [__main__] - Getting last prediction point for ticker: HVT
2025-05-19 23:20:01,097 - INFO - [__main__] - ==================================================
2025-05-19 23:20:01,097 - INFO - [__main__] - Preparing test data for HVT...
2025-05-19 23:20:01,132 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:01,132 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:01,132 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:01,151 - INFO - [src.data_preparation] - Ticker HVT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:01,151 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(247), np.int64(1): np.int64(392)}
2025-05-19 23:20:01,467 - INFO - [src.data_preparation] - Ticker HVT - Selected features:
2025-05-19 23:20:01,467 - INFO - [src.data_preparation] -   vnipc_t: 0.0764
2025-05-19 23:20:01,467 - INFO - [src.data_preparation] -   SK: 0.0718
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   insec_t: 0.0717
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   TVV: 0.0683
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   ATR: 0.0661
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   ma21_t: 0.0634
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   s_d7_t: 0.0571
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   SR: 0.0561
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   ma7_t: 0.0552
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   ma14_t: 0.0543
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   HL: 0.0540
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   variation_t: 0.0539
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:20:01,469 - INFO - [src.data_preparation] -   PM: 0.0467
2025-05-19 23:20:01,472 - INFO - [src.data_preparation] - Ticker HVT - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'TVV', 'ATR', 'Volatility', 'ma21_t', 's_d7_t', 'SR', 'ma7_t', 'ma14_t', 'HL', 'variation_t', 'ret', 'PM']
2025-05-19 23:20:01,556 - INFO - [src.data_preparation] - Ticker HVT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:01,556 - INFO - [src.data_preparation] - Ticker HVT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:01,558 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HVT
2025-05-19 23:20:01,558 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:01,558 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(162), np.int64(1): np.int64(301)}
2025-05-19 23:20:01,558 - INFO - [src.data_preparation] - Generating 139 synthetic minority samples
2025-05-19 23:20:01,563 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (602, 13, 15), y shape: (602,)
2025-05-19 23:20:01,564 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(301), np.int64(1): np.int64(301)}
2025-05-19 23:20:01,568 - INFO - [src.data_preparation] - Ticker HVT - Final 3D shapes: X_train=(602, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:01,568 - INFO - [__main__] - Using best model for HVT: logistic_regression (F1: 0.6667)
2025-05-19 23:20:01,568 - INFO - [__main__] - Loading logistic_regression model for HVT...
2025-05-19 23:20:01,569 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:01,569 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:01,569 - INFO - [__main__] - Making predictions for HVT using logistic_regression
2025-05-19 23:20:01,569 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:01,569 - INFO - [__main__] - Successfully got last prediction for HVT
2025-05-19 23:20:01,569 - INFO - [__main__] - 
Processing ticker: HVX
2025-05-19 23:20:01,569 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:01,569 - INFO - [__main__] - Getting last prediction point for ticker: HVX
2025-05-19 23:20:01,569 - INFO - [__main__] - ==================================================
2025-05-19 23:20:01,569 - INFO - [__main__] - Preparing test data for HVX...
2025-05-19 23:20:01,597 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:01,597 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:01,597 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:01,615 - INFO - [src.data_preparation] - Ticker HVX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:01,615 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:20:01,895 - INFO - [src.data_preparation] - Ticker HVX - Selected features:
2025-05-19 23:20:01,895 - INFO - [src.data_preparation] -   TVV: 0.0718
2025-05-19 23:20:01,895 - INFO - [src.data_preparation] -   Volatility: 0.0680
2025-05-19 23:20:01,895 - INFO - [src.data_preparation] -   SK: 0.0677
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   insec_t: 0.0676
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   s_d7_t: 0.0670
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   ATR: 0.0661
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   vnipc_t: 0.0660
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   ma14_t: 0.0654
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   ma21_t: 0.0617
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   ma7_t: 0.0559
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   HL: 0.0537
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   variation_t: 0.0496
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   ret: 0.0486
2025-05-19 23:20:01,896 - INFO - [src.data_preparation] -   PM: 0.0483
2025-05-19 23:20:01,899 - INFO - [src.data_preparation] - Ticker HVX - Using features: ['Date', 'TVV', 'Volatility', 'SK', 'insec_t', 's_d7_t', 'ATR', 'vnipc_t', 'ma14_t', 'ma21_t', 'ma7_t', 'HL', 'Median_HL', 'variation_t', 'ret', 'PM']
2025-05-19 23:20:01,977 - INFO - [src.data_preparation] - Ticker HVX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:01,977 - INFO - [src.data_preparation] - Ticker HVX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:01,979 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker HVX
2025-05-19 23:20:01,979 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:01,979 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(192), np.int64(1): np.int64(271)}
2025-05-19 23:20:01,979 - INFO - [src.data_preparation] - Generating 79 synthetic minority samples
2025-05-19 23:20:01,984 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (542, 13, 15), y shape: (542,)
2025-05-19 23:20:01,984 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(271), np.int64(1): np.int64(271)}
2025-05-19 23:20:01,989 - INFO - [src.data_preparation] - Ticker HVX - Final 3D shapes: X_train=(542, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:01,989 - INFO - [__main__] - Using best model for HVX: svm (F1: 0.6462)
2025-05-19 23:20:01,989 - INFO - [__main__] - Loading svm model for HVX...
2025-05-19 23:20:01,992 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:01,993 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:20:01,993 - INFO - [__main__] - Making predictions for HVX using svm
2025-05-19 23:20:01,994 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:01,994 - INFO - [__main__] - Successfully got last prediction for HVX
2025-05-19 23:20:01,995 - INFO - [__main__] - 
Processing ticker: ICF
2025-05-19 23:20:01,995 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:01,995 - INFO - [__main__] - Getting last prediction point for ticker: ICF
2025-05-19 23:20:01,995 - INFO - [__main__] - ==================================================
2025-05-19 23:20:01,995 - INFO - [__main__] - Preparing test data for ICF...
2025-05-19 23:20:02,022 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:02,022 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:02,022 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:02,041 - INFO - [src.data_preparation] - Ticker ICF - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:02,041 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(360)}
2025-05-19 23:20:02,311 - INFO - [src.data_preparation] - Ticker ICF - Selected features:
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   Volatility: 0.0822
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   vnipc_t: 0.0820
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   insec_t: 0.0735
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   TVV: 0.0702
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   SK: 0.0611
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   ma21_t: 0.0583
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   variation_t: 0.0562
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   ma14_t: 0.0557
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   ma7_t: 0.0555
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   ATR: 0.0553
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:20:02,312 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:20:02,313 - INFO - [src.data_preparation] -   ret: 0.0513
2025-05-19 23:20:02,313 - INFO - [src.data_preparation] -   HL: 0.0431
2025-05-19 23:20:02,316 - INFO - [src.data_preparation] - Ticker ICF - Using features: ['Date', 'Volatility', 'vnipc_t', 'insec_t', 'TVV', 'SK', 's_d7_t', 'ma21_t', 'variation_t', 'ma14_t', 'ma7_t', 'ATR', 'Median_HL', 'PM', 'ret', 'HL']
2025-05-19 23:20:02,395 - INFO - [src.data_preparation] - Ticker ICF - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:02,395 - INFO - [src.data_preparation] - Ticker ICF - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:02,397 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ICF
2025-05-19 23:20:02,397 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:20:02,397 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(261)}
2025-05-19 23:20:02,397 - INFO - [src.data_preparation] - Generating 60 synthetic minority samples
2025-05-19 23:20:02,400 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:20:02,400 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:20:02,403 - INFO - [src.data_preparation] - Ticker ICF - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:02,403 - INFO - [__main__] - Using best model for ICF: svm (F1: 0.5862)
2025-05-19 23:20:02,403 - INFO - [__main__] - Loading svm model for ICF...
2025-05-19 23:20:02,404 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:02,405 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:20:02,405 - INFO - [__main__] - Making predictions for ICF using svm
2025-05-19 23:20:02,405 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:02,405 - INFO - [__main__] - Successfully got last prediction for ICF
2025-05-19 23:20:02,405 - INFO - [__main__] - 
Processing ticker: ICG
2025-05-19 23:20:02,405 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:02,406 - INFO - [__main__] - Getting last prediction point for ticker: ICG
2025-05-19 23:20:02,406 - INFO - [__main__] - ==================================================
2025-05-19 23:20:02,406 - INFO - [__main__] - Preparing test data for ICG...
2025-05-19 23:20:02,434 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:02,434 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:02,434 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:02,453 - INFO - [src.data_preparation] - Ticker ICG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:02,453 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(291), np.int64(1): np.int64(348)}
2025-05-19 23:20:02,765 - INFO - [src.data_preparation] - Ticker ICG - Selected features:
2025-05-19 23:20:02,765 - INFO - [src.data_preparation] -   TVV: 0.0714
2025-05-19 23:20:02,765 - INFO - [src.data_preparation] -   vnipc_t: 0.0699
2025-05-19 23:20:02,765 - INFO - [src.data_preparation] -   insec_t: 0.0692
2025-05-19 23:20:02,765 - INFO - [src.data_preparation] -   s_d7_t: 0.0680
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   ATR: 0.0633
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   ma14_t: 0.0632
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   SK: 0.0618
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   PM: 0.0564
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   HL: 0.0557
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   Median_HL: 0.0548
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   variation_t: 0.0545
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   ma7_t: 0.0545
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   ma21_t: 0.0535
2025-05-19 23:20:02,766 - INFO - [src.data_preparation] -   ret: 0.0489
2025-05-19 23:20:02,769 - INFO - [src.data_preparation] - Ticker ICG - Using features: ['Date', 'TVV', 'vnipc_t', 'insec_t', 's_d7_t', 'ATR', 'ma14_t', 'SK', 'Volatility', 'PM', 'HL', 'Median_HL', 'variation_t', 'ma7_t', 'ma21_t', 'ret']
2025-05-19 23:20:02,883 - INFO - [src.data_preparation] - Ticker ICG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:02,883 - INFO - [src.data_preparation] - Ticker ICG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:02,885 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ICG
2025-05-19 23:20:02,885 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:02,885 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:20:02,885 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:20:02,888 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:20:02,888 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:20:02,892 - INFO - [src.data_preparation] - Ticker ICG - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:02,892 - INFO - [__main__] - Using best model for ICG: svm (F1: 0.7059)
2025-05-19 23:20:02,892 - INFO - [__main__] - Loading svm model for ICG...
2025-05-19 23:20:02,894 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:02,894 - INFO - [__main__] - Model size: 0.70 MB
2025-05-19 23:20:02,894 - INFO - [__main__] - Making predictions for ICG using svm
2025-05-19 23:20:02,895 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:02,895 - INFO - [__main__] - Successfully got last prediction for ICG
2025-05-19 23:20:02,895 - INFO - [__main__] - 
Processing ticker: ICI
2025-05-19 23:20:02,895 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:02,895 - INFO - [__main__] - Getting last prediction point for ticker: ICI
2025-05-19 23:20:02,895 - INFO - [__main__] - ==================================================
2025-05-19 23:20:02,895 - INFO - [__main__] - Preparing test data for ICI...
2025-05-19 23:20:02,932 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:02,932 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:02,932 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:02,953 - INFO - [src.data_preparation] - Ticker ICI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:02,953 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(158), np.int64(1): np.int64(481)}
2025-05-19 23:20:03,204 - INFO - [src.data_preparation] - Ticker ICI - Selected features:
2025-05-19 23:20:03,204 - INFO - [src.data_preparation] -   vnipc_t: 0.1005
2025-05-19 23:20:03,204 - INFO - [src.data_preparation] -   TVV: 0.0964
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   ATR: 0.0700
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   s_d7_t: 0.0688
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   Volatility: 0.0644
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   ma7_t: 0.0618
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   HL: 0.0603
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   SK: 0.0596
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   ma21_t: 0.0531
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   Median_HL: 0.0496
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   variation_t: 0.0481
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   insec_t: 0.0478
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   PM: 0.0468
2025-05-19 23:20:03,205 - INFO - [src.data_preparation] -   SR: 0.0408
2025-05-19 23:20:03,209 - INFO - [src.data_preparation] - Ticker ICI - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 's_d7_t', 'Volatility', 'ma7_t', 'HL', 'SK', 'ma14_t', 'ma21_t', 'Median_HL', 'variation_t', 'insec_t', 'PM', 'SR']
2025-05-19 23:20:03,288 - INFO - [src.data_preparation] - Ticker ICI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:03,288 - INFO - [src.data_preparation] - Ticker ICI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:03,289 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ICI
2025-05-19 23:20:03,289 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:03,289 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(93), np.int64(1): np.int64(370)}
2025-05-19 23:20:03,289 - INFO - [src.data_preparation] - Generating 277 synthetic minority samples
2025-05-19 23:20:03,299 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (740, 13, 15), y shape: (740,)
2025-05-19 23:20:03,299 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(370), np.int64(1): np.int64(370)}
2025-05-19 23:20:03,302 - INFO - [src.data_preparation] - Ticker ICI - Final 3D shapes: X_train=(740, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:03,303 - INFO - [__main__] - Using best model for ICI: svm (F1: 0.6452)
2025-05-19 23:20:03,303 - INFO - [__main__] - Loading svm model for ICI...
2025-05-19 23:20:03,304 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:03,304 - INFO - [__main__] - Model size: 0.48 MB
2025-05-19 23:20:03,304 - INFO - [__main__] - Making predictions for ICI using svm
2025-05-19 23:20:03,306 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:03,306 - INFO - [__main__] - Successfully got last prediction for ICI
2025-05-19 23:20:03,306 - INFO - [__main__] - 
Processing ticker: IDI
2025-05-19 23:20:03,306 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:03,306 - INFO - [__main__] - Getting last prediction point for ticker: IDI
2025-05-19 23:20:03,306 - INFO - [__main__] - ==================================================
2025-05-19 23:20:03,306 - INFO - [__main__] - Preparing test data for IDI...
2025-05-19 23:20:03,333 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:03,333 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:03,333 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:03,351 - INFO - [src.data_preparation] - Ticker IDI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:03,351 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(315), np.int64(1): np.int64(324)}
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] - Ticker IDI - Selected features:
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   insec_t: 0.0755
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   vnipc_t: 0.0741
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   s_d7_t: 0.0691
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   SK: 0.0678
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   Volatility: 0.0672
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   TVV: 0.0664
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   PM: 0.0556
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   ma21_t: 0.0552
2025-05-19 23:20:03,659 - INFO - [src.data_preparation] -   ATR: 0.0527
2025-05-19 23:20:03,660 - INFO - [src.data_preparation] -   ma7_t: 0.0524
2025-05-19 23:20:03,660 - INFO - [src.data_preparation] -   ma14_t: 0.0519
2025-05-19 23:20:03,660 - INFO - [src.data_preparation] -   Median_HL: 0.0516
2025-05-19 23:20:03,660 - INFO - [src.data_preparation] -   SR: 0.0507
2025-05-19 23:20:03,660 - INFO - [src.data_preparation] -   HL: 0.0506
2025-05-19 23:20:03,662 - INFO - [src.data_preparation] - Ticker IDI - Using features: ['Date', 'insec_t', 'vnipc_t', 's_d7_t', 'SK', 'Volatility', 'TVV', 'PM', 'ret', 'ma21_t', 'ATR', 'ma7_t', 'ma14_t', 'Median_HL', 'SR', 'HL']
2025-05-19 23:20:03,741 - INFO - [src.data_preparation] - Ticker IDI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:03,742 - INFO - [src.data_preparation] - Ticker IDI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:03,743 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IDI
2025-05-19 23:20:03,743 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:03,743 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:20:03,744 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:20:03,745 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:20:03,745 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:20:03,747 - INFO - [src.data_preparation] - Ticker IDI - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:03,747 - INFO - [__main__] - Using best model for IDI: lstm (F1: 0.6032)
2025-05-19 23:20:03,747 - INFO - [__main__] - Loading lstm model for IDI...
2025-05-19 23:20:03,751 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:03,752 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:20:03,752 - INFO - [__main__] - Making predictions for IDI using lstm
2025-05-19 23:20:03,753 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:03,753 - INFO - [__main__] - Successfully got last prediction for IDI
2025-05-19 23:20:03,754 - INFO - [__main__] - 
Processing ticker: IDJ
2025-05-19 23:20:03,754 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:03,754 - INFO - [__main__] - Getting last prediction point for ticker: IDJ
2025-05-19 23:20:03,754 - INFO - [__main__] - ==================================================
2025-05-19 23:20:03,754 - INFO - [__main__] - Preparing test data for IDJ...
2025-05-19 23:20:03,782 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:03,782 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:03,782 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:03,801 - INFO - [src.data_preparation] - Ticker IDJ - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:03,801 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(274), np.int64(1): np.int64(365)}
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] - Ticker IDJ - Selected features:
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   vnipc_t: 0.0859
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   Volatility: 0.0752
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   SK: 0.0710
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   TVV: 0.0674
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   insec_t: 0.0660
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   ma7_t: 0.0612
2025-05-19 23:20:04,127 - INFO - [src.data_preparation] -   ma21_t: 0.0606
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   PM: 0.0604
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   Median_HL: 0.0591
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   ma14_t: 0.0591
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   s_d7_t: 0.0573
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   ATR: 0.0538
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   ret: 0.0481
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   variation_t: 0.0475
2025-05-19 23:20:04,128 - INFO - [src.data_preparation] -   HL: 0.0411
2025-05-19 23:20:04,130 - INFO - [src.data_preparation] - Ticker IDJ - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'TVV', 'insec_t', 'ma7_t', 'ma21_t', 'PM', 'Median_HL', 'ma14_t', 's_d7_t', 'ATR', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:04,209 - INFO - [src.data_preparation] - Ticker IDJ - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:04,209 - INFO - [src.data_preparation] - Ticker IDJ - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:04,209 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IDJ
2025-05-19 23:20:04,209 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:04,209 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(180), np.int64(1): np.int64(283)}
2025-05-19 23:20:04,211 - INFO - [src.data_preparation] - Generating 103 synthetic minority samples
2025-05-19 23:20:04,215 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (566, 13, 15), y shape: (566,)
2025-05-19 23:20:04,215 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(283), np.int64(1): np.int64(283)}
2025-05-19 23:20:04,219 - INFO - [src.data_preparation] - Ticker IDJ - Final 3D shapes: X_train=(566, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:04,219 - INFO - [__main__] - Using best model for IDJ: lstm (F1: 0.6250)
2025-05-19 23:20:04,219 - INFO - [__main__] - Loading lstm model for IDJ...
2025-05-19 23:20:04,223 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:04,224 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:20:04,224 - INFO - [__main__] - Making predictions for IDJ using lstm
2025-05-19 23:20:04,225 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:04,226 - INFO - [__main__] - Successfully got last prediction for IDJ
2025-05-19 23:20:04,226 - INFO - [__main__] - 
Processing ticker: IDV
2025-05-19 23:20:04,226 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:04,226 - INFO - [__main__] - Getting last prediction point for ticker: IDV
2025-05-19 23:20:04,226 - INFO - [__main__] - ==================================================
2025-05-19 23:20:04,226 - INFO - [__main__] - Preparing test data for IDV...
2025-05-19 23:20:04,265 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:04,267 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:04,267 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:04,286 - INFO - [src.data_preparation] - Ticker IDV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:04,287 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:20:04,630 - INFO - [src.data_preparation] - Ticker IDV - Selected features:
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   TVV: 0.0735
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   SK: 0.0700
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   Volatility: 0.0650
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   insec_t: 0.0631
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   HL: 0.0574
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   ma14_t: 0.0572
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   variation_t: 0.0568
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   SR: 0.0568
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   ma21_t: 0.0516
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   LO: 0.0516
2025-05-19 23:20:04,631 - INFO - [src.data_preparation] -   ret: 0.0500
2025-05-19 23:20:04,634 - INFO - [src.data_preparation] - Ticker IDV - Using features: ['Date', 'TVV', 'vnipc_t', 'SK', 'Volatility', 'insec_t', 's_d7_t', 'ATR', 'HL', 'ma14_t', 'variation_t', 'SR', 'PM', 'ma21_t', 'LO', 'ret']
2025-05-19 23:20:04,714 - INFO - [src.data_preparation] - Ticker IDV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:04,715 - INFO - [src.data_preparation] - Ticker IDV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:04,715 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IDV
2025-05-19 23:20:04,715 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:04,715 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:20:04,717 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:20:04,720 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:20:04,720 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:20:04,723 - INFO - [src.data_preparation] - Ticker IDV - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:04,723 - INFO - [__main__] - Using best model for IDV: svm (F1: 0.5806)
2025-05-19 23:20:04,723 - INFO - [__main__] - Loading svm model for IDV...
2025-05-19 23:20:04,724 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:04,725 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:20:04,725 - INFO - [__main__] - Making predictions for IDV using svm
2025-05-19 23:20:04,726 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:04,726 - INFO - [__main__] - Successfully got last prediction for IDV
2025-05-19 23:20:04,726 - INFO - [__main__] - 
Processing ticker: IFS
2025-05-19 23:20:04,726 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:04,727 - INFO - [__main__] - Getting last prediction point for ticker: IFS
2025-05-19 23:20:04,727 - INFO - [__main__] - ==================================================
2025-05-19 23:20:04,727 - INFO - [__main__] - Preparing test data for IFS...
2025-05-19 23:20:04,754 - INFO - [src.data_preparation] - After processing - X shape: (457, 19), y shape: (457,)
2025-05-19 23:20:04,754 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:04,754 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:04,772 - INFO - [src.data_preparation] - Ticker IFS - Original shapes: X=(457, 18), y=(457,)
2025-05-19 23:20:04,773 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(194), np.int64(1): np.int64(263)}
2025-05-19 23:20:05,015 - INFO - [src.data_preparation] - Ticker IFS - Selected features:
2025-05-19 23:20:05,015 - INFO - [src.data_preparation] -   vnipc_t: 0.0838
2025-05-19 23:20:05,016 - INFO - [src.data_preparation] -   SK: 0.0752
2025-05-19 23:20:05,016 - INFO - [src.data_preparation] -   Volatility: 0.0718
2025-05-19 23:20:05,016 - INFO - [src.data_preparation] -   TVV: 0.0716
2025-05-19 23:20:05,016 - INFO - [src.data_preparation] -   s_d7_t: 0.0683
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   SR: 0.0620
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   HL: 0.0592
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   insec_t: 0.0569
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   PM: 0.0508
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   ma14_t: 0.0493
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   LO: 0.0490
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   ret: 0.0485
2025-05-19 23:20:05,017 - INFO - [src.data_preparation] -   Median_HL: 0.0483
2025-05-19 23:20:05,018 - INFO - [src.data_preparation] -   ma7_t: 0.0482
2025-05-19 23:20:05,021 - INFO - [src.data_preparation] - Ticker IFS - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'TVV', 's_d7_t', 'ATR', 'SR', 'HL', 'insec_t', 'PM', 'ma14_t', 'LO', 'ret', 'Median_HL', 'ma7_t']
2025-05-19 23:20:05,106 - INFO - [src.data_preparation] - Ticker IFS - 2D shapes: X_train=(281, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:05,106 - INFO - [src.data_preparation] - Ticker IFS - 3D shapes: X_train=(281, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:05,108 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IFS
2025-05-19 23:20:05,108 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (281, 13, 15), y shape: (281,)
2025-05-19 23:20:05,108 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(120), np.int64(1): np.int64(161)}
2025-05-19 23:20:05,108 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:20:05,110 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (322, 13, 15), y shape: (322,)
2025-05-19 23:20:05,110 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(161), np.int64(1): np.int64(161)}
2025-05-19 23:20:05,113 - INFO - [src.data_preparation] - Ticker IFS - Final 3D shapes: X_train=(322, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:05,113 - INFO - [__main__] - Using best model for IFS: lstm (F1: 0.0000)
2025-05-19 23:20:05,113 - INFO - [__main__] - Loading lstm model for IFS...
2025-05-19 23:20:05,117 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:05,119 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:20:05,119 - INFO - [__main__] - Making predictions for IFS using lstm
2025-05-19 23:20:05,123 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:05,123 - INFO - [__main__] - Successfully got last prediction for IFS
2025-05-19 23:20:05,123 - INFO - [__main__] - 
Processing ticker: IHK
2025-05-19 23:20:05,123 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:05,123 - INFO - [__main__] - Getting last prediction point for ticker: IHK
2025-05-19 23:20:05,124 - INFO - [__main__] - ==================================================
2025-05-19 23:20:05,124 - INFO - [__main__] - Preparing test data for IHK...
2025-05-19 23:20:05,172 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:05,172 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:05,172 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:05,202 - INFO - [src.data_preparation] - Ticker IHK - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:05,202 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(115), np.int64(1): np.int64(524)}
2025-05-19 23:20:05,504 - INFO - [src.data_preparation] - Ticker IHK - Selected features:
2025-05-19 23:20:05,504 - INFO - [src.data_preparation] -   vnipc_t: 0.1039
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   TVV: 0.0885
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   ma21_t: 0.0833
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   ma7_t: 0.0738
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   ma14_t: 0.0697
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   SK: 0.0646
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   ATR: 0.0645
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   Median_HL: 0.0610
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   PM: 0.0606
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   Volatility: 0.0549
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   HL: 0.0435
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   ret: 0.0401
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   variation_t: 0.0393
2025-05-19 23:20:05,505 - INFO - [src.data_preparation] -   insec_t: 0.0347
2025-05-19 23:20:05,507 - INFO - [src.data_preparation] - Ticker IHK - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma7_t', 'ma14_t', 's_d7_t', 'SK', 'ATR', 'Median_HL', 'PM', 'Volatility', 'HL', 'ret', 'variation_t', 'insec_t']
2025-05-19 23:20:05,591 - INFO - [src.data_preparation] - Ticker IHK - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:05,591 - INFO - [src.data_preparation] - Ticker IHK - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:05,593 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IHK
2025-05-19 23:20:05,593 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:05,593 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(94), np.int64(1): np.int64(369)}
2025-05-19 23:20:05,593 - INFO - [src.data_preparation] - Generating 275 synthetic minority samples
2025-05-19 23:20:05,603 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (738, 13, 15), y shape: (738,)
2025-05-19 23:20:05,603 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(369), np.int64(1): np.int64(369)}
2025-05-19 23:20:05,607 - INFO - [src.data_preparation] - Ticker IHK - Final 3D shapes: X_train=(738, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:05,608 - INFO - [__main__] - Using best model for IHK: svm (F1: 0.9000)
2025-05-19 23:20:05,608 - INFO - [__main__] - Loading svm model for IHK...
2025-05-19 23:20:05,609 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:05,609 - INFO - [__main__] - Model size: 0.61 MB
2025-05-19 23:20:05,609 - INFO - [__main__] - Making predictions for IHK using svm
2025-05-19 23:20:05,610 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:05,610 - INFO - [__main__] - Successfully got last prediction for IHK
2025-05-19 23:20:05,610 - INFO - [__main__] - 
Processing ticker: IJC
2025-05-19 23:20:05,610 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:05,611 - INFO - [__main__] - Getting last prediction point for ticker: IJC
2025-05-19 23:20:05,611 - INFO - [__main__] - ==================================================
2025-05-19 23:20:05,611 - INFO - [__main__] - Preparing test data for IJC...
2025-05-19 23:20:05,638 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:05,638 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:05,639 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:05,656 - INFO - [src.data_preparation] - Ticker IJC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:05,657 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] - Ticker IJC - Selected features:
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] -   insec_t: 0.0707
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] -   vnipc_t: 0.0669
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] -   SK: 0.0629
2025-05-19 23:20:05,959 - INFO - [src.data_preparation] -   LO: 0.0622
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   HL: 0.0608
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   s_d7_t: 0.0602
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   variation_t: 0.0570
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   ret: 0.0555
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   ATR: 0.0549
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   ma14_t: 0.0531
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   PM: 0.0522
2025-05-19 23:20:05,960 - INFO - [src.data_preparation] -   SR: 0.0519
2025-05-19 23:20:05,962 - INFO - [src.data_preparation] - Ticker IJC - Using features: ['Date', 'insec_t', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'LO', 'HL', 's_d7_t', 'ma21_t', 'variation_t', 'ret', 'ATR', 'ma14_t', 'PM', 'SR']
2025-05-19 23:20:06,051 - INFO - [src.data_preparation] - Ticker IJC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:06,051 - INFO - [src.data_preparation] - Ticker IJC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:06,053 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IJC
2025-05-19 23:20:06,053 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:06,053 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:20:06,053 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:20:06,055 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:20:06,055 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:20:06,058 - INFO - [src.data_preparation] - Ticker IJC - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:06,058 - INFO - [__main__] - Using best model for IJC: svm (F1: 0.6970)
2025-05-19 23:20:06,058 - INFO - [__main__] - Loading svm model for IJC...
2025-05-19 23:20:06,059 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:06,060 - INFO - [__main__] - Model size: 0.67 MB
2025-05-19 23:20:06,060 - INFO - [__main__] - Making predictions for IJC using svm
2025-05-19 23:20:06,060 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:06,061 - INFO - [__main__] - Successfully got last prediction for IJC
2025-05-19 23:20:06,061 - INFO - [__main__] - 
Processing ticker: ILC
2025-05-19 23:20:06,061 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:06,061 - INFO - [__main__] - Getting last prediction point for ticker: ILC
2025-05-19 23:20:06,061 - INFO - [__main__] - ==================================================
2025-05-19 23:20:06,061 - INFO - [__main__] - Preparing test data for ILC...
2025-05-19 23:20:06,094 - INFO - [src.data_preparation] - After processing - X shape: (423, 19), y shape: (423,)
2025-05-19 23:20:06,094 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:06,094 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:06,114 - INFO - [src.data_preparation] - Ticker ILC - Original shapes: X=(423, 18), y=(423,)
2025-05-19 23:20:06,114 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(155), np.int64(1): np.int64(268)}
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] - Ticker ILC - Selected features:
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] -   vnipc_t: 0.0844
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] -   ma14_t: 0.0723
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] -   TVV: 0.0716
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] -   ma21_t: 0.0672
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] -   Volatility: 0.0626
2025-05-19 23:20:06,322 - INFO - [src.data_preparation] -   Median_HL: 0.0626
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   ATR: 0.0623
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   s_d7_t: 0.0614
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   ma7_t: 0.0606
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   SK: 0.0602
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   variation_t: 0.0513
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   insec_t: 0.0507
2025-05-19 23:20:06,323 - INFO - [src.data_preparation] -   HL: 0.0466
2025-05-19 23:20:06,325 - INFO - [src.data_preparation] - Ticker ILC - Using features: ['Date', 'vnipc_t', 'ma14_t', 'TVV', 'ma21_t', 'Volatility', 'Median_HL', 'ATR', 's_d7_t', 'ma7_t', 'SK', 'ret', 'PM', 'variation_t', 'insec_t', 'HL']
2025-05-19 23:20:06,385 - INFO - [src.data_preparation] - Ticker ILC - 2D shapes: X_train=(247, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:06,385 - INFO - [src.data_preparation] - Ticker ILC - 3D shapes: X_train=(247, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:06,387 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ILC
2025-05-19 23:20:06,387 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (247, 13, 15), y shape: (247,)
2025-05-19 23:20:06,387 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(75), np.int64(1): np.int64(172)}
2025-05-19 23:20:06,387 - INFO - [src.data_preparation] - Generating 97 synthetic minority samples
2025-05-19 23:20:06,391 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (344, 13, 15), y shape: (344,)
2025-05-19 23:20:06,391 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(172), np.int64(1): np.int64(172)}
2025-05-19 23:20:06,393 - INFO - [src.data_preparation] - Ticker ILC - Final 3D shapes: X_train=(344, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:06,393 - INFO - [__main__] - Using best model for ILC: svm (F1: 0.6250)
2025-05-19 23:20:06,393 - INFO - [__main__] - Loading svm model for ILC...
2025-05-19 23:20:06,394 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:06,395 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:20:06,395 - INFO - [__main__] - Making predictions for ILC using svm
2025-05-19 23:20:06,395 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:06,396 - INFO - [__main__] - Successfully got last prediction for ILC
2025-05-19 23:20:06,396 - INFO - [__main__] - 
Processing ticker: IME
2025-05-19 23:20:06,396 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:06,396 - INFO - [__main__] - Getting last prediction point for ticker: IME
2025-05-19 23:20:06,396 - INFO - [__main__] - ==================================================
2025-05-19 23:20:06,396 - INFO - [__main__] - Preparing test data for IME...
2025-05-19 23:20:06,421 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:06,421 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:06,422 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:06,443 - INFO - [src.data_preparation] - Ticker IME - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:06,444 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(64), np.int64(1): np.int64(575)}
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] - Ticker IME - Selected features:
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] -   vnipc_t: 0.1320
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] -   TVV: 0.0895
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] -   ma21_t: 0.0818
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] -   ma14_t: 0.0768
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] -   HL: 0.0661
2025-05-19 23:20:06,633 - INFO - [src.data_preparation] -   ATR: 0.0616
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   ma7_t: 0.0569
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   insec_t: 0.0534
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   s_d7_t: 0.0522
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   Median_HL: 0.0486
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   SK: 0.0449
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   Volatility: 0.0428
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   variation_t: 0.0424
2025-05-19 23:20:06,634 - INFO - [src.data_preparation] -   ret: 0.0411
2025-05-19 23:20:06,637 - INFO - [src.data_preparation] - Ticker IME - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'HL', 'ATR', 'ma7_t', 'insec_t', 's_d7_t', 'PM', 'Median_HL', 'SK', 'Volatility', 'variation_t', 'ret']
2025-05-19 23:20:06,719 - INFO - [src.data_preparation] - Ticker IME - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:06,719 - INFO - [src.data_preparation] - Ticker IME - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:06,721 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IME
2025-05-19 23:20:06,721 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:06,721 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(61), np.int64(1): np.int64(402)}
2025-05-19 23:20:06,722 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:20:06,724 - INFO - [src.data_preparation] - Ticker IME - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:06,724 - INFO - [__main__] - Using best model for IME: lstm (F1: 0.9767)
2025-05-19 23:20:06,724 - INFO - [__main__] - Loading lstm model for IME...
2025-05-19 23:20:06,729 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:06,730 - INFO - [__main__] - Model size: 0.28 MB
2025-05-19 23:20:06,730 - INFO - [__main__] - Making predictions for IME using lstm
2025-05-19 23:20:06,734 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:06,734 - INFO - [__main__] - Successfully got last prediction for IME
2025-05-19 23:20:06,734 - INFO - [__main__] - 
Processing ticker: IMP
2025-05-19 23:20:06,734 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:06,734 - INFO - [__main__] - Getting last prediction point for ticker: IMP
2025-05-19 23:20:06,735 - INFO - [__main__] - ==================================================
2025-05-19 23:20:06,735 - INFO - [__main__] - Preparing test data for IMP...
2025-05-19 23:20:06,760 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:06,760 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:06,760 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:06,779 - INFO - [src.data_preparation] - Ticker IMP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:06,779 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(303), np.int64(1): np.int64(336)}
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] - Ticker IMP - Selected features:
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   insec_t: 0.0851
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   TVV: 0.0703
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   vnipc_t: 0.0671
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   SK: 0.0621
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   Volatility: 0.0604
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   SR: 0.0588
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   LO: 0.0580
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   HL: 0.0553
2025-05-19 23:20:07,120 - INFO - [src.data_preparation] -   ATR: 0.0550
2025-05-19 23:20:07,121 - INFO - [src.data_preparation] -   PM: 0.0548
2025-05-19 23:20:07,121 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:20:07,121 - INFO - [src.data_preparation] -   ma7_t: 0.0531
2025-05-19 23:20:07,121 - INFO - [src.data_preparation] -   ma14_t: 0.0528
2025-05-19 23:20:07,121 - INFO - [src.data_preparation] -   variation_t: 0.0520
2025-05-19 23:20:07,123 - INFO - [src.data_preparation] - Ticker IMP - Using features: ['Date', 'insec_t', 'TVV', 'vnipc_t', 'SK', 's_d7_t', 'Volatility', 'SR', 'LO', 'HL', 'ATR', 'PM', 'ret', 'ma7_t', 'ma14_t', 'variation_t']
2025-05-19 23:20:07,203 - INFO - [src.data_preparation] - Ticker IMP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:07,203 - INFO - [src.data_preparation] - Ticker IMP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:07,206 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IMP
2025-05-19 23:20:07,206 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:07,206 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:20:07,206 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:20:07,208 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:20:07,208 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:20:07,210 - INFO - [src.data_preparation] - Ticker IMP - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:07,210 - INFO - [__main__] - Using best model for IMP: svm (F1: 0.5000)
2025-05-19 23:20:07,210 - INFO - [__main__] - Loading svm model for IMP...
2025-05-19 23:20:07,212 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:07,212 - INFO - [__main__] - Model size: 0.67 MB
2025-05-19 23:20:07,212 - INFO - [__main__] - Making predictions for IMP using svm
2025-05-19 23:20:07,213 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:07,213 - INFO - [__main__] - Successfully got last prediction for IMP
2025-05-19 23:20:07,213 - INFO - [__main__] - 
Processing ticker: IN4
2025-05-19 23:20:07,213 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:07,213 - INFO - [__main__] - Getting last prediction point for ticker: IN4
2025-05-19 23:20:07,213 - INFO - [__main__] - ==================================================
2025-05-19 23:20:07,213 - INFO - [__main__] - Preparing test data for IN4...
2025-05-19 23:20:07,241 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:07,241 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:07,242 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:07,259 - INFO - [src.data_preparation] - Ticker IN4 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:07,259 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(96), np.int64(1): np.int64(543)}
2025-05-19 23:20:07,518 - INFO - [src.data_preparation] - Ticker IN4 - Selected features:
2025-05-19 23:20:07,518 - INFO - [src.data_preparation] -   ma21_t: 0.0822
2025-05-19 23:20:07,518 - INFO - [src.data_preparation] -   ma14_t: 0.0792
2025-05-19 23:20:07,518 - INFO - [src.data_preparation] -   HL: 0.0727
2025-05-19 23:20:07,518 - INFO - [src.data_preparation] -   vnipc_t: 0.0704
2025-05-19 23:20:07,519 - INFO - [src.data_preparation] -   TVV: 0.0699
2025-05-19 23:20:07,519 - INFO - [src.data_preparation] -   ATR: 0.0679
2025-05-19 23:20:07,519 - INFO - [src.data_preparation] -   ma7_t: 0.0674
2025-05-19 23:20:07,519 - INFO - [src.data_preparation] -   s_d7_t: 0.0666
2025-05-19 23:20:07,519 - INFO - [src.data_preparation] -   PM: 0.0640
2025-05-19 23:20:07,519 - INFO - [src.data_preparation] -   Median_HL: 0.0573
2025-05-19 23:20:07,520 - INFO - [src.data_preparation] -   Volatility: 0.0572
2025-05-19 23:20:07,520 - INFO - [src.data_preparation] -   SR: 0.0531
2025-05-19 23:20:07,520 - INFO - [src.data_preparation] -   SK: 0.0459
2025-05-19 23:20:07,521 - INFO - [src.data_preparation] -   LO: 0.0379
2025-05-19 23:20:07,521 - INFO - [src.data_preparation] -   variation_t: 0.0372
2025-05-19 23:20:07,526 - INFO - [src.data_preparation] - Ticker IN4 - Using features: ['Date', 'ma21_t', 'ma14_t', 'HL', 'vnipc_t', 'TVV', 'ATR', 'ma7_t', 's_d7_t', 'PM', 'Median_HL', 'Volatility', 'SR', 'SK', 'LO', 'variation_t']
2025-05-19 23:20:07,639 - INFO - [src.data_preparation] - Ticker IN4 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:07,639 - INFO - [src.data_preparation] - Ticker IN4 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:07,642 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IN4
2025-05-19 23:20:07,643 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:07,643 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(72), np.int64(1): np.int64(391)}
2025-05-19 23:20:07,643 - INFO - [src.data_preparation] - Generating 319 synthetic minority samples
2025-05-19 23:20:07,656 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (782, 13, 15), y shape: (782,)
2025-05-19 23:20:07,656 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(391), np.int64(1): np.int64(391)}
2025-05-19 23:20:07,661 - INFO - [src.data_preparation] - Ticker IN4 - Final 3D shapes: X_train=(782, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:07,661 - INFO - [__main__] - Using best model for IN4: logistic_regression (F1: 0.7536)
2025-05-19 23:20:07,662 - INFO - [__main__] - Loading logistic_regression model for IN4...
2025-05-19 23:20:07,662 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:07,662 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:07,663 - INFO - [__main__] - Making predictions for IN4 using logistic_regression
2025-05-19 23:20:07,663 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:07,663 - INFO - [__main__] - Successfully got last prediction for IN4
2025-05-19 23:20:07,663 - INFO - [__main__] - 
Processing ticker: INC
2025-05-19 23:20:07,663 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:07,663 - INFO - [__main__] - Getting last prediction point for ticker: INC
2025-05-19 23:20:07,663 - INFO - [__main__] - ==================================================
2025-05-19 23:20:07,664 - INFO - [__main__] - Preparing test data for INC...
2025-05-19 23:20:07,692 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:07,692 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:07,692 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:07,711 - INFO - [src.data_preparation] - Ticker INC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:07,711 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(166), np.int64(1): np.int64(473)}
2025-05-19 23:20:07,967 - INFO - [src.data_preparation] - Ticker INC - Selected features:
2025-05-19 23:20:07,967 - INFO - [src.data_preparation] -   vnipc_t: 0.0880
2025-05-19 23:20:07,967 - INFO - [src.data_preparation] -   ma21_t: 0.0792
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   TVV: 0.0771
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   SK: 0.0697
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   ma14_t: 0.0691
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   ATR: 0.0677
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   Volatility: 0.0660
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   ma7_t: 0.0650
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   Median_HL: 0.0609
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   PM: 0.0589
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   insec_t: 0.0459
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   ret: 0.0435
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   variation_t: 0.0425
2025-05-19 23:20:07,968 - INFO - [src.data_preparation] -   SR: 0.0371
2025-05-19 23:20:07,971 - INFO - [src.data_preparation] - Ticker INC - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'SK', 'ma14_t', 'ATR', 'Volatility', 'ma7_t', 's_d7_t', 'Median_HL', 'PM', 'insec_t', 'ret', 'variation_t', 'SR']
2025-05-19 23:20:08,055 - INFO - [src.data_preparation] - Ticker INC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:08,055 - INFO - [src.data_preparation] - Ticker INC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:08,056 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker INC
2025-05-19 23:20:08,056 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:08,057 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(138), np.int64(1): np.int64(325)}
2025-05-19 23:20:08,057 - INFO - [src.data_preparation] - Generating 187 synthetic minority samples
2025-05-19 23:20:08,065 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (650, 13, 15), y shape: (650,)
2025-05-19 23:20:08,065 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(325), np.int64(1): np.int64(325)}
2025-05-19 23:20:08,068 - INFO - [src.data_preparation] - Ticker INC - Final 3D shapes: X_train=(650, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:08,068 - INFO - [__main__] - Using best model for INC: svm (F1: 0.9398)
2025-05-19 23:20:08,068 - INFO - [__main__] - Loading svm model for INC...
2025-05-19 23:20:08,069 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:08,070 - INFO - [__main__] - Model size: 0.98 MB
2025-05-19 23:20:08,070 - INFO - [__main__] - Making predictions for INC using svm
2025-05-19 23:20:08,071 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:08,071 - INFO - [__main__] - Successfully got last prediction for INC
2025-05-19 23:20:08,071 - INFO - [__main__] - 
Processing ticker: INN
2025-05-19 23:20:08,071 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:08,071 - INFO - [__main__] - Getting last prediction point for ticker: INN
2025-05-19 23:20:08,071 - INFO - [__main__] - ==================================================
2025-05-19 23:20:08,071 - INFO - [__main__] - Preparing test data for INN...
2025-05-19 23:20:08,097 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:08,098 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:08,098 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:08,115 - INFO - [src.data_preparation] - Ticker INN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:08,115 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] - Ticker INN - Selected features:
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   Volatility: 0.0684
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   SR: 0.0669
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   insec_t: 0.0656
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   vnipc_t: 0.0652
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   SK: 0.0644
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   TVV: 0.0617
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   HL: 0.0591
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   ATR: 0.0590
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   variation_t: 0.0573
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   LO: 0.0570
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   ret: 0.0565
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   ma14_t: 0.0513
2025-05-19 23:20:08,407 - INFO - [src.data_preparation] -   Median_HL: 0.0497
2025-05-19 23:20:08,411 - INFO - [src.data_preparation] - Ticker INN - Using features: ['Date', 'Volatility', 'SR', 'insec_t', 'vnipc_t', 'SK', 's_d7_t', 'TVV', 'HL', 'ATR', 'variation_t', 'LO', 'ret', 'PM', 'ma14_t', 'Median_HL']
2025-05-19 23:20:08,498 - INFO - [src.data_preparation] - Ticker INN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:08,498 - INFO - [src.data_preparation] - Ticker INN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:08,500 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker INN
2025-05-19 23:20:08,500 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:08,500 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(258)}
2025-05-19 23:20:08,500 - INFO - [src.data_preparation] - Generating 53 synthetic minority samples
2025-05-19 23:20:08,504 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:20:08,504 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:20:08,507 - INFO - [src.data_preparation] - Ticker INN - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:08,507 - INFO - [__main__] - Using best model for INN: svm (F1: 0.7429)
2025-05-19 23:20:08,507 - INFO - [__main__] - Loading svm model for INN...
2025-05-19 23:20:08,508 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:08,509 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:20:08,509 - INFO - [__main__] - Making predictions for INN using svm
2025-05-19 23:20:08,509 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:08,509 - INFO - [__main__] - Successfully got last prediction for INN
2025-05-19 23:20:08,509 - INFO - [__main__] - 
Processing ticker: ITA
2025-05-19 23:20:08,510 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:08,510 - INFO - [__main__] - Getting last prediction point for ticker: ITA
2025-05-19 23:20:08,510 - INFO - [__main__] - ==================================================
2025-05-19 23:20:08,510 - INFO - [__main__] - Preparing test data for ITA...
2025-05-19 23:20:08,538 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:08,538 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:08,538 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:08,557 - INFO - [src.data_preparation] - Ticker ITA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:08,557 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(300), np.int64(1): np.int64(339)}
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] - Ticker ITA - Selected features:
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   vnipc_t: 0.0751
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   TVV: 0.0693
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   Volatility: 0.0668
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   HL: 0.0667
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   insec_t: 0.0638
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   ma21_t: 0.0597
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   ma14_t: 0.0538
2025-05-19 23:20:08,851 - INFO - [src.data_preparation] -   PM: 0.0517
2025-05-19 23:20:08,852 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:20:08,852 - INFO - [src.data_preparation] -   Median_HL: 0.0497
2025-05-19 23:20:08,852 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:20:08,852 - INFO - [src.data_preparation] -   SR: 0.0475
2025-05-19 23:20:08,854 - INFO - [src.data_preparation] - Ticker ITA - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'HL', 'ATR', 'insec_t', 's_d7_t', 'SK', 'ma21_t', 'ma14_t', 'PM', 'variation_t', 'Median_HL', 'ret', 'SR']
2025-05-19 23:20:08,936 - INFO - [src.data_preparation] - Ticker ITA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:08,936 - INFO - [src.data_preparation] - Ticker ITA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:08,938 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ITA
2025-05-19 23:20:08,938 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:08,938 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:20:08,938 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:20:08,940 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:20:08,940 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:20:08,942 - INFO - [src.data_preparation] - Ticker ITA - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:08,942 - INFO - [__main__] - Using best model for ITA: svm (F1: 0.8421)
2025-05-19 23:20:08,942 - INFO - [__main__] - Loading svm model for ITA...
2025-05-19 23:20:08,944 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:08,944 - INFO - [__main__] - Model size: 0.64 MB
2025-05-19 23:20:08,944 - INFO - [__main__] - Making predictions for ITA using svm
2025-05-19 23:20:08,944 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:08,945 - INFO - [__main__] - Successfully got last prediction for ITA
2025-05-19 23:20:08,945 - INFO - [__main__] - 
Processing ticker: ITC
2025-05-19 23:20:08,945 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:08,945 - INFO - [__main__] - Getting last prediction point for ticker: ITC
2025-05-19 23:20:08,945 - INFO - [__main__] - ==================================================
2025-05-19 23:20:08,945 - INFO - [__main__] - Preparing test data for ITC...
2025-05-19 23:20:08,971 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:08,971 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:08,971 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:08,999 - INFO - [src.data_preparation] - Ticker ITC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:09,000 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:20:09,284 - INFO - [src.data_preparation] - Ticker ITC - Selected features:
2025-05-19 23:20:09,284 - INFO - [src.data_preparation] -   SK: 0.0768
2025-05-19 23:20:09,284 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   insec_t: 0.0710
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   Volatility: 0.0665
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   s_d7_t: 0.0654
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   TVV: 0.0616
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   LO: 0.0579
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   ret: 0.0565
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   ATR: 0.0548
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   variation_t: 0.0540
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   ma14_t: 0.0533
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   ma7_t: 0.0524
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   ma21_t: 0.0520
2025-05-19 23:20:09,285 - INFO - [src.data_preparation] -   PM: 0.0482
2025-05-19 23:20:09,288 - INFO - [src.data_preparation] - Ticker ITC - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'TVV', 'HL', 'LO', 'ret', 'ATR', 'variation_t', 'ma14_t', 'ma7_t', 'ma21_t', 'PM']
2025-05-19 23:20:09,365 - INFO - [src.data_preparation] - Ticker ITC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:09,365 - INFO - [src.data_preparation] - Ticker ITC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:09,366 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ITC
2025-05-19 23:20:09,366 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:09,366 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:20:09,366 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:20:09,370 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:20:09,370 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:20:09,372 - INFO - [src.data_preparation] - Ticker ITC - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:09,373 - INFO - [__main__] - Using best model for ITC: transformer (F1: 0.6667)
2025-05-19 23:20:09,373 - INFO - [__main__] - Loading transformer model for ITC...
2025-05-19 23:20:09,385 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:09,390 - INFO - [__main__] - Model size: 0.34 MB
2025-05-19 23:20:09,390 - INFO - [__main__] - Making predictions for ITC using transformer
2025-05-19 23:20:09,392 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:09,392 - INFO - [__main__] - Successfully got last prediction for ITC
2025-05-19 23:20:09,392 - INFO - [__main__] - 
Processing ticker: ITD
2025-05-19 23:20:09,392 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:09,392 - INFO - [__main__] - Getting last prediction point for ticker: ITD
2025-05-19 23:20:09,393 - INFO - [__main__] - ==================================================
2025-05-19 23:20:09,393 - INFO - [__main__] - Preparing test data for ITD...
2025-05-19 23:20:09,428 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:09,428 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:09,430 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:09,460 - INFO - [src.data_preparation] - Ticker ITD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:09,461 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(308), np.int64(1): np.int64(331)}
2025-05-19 23:20:09,817 - INFO - [src.data_preparation] - Ticker ITD - Selected features:
2025-05-19 23:20:09,817 - INFO - [src.data_preparation] -   vnipc_t: 0.0748
2025-05-19 23:20:09,817 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:20:09,817 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:20:09,817 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   ATR: 0.0617
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   insec_t: 0.0602
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   SR: 0.0586
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   HL: 0.0585
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   ret: 0.0575
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   ma21_t: 0.0565
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   ma14_t: 0.0545
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   LO: 0.0536
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:20:09,818 - INFO - [src.data_preparation] -   PM: 0.0501
2025-05-19 23:20:09,821 - INFO - [src.data_preparation] - Ticker ITD - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'Volatility', 'TVV', 'ATR', 'insec_t', 'SR', 'HL', 'ret', 'ma21_t', 'ma14_t', 'LO', 'Median_HL', 'PM']
2025-05-19 23:20:09,912 - INFO - [src.data_preparation] - Ticker ITD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:09,912 - INFO - [src.data_preparation] - Ticker ITD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:09,914 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ITD
2025-05-19 23:20:09,914 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:09,914 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:20:09,914 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:20:09,917 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:20:09,917 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:20:09,920 - INFO - [src.data_preparation] - Ticker ITD - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:09,920 - INFO - [__main__] - Using best model for ITD: transformer (F1: 0.5417)
2025-05-19 23:20:09,920 - INFO - [__main__] - Loading transformer model for ITD...
2025-05-19 23:20:09,936 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:20:09,940 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:20:09,940 - INFO - [__main__] - Making predictions for ITD using transformer
2025-05-19 23:20:09,943 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:09,944 - INFO - [__main__] - Successfully got last prediction for ITD
2025-05-19 23:20:09,944 - INFO - [__main__] - 
Processing ticker: ITQ
2025-05-19 23:20:09,944 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:09,944 - INFO - [__main__] - Getting last prediction point for ticker: ITQ
2025-05-19 23:20:09,944 - INFO - [__main__] - ==================================================
2025-05-19 23:20:09,944 - INFO - [__main__] - Preparing test data for ITQ...
2025-05-19 23:20:09,984 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:09,984 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:09,984 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:10,013 - INFO - [src.data_preparation] - Ticker ITQ - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:10,014 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(267), np.int64(1): np.int64(372)}
2025-05-19 23:20:10,329 - INFO - [src.data_preparation] - Ticker ITQ - Selected features:
2025-05-19 23:20:10,329 - INFO - [src.data_preparation] -   vnipc_t: 0.0760
2025-05-19 23:20:10,329 - INFO - [src.data_preparation] -   insec_t: 0.0750
2025-05-19 23:20:10,329 - INFO - [src.data_preparation] -   SK: 0.0679
2025-05-19 23:20:10,329 - INFO - [src.data_preparation] -   ma14_t: 0.0633
2025-05-19 23:20:10,329 - INFO - [src.data_preparation] -   Volatility: 0.0618
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   Median_HL: 0.0603
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   TVV: 0.0603
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   PM: 0.0582
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   ma21_t: 0.0579
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   ATR: 0.0564
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   s_d7_t: 0.0543
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   SR: 0.0533
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   ret: 0.0498
2025-05-19 23:20:10,330 - INFO - [src.data_preparation] -   variation_t: 0.0463
2025-05-19 23:20:10,333 - INFO - [src.data_preparation] - Ticker ITQ - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'ma14_t', 'Volatility', 'Median_HL', 'TVV', 'PM', 'ma21_t', 'ATR', 'ma7_t', 's_d7_t', 'SR', 'ret', 'variation_t']
2025-05-19 23:20:10,411 - INFO - [src.data_preparation] - Ticker ITQ - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:10,412 - INFO - [src.data_preparation] - Ticker ITQ - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:10,413 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ITQ
2025-05-19 23:20:10,413 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:10,413 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:20:10,413 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:20:10,417 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:20:10,417 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:20:10,419 - INFO - [src.data_preparation] - Ticker ITQ - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:10,420 - INFO - [__main__] - Using best model for ITQ: svm (F1: 0.6866)
2025-05-19 23:20:10,420 - INFO - [__main__] - Loading svm model for ITQ...
2025-05-19 23:20:10,421 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:10,422 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:20:10,422 - INFO - [__main__] - Making predictions for ITQ using svm
2025-05-19 23:20:10,422 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:10,423 - INFO - [__main__] - Successfully got last prediction for ITQ
2025-05-19 23:20:10,423 - INFO - [__main__] - 
Processing ticker: IVS
2025-05-19 23:20:10,423 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:10,423 - INFO - [__main__] - Getting last prediction point for ticker: IVS
2025-05-19 23:20:10,423 - INFO - [__main__] - ==================================================
2025-05-19 23:20:10,423 - INFO - [__main__] - Preparing test data for IVS...
2025-05-19 23:20:10,451 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:10,451 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:10,451 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:10,470 - INFO - [src.data_preparation] - Ticker IVS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:10,470 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] - Ticker IVS - Selected features:
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   vnipc_t: 0.0704
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   ma21_t: 0.0676
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   s_d7_t: 0.0668
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   insec_t: 0.0655
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   SK: 0.0654
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   ma14_t: 0.0616
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   LO: 0.0596
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   TVV: 0.0571
2025-05-19 23:20:10,765 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:20:10,766 - INFO - [src.data_preparation] -   Volatility: 0.0559
2025-05-19 23:20:10,766 - INFO - [src.data_preparation] -   HL: 0.0554
2025-05-19 23:20:10,766 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:20:10,766 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:20:10,766 - INFO - [src.data_preparation] -   variation_t: 0.0515
2025-05-19 23:20:10,766 - INFO - [src.data_preparation] -   PM: 0.0506
2025-05-19 23:20:10,768 - INFO - [src.data_preparation] - Ticker IVS - Using features: ['Date', 'vnipc_t', 'ma21_t', 's_d7_t', 'insec_t', 'SK', 'ma14_t', 'LO', 'TVV', 'ATR', 'Volatility', 'HL', 'ret', 'Median_HL', 'variation_t', 'PM']
2025-05-19 23:20:10,853 - INFO - [src.data_preparation] - Ticker IVS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:10,853 - INFO - [src.data_preparation] - Ticker IVS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:10,854 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker IVS
2025-05-19 23:20:10,855 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:10,855 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:20:10,855 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:20:10,858 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:20:10,858 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:20:10,861 - INFO - [src.data_preparation] - Ticker IVS - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:10,861 - INFO - [__main__] - Using best model for IVS: transformer (F1: 0.6182)
2025-05-19 23:20:10,861 - INFO - [__main__] - Loading transformer model for IVS...
2025-05-19 23:20:10,872 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:10,879 - INFO - [__main__] - Model size: 0.12 MB
2025-05-19 23:20:10,879 - INFO - [__main__] - Making predictions for IVS using transformer
2025-05-19 23:20:10,882 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:10,883 - INFO - [__main__] - Successfully got last prediction for IVS
2025-05-19 23:20:10,883 - INFO - [__main__] - 
Processing ticker: JVC
2025-05-19 23:20:10,883 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:10,883 - INFO - [__main__] - Getting last prediction point for ticker: JVC
2025-05-19 23:20:10,883 - INFO - [__main__] - ==================================================
2025-05-19 23:20:10,883 - INFO - [__main__] - Preparing test data for JVC...
2025-05-19 23:20:10,920 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:10,920 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:10,920 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:10,944 - INFO - [src.data_preparation] - Ticker JVC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:10,944 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(319), np.int64(1): np.int64(320)}
2025-05-19 23:20:11,266 - INFO - [src.data_preparation] - Ticker JVC - Selected features:
2025-05-19 23:20:11,266 - INFO - [src.data_preparation] -   vnipc_t: 0.0733
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   s_d7_t: 0.0717
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   SK: 0.0649
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   ma21_t: 0.0632
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   HL: 0.0590
2025-05-19 23:20:11,267 - INFO - [src.data_preparation] -   TVV: 0.0585
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   ATR: 0.0577
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   variation_t: 0.0572
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   SR: 0.0538
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   ma14_t: 0.0498
2025-05-19 23:20:11,268 - INFO - [src.data_preparation] -   PM: 0.0490
2025-05-19 23:20:11,270 - INFO - [src.data_preparation] - Ticker JVC - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'Volatility', 'ma21_t', 'insec_t', 'HL', 'TVV', 'ATR', 'variation_t', 'SR', 'ret', 'Median_HL', 'ma14_t', 'PM']
2025-05-19 23:20:11,352 - INFO - [src.data_preparation] - Ticker JVC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:11,352 - INFO - [src.data_preparation] - Ticker JVC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:11,353 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker JVC
2025-05-19 23:20:11,353 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:11,353 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(227), np.int64(1): np.int64(236)}
2025-05-19 23:20:11,353 - INFO - [src.data_preparation] - Generating 9 synthetic minority samples
2025-05-19 23:20:11,354 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (472, 13, 15), y shape: (472,)
2025-05-19 23:20:11,355 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(236), np.int64(1): np.int64(236)}
2025-05-19 23:20:11,357 - INFO - [src.data_preparation] - Ticker JVC - Final 3D shapes: X_train=(472, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:11,357 - INFO - [__main__] - Using best model for JVC: logistic_regression (F1: 0.6786)
2025-05-19 23:20:11,357 - INFO - [__main__] - Loading logistic_regression model for JVC...
2025-05-19 23:20:11,358 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:11,358 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:11,358 - INFO - [__main__] - Making predictions for JVC using logistic_regression
2025-05-19 23:20:11,359 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:11,359 - INFO - [__main__] - Successfully got last prediction for JVC
2025-05-19 23:20:11,359 - INFO - [__main__] - 
Processing ticker: KAC
2025-05-19 23:20:11,359 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:11,359 - INFO - [__main__] - Getting last prediction point for ticker: KAC
2025-05-19 23:20:11,359 - INFO - [__main__] - ==================================================
2025-05-19 23:20:11,359 - INFO - [__main__] - Preparing test data for KAC...
2025-05-19 23:20:11,387 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:11,387 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:11,387 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:11,405 - INFO - [src.data_preparation] - Ticker KAC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:11,405 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(146), np.int64(1): np.int64(492)}
2025-05-19 23:20:11,622 - INFO - [src.data_preparation] - Ticker KAC - Selected features:
2025-05-19 23:20:11,622 - INFO - [src.data_preparation] -   TVV: 0.1036
2025-05-19 23:20:11,622 - INFO - [src.data_preparation] -   HL: 0.0869
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   vnipc_t: 0.0853
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   ATR: 0.0674
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   ret: 0.0595
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   insec_t: 0.0576
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   Volatility: 0.0556
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   MDD: 0.0526
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   ma21_t: 0.0525
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   SK: 0.0523
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   s_d7_t: 0.0480
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   SR: 0.0471
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   PM: 0.0442
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   variation_t: 0.0437
2025-05-19 23:20:11,623 - INFO - [src.data_preparation] -   Median_HL: 0.0410
2025-05-19 23:20:11,625 - INFO - [src.data_preparation] - Ticker KAC - Using features: ['Date', 'TVV', 'HL', 'vnipc_t', 'ATR', 'ret', 'insec_t', 'Volatility', 'MDD', 'ma21_t', 'SK', 's_d7_t', 'SR', 'PM', 'variation_t', 'Median_HL']
2025-05-19 23:20:11,704 - INFO - [src.data_preparation] - Ticker KAC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:11,704 - INFO - [src.data_preparation] - Ticker KAC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:11,705 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KAC
2025-05-19 23:20:11,705 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:20:11,705 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(132), np.int64(1): np.int64(330)}
2025-05-19 23:20:11,705 - INFO - [src.data_preparation] - Generating 198 synthetic minority samples
2025-05-19 23:20:11,713 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (660, 13, 15), y shape: (660,)
2025-05-19 23:20:11,713 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(330), np.int64(1): np.int64(330)}
2025-05-19 23:20:11,716 - INFO - [src.data_preparation] - Ticker KAC - Final 3D shapes: X_train=(660, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:11,717 - INFO - [__main__] - Using best model for KAC: lstm (F1: 0.9885)
2025-05-19 23:20:11,717 - INFO - [__main__] - Loading lstm model for KAC...
2025-05-19 23:20:11,721 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:11,722 - INFO - [__main__] - Model size: 0.28 MB
2025-05-19 23:20:11,722 - INFO - [__main__] - Making predictions for KAC using lstm
2025-05-19 23:20:11,724 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:11,724 - INFO - [__main__] - Successfully got last prediction for KAC
2025-05-19 23:20:11,725 - INFO - [__main__] - 
Processing ticker: KBC
2025-05-19 23:20:11,725 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:11,725 - INFO - [__main__] - Getting last prediction point for ticker: KBC
2025-05-19 23:20:11,725 - INFO - [__main__] - ==================================================
2025-05-19 23:20:11,725 - INFO - [__main__] - Preparing test data for KBC...
2025-05-19 23:20:11,767 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:11,767 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:11,767 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:11,792 - INFO - [src.data_preparation] - Ticker KBC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:11,792 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(280), np.int64(1): np.int64(359)}
2025-05-19 23:20:12,148 - INFO - [src.data_preparation] - Ticker KBC - Selected features:
2025-05-19 23:20:12,148 - INFO - [src.data_preparation] -   Volatility: 0.0725
2025-05-19 23:20:12,148 - INFO - [src.data_preparation] -   s_d7_t: 0.0661
2025-05-19 23:20:12,148 - INFO - [src.data_preparation] -   insec_t: 0.0640
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   SK: 0.0636
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   ma14_t: 0.0628
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   TVV: 0.0617
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   HL: 0.0612
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   vnipc_t: 0.0604
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   ma21_t: 0.0587
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   ret: 0.0557
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   LO: 0.0552
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:20:12,149 - INFO - [src.data_preparation] -   PM: 0.0520
2025-05-19 23:20:12,152 - INFO - [src.data_preparation] - Ticker KBC - Using features: ['Date', 'Volatility', 's_d7_t', 'insec_t', 'SK', 'ma14_t', 'TVV', 'HL', 'vnipc_t', 'ma21_t', 'ATR', 'ret', 'LO', 'ma7_t', 'Median_HL', 'PM']
2025-05-19 23:20:12,242 - INFO - [src.data_preparation] - Ticker KBC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:12,242 - INFO - [src.data_preparation] - Ticker KBC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:12,244 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KBC
2025-05-19 23:20:12,244 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:12,244 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:20:12,244 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:20:12,248 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:20:12,248 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:20:12,253 - INFO - [src.data_preparation] - Ticker KBC - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:12,253 - INFO - [__main__] - Using best model for KBC: transformer (F1: 0.4848)
2025-05-19 23:20:12,253 - INFO - [__main__] - Loading transformer model for KBC...
2025-05-19 23:20:12,266 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:12,271 - INFO - [__main__] - Model size: 0.40 MB
2025-05-19 23:20:12,271 - INFO - [__main__] - Making predictions for KBC using transformer
2025-05-19 23:20:12,274 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:12,275 - INFO - [__main__] - Successfully got last prediction for KBC
2025-05-19 23:20:12,275 - INFO - [__main__] - 
Processing ticker: KCE
2025-05-19 23:20:12,275 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:12,275 - INFO - [__main__] - Getting last prediction point for ticker: KCE
2025-05-19 23:20:12,275 - INFO - [__main__] - ==================================================
2025-05-19 23:20:12,276 - INFO - [__main__] - Preparing test data for KCE...
2025-05-19 23:20:12,317 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:12,317 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:12,317 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:12,338 - INFO - [src.data_preparation] - Ticker KCE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:12,338 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(118), np.int64(1): np.int64(521)}
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] - Ticker KCE - Selected features:
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   vnipc_t: 0.0951
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   ma21_t: 0.0828
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   ma7_t: 0.0806
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   ma14_t: 0.0775
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   ATR: 0.0725
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   s_d7_t: 0.0699
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   TVV: 0.0671
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   SK: 0.0621
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   Median_HL: 0.0594
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   PM: 0.0578
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   Volatility: 0.0494
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   HL: 0.0433
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   insec_t: 0.0364
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   ret: 0.0357
2025-05-19 23:20:12,628 - INFO - [src.data_preparation] -   SR: 0.0341
2025-05-19 23:20:12,632 - INFO - [src.data_preparation] - Ticker KCE - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma7_t', 'ma14_t', 'ATR', 's_d7_t', 'TVV', 'SK', 'Median_HL', 'PM', 'Volatility', 'HL', 'insec_t', 'ret', 'SR']
2025-05-19 23:20:12,712 - INFO - [src.data_preparation] - Ticker KCE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:12,712 - INFO - [src.data_preparation] - Ticker KCE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:12,714 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KCE
2025-05-19 23:20:12,714 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:12,714 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(71), np.int64(1): np.int64(392)}
2025-05-19 23:20:12,714 - INFO - [src.data_preparation] - Generating 321 synthetic minority samples
2025-05-19 23:20:12,725 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (784, 13, 15), y shape: (784,)
2025-05-19 23:20:12,725 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(392), np.int64(1): np.int64(392)}
2025-05-19 23:20:12,729 - INFO - [src.data_preparation] - Ticker KCE - Final 3D shapes: X_train=(784, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:12,729 - INFO - [__main__] - Using best model for KCE: svm (F1: 0.7606)
2025-05-19 23:20:12,730 - INFO - [__main__] - Loading svm model for KCE...
2025-05-19 23:20:12,731 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:12,732 - INFO - [__main__] - Model size: 0.48 MB
2025-05-19 23:20:12,732 - INFO - [__main__] - Making predictions for KCE using svm
2025-05-19 23:20:12,732 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:12,733 - INFO - [__main__] - Successfully got last prediction for KCE
2025-05-19 23:20:12,733 - INFO - [__main__] - 
Processing ticker: KDC
2025-05-19 23:20:12,733 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:12,733 - INFO - [__main__] - Getting last prediction point for ticker: KDC
2025-05-19 23:20:12,733 - INFO - [__main__] - ==================================================
2025-05-19 23:20:12,733 - INFO - [__main__] - Preparing test data for KDC...
2025-05-19 23:20:12,760 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:12,760 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:12,760 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:12,778 - INFO - [src.data_preparation] - Ticker KDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:12,778 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(329), np.int64(1): np.int64(310)}
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] - Ticker KDC - Selected features:
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   SK: 0.0805
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   vnipc_t: 0.0736
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   Volatility: 0.0701
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   insec_t: 0.0669
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   TVV: 0.0665
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   ATR: 0.0646
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   s_d7_t: 0.0618
2025-05-19 23:20:13,092 - INFO - [src.data_preparation] -   ret: 0.0565
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   LO: 0.0562
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   SR: 0.0552
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   ma7_t: 0.0532
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   ma14_t: 0.0529
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   variation_t: 0.0507
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   HL: 0.0506
2025-05-19 23:20:13,093 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:20:13,095 - INFO - [src.data_preparation] - Ticker KDC - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'insec_t', 'TVV', 'ATR', 's_d7_t', 'ret', 'LO', 'SR', 'ma7_t', 'ma14_t', 'variation_t', 'HL', 'PM']
2025-05-19 23:20:13,175 - INFO - [src.data_preparation] - Ticker KDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:13,175 - INFO - [src.data_preparation] - Ticker KDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:13,177 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KDC
2025-05-19 23:20:13,178 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:13,178 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(225)}
2025-05-19 23:20:13,178 - INFO - [src.data_preparation] - Generating 13 synthetic minority samples
2025-05-19 23:20:13,179 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (476, 13, 15), y shape: (476,)
2025-05-19 23:20:13,179 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(238)}
2025-05-19 23:20:13,182 - INFO - [src.data_preparation] - Ticker KDC - Final 3D shapes: X_train=(476, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:13,182 - INFO - [__main__] - Using best model for KDC: logistic_regression (F1: 0.4390)
2025-05-19 23:20:13,182 - INFO - [__main__] - Loading logistic_regression model for KDC...
2025-05-19 23:20:13,183 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:13,183 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:13,183 - INFO - [__main__] - Making predictions for KDC using logistic_regression
2025-05-19 23:20:13,183 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:13,184 - INFO - [__main__] - Successfully got last prediction for KDC
2025-05-19 23:20:13,184 - INFO - [__main__] - 
Processing ticker: KDH
2025-05-19 23:20:13,184 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:13,184 - INFO - [__main__] - Getting last prediction point for ticker: KDH
2025-05-19 23:20:13,184 - INFO - [__main__] - ==================================================
2025-05-19 23:20:13,184 - INFO - [__main__] - Preparing test data for KDH...
2025-05-19 23:20:13,210 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:13,210 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:13,210 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:13,228 - INFO - [src.data_preparation] - Ticker KDH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:13,228 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:20:13,537 - INFO - [src.data_preparation] - Ticker KDH - Selected features:
2025-05-19 23:20:13,537 - INFO - [src.data_preparation] -   SK: 0.0773
2025-05-19 23:20:13,538 - INFO - [src.data_preparation] -   vnipc_t: 0.0739
2025-05-19 23:20:13,538 - INFO - [src.data_preparation] -   insec_t: 0.0720
2025-05-19 23:20:13,538 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:20:13,538 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:20:13,538 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:20:13,538 - INFO - [src.data_preparation] -   ATR: 0.0613
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   variation_t: 0.0568
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   HL: 0.0533
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   LO: 0.0529
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   SR: 0.0523
2025-05-19 23:20:13,539 - INFO - [src.data_preparation] -   ma14_t: 0.0512
2025-05-19 23:20:13,540 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:20:13,543 - INFO - [src.data_preparation] - Ticker KDH - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'TVV', 'Volatility', 's_d7_t', 'ATR', 'variation_t', 'ret', 'ma7_t', 'HL', 'LO', 'SR', 'ma14_t', 'PM']
2025-05-19 23:20:13,622 - INFO - [src.data_preparation] - Ticker KDH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:13,623 - INFO - [src.data_preparation] - Ticker KDH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:13,624 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KDH
2025-05-19 23:20:13,624 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:13,624 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(274)}
2025-05-19 23:20:13,624 - INFO - [src.data_preparation] - Generating 85 synthetic minority samples
2025-05-19 23:20:13,628 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (548, 13, 15), y shape: (548,)
2025-05-19 23:20:13,628 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(274), np.int64(1): np.int64(274)}
2025-05-19 23:20:13,630 - INFO - [src.data_preparation] - Ticker KDH - Final 3D shapes: X_train=(548, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:13,631 - INFO - [__main__] - Using best model for KDH: lstm (F1: 0.6667)
2025-05-19 23:20:13,631 - INFO - [__main__] - Loading lstm model for KDH...
2025-05-19 23:20:13,634 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:13,635 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:20:13,635 - INFO - [__main__] - Making predictions for KDH using lstm
2025-05-19 23:20:13,636 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:13,637 - INFO - [__main__] - Successfully got last prediction for KDH
2025-05-19 23:20:13,637 - INFO - [__main__] - 
Processing ticker: KHL
2025-05-19 23:20:13,637 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:13,637 - INFO - [__main__] - Getting last prediction point for ticker: KHL
2025-05-19 23:20:13,637 - INFO - [__main__] - ==================================================
2025-05-19 23:20:13,637 - INFO - [__main__] - Preparing test data for KHL...
2025-05-19 23:20:13,668 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:13,668 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:13,668 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:13,696 - INFO - [src.data_preparation] - Ticker KHL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:13,696 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(186), np.int64(1): np.int64(453)}
2025-05-19 23:20:13,939 - INFO - [src.data_preparation] - Ticker KHL - Selected features:
2025-05-19 23:20:13,939 - INFO - [src.data_preparation] -   vnipc_t: 0.0990
2025-05-19 23:20:13,939 - INFO - [src.data_preparation] -   ma21_t: 0.0821
2025-05-19 23:20:13,939 - INFO - [src.data_preparation] -   TVV: 0.0809
2025-05-19 23:20:13,939 - INFO - [src.data_preparation] -   ma14_t: 0.0776
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   insec_t: 0.0725
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   ma7_t: 0.0678
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   s_d7_t: 0.0593
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   SK: 0.0586
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   Median_HL: 0.0576
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   PM: 0.0552
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   ATR: 0.0455
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   variation_t: 0.0412
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   ret: 0.0410
2025-05-19 23:20:13,940 - INFO - [src.data_preparation] -   SR: 0.0261
2025-05-19 23:20:13,942 - INFO - [src.data_preparation] - Ticker KHL - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ma14_t', 'insec_t', 'ma7_t', 'Volatility', 's_d7_t', 'SK', 'Median_HL', 'PM', 'ATR', 'variation_t', 'ret', 'SR']
2025-05-19 23:20:14,035 - INFO - [src.data_preparation] - Ticker KHL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:14,036 - INFO - [src.data_preparation] - Ticker KHL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:14,037 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KHL
2025-05-19 23:20:14,037 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:14,037 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(145), np.int64(1): np.int64(318)}
2025-05-19 23:20:14,037 - INFO - [src.data_preparation] - Generating 173 synthetic minority samples
2025-05-19 23:20:14,044 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (636, 13, 15), y shape: (636,)
2025-05-19 23:20:14,044 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(318), np.int64(1): np.int64(318)}
2025-05-19 23:20:14,048 - INFO - [src.data_preparation] - Ticker KHL - Final 3D shapes: X_train=(636, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:14,048 - INFO - [__main__] - Using best model for KHL: lstm (F1: 0.9885)
2025-05-19 23:20:14,048 - INFO - [__main__] - Loading lstm model for KHL...
2025-05-19 23:20:14,052 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:14,053 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:20:14,053 - INFO - [__main__] - Making predictions for KHL using lstm
2025-05-19 23:20:14,058 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:14,058 - INFO - [__main__] - Successfully got last prediction for KHL
2025-05-19 23:20:14,058 - INFO - [__main__] - 
Processing ticker: KHP
2025-05-19 23:20:14,059 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:14,059 - INFO - [__main__] - Getting last prediction point for ticker: KHP
2025-05-19 23:20:14,059 - INFO - [__main__] - ==================================================
2025-05-19 23:20:14,059 - INFO - [__main__] - Preparing test data for KHP...
2025-05-19 23:20:14,102 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:14,103 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:14,103 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:14,124 - INFO - [src.data_preparation] - Ticker KHP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:14,124 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(293), np.int64(1): np.int64(346)}
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] - Ticker KHP - Selected features:
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   insec_t: 0.0731
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   vnipc_t: 0.0731
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   SK: 0.0678
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   s_d7_t: 0.0630
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   TVV: 0.0616
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   HL: 0.0609
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:20:14,477 - INFO - [src.data_preparation] -   ma14_t: 0.0582
2025-05-19 23:20:14,478 - INFO - [src.data_preparation] -   variation_t: 0.0562
2025-05-19 23:20:14,478 - INFO - [src.data_preparation] -   ma21_t: 0.0555
2025-05-19 23:20:14,478 - INFO - [src.data_preparation] -   ret: 0.0534
2025-05-19 23:20:14,478 - INFO - [src.data_preparation] -   LO: 0.0527
2025-05-19 23:20:14,478 - INFO - [src.data_preparation] -   SR: 0.0525
2025-05-19 23:20:14,478 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:20:14,481 - INFO - [src.data_preparation] - Ticker KHP - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 's_d7_t', 'Volatility', 'TVV', 'HL', 'ATR', 'ma14_t', 'variation_t', 'ma21_t', 'ret', 'LO', 'SR', 'PM']
2025-05-19 23:20:14,601 - INFO - [src.data_preparation] - Ticker KHP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:14,601 - INFO - [src.data_preparation] - Ticker KHP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:14,603 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KHP
2025-05-19 23:20:14,603 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:14,603 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:20:14,603 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:20:14,606 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:20:14,606 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:20:14,610 - INFO - [src.data_preparation] - Ticker KHP - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:14,610 - INFO - [__main__] - Using best model for KHP: transformer (F1: 0.5455)
2025-05-19 23:20:14,610 - INFO - [__main__] - Loading transformer model for KHP...
2025-05-19 23:20:14,620 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:14,622 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:20:14,622 - INFO - [__main__] - Making predictions for KHP using transformer
2025-05-19 23:20:14,623 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:14,624 - INFO - [__main__] - Successfully got last prediction for KHP
2025-05-19 23:20:14,624 - INFO - [__main__] - 
Processing ticker: KKC
2025-05-19 23:20:14,624 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:14,624 - INFO - [__main__] - Getting last prediction point for ticker: KKC
2025-05-19 23:20:14,624 - INFO - [__main__] - ==================================================
2025-05-19 23:20:14,625 - INFO - [__main__] - Preparing test data for KKC...
2025-05-19 23:20:14,662 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:14,662 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:14,662 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:14,689 - INFO - [src.data_preparation] - Ticker KKC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:14,689 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(267), np.int64(1): np.int64(372)}
2025-05-19 23:20:15,004 - INFO - [src.data_preparation] - Ticker KKC - Selected features:
2025-05-19 23:20:15,004 - INFO - [src.data_preparation] -   vnipc_t: 0.0767
2025-05-19 23:20:15,004 - INFO - [src.data_preparation] -   SK: 0.0694
2025-05-19 23:20:15,004 - INFO - [src.data_preparation] -   ma14_t: 0.0669
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   Volatility: 0.0653
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   ATR: 0.0638
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   TVV: 0.0633
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   s_d7_t: 0.0630
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   ret: 0.0547
2025-05-19 23:20:15,005 - INFO - [src.data_preparation] -   insec_t: 0.0546
2025-05-19 23:20:15,006 - INFO - [src.data_preparation] -   PM: 0.0527
2025-05-19 23:20:15,006 - INFO - [src.data_preparation] -   Median_HL: 0.0524
2025-05-19 23:20:15,006 - INFO - [src.data_preparation] -   HL: 0.0523
2025-05-19 23:20:15,006 - INFO - [src.data_preparation] -   variation_t: 0.0523
2025-05-19 23:20:15,009 - INFO - [src.data_preparation] - Ticker KKC - Using features: ['Date', 'vnipc_t', 'SK', 'ma14_t', 'Volatility', 'ATR', 'TVV', 's_d7_t', 'ma21_t', 'ma7_t', 'ret', 'insec_t', 'PM', 'Median_HL', 'HL', 'variation_t']
2025-05-19 23:20:15,093 - INFO - [src.data_preparation] - Ticker KKC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:15,093 - INFO - [src.data_preparation] - Ticker KKC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:15,095 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KKC
2025-05-19 23:20:15,095 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:15,095 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:20:15,095 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:20:15,099 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:20:15,099 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:20:15,102 - INFO - [src.data_preparation] - Ticker KKC - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:15,103 - INFO - [__main__] - Using best model for KKC: lstm (F1: 0.7246)
2025-05-19 23:20:15,103 - INFO - [__main__] - Loading lstm model for KKC...
2025-05-19 23:20:15,107 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:15,109 - INFO - [__main__] - Model size: 0.45 MB
2025-05-19 23:20:15,109 - INFO - [__main__] - Making predictions for KKC using lstm
2025-05-19 23:20:15,113 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:15,113 - INFO - [__main__] - Successfully got last prediction for KKC
2025-05-19 23:20:15,113 - INFO - [__main__] - 
Processing ticker: KMR
2025-05-19 23:20:15,113 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:15,113 - INFO - [__main__] - Getting last prediction point for ticker: KMR
2025-05-19 23:20:15,114 - INFO - [__main__] - ==================================================
2025-05-19 23:20:15,114 - INFO - [__main__] - Preparing test data for KMR...
2025-05-19 23:20:15,143 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:15,143 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:15,143 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:15,162 - INFO - [src.data_preparation] - Ticker KMR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:15,162 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(325), np.int64(1): np.int64(314)}
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] - Ticker KMR - Selected features:
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   SK: 0.0822
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   vnipc_t: 0.0715
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   s_d7_t: 0.0713
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   Volatility: 0.0675
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   TVV: 0.0672
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   insec_t: 0.0654
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   ATR: 0.0608
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   variation_t: 0.0577
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   ma21_t: 0.0557
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   SR: 0.0551
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   Median_HL: 0.0533
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   ma14_t: 0.0502
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   PM: 0.0482
2025-05-19 23:20:15,495 - INFO - [src.data_preparation] -   ma7_t: 0.0476
2025-05-19 23:20:15,499 - INFO - [src.data_preparation] - Ticker KMR - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'Volatility', 'TVV', 'insec_t', 'ATR', 'variation_t', 'ma21_t', 'SR', 'ret', 'Median_HL', 'ma14_t', 'PM', 'ma7_t']
2025-05-19 23:20:15,588 - INFO - [src.data_preparation] - Ticker KMR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:15,588 - INFO - [src.data_preparation] - Ticker KMR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:15,589 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KMR
2025-05-19 23:20:15,590 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:15,590 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(230), np.int64(1): np.int64(233)}
2025-05-19 23:20:15,590 - INFO - [src.data_preparation] - Generating 3 synthetic minority samples
2025-05-19 23:20:15,590 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (466, 13, 15), y shape: (466,)
2025-05-19 23:20:15,590 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(233)}
2025-05-19 23:20:15,592 - INFO - [src.data_preparation] - Ticker KMR - Final 3D shapes: X_train=(466, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:15,592 - INFO - [__main__] - Using best model for KMR: logistic_regression (F1: 0.4242)
2025-05-19 23:20:15,593 - INFO - [__main__] - Loading logistic_regression model for KMR...
2025-05-19 23:20:15,593 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:15,593 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:15,593 - INFO - [__main__] - Making predictions for KMR using logistic_regression
2025-05-19 23:20:15,594 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:15,594 - INFO - [__main__] - Successfully got last prediction for KMR
2025-05-19 23:20:15,594 - INFO - [__main__] - 
Processing ticker: KMT
2025-05-19 23:20:15,594 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:15,594 - INFO - [__main__] - Getting last prediction point for ticker: KMT
2025-05-19 23:20:15,594 - INFO - [__main__] - ==================================================
2025-05-19 23:20:15,594 - INFO - [__main__] - Preparing test data for KMT...
2025-05-19 23:20:15,620 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:15,620 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:15,620 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:15,638 - INFO - [src.data_preparation] - Ticker KMT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:15,639 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(114), np.int64(1): np.int64(525)}
2025-05-19 23:20:15,875 - INFO - [src.data_preparation] - Ticker KMT - Selected features:
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   vnipc_t: 0.0951
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   ma21_t: 0.0879
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   ma14_t: 0.0793
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   ma7_t: 0.0750
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   TVV: 0.0746
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   s_d7_t: 0.0646
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   ATR: 0.0628
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   Volatility: 0.0597
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   PM: 0.0568
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   Median_HL: 0.0567
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   SK: 0.0554
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   HL: 0.0503
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   insec_t: 0.0487
2025-05-19 23:20:15,876 - INFO - [src.data_preparation] -   SR: 0.0317
2025-05-19 23:20:15,877 - INFO - [src.data_preparation] -   variation_t: 0.0309
2025-05-19 23:20:15,879 - INFO - [src.data_preparation] - Ticker KMT - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'TVV', 's_d7_t', 'ATR', 'Volatility', 'PM', 'Median_HL', 'SK', 'HL', 'insec_t', 'SR', 'variation_t']
2025-05-19 23:20:15,964 - INFO - [src.data_preparation] - Ticker KMT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:15,964 - INFO - [src.data_preparation] - Ticker KMT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:15,966 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KMT
2025-05-19 23:20:15,966 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:15,966 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(76), np.int64(1): np.int64(387)}
2025-05-19 23:20:15,966 - INFO - [src.data_preparation] - Generating 311 synthetic minority samples
2025-05-19 23:20:15,977 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (774, 13, 15), y shape: (774,)
2025-05-19 23:20:15,977 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(387), np.int64(1): np.int64(387)}
2025-05-19 23:20:15,982 - INFO - [src.data_preparation] - Ticker KMT - Final 3D shapes: X_train=(774, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:15,982 - INFO - [__main__] - Using best model for KMT: svm (F1: 0.9524)
2025-05-19 23:20:15,982 - INFO - [__main__] - Loading svm model for KMT...
2025-05-19 23:20:15,983 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:15,984 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:20:15,984 - INFO - [__main__] - Making predictions for KMT using svm
2025-05-19 23:20:15,984 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:15,985 - INFO - [__main__] - Successfully got last prediction for KMT
2025-05-19 23:20:15,985 - INFO - [__main__] - 
Processing ticker: KSB
2025-05-19 23:20:15,985 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:15,985 - INFO - [__main__] - Getting last prediction point for ticker: KSB
2025-05-19 23:20:15,985 - INFO - [__main__] - ==================================================
2025-05-19 23:20:15,985 - INFO - [__main__] - Preparing test data for KSB...
2025-05-19 23:20:16,013 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:16,013 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:16,013 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:16,031 - INFO - [src.data_preparation] - Ticker KSB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:16,031 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] - Ticker KSB - Selected features:
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   TVV: 0.0719
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   Volatility: 0.0700
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   s_d7_t: 0.0695
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   insec_t: 0.0665
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   vnipc_t: 0.0648
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   HL: 0.0594
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   LO: 0.0590
2025-05-19 23:20:16,323 - INFO - [src.data_preparation] -   ATR: 0.0561
2025-05-19 23:20:16,324 - INFO - [src.data_preparation] -   ret: 0.0545
2025-05-19 23:20:16,324 - INFO - [src.data_preparation] -   ma21_t: 0.0543
2025-05-19 23:20:16,324 - INFO - [src.data_preparation] -   PM: 0.0517
2025-05-19 23:20:16,324 - INFO - [src.data_preparation] -   variation_t: 0.0510
2025-05-19 23:20:16,324 - INFO - [src.data_preparation] -   ma14_t: 0.0500
2025-05-19 23:20:16,324 - INFO - [src.data_preparation] -   ma7_t: 0.0495
2025-05-19 23:20:16,326 - INFO - [src.data_preparation] - Ticker KSB - Using features: ['Date', 'TVV', 'Volatility', 's_d7_t', 'insec_t', 'SK', 'vnipc_t', 'HL', 'LO', 'ATR', 'ret', 'ma21_t', 'PM', 'variation_t', 'ma14_t', 'ma7_t']
2025-05-19 23:20:16,406 - INFO - [src.data_preparation] - Ticker KSB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:16,406 - INFO - [src.data_preparation] - Ticker KSB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:16,407 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KSB
2025-05-19 23:20:16,407 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:16,407 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:20:16,407 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:20:16,409 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:20:16,409 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:20:16,411 - INFO - [src.data_preparation] - Ticker KSB - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:16,411 - INFO - [__main__] - Using best model for KSB: lstm (F1: 0.3333)
2025-05-19 23:20:16,411 - INFO - [__main__] - Loading lstm model for KSB...
2025-05-19 23:20:16,416 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:16,417 - INFO - [__main__] - Model size: 0.38 MB
2025-05-19 23:20:16,417 - INFO - [__main__] - Making predictions for KSB using lstm
2025-05-19 23:20:16,421 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:16,421 - INFO - [__main__] - Successfully got last prediction for KSB
2025-05-19 23:20:16,421 - INFO - [__main__] - 
Processing ticker: KSD
2025-05-19 23:20:16,421 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:16,422 - INFO - [__main__] - Getting last prediction point for ticker: KSD
2025-05-19 23:20:16,422 - INFO - [__main__] - ==================================================
2025-05-19 23:20:16,422 - INFO - [__main__] - Preparing test data for KSD...
2025-05-19 23:20:16,468 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:16,468 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:16,468 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:16,489 - INFO - [src.data_preparation] - Ticker KSD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:16,489 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(247), np.int64(1): np.int64(392)}
2025-05-19 23:20:16,809 - INFO - [src.data_preparation] - Ticker KSD - Selected features:
2025-05-19 23:20:16,809 - INFO - [src.data_preparation] -   vnipc_t: 0.0969
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   TVV: 0.0738
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   insec_t: 0.0705
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   s_d7_t: 0.0685
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   SK: 0.0647
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   ma21_t: 0.0642
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   ma7_t: 0.0623
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   ma14_t: 0.0588
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   ret: 0.0508
2025-05-19 23:20:16,810 - INFO - [src.data_preparation] -   variation_t: 0.0473
2025-05-19 23:20:16,811 - INFO - [src.data_preparation] -   HL: 0.0369
2025-05-19 23:20:16,814 - INFO - [src.data_preparation] - Ticker KSD - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 's_d7_t', 'SK', 'ma21_t', 'ma7_t', 'ATR', 'ma14_t', 'Median_HL', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:16,906 - INFO - [src.data_preparation] - Ticker KSD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:16,906 - INFO - [src.data_preparation] - Ticker KSD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:16,907 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KSD
2025-05-19 23:20:16,908 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:16,908 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(170), np.int64(1): np.int64(293)}
2025-05-19 23:20:16,908 - INFO - [src.data_preparation] - Generating 123 synthetic minority samples
2025-05-19 23:20:16,913 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (586, 13, 15), y shape: (586,)
2025-05-19 23:20:16,913 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(293), np.int64(1): np.int64(293)}
2025-05-19 23:20:16,916 - INFO - [src.data_preparation] - Ticker KSD - Final 3D shapes: X_train=(586, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:16,917 - INFO - [__main__] - Using best model for KSD: svm (F1: 0.7606)
2025-05-19 23:20:16,917 - INFO - [__main__] - Loading svm model for KSD...
2025-05-19 23:20:16,918 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:16,919 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:20:16,919 - INFO - [__main__] - Making predictions for KSD using svm
2025-05-19 23:20:16,919 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:16,920 - INFO - [__main__] - Successfully got last prediction for KSD
2025-05-19 23:20:16,920 - INFO - [__main__] - 
Processing ticker: KSH
2025-05-19 23:20:16,920 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:16,920 - INFO - [__main__] - Getting last prediction point for ticker: KSH
2025-05-19 23:20:16,920 - INFO - [__main__] - ==================================================
2025-05-19 23:20:16,920 - INFO - [__main__] - Preparing test data for KSH...
2025-05-19 23:20:16,948 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:16,948 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:16,948 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:16,966 - INFO - [src.data_preparation] - Ticker KSH - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:16,967 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(360)}
2025-05-19 23:20:17,240 - INFO - [src.data_preparation] - Ticker KSH - Selected features:
2025-05-19 23:20:17,240 - INFO - [src.data_preparation] -   vnipc_t: 0.0792
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   insec_t: 0.0747
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   ma7_t: 0.0674
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   Median_HL: 0.0661
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   TVV: 0.0644
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   PM: 0.0626
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   ma21_t: 0.0621
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   ma14_t: 0.0605
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   Volatility: 0.0586
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   ATR: 0.0534
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   HL: 0.0498
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   ret: 0.0445
2025-05-19 23:20:17,241 - INFO - [src.data_preparation] -   variation_t: 0.0411
2025-05-19 23:20:17,244 - INFO - [src.data_preparation] - Ticker KSH - Using features: ['Date', 'vnipc_t', 'insec_t', 'ma7_t', 'Median_HL', 'TVV', 'SK', 'PM', 'ma21_t', 's_d7_t', 'ma14_t', 'Volatility', 'ATR', 'HL', 'ret', 'variation_t']
2025-05-19 23:20:17,324 - INFO - [src.data_preparation] - Ticker KSH - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:17,324 - INFO - [src.data_preparation] - Ticker KSH - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:17,325 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KSH
2025-05-19 23:20:17,325 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:20:17,326 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(230), np.int64(1): np.int64(232)}
2025-05-19 23:20:17,326 - INFO - [src.data_preparation] - Generating 2 synthetic minority samples
2025-05-19 23:20:17,327 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:20:17,327 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:20:17,329 - INFO - [src.data_preparation] - Ticker KSH - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:17,330 - INFO - [__main__] - Using best model for KSH: lstm (F1: 0.9885)
2025-05-19 23:20:17,330 - INFO - [__main__] - Loading lstm model for KSH...
2025-05-19 23:20:17,333 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:17,334 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:20:17,334 - INFO - [__main__] - Making predictions for KSH using lstm
2025-05-19 23:20:17,335 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:17,335 - INFO - [__main__] - Successfully got last prediction for KSH
2025-05-19 23:20:17,335 - INFO - [__main__] - 
Processing ticker: KST
2025-05-19 23:20:17,335 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:17,335 - INFO - [__main__] - Getting last prediction point for ticker: KST
2025-05-19 23:20:17,337 - INFO - [__main__] - ==================================================
2025-05-19 23:20:17,337 - INFO - [__main__] - Preparing test data for KST...
2025-05-19 23:20:17,367 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:17,367 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:17,368 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:17,400 - INFO - [src.data_preparation] - Ticker KST - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:17,400 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(160), np.int64(1): np.int64(479)}
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] - Ticker KST - Selected features:
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   TVV: 0.0876
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   ATR: 0.0801
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   s_d7_t: 0.0742
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   ma21_t: 0.0730
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   vnipc_t: 0.0720
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   ma7_t: 0.0673
2025-05-19 23:20:17,703 - INFO - [src.data_preparation] -   ma14_t: 0.0639
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   Median_HL: 0.0628
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   SK: 0.0620
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   PM: 0.0614
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   insec_t: 0.0456
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   ret: 0.0400
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   variation_t: 0.0387
2025-05-19 23:20:17,705 - INFO - [src.data_preparation] -   HL: 0.0373
2025-05-19 23:20:17,707 - INFO - [src.data_preparation] - Ticker KST - Using features: ['Date', 'TVV', 'ATR', 's_d7_t', 'ma21_t', 'vnipc_t', 'ma7_t', 'ma14_t', 'Volatility', 'Median_HL', 'SK', 'PM', 'insec_t', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:17,786 - INFO - [src.data_preparation] - Ticker KST - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:17,787 - INFO - [src.data_preparation] - Ticker KST - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:17,788 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KST
2025-05-19 23:20:17,788 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:17,788 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(106), np.int64(1): np.int64(357)}
2025-05-19 23:20:17,788 - INFO - [src.data_preparation] - Generating 251 synthetic minority samples
2025-05-19 23:20:17,797 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (714, 13, 15), y shape: (714,)
2025-05-19 23:20:17,797 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(357), np.int64(1): np.int64(357)}
2025-05-19 23:20:17,802 - INFO - [src.data_preparation] - Ticker KST - Final 3D shapes: X_train=(714, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:17,802 - INFO - [__main__] - Using best model for KST: svm (F1: 0.6207)
2025-05-19 23:20:17,802 - INFO - [__main__] - Loading svm model for KST...
2025-05-19 23:20:17,803 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:17,803 - INFO - [__main__] - Model size: 0.50 MB
2025-05-19 23:20:17,803 - INFO - [__main__] - Making predictions for KST using svm
2025-05-19 23:20:17,805 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:17,805 - INFO - [__main__] - Successfully got last prediction for KST
2025-05-19 23:20:17,806 - INFO - [__main__] - 
Processing ticker: KTS
2025-05-19 23:20:17,806 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:17,806 - INFO - [__main__] - Getting last prediction point for ticker: KTS
2025-05-19 23:20:17,806 - INFO - [__main__] - ==================================================
2025-05-19 23:20:17,806 - INFO - [__main__] - Preparing test data for KTS...
2025-05-19 23:20:17,837 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:17,837 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:17,837 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:17,855 - INFO - [src.data_preparation] - Ticker KTS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:17,855 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] - Ticker KTS - Selected features:
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   vnipc_t: 0.0718
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   ATR: 0.0705
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   ma21_t: 0.0646
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   SK: 0.0643
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   TVV: 0.0589
2025-05-19 23:20:18,145 - INFO - [src.data_preparation] -   ma14_t: 0.0586
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   HL: 0.0551
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   insec_t: 0.0540
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   SR: 0.0531
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   variation_t: 0.0530
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   ret: 0.0512
2025-05-19 23:20:18,147 - INFO - [src.data_preparation] -   LO: 0.0512
2025-05-19 23:20:18,149 - INFO - [src.data_preparation] - Ticker KTS - Using features: ['Date', 'vnipc_t', 'ATR', 'ma21_t', 'SK', 'Volatility', 's_d7_t', 'TVV', 'ma14_t', 'HL', 'ma7_t', 'insec_t', 'SR', 'variation_t', 'ret', 'LO']
2025-05-19 23:20:18,229 - INFO - [src.data_preparation] - Ticker KTS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:18,229 - INFO - [src.data_preparation] - Ticker KTS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:18,231 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KTS
2025-05-19 23:20:18,231 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:18,231 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:20:18,231 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:20:18,233 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:20:18,233 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:20:18,235 - INFO - [src.data_preparation] - Ticker KTS - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:18,235 - INFO - [__main__] - Using best model for KTS: logistic_regression (F1: 0.6866)
2025-05-19 23:20:18,235 - INFO - [__main__] - Loading logistic_regression model for KTS...
2025-05-19 23:20:18,237 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:18,237 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:18,237 - INFO - [__main__] - Making predictions for KTS using logistic_regression
2025-05-19 23:20:18,238 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:18,238 - INFO - [__main__] - Successfully got last prediction for KTS
2025-05-19 23:20:18,238 - INFO - [__main__] - 
Processing ticker: KTT
2025-05-19 23:20:18,238 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:18,238 - INFO - [__main__] - Getting last prediction point for ticker: KTT
2025-05-19 23:20:18,238 - INFO - [__main__] - ==================================================
2025-05-19 23:20:18,238 - INFO - [__main__] - Preparing test data for KTT...
2025-05-19 23:20:18,263 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:20:18,263 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:18,265 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:18,283 - INFO - [src.data_preparation] - Ticker KTT - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:20:18,283 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(211), np.int64(1): np.int64(426)}
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] - Ticker KTT - Selected features:
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   vnipc_t: 0.0844
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   TVV: 0.0789
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   ma21_t: 0.0755
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   ma14_t: 0.0706
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   Volatility: 0.0702
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   SK: 0.0675
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   ma7_t: 0.0663
2025-05-19 23:20:18,592 - INFO - [src.data_preparation] -   PM: 0.0635
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   s_d7_t: 0.0590
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   insec_t: 0.0587
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   ATR: 0.0583
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   Median_HL: 0.0577
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   variation_t: 0.0449
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   ret: 0.0437
2025-05-19 23:20:18,593 - INFO - [src.data_preparation] -   HL: 0.0421
2025-05-19 23:20:18,595 - INFO - [src.data_preparation] - Ticker KTT - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'Volatility', 'SK', 'ma7_t', 'PM', 's_d7_t', 'insec_t', 'ATR', 'Median_HL', 'variation_t', 'ret', 'HL']
2025-05-19 23:20:18,678 - INFO - [src.data_preparation] - Ticker KTT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(43, 195)
2025-05-19 23:20:18,678 - INFO - [src.data_preparation] - Ticker KTT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(43, 13, 15)
2025-05-19 23:20:18,679 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker KTT
2025-05-19 23:20:18,679 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:18,679 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(140), np.int64(1): np.int64(323)}
2025-05-19 23:20:18,679 - INFO - [src.data_preparation] - Generating 183 synthetic minority samples
2025-05-19 23:20:18,686 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (646, 13, 15), y shape: (646,)
2025-05-19 23:20:18,687 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(323), np.int64(1): np.int64(323)}
2025-05-19 23:20:18,691 - INFO - [src.data_preparation] - Ticker KTT - Final 3D shapes: X_train=(646, 13, 15), X_valid=(90, 13, 15), X_test=(43, 13, 15)
2025-05-19 23:20:18,691 - INFO - [__main__] - Using best model for KTT: lstm (F1: 0.9091)
2025-05-19 23:20:18,691 - INFO - [__main__] - Loading lstm model for KTT...
2025-05-19 23:20:18,694 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:18,695 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:20:18,695 - INFO - [__main__] - Making predictions for KTT using lstm
2025-05-19 23:20:18,699 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:18,699 - INFO - [__main__] - Successfully got last prediction for KTT
2025-05-19 23:20:18,699 - INFO - [__main__] - 
Processing ticker: L10
2025-05-19 23:20:18,699 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:18,699 - INFO - [__main__] - Getting last prediction point for ticker: L10
2025-05-19 23:20:18,699 - INFO - [__main__] - ==================================================
2025-05-19 23:20:18,700 - INFO - [__main__] - Preparing test data for L10...
2025-05-19 23:20:18,744 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:18,745 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:18,745 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:18,764 - INFO - [src.data_preparation] - Ticker L10 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:18,765 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(240), np.int64(1): np.int64(399)}
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] - Ticker L10 - Selected features:
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   vnipc_t: 0.0745
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   s_d7_t: 0.0694
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   TVV: 0.0682
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   ATR: 0.0672
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   SK: 0.0623
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   ma21_t: 0.0621
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   ma14_t: 0.0591
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   ma7_t: 0.0582
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   PM: 0.0577
2025-05-19 23:20:19,156 - INFO - [src.data_preparation] -   insec_t: 0.0556
2025-05-19 23:20:19,157 - INFO - [src.data_preparation] -   Median_HL: 0.0538
2025-05-19 23:20:19,157 - INFO - [src.data_preparation] -   SR: 0.0526
2025-05-19 23:20:19,157 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:20:19,157 - INFO - [src.data_preparation] -   variation_t: 0.0509
2025-05-19 23:20:19,159 - INFO - [src.data_preparation] - Ticker L10 - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'ATR', 'SK', 'ma21_t', 'Volatility', 'ma14_t', 'ma7_t', 'PM', 'insec_t', 'Median_HL', 'SR', 'ret', 'variation_t']
2025-05-19 23:20:19,267 - INFO - [src.data_preparation] - Ticker L10 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:19,267 - INFO - [src.data_preparation] - Ticker L10 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:19,269 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L10
2025-05-19 23:20:19,269 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:19,270 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(181), np.int64(1): np.int64(282)}
2025-05-19 23:20:19,270 - INFO - [src.data_preparation] - Generating 101 synthetic minority samples
2025-05-19 23:20:19,277 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:20:19,277 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:20:19,281 - INFO - [src.data_preparation] - Ticker L10 - Final 3D shapes: X_train=(564, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:19,281 - INFO - [__main__] - Using best model for L10: svm (F1: 0.7429)
2025-05-19 23:20:19,281 - INFO - [__main__] - Loading svm model for L10...
2025-05-19 23:20:19,282 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:19,283 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:20:19,283 - INFO - [__main__] - Making predictions for L10 using svm
2025-05-19 23:20:19,284 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:19,284 - INFO - [__main__] - Successfully got last prediction for L10
2025-05-19 23:20:19,284 - INFO - [__main__] - 
Processing ticker: L14
2025-05-19 23:20:19,284 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:19,284 - INFO - [__main__] - Getting last prediction point for ticker: L14
2025-05-19 23:20:19,284 - INFO - [__main__] - ==================================================
2025-05-19 23:20:19,284 - INFO - [__main__] - Preparing test data for L14...
2025-05-19 23:20:19,320 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:19,320 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:19,320 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:19,340 - INFO - [src.data_preparation] - Ticker L14 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:19,340 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(310), np.int64(1): np.int64(329)}
2025-05-19 23:20:19,651 - INFO - [src.data_preparation] - Ticker L14 - Selected features:
2025-05-19 23:20:19,651 - INFO - [src.data_preparation] -   vnipc_t: 0.0759
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   s_d7_t: 0.0734
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   SK: 0.0697
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   ATR: 0.0633
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   TVV: 0.0604
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   insec_t: 0.0602
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   Median_HL: 0.0567
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   HL: 0.0552
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   ma14_t: 0.0545
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   ma7_t: 0.0526
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   LO: 0.0519
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   ma21_t: 0.0518
2025-05-19 23:20:19,652 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:20:19,656 - INFO - [src.data_preparation] - Ticker L14 - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'Volatility', 'ATR', 'TVV', 'insec_t', 'Median_HL', 'HL', 'PM', 'ma14_t', 'ma7_t', 'LO', 'ma21_t', 'ret']
2025-05-19 23:20:19,738 - INFO - [src.data_preparation] - Ticker L14 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:19,738 - INFO - [src.data_preparation] - Ticker L14 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:19,741 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L14
2025-05-19 23:20:19,741 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:19,741 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(214), np.int64(1): np.int64(249)}
2025-05-19 23:20:19,741 - INFO - [src.data_preparation] - Generating 35 synthetic minority samples
2025-05-19 23:20:19,743 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (498, 13, 15), y shape: (498,)
2025-05-19 23:20:19,743 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(249), np.int64(1): np.int64(249)}
2025-05-19 23:20:19,746 - INFO - [src.data_preparation] - Ticker L14 - Final 3D shapes: X_train=(498, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:19,746 - INFO - [__main__] - Using best model for L14: lstm (F1: 0.6829)
2025-05-19 23:20:19,746 - INFO - [__main__] - Loading lstm model for L14...
2025-05-19 23:20:19,749 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:19,750 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:20:19,751 - INFO - [__main__] - Making predictions for L14 using lstm
2025-05-19 23:20:19,752 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:19,752 - INFO - [__main__] - Successfully got last prediction for L14
2025-05-19 23:20:19,752 - INFO - [__main__] - 
Processing ticker: L18
2025-05-19 23:20:19,752 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:19,752 - INFO - [__main__] - Getting last prediction point for ticker: L18
2025-05-19 23:20:19,752 - INFO - [__main__] - ==================================================
2025-05-19 23:20:19,753 - INFO - [__main__] - Preparing test data for L18...
2025-05-19 23:20:19,797 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:19,797 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:19,797 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:19,823 - INFO - [src.data_preparation] - Ticker L18 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:19,823 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(222), np.int64(1): np.int64(417)}
2025-05-19 23:20:20,134 - INFO - [src.data_preparation] - Ticker L18 - Selected features:
2025-05-19 23:20:20,134 - INFO - [src.data_preparation] -   SK: 0.0716
2025-05-19 23:20:20,134 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:20:20,134 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:20:20,134 - INFO - [src.data_preparation] -   ma14_t: 0.0686
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   TVV: 0.0651
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   PM: 0.0646
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   ATR: 0.0625
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   Median_HL: 0.0613
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   ma21_t: 0.0611
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   insec_t: 0.0569
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   ma7_t: 0.0560
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   HL: 0.0511
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   LO: 0.0467
2025-05-19 23:20:20,135 - INFO - [src.data_preparation] -   ret: 0.0454
2025-05-19 23:20:20,138 - INFO - [src.data_preparation] - Ticker L18 - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'ma14_t', 'TVV', 'PM', 'ATR', 'Median_HL', 'ma21_t', 's_d7_t', 'insec_t', 'ma7_t', 'HL', 'LO', 'ret']
2025-05-19 23:20:20,222 - INFO - [src.data_preparation] - Ticker L18 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:20,222 - INFO - [src.data_preparation] - Ticker L18 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:20,224 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L18
2025-05-19 23:20:20,224 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:20,224 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(139), np.int64(1): np.int64(324)}
2025-05-19 23:20:20,224 - INFO - [src.data_preparation] - Generating 185 synthetic minority samples
2025-05-19 23:20:20,231 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (648, 13, 15), y shape: (648,)
2025-05-19 23:20:20,231 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(324), np.int64(1): np.int64(324)}
2025-05-19 23:20:20,234 - INFO - [src.data_preparation] - Ticker L18 - Final 3D shapes: X_train=(648, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:20,234 - INFO - [__main__] - Using best model for L18: logistic_regression (F1: 0.4500)
2025-05-19 23:20:20,235 - INFO - [__main__] - Loading logistic_regression model for L18...
2025-05-19 23:20:20,236 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:20,236 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:20,236 - INFO - [__main__] - Making predictions for L18 using logistic_regression
2025-05-19 23:20:20,236 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:20,237 - INFO - [__main__] - Successfully got last prediction for L18
2025-05-19 23:20:20,237 - INFO - [__main__] - 
Processing ticker: L35
2025-05-19 23:20:20,237 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:20,237 - INFO - [__main__] - Getting last prediction point for ticker: L35
2025-05-19 23:20:20,237 - INFO - [__main__] - ==================================================
2025-05-19 23:20:20,237 - INFO - [__main__] - Preparing test data for L35...
2025-05-19 23:20:20,264 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:20,264 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:20,264 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:20,285 - INFO - [src.data_preparation] - Ticker L35 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:20,287 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(203), np.int64(1): np.int64(435)}
2025-05-19 23:20:20,560 - INFO - [src.data_preparation] - Ticker L35 - Selected features:
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   vnipc_t: 0.0875
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   TVV: 0.0851
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   Volatility: 0.0704
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   s_d7_t: 0.0694
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   ma14_t: 0.0692
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   ATR: 0.0655
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   ma7_t: 0.0604
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   ma21_t: 0.0595
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   SK: 0.0583
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   insec_t: 0.0574
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   Median_HL: 0.0514
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   ret: 0.0508
2025-05-19 23:20:20,561 - INFO - [src.data_preparation] -   variation_t: 0.0505
2025-05-19 23:20:20,562 - INFO - [src.data_preparation] -   HL: 0.0396
2025-05-19 23:20:20,564 - INFO - [src.data_preparation] - Ticker L35 - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'ma14_t', 'ATR', 'ma7_t', 'ma21_t', 'SK', 'PM', 'insec_t', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:20,644 - INFO - [src.data_preparation] - Ticker L35 - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:20:20,644 - INFO - [src.data_preparation] - Ticker L35 - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:20,646 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L35
2025-05-19 23:20:20,646 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:20,646 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(142), np.int64(1): np.int64(321)}
2025-05-19 23:20:20,646 - INFO - [src.data_preparation] - Generating 179 synthetic minority samples
2025-05-19 23:20:20,654 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (642, 13, 15), y shape: (642,)
2025-05-19 23:20:20,654 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(321), np.int64(1): np.int64(321)}
2025-05-19 23:20:20,657 - INFO - [src.data_preparation] - Ticker L35 - Final 3D shapes: X_train=(642, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:20,658 - INFO - [__main__] - Using best model for L35: svm (F1: 0.7606)
2025-05-19 23:20:20,658 - INFO - [__main__] - Loading svm model for L35...
2025-05-19 23:20:20,659 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:20,660 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:20:20,660 - INFO - [__main__] - Making predictions for L35 using svm
2025-05-19 23:20:20,660 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:20,661 - INFO - [__main__] - Successfully got last prediction for L35
2025-05-19 23:20:20,661 - INFO - [__main__] - 
Processing ticker: L43
2025-05-19 23:20:20,661 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:20,661 - INFO - [__main__] - Getting last prediction point for ticker: L43
2025-05-19 23:20:20,661 - INFO - [__main__] - ==================================================
2025-05-19 23:20:20,661 - INFO - [__main__] - Preparing test data for L43...
2025-05-19 23:20:20,691 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:20,691 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:20,691 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:20,709 - INFO - [src.data_preparation] - Ticker L43 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:20,709 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(184), np.int64(1): np.int64(454)}
2025-05-19 23:20:20,937 - INFO - [src.data_preparation] - Ticker L43 - Selected features:
2025-05-19 23:20:20,937 - INFO - [src.data_preparation] -   vnipc_t: 0.0902
2025-05-19 23:20:20,937 - INFO - [src.data_preparation] -   TVV: 0.0820
2025-05-19 23:20:20,937 - INFO - [src.data_preparation] -   Volatility: 0.0744
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   ATR: 0.0712
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   ma21_t: 0.0701
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   ma7_t: 0.0631
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   ma14_t: 0.0615
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   SK: 0.0530
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   PM: 0.0527
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   HL: 0.0511
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   insec_t: 0.0448
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   ret: 0.0447
2025-05-19 23:20:20,938 - INFO - [src.data_preparation] -   variation_t: 0.0414
2025-05-19 23:20:20,940 - INFO - [src.data_preparation] - Ticker L43 - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'ATR', 'ma21_t', 's_d7_t', 'ma7_t', 'ma14_t', 'SK', 'PM', 'HL', 'Median_HL', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:20:21,028 - INFO - [src.data_preparation] - Ticker L43 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:20:21,028 - INFO - [src.data_preparation] - Ticker L43 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:21,031 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L43
2025-05-19 23:20:21,031 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:21,031 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(116), np.int64(1): np.int64(347)}
2025-05-19 23:20:21,031 - INFO - [src.data_preparation] - Generating 231 synthetic minority samples
2025-05-19 23:20:21,040 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (694, 13, 15), y shape: (694,)
2025-05-19 23:20:21,040 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(347), np.int64(1): np.int64(347)}
2025-05-19 23:20:21,044 - INFO - [src.data_preparation] - Ticker L43 - Final 3D shapes: X_train=(694, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:21,044 - INFO - [__main__] - Using best model for L43: logistic_regression (F1: 0.3902)
2025-05-19 23:20:21,044 - INFO - [__main__] - Loading logistic_regression model for L43...
2025-05-19 23:20:21,045 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:21,045 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:21,045 - INFO - [__main__] - Making predictions for L43 using logistic_regression
2025-05-19 23:20:21,045 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:21,046 - INFO - [__main__] - Successfully got last prediction for L43
2025-05-19 23:20:21,046 - INFO - [__main__] - 
Processing ticker: L44
2025-05-19 23:20:21,046 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:21,046 - INFO - [__main__] - Getting last prediction point for ticker: L44
2025-05-19 23:20:21,046 - INFO - [__main__] - ==================================================
2025-05-19 23:20:21,046 - INFO - [__main__] - Preparing test data for L44...
2025-05-19 23:20:21,073 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:21,073 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:21,073 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:21,092 - INFO - [src.data_preparation] - Ticker L44 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:21,092 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(192), np.int64(1): np.int64(447)}
2025-05-19 23:20:21,349 - INFO - [src.data_preparation] - Ticker L44 - Selected features:
2025-05-19 23:20:21,349 - INFO - [src.data_preparation] -   TVV: 0.0943
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   vnipc_t: 0.0921
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   ATR: 0.0743
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   insec_t: 0.0711
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   ma21_t: 0.0709
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   SK: 0.0661
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   ma14_t: 0.0637
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   Volatility: 0.0586
2025-05-19 23:20:21,350 - INFO - [src.data_preparation] -   s_d7_t: 0.0572
2025-05-19 23:20:21,351 - INFO - [src.data_preparation] -   ma7_t: 0.0561
2025-05-19 23:20:21,351 - INFO - [src.data_preparation] -   ret: 0.0480
2025-05-19 23:20:21,351 - INFO - [src.data_preparation] -   Median_HL: 0.0446
2025-05-19 23:20:21,351 - INFO - [src.data_preparation] -   PM: 0.0444
2025-05-19 23:20:21,351 - INFO - [src.data_preparation] -   variation_t: 0.0430
2025-05-19 23:20:21,351 - INFO - [src.data_preparation] -   SR: 0.0372
2025-05-19 23:20:21,355 - INFO - [src.data_preparation] - Ticker L44 - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'insec_t', 'ma21_t', 'SK', 'ma14_t', 'Volatility', 's_d7_t', 'ma7_t', 'ret', 'Median_HL', 'PM', 'variation_t', 'SR']
2025-05-19 23:20:21,448 - INFO - [src.data_preparation] - Ticker L44 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:21,448 - INFO - [src.data_preparation] - Ticker L44 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:21,450 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L44
2025-05-19 23:20:21,450 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:21,450 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(143), np.int64(1): np.int64(320)}
2025-05-19 23:20:21,450 - INFO - [src.data_preparation] - Generating 177 synthetic minority samples
2025-05-19 23:20:21,461 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (640, 13, 15), y shape: (640,)
2025-05-19 23:20:21,461 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(320), np.int64(1): np.int64(320)}
2025-05-19 23:20:21,468 - INFO - [src.data_preparation] - Ticker L44 - Final 3D shapes: X_train=(640, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:21,468 - INFO - [__main__] - Using best model for L44: svm (F1: 0.8571)
2025-05-19 23:20:21,468 - INFO - [__main__] - Loading svm model for L44...
2025-05-19 23:20:21,471 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:21,472 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:20:21,472 - INFO - [__main__] - Making predictions for L44 using svm
2025-05-19 23:20:21,473 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:21,474 - INFO - [__main__] - Successfully got last prediction for L44
2025-05-19 23:20:21,474 - INFO - [__main__] - 
Processing ticker: L61
2025-05-19 23:20:21,474 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:21,474 - INFO - [__main__] - Getting last prediction point for ticker: L61
2025-05-19 23:20:21,474 - INFO - [__main__] - ==================================================
2025-05-19 23:20:21,475 - INFO - [__main__] - Preparing test data for L61...
2025-05-19 23:20:21,529 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:21,529 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:21,529 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:21,555 - INFO - [src.data_preparation] - Ticker L61 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:21,555 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(237), np.int64(1): np.int64(401)}
2025-05-19 23:20:21,826 - INFO - [src.data_preparation] - Ticker L61 - Selected features:
2025-05-19 23:20:21,826 - INFO - [src.data_preparation] -   ATR: 0.0787
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   vnipc_t: 0.0731
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   insec_t: 0.0712
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   Volatility: 0.0623
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   s_d7_t: 0.0608
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   ma21_t: 0.0592
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   variation_t: 0.0568
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   HL: 0.0559
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   ret: 0.0546
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   ma7_t: 0.0513
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   Median_HL: 0.0484
2025-05-19 23:20:21,827 - INFO - [src.data_preparation] -   SR: 0.0469
2025-05-19 23:20:21,830 - INFO - [src.data_preparation] - Ticker L61 - Using features: ['Date', 'ATR', 'vnipc_t', 'insec_t', 'TVV', 'SK', 'Volatility', 's_d7_t', 'ma21_t', 'ma14_t', 'variation_t', 'HL', 'ret', 'ma7_t', 'Median_HL', 'SR']
2025-05-19 23:20:21,909 - INFO - [src.data_preparation] - Ticker L61 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:20:21,909 - INFO - [src.data_preparation] - Ticker L61 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:21,912 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L61
2025-05-19 23:20:21,912 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:21,912 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:20:21,912 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:20:21,917 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:20:21,917 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:20:21,920 - INFO - [src.data_preparation] - Ticker L61 - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:21,920 - INFO - [__main__] - Using best model for L61: svm (F1: 0.7887)
2025-05-19 23:20:21,920 - INFO - [__main__] - Loading svm model for L61...
2025-05-19 23:20:21,921 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:21,922 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:20:21,922 - INFO - [__main__] - Making predictions for L61 using svm
2025-05-19 23:20:21,922 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:21,923 - INFO - [__main__] - Successfully got last prediction for L61
2025-05-19 23:20:21,923 - INFO - [__main__] - 
Processing ticker: L62
2025-05-19 23:20:21,923 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:21,923 - INFO - [__main__] - Getting last prediction point for ticker: L62
2025-05-19 23:20:21,923 - INFO - [__main__] - ==================================================
2025-05-19 23:20:21,923 - INFO - [__main__] - Preparing test data for L62...
2025-05-19 23:20:21,950 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:21,950 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:21,950 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:21,968 - INFO - [src.data_preparation] - Ticker L62 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:21,968 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(168), np.int64(1): np.int64(470)}
2025-05-19 23:20:22,207 - INFO - [src.data_preparation] - Ticker L62 - Selected features:
2025-05-19 23:20:22,207 - INFO - [src.data_preparation] -   ATR: 0.0837
2025-05-19 23:20:22,207 - INFO - [src.data_preparation] -   vnipc_t: 0.0808
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   TVV: 0.0775
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   s_d7_t: 0.0737
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   Volatility: 0.0734
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   ma21_t: 0.0656
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   HL: 0.0615
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   SK: 0.0602
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   ma14_t: 0.0577
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   Median_HL: 0.0448
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   ret: 0.0422
2025-05-19 23:20:22,208 - INFO - [src.data_preparation] -   variation_t: 0.0399
2025-05-19 23:20:22,211 - INFO - [src.data_preparation] - Ticker L62 - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'Volatility', 'ma21_t', 'insec_t', 'HL', 'SK', 'ma14_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'variation_t']
2025-05-19 23:20:22,291 - INFO - [src.data_preparation] - Ticker L62 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:20:22,291 - INFO - [src.data_preparation] - Ticker L62 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:22,293 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker L62
2025-05-19 23:20:22,293 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:22,293 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(103), np.int64(1): np.int64(360)}
2025-05-19 23:20:22,293 - INFO - [src.data_preparation] - Generating 257 synthetic minority samples
2025-05-19 23:20:22,303 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (720, 13, 15), y shape: (720,)
2025-05-19 23:20:22,303 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(360), np.int64(1): np.int64(360)}
2025-05-19 23:20:22,307 - INFO - [src.data_preparation] - Ticker L62 - Final 3D shapes: X_train=(720, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:22,309 - INFO - [__main__] - Using best model for L62: transformer (F1: 0.7353)
2025-05-19 23:20:22,309 - INFO - [__main__] - Loading transformer model for L62...
2025-05-19 23:20:22,322 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:22,328 - INFO - [__main__] - Model size: 0.15 MB
2025-05-19 23:20:22,329 - INFO - [__main__] - Making predictions for L62 using transformer
2025-05-19 23:20:22,330 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:22,332 - INFO - [__main__] - Successfully got last prediction for L62
2025-05-19 23:20:22,332 - INFO - [__main__] - 
Processing ticker: LAF
2025-05-19 23:20:22,332 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:22,332 - INFO - [__main__] - Getting last prediction point for ticker: LAF
2025-05-19 23:20:22,332 - INFO - [__main__] - ==================================================
2025-05-19 23:20:22,332 - INFO - [__main__] - Preparing test data for LAF...
2025-05-19 23:20:22,372 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:22,373 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:22,373 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:22,399 - INFO - [src.data_preparation] - Ticker LAF - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:22,399 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(280), np.int64(1): np.int64(358)}
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] - Ticker LAF - Selected features:
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   vnipc_t: 0.0783
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   SK: 0.0684
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   insec_t: 0.0682
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   TVV: 0.0669
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   s_d7_t: 0.0666
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   ma21_t: 0.0604
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   ATR: 0.0581
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   ma14_t: 0.0578
2025-05-19 23:20:22,722 - INFO - [src.data_preparation] -   Volatility: 0.0558
2025-05-19 23:20:22,723 - INFO - [src.data_preparation] -   SR: 0.0556
2025-05-19 23:20:22,723 - INFO - [src.data_preparation] -   ma7_t: 0.0555
2025-05-19 23:20:22,723 - INFO - [src.data_preparation] -   LO: 0.0546
2025-05-19 23:20:22,723 - INFO - [src.data_preparation] -   ret: 0.0538
2025-05-19 23:20:22,723 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:20:22,723 - INFO - [src.data_preparation] -   HL: 0.0512
2025-05-19 23:20:22,726 - INFO - [src.data_preparation] - Ticker LAF - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'TVV', 's_d7_t', 'ma21_t', 'ATR', 'ma14_t', 'Volatility', 'SR', 'ma7_t', 'LO', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:22,810 - INFO - [src.data_preparation] - Ticker LAF - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:22,810 - INFO - [src.data_preparation] - Ticker LAF - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:22,812 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LAF
2025-05-19 23:20:22,812 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:20:22,812 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(265)}
2025-05-19 23:20:22,812 - INFO - [src.data_preparation] - Generating 68 synthetic minority samples
2025-05-19 23:20:22,815 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:20:22,815 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:20:22,817 - INFO - [src.data_preparation] - Ticker LAF - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:22,817 - INFO - [__main__] - Using best model for LAF: svm (F1: 0.6667)
2025-05-19 23:20:22,817 - INFO - [__main__] - Loading svm model for LAF...
2025-05-19 23:20:22,819 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:22,819 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:20:22,819 - INFO - [__main__] - Making predictions for LAF using svm
2025-05-19 23:20:22,820 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:22,820 - INFO - [__main__] - Successfully got last prediction for LAF
2025-05-19 23:20:22,820 - INFO - [__main__] - 
Processing ticker: LAS
2025-05-19 23:20:22,820 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:22,820 - INFO - [__main__] - Getting last prediction point for ticker: LAS
2025-05-19 23:20:22,820 - INFO - [__main__] - ==================================================
2025-05-19 23:20:22,820 - INFO - [__main__] - Preparing test data for LAS...
2025-05-19 23:20:22,847 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:22,847 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:22,847 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:22,866 - INFO - [src.data_preparation] - Ticker LAS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:22,866 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:20:23,172 - INFO - [src.data_preparation] - Ticker LAS - Selected features:
2025-05-19 23:20:23,172 - INFO - [src.data_preparation] -   vnipc_t: 0.0748
2025-05-19 23:20:23,172 - INFO - [src.data_preparation] -   TVV: 0.0740
2025-05-19 23:20:23,172 - INFO - [src.data_preparation] -   insec_t: 0.0659
2025-05-19 23:20:23,172 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:20:23,172 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   ATR: 0.0587
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   HL: 0.0581
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   LO: 0.0559
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   SR: 0.0514
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   ma21_t: 0.0507
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   Median_HL: 0.0507
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   variation_t: 0.0501
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   ma14_t: 0.0500
2025-05-19 23:20:23,173 - INFO - [src.data_preparation] -   ma7_t: 0.0491
2025-05-19 23:20:23,176 - INFO - [src.data_preparation] - Ticker LAS - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'SK', 's_d7_t', 'Volatility', 'ATR', 'HL', 'LO', 'SR', 'ma21_t', 'Median_HL', 'variation_t', 'ma14_t', 'ma7_t']
2025-05-19 23:20:23,260 - INFO - [src.data_preparation] - Ticker LAS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:23,260 - INFO - [src.data_preparation] - Ticker LAS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:23,261 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LAS
2025-05-19 23:20:23,262 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:23,262 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:20:23,262 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:20:23,263 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:20:23,264 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:20:23,266 - INFO - [src.data_preparation] - Ticker LAS - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:23,266 - INFO - [__main__] - Using best model for LAS: svm (F1: 0.6087)
2025-05-19 23:20:23,266 - INFO - [__main__] - Loading svm model for LAS...
2025-05-19 23:20:23,267 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:23,267 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:20:23,268 - INFO - [__main__] - Making predictions for LAS using svm
2025-05-19 23:20:23,269 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:23,269 - INFO - [__main__] - Successfully got last prediction for LAS
2025-05-19 23:20:23,270 - INFO - [__main__] - 
Processing ticker: LBE
2025-05-19 23:20:23,270 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:23,270 - INFO - [__main__] - Getting last prediction point for ticker: LBE
2025-05-19 23:20:23,270 - INFO - [__main__] - ==================================================
2025-05-19 23:20:23,270 - INFO - [__main__] - Preparing test data for LBE...
2025-05-19 23:20:23,294 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:23,294 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:23,295 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:23,312 - INFO - [src.data_preparation] - Ticker LBE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:23,313 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(140), np.int64(1): np.int64(499)}
2025-05-19 23:20:23,627 - INFO - [src.data_preparation] - Ticker LBE - Selected features:
2025-05-19 23:20:23,628 - INFO - [src.data_preparation] -   vnipc_t: 0.1062
2025-05-19 23:20:23,628 - INFO - [src.data_preparation] -   ma21_t: 0.0879
2025-05-19 23:20:23,628 - INFO - [src.data_preparation] -   ma14_t: 0.0742
2025-05-19 23:20:23,628 - INFO - [src.data_preparation] -   TVV: 0.0721
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   PM: 0.0674
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   ma7_t: 0.0663
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   ATR: 0.0656
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   Median_HL: 0.0651
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   Volatility: 0.0552
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   SK: 0.0506
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   insec_t: 0.0470
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   LO: 0.0384
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   ret: 0.0381
2025-05-19 23:20:23,629 - INFO - [src.data_preparation] -   HL: 0.0373
2025-05-19 23:20:23,632 - INFO - [src.data_preparation] - Ticker LBE - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'TVV', 'PM', 'ma7_t', 'ATR', 'Median_HL', 's_d7_t', 'Volatility', 'SK', 'insec_t', 'LO', 'ret', 'HL']
2025-05-19 23:20:23,739 - INFO - [src.data_preparation] - Ticker LBE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:23,739 - INFO - [src.data_preparation] - Ticker LBE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:23,741 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LBE
2025-05-19 23:20:23,741 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:23,742 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(98), np.int64(1): np.int64(365)}
2025-05-19 23:20:23,742 - INFO - [src.data_preparation] - Generating 267 synthetic minority samples
2025-05-19 23:20:23,756 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (730, 13, 15), y shape: (730,)
2025-05-19 23:20:23,756 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(365), np.int64(1): np.int64(365)}
2025-05-19 23:20:23,760 - INFO - [src.data_preparation] - Ticker LBE - Final 3D shapes: X_train=(730, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:23,761 - INFO - [__main__] - Using best model for LBE: svm (F1: 0.8421)
2025-05-19 23:20:23,761 - INFO - [__main__] - Loading svm model for LBE...
2025-05-19 23:20:23,763 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:23,763 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:20:23,763 - INFO - [__main__] - Making predictions for LBE using svm
2025-05-19 23:20:23,764 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:23,764 - INFO - [__main__] - Successfully got last prediction for LBE
2025-05-19 23:20:23,764 - INFO - [__main__] - 
Processing ticker: LBM
2025-05-19 23:20:23,765 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:23,765 - INFO - [__main__] - Getting last prediction point for ticker: LBM
2025-05-19 23:20:23,765 - INFO - [__main__] - ==================================================
2025-05-19 23:20:23,765 - INFO - [__main__] - Preparing test data for LBM...
2025-05-19 23:20:23,795 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:23,795 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:23,795 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:23,819 - INFO - [src.data_preparation] - Ticker LBM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:23,819 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] - Ticker LBM - Selected features:
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   insec_t: 0.0717
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   vnipc_t: 0.0683
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   SK: 0.0655
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   TVV: 0.0638
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   ATR: 0.0628
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   s_d7_t: 0.0605
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   PM: 0.0592
2025-05-19 23:20:24,132 - INFO - [src.data_preparation] -   ma21_t: 0.0570
2025-05-19 23:20:24,133 - INFO - [src.data_preparation] -   Median_HL: 0.0565
2025-05-19 23:20:24,133 - INFO - [src.data_preparation] -   SR: 0.0564
2025-05-19 23:20:24,133 - INFO - [src.data_preparation] -   HL: 0.0558
2025-05-19 23:20:24,133 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:20:24,133 - INFO - [src.data_preparation] -   variation_t: 0.0536
2025-05-19 23:20:24,133 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:20:24,135 - INFO - [src.data_preparation] - Ticker LBM - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 'TVV', 'ATR', 'Volatility', 's_d7_t', 'PM', 'ma21_t', 'Median_HL', 'SR', 'HL', 'ma7_t', 'variation_t', 'ma14_t']
2025-05-19 23:20:24,218 - INFO - [src.data_preparation] - Ticker LBM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:24,220 - INFO - [src.data_preparation] - Ticker LBM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:24,221 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LBM
2025-05-19 23:20:24,221 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:24,221 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:20:24,221 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:20:24,224 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:20:24,224 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:20:24,227 - INFO - [src.data_preparation] - Ticker LBM - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:24,227 - INFO - [__main__] - Using best model for LBM: logistic_regression (F1: 0.6275)
2025-05-19 23:20:24,227 - INFO - [__main__] - Loading logistic_regression model for LBM...
2025-05-19 23:20:24,228 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:24,228 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:24,228 - INFO - [__main__] - Making predictions for LBM using logistic_regression
2025-05-19 23:20:24,228 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:24,229 - INFO - [__main__] - Successfully got last prediction for LBM
2025-05-19 23:20:24,229 - INFO - [__main__] - 
Processing ticker: LCC
2025-05-19 23:20:24,229 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:24,229 - INFO - [__main__] - Getting last prediction point for ticker: LCC
2025-05-19 23:20:24,229 - INFO - [__main__] - ==================================================
2025-05-19 23:20:24,229 - INFO - [__main__] - Preparing test data for LCC...
2025-05-19 23:20:24,254 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:24,255 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:24,255 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:24,272 - INFO - [src.data_preparation] - Ticker LCC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:24,272 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(47), np.int64(1): np.int64(592)}
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] - Ticker LCC - Selected features:
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] -   vnipc_t: 0.1528
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] -   TVV: 0.1296
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] -   ma21_t: 0.0936
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] -   ma14_t: 0.0846
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] -   ma7_t: 0.0711
2025-05-19 23:20:24,435 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   PM: 0.0599
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   Volatility: 0.0555
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   ATR: 0.0515
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   SK: 0.0378
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   ret: 0.0333
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   SR: 0.0321
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   insec_t: 0.0293
2025-05-19 23:20:24,436 - INFO - [src.data_preparation] -   variation_t: 0.0276
2025-05-19 23:20:24,438 - INFO - [src.data_preparation] - Ticker LCC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'PM', 'Volatility', 'ATR', 'Median_HL', 'SK', 'ret', 'SR', 'insec_t', 'variation_t']
2025-05-19 23:20:24,520 - INFO - [src.data_preparation] - Ticker LCC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:24,521 - INFO - [src.data_preparation] - Ticker LCC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:24,522 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LCC
2025-05-19 23:20:24,522 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:24,522 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(20), np.int64(1): np.int64(443)}
2025-05-19 23:20:24,522 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:20:24,526 - INFO - [src.data_preparation] - Ticker LCC - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:24,526 - INFO - [__main__] - Using best model for LCC: logistic_regression (F1: 0.8919)
2025-05-19 23:20:24,526 - INFO - [__main__] - Loading logistic_regression model for LCC...
2025-05-19 23:20:24,527 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:24,527 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:24,527 - INFO - [__main__] - Making predictions for LCC using logistic_regression
2025-05-19 23:20:24,528 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:24,528 - INFO - [__main__] - Successfully got last prediction for LCC
2025-05-19 23:20:24,528 - INFO - [__main__] - 
Processing ticker: LCD
2025-05-19 23:20:24,528 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:24,528 - INFO - [__main__] - Getting last prediction point for ticker: LCD
2025-05-19 23:20:24,528 - INFO - [__main__] - ==================================================
2025-05-19 23:20:24,528 - INFO - [__main__] - Preparing test data for LCD...
2025-05-19 23:20:24,557 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:24,557 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:24,557 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:24,577 - INFO - [src.data_preparation] - Ticker LCD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:24,577 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(45), np.int64(1): np.int64(594)}
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] - Ticker LCD - Selected features:
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   vnipc_t: 0.1518
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   ma21_t: 0.1089
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   ma14_t: 0.0916
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   ATR: 0.0760
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   TVV: 0.0671
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   s_d7_t: 0.0648
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   Volatility: 0.0575
2025-05-19 23:20:24,763 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:20:24,764 - INFO - [src.data_preparation] -   SK: 0.0519
2025-05-19 23:20:24,764 - INFO - [src.data_preparation] -   PM: 0.0486
2025-05-19 23:20:24,764 - INFO - [src.data_preparation] -   ret: 0.0398
2025-05-19 23:20:24,764 - INFO - [src.data_preparation] -   variation_t: 0.0327
2025-05-19 23:20:24,764 - INFO - [src.data_preparation] -   HL: 0.0298
2025-05-19 23:20:24,764 - INFO - [src.data_preparation] -   insec_t: 0.0258
2025-05-19 23:20:24,766 - INFO - [src.data_preparation] - Ticker LCD - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ATR', 'TVV', 's_d7_t', 'ma7_t', 'Volatility', 'Median_HL', 'SK', 'PM', 'ret', 'variation_t', 'HL', 'insec_t']
2025-05-19 23:20:24,864 - INFO - [src.data_preparation] - Ticker LCD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:24,864 - INFO - [src.data_preparation] - Ticker LCD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:24,865 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LCD
2025-05-19 23:20:24,865 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:24,865 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(39), np.int64(1): np.int64(424)}
2025-05-19 23:20:24,865 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:20:24,869 - INFO - [src.data_preparation] - Ticker LCD - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:24,869 - INFO - [__main__] - Using best model for LCD: lstm (F1: 0.9767)
2025-05-19 23:20:24,869 - INFO - [__main__] - Loading lstm model for LCD...
2025-05-19 23:20:24,875 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:24,878 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:20:24,878 - INFO - [__main__] - Making predictions for LCD using lstm
2025-05-19 23:20:24,883 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:24,883 - INFO - [__main__] - Successfully got last prediction for LCD
2025-05-19 23:20:24,883 - INFO - [__main__] - 
Processing ticker: LCG
2025-05-19 23:20:24,883 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:24,884 - INFO - [__main__] - Getting last prediction point for ticker: LCG
2025-05-19 23:20:24,884 - INFO - [__main__] - ==================================================
2025-05-19 23:20:24,884 - INFO - [__main__] - Preparing test data for LCG...
2025-05-19 23:20:24,925 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:24,925 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:24,925 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:24,958 - INFO - [src.data_preparation] - Ticker LCG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:24,958 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:20:25,293 - INFO - [src.data_preparation] - Ticker LCG - Selected features:
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   vnipc_t: 0.0700
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   insec_t: 0.0686
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   Volatility: 0.0645
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   variation_t: 0.0629
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   ma14_t: 0.0606
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   HL: 0.0591
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   TVV: 0.0583
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   PM: 0.0567
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   ma7_t: 0.0564
2025-05-19 23:20:25,294 - INFO - [src.data_preparation] -   ATR: 0.0562
2025-05-19 23:20:25,295 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:20:25,295 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:20:25,295 - INFO - [src.data_preparation] -   Median_HL: 0.0487
2025-05-19 23:20:25,298 - INFO - [src.data_preparation] - Ticker LCG - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'variation_t', 'SK', 'ma14_t', 'HL', 'TVV', 'PM', 'ma7_t', 'ATR', 'ret', 'ma21_t', 'Median_HL']
2025-05-19 23:20:25,394 - INFO - [src.data_preparation] - Ticker LCG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:25,394 - INFO - [src.data_preparation] - Ticker LCG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:25,396 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LCG
2025-05-19 23:20:25,396 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:25,396 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(217), np.int64(1): np.int64(246)}
2025-05-19 23:20:25,396 - INFO - [src.data_preparation] - Generating 29 synthetic minority samples
2025-05-19 23:20:25,398 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (492, 13, 15), y shape: (492,)
2025-05-19 23:20:25,398 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(246), np.int64(1): np.int64(246)}
2025-05-19 23:20:25,401 - INFO - [src.data_preparation] - Ticker LCG - Final 3D shapes: X_train=(492, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:25,401 - INFO - [__main__] - Using best model for LCG: logistic_regression (F1: 0.3871)
2025-05-19 23:20:25,401 - INFO - [__main__] - Loading logistic_regression model for LCG...
2025-05-19 23:20:25,402 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:25,402 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:25,402 - INFO - [__main__] - Making predictions for LCG using logistic_regression
2025-05-19 23:20:25,402 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:25,403 - INFO - [__main__] - Successfully got last prediction for LCG
2025-05-19 23:20:25,403 - INFO - [__main__] - 
Processing ticker: LCM
2025-05-19 23:20:25,403 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:25,403 - INFO - [__main__] - Getting last prediction point for ticker: LCM
2025-05-19 23:20:25,403 - INFO - [__main__] - ==================================================
2025-05-19 23:20:25,403 - INFO - [__main__] - Preparing test data for LCM...
2025-05-19 23:20:25,430 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:25,430 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:25,430 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:25,450 - INFO - [src.data_preparation] - Ticker LCM - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:25,450 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(333)}
2025-05-19 23:20:25,745 - INFO - [src.data_preparation] - Ticker LCM - Selected features:
2025-05-19 23:20:25,745 - INFO - [src.data_preparation] -   vnipc_t: 0.0866
2025-05-19 23:20:25,745 - INFO - [src.data_preparation] -   insec_t: 0.0819
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   TVV: 0.0718
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   Volatility: 0.0659
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   SK: 0.0633
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   s_d7_t: 0.0618
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   ma21_t: 0.0554
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   ma7_t: 0.0545
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   ATR: 0.0543
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   ret: 0.0538
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   Median_HL: 0.0527
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   variation_t: 0.0499
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   ma14_t: 0.0499
2025-05-19 23:20:25,746 - INFO - [src.data_preparation] -   SR: 0.0463
2025-05-19 23:20:25,749 - INFO - [src.data_preparation] - Ticker LCM - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'Volatility', 'SK', 's_d7_t', 'ma21_t', 'ma7_t', 'ATR', 'ret', 'Median_HL', 'PM', 'variation_t', 'ma14_t', 'SR']
2025-05-19 23:20:25,837 - INFO - [src.data_preparation] - Ticker LCM - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:20:25,837 - INFO - [src.data_preparation] - Ticker LCM - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:25,838 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LCM
2025-05-19 23:20:25,838 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:25,838 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(227), np.int64(1): np.int64(236)}
2025-05-19 23:20:25,838 - INFO - [src.data_preparation] - Generating 9 synthetic minority samples
2025-05-19 23:20:25,839 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (472, 13, 15), y shape: (472,)
2025-05-19 23:20:25,840 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(236), np.int64(1): np.int64(236)}
2025-05-19 23:20:25,843 - INFO - [src.data_preparation] - Ticker LCM - Final 3D shapes: X_train=(472, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:25,843 - INFO - [__main__] - Using best model for LCM: lstm (F1: 0.6207)
2025-05-19 23:20:25,843 - INFO - [__main__] - Loading lstm model for LCM...
2025-05-19 23:20:25,847 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:25,848 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:20:25,848 - INFO - [__main__] - Making predictions for LCM using lstm
2025-05-19 23:20:25,850 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:25,850 - INFO - [__main__] - Successfully got last prediction for LCM
2025-05-19 23:20:25,850 - INFO - [__main__] - 
Processing ticker: LCS
2025-05-19 23:20:25,851 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:25,851 - INFO - [__main__] - Getting last prediction point for ticker: LCS
2025-05-19 23:20:25,851 - INFO - [__main__] - ==================================================
2025-05-19 23:20:25,851 - INFO - [__main__] - Preparing test data for LCS...
2025-05-19 23:20:25,891 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:20:25,891 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:25,891 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:25,925 - INFO - [src.data_preparation] - Ticker LCS - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:20:25,925 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(202), np.int64(1): np.int64(435)}
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] - Ticker LCS - Selected features:
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   vnipc_t: 0.0870
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   ma14_t: 0.0814
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   ma21_t: 0.0790
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   TVV: 0.0710
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   ma7_t: 0.0674
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:20:26,288 - INFO - [src.data_preparation] -   s_d7_t: 0.0636
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   Median_HL: 0.0594
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   PM: 0.0586
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   ATR: 0.0578
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   insec_t: 0.0575
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   SK: 0.0564
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   variation_t: 0.0439
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   ret: 0.0430
2025-05-19 23:20:26,289 - INFO - [src.data_preparation] -   HL: 0.0360
2025-05-19 23:20:26,293 - INFO - [src.data_preparation] - Ticker LCS - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'TVV', 'ma7_t', 'Volatility', 's_d7_t', 'Median_HL', 'PM', 'ATR', 'insec_t', 'SK', 'variation_t', 'ret', 'HL']
2025-05-19 23:20:26,434 - INFO - [src.data_preparation] - Ticker LCS - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:20:26,434 - INFO - [src.data_preparation] - Ticker LCS - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:26,437 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LCS
2025-05-19 23:20:26,438 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:26,438 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(159), np.int64(1): np.int64(304)}
2025-05-19 23:20:26,438 - INFO - [src.data_preparation] - Generating 145 synthetic minority samples
2025-05-19 23:20:26,445 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (608, 13, 15), y shape: (608,)
2025-05-19 23:20:26,445 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(304), np.int64(1): np.int64(304)}
2025-05-19 23:20:26,449 - INFO - [src.data_preparation] - Ticker LCS - Final 3D shapes: X_train=(608, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:26,449 - INFO - [__main__] - Using best model for LCS: lstm (F1: 0.9000)
2025-05-19 23:20:26,449 - INFO - [__main__] - Loading lstm model for LCS...
2025-05-19 23:20:26,453 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:26,454 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:20:26,455 - INFO - [__main__] - Making predictions for LCS using lstm
2025-05-19 23:20:26,455 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:26,457 - INFO - [__main__] - Successfully got last prediction for LCS
2025-05-19 23:20:26,457 - INFO - [__main__] - 
Processing ticker: LDP
2025-05-19 23:20:26,457 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:26,458 - INFO - [__main__] - Getting last prediction point for ticker: LDP
2025-05-19 23:20:26,458 - INFO - [__main__] - ==================================================
2025-05-19 23:20:26,458 - INFO - [__main__] - Preparing test data for LDP...
2025-05-19 23:20:26,505 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:26,505 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:26,507 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:26,543 - INFO - [src.data_preparation] - Ticker LDP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:26,544 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(303), np.int64(1): np.int64(336)}
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] - Ticker LDP - Selected features:
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   vnipc_t: 0.0720
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   SK: 0.0715
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   ATR: 0.0692
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   insec_t: 0.0655
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   TVV: 0.0623
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   Volatility: 0.0623
2025-05-19 23:20:26,953 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   SR: 0.0565
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   ma7_t: 0.0544
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   PM: 0.0528
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   ma14_t: 0.0519
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:20:26,954 - INFO - [src.data_preparation] -   LO: 0.0501
2025-05-19 23:20:26,958 - INFO - [src.data_preparation] - Ticker LDP - Using features: ['Date', 'vnipc_t', 'SK', 'ATR', 'insec_t', 's_d7_t', 'TVV', 'Volatility', 'HL', 'SR', 'ma21_t', 'ma7_t', 'PM', 'ma14_t', 'Median_HL', 'LO']
2025-05-19 23:20:27,059 - INFO - [src.data_preparation] - Ticker LDP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:27,060 - INFO - [src.data_preparation] - Ticker LDP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:27,062 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LDP
2025-05-19 23:20:27,062 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:27,062 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:20:27,062 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:20:27,064 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:20:27,065 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:20:27,069 - INFO - [src.data_preparation] - Ticker LDP - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:27,069 - INFO - [__main__] - Using best model for LDP: lstm (F1: 0.5405)
2025-05-19 23:20:27,069 - INFO - [__main__] - Loading lstm model for LDP...
2025-05-19 23:20:27,073 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:27,074 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:20:27,074 - INFO - [__main__] - Making predictions for LDP using lstm
2025-05-19 23:20:27,077 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:27,077 - INFO - [__main__] - Successfully got last prediction for LDP
2025-05-19 23:20:27,077 - INFO - [__main__] - 
Processing ticker: LGC
2025-05-19 23:20:27,078 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:27,078 - INFO - [__main__] - Getting last prediction point for ticker: LGC
2025-05-19 23:20:27,078 - INFO - [__main__] - ==================================================
2025-05-19 23:20:27,078 - INFO - [__main__] - Preparing test data for LGC...
2025-05-19 23:20:27,133 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:27,133 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:27,134 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:27,157 - INFO - [src.data_preparation] - Ticker LGC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:27,157 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(361)}
2025-05-19 23:20:27,529 - INFO - [src.data_preparation] - Ticker LGC - Selected features:
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   TVV: 0.0807
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   Volatility: 0.0729
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   SK: 0.0668
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   vnipc_t: 0.0662
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   s_d7_t: 0.0624
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   HL: 0.0616
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   ma21_t: 0.0598
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   ma14_t: 0.0579
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   SR: 0.0564
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   insec_t: 0.0541
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   variation_t: 0.0528
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   ma7_t: 0.0519
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   ret: 0.0515
2025-05-19 23:20:27,537 - INFO - [src.data_preparation] -   Median_HL: 0.0502
2025-05-19 23:20:27,538 - INFO - [src.data_preparation] - Ticker LGC - Using features: ['Date', 'TVV', 'Volatility', 'SK', 'vnipc_t', 's_d7_t', 'HL', 'ATR', 'ma21_t', 'ma14_t', 'SR', 'insec_t', 'variation_t', 'ma7_t', 'ret', 'Median_HL']
2025-05-19 23:20:27,633 - INFO - [src.data_preparation] - Ticker LGC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:27,634 - INFO - [src.data_preparation] - Ticker LGC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:27,635 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LGC
2025-05-19 23:20:27,635 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:27,636 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:20:27,636 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:20:27,637 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:20:27,637 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:20:27,640 - INFO - [src.data_preparation] - Ticker LGC - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:27,640 - INFO - [__main__] - Using best model for LGC: transformer (F1: 0.8684)
2025-05-19 23:20:27,640 - INFO - [__main__] - Loading transformer model for LGC...
2025-05-19 23:20:27,654 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:27,657 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:20:27,658 - INFO - [__main__] - Making predictions for LGC using transformer
2025-05-19 23:20:27,659 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:27,659 - INFO - [__main__] - Successfully got last prediction for LGC
2025-05-19 23:20:27,660 - INFO - [__main__] - 
Processing ticker: LGL
2025-05-19 23:20:27,660 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:27,660 - INFO - [__main__] - Getting last prediction point for ticker: LGL
2025-05-19 23:20:27,660 - INFO - [__main__] - ==================================================
2025-05-19 23:20:27,660 - INFO - [__main__] - Preparing test data for LGL...
2025-05-19 23:20:27,704 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:27,704 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:27,704 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:27,718 - INFO - [src.data_preparation] - Ticker LGL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:27,718 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(327), np.int64(1): np.int64(312)}
2025-05-19 23:20:28,072 - INFO - [src.data_preparation] - Ticker LGL - Selected features:
2025-05-19 23:20:28,072 - INFO - [src.data_preparation] -   SK: 0.0786
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   vnipc_t: 0.0721
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   ret: 0.0619
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   insec_t: 0.0605
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   Volatility: 0.0595
2025-05-19 23:20:28,073 - INFO - [src.data_preparation] -   TVV: 0.0586
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   Median_HL: 0.0565
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   LO: 0.0558
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   variation_t: 0.0549
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   ma14_t: 0.0543
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   HL: 0.0537
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   ma7_t: 0.0522
2025-05-19 23:20:28,074 - INFO - [src.data_preparation] -   PM: 0.0512
2025-05-19 23:20:28,078 - INFO - [src.data_preparation] - Ticker LGL - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'ATR', 'ret', 'insec_t', 'Volatility', 'TVV', 'Median_HL', 'LO', 'variation_t', 'ma14_t', 'HL', 'ma7_t', 'PM']
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Ticker LGL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Ticker LGL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LGL
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(229), np.int64(1): np.int64(234)}
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Generating 5 synthetic minority samples
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (468, 13, 15), y shape: (468,)
2025-05-19 23:20:28,181 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(234), np.int64(1): np.int64(234)}
2025-05-19 23:20:28,188 - INFO - [src.data_preparation] - Ticker LGL - Final 3D shapes: X_train=(468, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:28,188 - INFO - [__main__] - Using best model for LGL: logistic_regression (F1: 0.6545)
2025-05-19 23:20:28,188 - INFO - [__main__] - Loading logistic_regression model for LGL...
2025-05-19 23:20:28,188 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:28,188 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:28,188 - INFO - [__main__] - Making predictions for LGL using logistic_regression
2025-05-19 23:20:28,188 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:28,188 - INFO - [__main__] - Successfully got last prediction for LGL
2025-05-19 23:20:28,188 - INFO - [__main__] - 
Processing ticker: LHC
2025-05-19 23:20:28,188 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:28,188 - INFO - [__main__] - Getting last prediction point for ticker: LHC
2025-05-19 23:20:28,188 - INFO - [__main__] - ==================================================
2025-05-19 23:20:28,188 - INFO - [__main__] - Preparing test data for LHC...
2025-05-19 23:20:28,231 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:28,231 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:28,232 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:28,269 - INFO - [src.data_preparation] - Ticker LHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:28,269 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(292), np.int64(1): np.int64(347)}
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] - Ticker LHC - Selected features:
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] -   insec_t: 0.0773
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] -   vnipc_t: 0.0744
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] -   SR: 0.0631
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] -   SK: 0.0616
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] -   Volatility: 0.0614
2025-05-19 23:20:28,760 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   ATR: 0.0583
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   HL: 0.0579
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   ma14_t: 0.0560
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   LO: 0.0551
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   ret: 0.0551
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   variation_t: 0.0532
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:20:28,761 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:20:28,765 - INFO - [src.data_preparation] - Ticker LHC - Using features: ['Date', 'insec_t', 'vnipc_t', 'SR', 'SK', 'Volatility', 'TVV', 's_d7_t', 'ATR', 'HL', 'ma14_t', 'LO', 'ret', 'variation_t', 'Median_HL', 'PM']
2025-05-19 23:20:28,935 - INFO - [src.data_preparation] - Ticker LHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:28,935 - INFO - [src.data_preparation] - Ticker LHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:28,938 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LHC
2025-05-19 23:20:28,938 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:28,938 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:20:28,939 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:20:28,944 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:20:28,944 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:20:28,952 - INFO - [src.data_preparation] - Ticker LHC - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:28,952 - INFO - [__main__] - Using best model for LHC: logistic_regression (F1: 0.2069)
2025-05-19 23:20:28,952 - INFO - [__main__] - Loading logistic_regression model for LHC...
2025-05-19 23:20:28,954 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:28,954 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:28,954 - INFO - [__main__] - Making predictions for LHC using logistic_regression
2025-05-19 23:20:28,955 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:28,956 - INFO - [__main__] - Successfully got last prediction for LHC
2025-05-19 23:20:28,956 - INFO - [__main__] - 
Processing ticker: LHG
2025-05-19 23:20:28,956 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:28,956 - INFO - [__main__] - Getting last prediction point for ticker: LHG
2025-05-19 23:20:28,956 - INFO - [__main__] - ==================================================
2025-05-19 23:20:28,956 - INFO - [__main__] - Preparing test data for LHG...
2025-05-19 23:20:29,018 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:29,018 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:29,019 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:29,060 - INFO - [src.data_preparation] - Ticker LHG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:29,061 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:20:29,570 - INFO - [src.data_preparation] - Ticker LHG - Selected features:
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   SK: 0.0745
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   insec_t: 0.0705
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   vnipc_t: 0.0669
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   Volatility: 0.0666
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   TVV: 0.0646
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   LO: 0.0611
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   s_d7_t: 0.0574
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   ret: 0.0568
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   ATR: 0.0564
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   SR: 0.0546
2025-05-19 23:20:29,571 - INFO - [src.data_preparation] -   variation_t: 0.0544
2025-05-19 23:20:29,572 - INFO - [src.data_preparation] -   ma14_t: 0.0541
2025-05-19 23:20:29,572 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:20:29,572 - INFO - [src.data_preparation] -   HL: 0.0521
2025-05-19 23:20:29,572 - INFO - [src.data_preparation] -   ma21_t: 0.0517
2025-05-19 23:20:29,575 - INFO - [src.data_preparation] - Ticker LHG - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'Volatility', 'TVV', 'LO', 's_d7_t', 'ret', 'ATR', 'SR', 'variation_t', 'ma14_t', 'Median_HL', 'HL', 'ma21_t']
2025-05-19 23:20:29,725 - INFO - [src.data_preparation] - Ticker LHG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:29,727 - INFO - [src.data_preparation] - Ticker LHG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:29,730 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LHG
2025-05-19 23:20:29,730 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:29,730 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:20:29,731 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:20:29,733 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:20:29,733 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:20:29,738 - INFO - [src.data_preparation] - Ticker LHG - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:29,738 - INFO - [__main__] - Using best model for LHG: lstm (F1: 0.6032)
2025-05-19 23:20:29,738 - INFO - [__main__] - Loading lstm model for LHG...
2025-05-19 23:20:29,744 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:29,747 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:20:29,747 - INFO - [__main__] - Making predictions for LHG using lstm
2025-05-19 23:20:29,752 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:29,752 - INFO - [__main__] - Successfully got last prediction for LHG
2025-05-19 23:20:29,752 - INFO - [__main__] - 
Processing ticker: LIG
2025-05-19 23:20:29,753 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:29,753 - INFO - [__main__] - Getting last prediction point for ticker: LIG
2025-05-19 23:20:29,753 - INFO - [__main__] - ==================================================
2025-05-19 23:20:29,753 - INFO - [__main__] - Preparing test data for LIG...
2025-05-19 23:20:29,819 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:29,819 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:29,819 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:29,860 - INFO - [src.data_preparation] - Ticker LIG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:29,861 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(272), np.int64(1): np.int64(367)}
2025-05-19 23:20:30,438 - INFO - [src.data_preparation] - Ticker LIG - Selected features:
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   vnipc_t: 0.0827
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   SK: 0.0741
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   TVV: 0.0706
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   Volatility: 0.0670
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   insec_t: 0.0619
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   Median_HL: 0.0610
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   PM: 0.0591
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   s_d7_t: 0.0581
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   ATR: 0.0580
2025-05-19 23:20:30,439 - INFO - [src.data_preparation] -   ma21_t: 0.0573
2025-05-19 23:20:30,440 - INFO - [src.data_preparation] -   ma14_t: 0.0565
2025-05-19 23:20:30,440 - INFO - [src.data_preparation] -   ma7_t: 0.0552
2025-05-19 23:20:30,440 - INFO - [src.data_preparation] -   HL: 0.0505
2025-05-19 23:20:30,440 - INFO - [src.data_preparation] -   ret: 0.0476
2025-05-19 23:20:30,440 - INFO - [src.data_preparation] -   variation_t: 0.0474
2025-05-19 23:20:30,447 - INFO - [src.data_preparation] - Ticker LIG - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'Volatility', 'insec_t', 'Median_HL', 'PM', 's_d7_t', 'ATR', 'ma21_t', 'ma14_t', 'ma7_t', 'HL', 'ret', 'variation_t']
2025-05-19 23:20:30,627 - INFO - [src.data_preparation] - Ticker LIG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:30,627 - INFO - [src.data_preparation] - Ticker LIG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:30,631 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LIG
2025-05-19 23:20:30,631 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:30,631 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(196), np.int64(1): np.int64(267)}
2025-05-19 23:20:30,632 - INFO - [src.data_preparation] - Generating 71 synthetic minority samples
2025-05-19 23:20:30,639 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (534, 13, 15), y shape: (534,)
2025-05-19 23:20:30,639 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(267), np.int64(1): np.int64(267)}
2025-05-19 23:20:30,644 - INFO - [src.data_preparation] - Ticker LIG - Final 3D shapes: X_train=(534, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:30,644 - INFO - [__main__] - Using best model for LIG: logistic_regression (F1: 0.7500)
2025-05-19 23:20:30,644 - INFO - [__main__] - Loading logistic_regression model for LIG...
2025-05-19 23:20:30,646 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:30,646 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:30,646 - INFO - [__main__] - Making predictions for LIG using logistic_regression
2025-05-19 23:20:30,647 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:30,647 - INFO - [__main__] - Successfully got last prediction for LIG
2025-05-19 23:20:30,647 - INFO - [__main__] - 
Processing ticker: LIX
2025-05-19 23:20:30,648 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:30,648 - INFO - [__main__] - Getting last prediction point for ticker: LIX
2025-05-19 23:20:30,648 - INFO - [__main__] - ==================================================
2025-05-19 23:20:30,648 - INFO - [__main__] - Preparing test data for LIX...
2025-05-19 23:20:30,707 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:30,707 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:30,707 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:30,747 - INFO - [src.data_preparation] - Ticker LIX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:30,747 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] - Ticker LIX - Selected features:
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   SK: 0.0758
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   vnipc_t: 0.0677
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   Volatility: 0.0650
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   ma21_t: 0.0588
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   ATR: 0.0584
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   ma14_t: 0.0579
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   s_d7_t: 0.0576
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   TVV: 0.0571
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   ret: 0.0569
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   HL: 0.0563
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   LO: 0.0562
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   SR: 0.0543
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] -   variation_t: 0.0528
2025-05-19 23:20:31,210 - INFO - [src.data_preparation] - Ticker LIX - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'Volatility', 'ma21_t', 'ATR', 'ma14_t', 's_d7_t', 'TVV', 'ret', 'HL', 'LO', 'PM', 'SR', 'variation_t']
2025-05-19 23:20:31,332 - INFO - [src.data_preparation] - Ticker LIX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:31,333 - INFO - [src.data_preparation] - Ticker LIX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:31,335 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LIX
2025-05-19 23:20:31,335 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:31,335 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:20:31,335 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:20:31,338 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:20:31,338 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:20:31,342 - INFO - [src.data_preparation] - Ticker LIX - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:31,342 - INFO - [__main__] - Using best model for LIX: logistic_regression (F1: 0.4615)
2025-05-19 23:20:31,342 - INFO - [__main__] - Loading logistic_regression model for LIX...
2025-05-19 23:20:31,343 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:31,343 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:31,343 - INFO - [__main__] - Making predictions for LIX using logistic_regression
2025-05-19 23:20:31,343 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:31,344 - INFO - [__main__] - Successfully got last prediction for LIX
2025-05-19 23:20:31,344 - INFO - [__main__] - 
Processing ticker: LKW
2025-05-19 23:20:31,344 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:31,344 - INFO - [__main__] - Getting last prediction point for ticker: LKW
2025-05-19 23:20:31,344 - INFO - [__main__] - ==================================================
2025-05-19 23:20:31,344 - INFO - [__main__] - Preparing test data for LKW...
2025-05-19 23:20:31,410 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:31,410 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:31,411 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:31,443 - INFO - [src.data_preparation] - Ticker LKW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:31,443 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(229), np.int64(1): np.int64(410)}
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] - Ticker LKW - Selected features:
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   ATR: 0.0839
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   vnipc_t: 0.0783
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   Median_HL: 0.0659
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   SR: 0.0611
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   s_d7_t: 0.0604
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   PM: 0.0604
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   ma21_t: 0.0600
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   ma7_t: 0.0583
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   TVV: 0.0574
2025-05-19 23:20:31,805 - INFO - [src.data_preparation] -   ma14_t: 0.0546
2025-05-19 23:20:31,807 - INFO - [src.data_preparation] -   Volatility: 0.0518
2025-05-19 23:20:31,807 - INFO - [src.data_preparation] -   variation_t: 0.0498
2025-05-19 23:20:31,807 - INFO - [src.data_preparation] -   HL: 0.0478
2025-05-19 23:20:31,807 - INFO - [src.data_preparation] -   ret: 0.0464
2025-05-19 23:20:31,810 - INFO - [src.data_preparation] - Ticker LKW - Using features: ['Date', 'ATR', 'vnipc_t', 'Median_HL', 'SK', 'SR', 's_d7_t', 'PM', 'ma21_t', 'ma7_t', 'TVV', 'ma14_t', 'Volatility', 'variation_t', 'HL', 'ret']
2025-05-19 23:20:31,938 - INFO - [src.data_preparation] - Ticker LKW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:31,938 - INFO - [src.data_preparation] - Ticker LKW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:31,938 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LKW
2025-05-19 23:20:31,938 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:31,938 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(148), np.int64(1): np.int64(315)}
2025-05-19 23:20:31,938 - INFO - [src.data_preparation] - Generating 167 synthetic minority samples
2025-05-19 23:20:31,953 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (630, 13, 15), y shape: (630,)
2025-05-19 23:20:31,953 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(315), np.int64(1): np.int64(315)}
2025-05-19 23:20:31,957 - INFO - [src.data_preparation] - Ticker LKW - Final 3D shapes: X_train=(630, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:31,957 - INFO - [__main__] - Using best model for LKW: transformer (F1: 0.8421)
2025-05-19 23:20:31,957 - INFO - [__main__] - Loading transformer model for LKW...
2025-05-19 23:20:31,970 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:31,972 - INFO - [__main__] - Model size: 0.27 MB
2025-05-19 23:20:31,972 - INFO - [__main__] - Making predictions for LKW using transformer
2025-05-19 23:20:31,978 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:31,978 - INFO - [__main__] - Successfully got last prediction for LKW
2025-05-19 23:20:31,978 - INFO - [__main__] - 
Processing ticker: LM3
2025-05-19 23:20:31,978 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:31,978 - INFO - [__main__] - Getting last prediction point for ticker: LM3
2025-05-19 23:20:31,978 - INFO - [__main__] - ==================================================
2025-05-19 23:20:31,978 - INFO - [__main__] - Preparing test data for LM3...
2025-05-19 23:20:32,034 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:20:32,034 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:32,034 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:32,068 - INFO - [src.data_preparation] - Ticker LM3 - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:20:32,068 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(127), np.int64(1): np.int64(510)}
2025-05-19 23:20:32,361 - INFO - [src.data_preparation] - Ticker LM3 - Selected features:
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   vnipc_t: 0.1028
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   TVV: 0.0972
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   ma21_t: 0.0807
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   s_d7_t: 0.0729
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   ATR: 0.0700
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   ma14_t: 0.0696
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   ma7_t: 0.0666
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   SK: 0.0566
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   PM: 0.0444
2025-05-19 23:20:32,362 - INFO - [src.data_preparation] -   insec_t: 0.0427
2025-05-19 23:20:32,363 - INFO - [src.data_preparation] -   ret: 0.0394
2025-05-19 23:20:32,363 - INFO - [src.data_preparation] -   variation_t: 0.0359
2025-05-19 23:20:32,363 - INFO - [src.data_preparation] -   HL: 0.0315
2025-05-19 23:20:32,366 - INFO - [src.data_preparation] - Ticker LM3 - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 's_d7_t', 'ATR', 'ma14_t', 'ma7_t', 'Volatility', 'SK', 'Median_HL', 'PM', 'insec_t', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:32,462 - INFO - [src.data_preparation] - Ticker LM3 - 2D shapes: X_train=(461, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:32,462 - INFO - [src.data_preparation] - Ticker LM3 - 3D shapes: X_train=(461, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:32,467 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LM3
2025-05-19 23:20:32,467 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (461, 13, 15), y shape: (461,)
2025-05-19 23:20:32,467 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(106), np.int64(1): np.int64(355)}
2025-05-19 23:20:32,467 - INFO - [src.data_preparation] - Generating 249 synthetic minority samples
2025-05-19 23:20:32,477 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (710, 13, 15), y shape: (710,)
2025-05-19 23:20:32,477 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(355), np.int64(1): np.int64(355)}
2025-05-19 23:20:32,480 - INFO - [src.data_preparation] - Ticker LM3 - Final 3D shapes: X_train=(710, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:32,480 - INFO - [__main__] - Using best model for LM3: logistic_regression (F1: 0.9647)
2025-05-19 23:20:32,480 - INFO - [__main__] - Loading logistic_regression model for LM3...
2025-05-19 23:20:32,480 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:32,480 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:32,484 - INFO - [__main__] - Making predictions for LM3 using logistic_regression
2025-05-19 23:20:32,484 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:32,484 - INFO - [__main__] - Successfully got last prediction for LM3
2025-05-19 23:20:32,484 - INFO - [__main__] - 
Processing ticker: LM7
2025-05-19 23:20:32,484 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:32,484 - INFO - [__main__] - Getting last prediction point for ticker: LM7
2025-05-19 23:20:32,484 - INFO - [__main__] - ==================================================
2025-05-19 23:20:32,484 - INFO - [__main__] - Preparing test data for LM7...
2025-05-19 23:20:32,518 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:32,518 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:32,518 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:32,542 - INFO - [src.data_preparation] - Ticker LM7 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:32,544 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(209), np.int64(1): np.int64(429)}
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] - Ticker LM7 - Selected features:
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   vnipc_t: 0.0939
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   Volatility: 0.0779
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   TVV: 0.0722
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   s_d7_t: 0.0717
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   ATR: 0.0689
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   ma21_t: 0.0678
2025-05-19 23:20:32,848 - INFO - [src.data_preparation] -   ma14_t: 0.0656
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   insec_t: 0.0565
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   Median_HL: 0.0542
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   PM: 0.0496
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   ret: 0.0428
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   HL: 0.0402
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] -   variation_t: 0.0398
2025-05-19 23:20:32,850 - INFO - [src.data_preparation] - Ticker LM7 - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 's_d7_t', 'SK', 'ATR', 'ma21_t', 'ma14_t', 'insec_t', 'Median_HL', 'ma7_t', 'PM', 'ret', 'HL', 'variation_t']
2025-05-19 23:20:32,949 - INFO - [src.data_preparation] - Ticker LM7 - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:20:32,949 - INFO - [src.data_preparation] - Ticker LM7 - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:32,949 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LM7
2025-05-19 23:20:32,949 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:32,949 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(140), np.int64(1): np.int64(323)}
2025-05-19 23:20:32,949 - INFO - [src.data_preparation] - Generating 183 synthetic minority samples
2025-05-19 23:20:32,961 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (646, 13, 15), y shape: (646,)
2025-05-19 23:20:32,961 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(323), np.int64(1): np.int64(323)}
2025-05-19 23:20:32,967 - INFO - [src.data_preparation] - Ticker LM7 - Final 3D shapes: X_train=(646, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:32,968 - INFO - [__main__] - Using best model for LM7: lstm (F1: 0.8571)
2025-05-19 23:20:32,968 - INFO - [__main__] - Loading lstm model for LM7...
2025-05-19 23:20:32,969 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:32,973 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:20:32,973 - INFO - [__main__] - Making predictions for LM7 using lstm
2025-05-19 23:20:32,976 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:32,976 - INFO - [__main__] - Successfully got last prediction for LM7
2025-05-19 23:20:32,976 - INFO - [__main__] - 
Processing ticker: LM8
2025-05-19 23:20:32,976 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:32,976 - INFO - [__main__] - Getting last prediction point for ticker: LM8
2025-05-19 23:20:32,976 - INFO - [__main__] - ==================================================
2025-05-19 23:20:32,976 - INFO - [__main__] - Preparing test data for LM8...
2025-05-19 23:20:33,019 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:33,019 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:33,019 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:33,059 - INFO - [src.data_preparation] - Ticker LM8 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:33,059 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(267), np.int64(1): np.int64(372)}
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] - Ticker LM8 - Selected features:
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   SK: 0.0754
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   Volatility: 0.0705
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   vnipc_t: 0.0648
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   HL: 0.0632
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   s_d7_t: 0.0597
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   ma14_t: 0.0593
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   ATR: 0.0568
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   ma21_t: 0.0550
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   LO: 0.0550
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   SR: 0.0545
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   Median_HL: 0.0499
2025-05-19 23:20:33,511 - INFO - [src.data_preparation] -   ma7_t: 0.0490
2025-05-19 23:20:33,518 - INFO - [src.data_preparation] - Ticker LM8 - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'HL', 'insec_t', 's_d7_t', 'ma14_t', 'TVV', 'ATR', 'ma21_t', 'LO', 'SR', 'ret', 'Median_HL', 'ma7_t']
2025-05-19 23:20:33,618 - INFO - [src.data_preparation] - Ticker LM8 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:33,618 - INFO - [src.data_preparation] - Ticker LM8 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:33,618 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LM8
2025-05-19 23:20:33,618 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:33,618 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:20:33,618 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:20:33,628 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:20:33,628 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:20:33,628 - INFO - [src.data_preparation] - Ticker LM8 - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:33,632 - INFO - [__main__] - Using best model for LM8: transformer (F1: 0.7164)
2025-05-19 23:20:33,632 - INFO - [__main__] - Loading transformer model for LM8...
2025-05-19 23:20:33,639 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:33,649 - INFO - [__main__] - Model size: 0.44 MB
2025-05-19 23:20:33,649 - INFO - [__main__] - Making predictions for LM8 using transformer
2025-05-19 23:20:33,661 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:33,661 - INFO - [__main__] - Successfully got last prediction for LM8
2025-05-19 23:20:33,661 - INFO - [__main__] - 
Processing ticker: LO5
2025-05-19 23:20:33,661 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:33,661 - INFO - [__main__] - Getting last prediction point for ticker: LO5
2025-05-19 23:20:33,661 - INFO - [__main__] - ==================================================
2025-05-19 23:20:33,661 - INFO - [__main__] - Preparing test data for LO5...
2025-05-19 23:20:33,701 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:33,701 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:33,701 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:33,739 - INFO - [src.data_preparation] - Ticker LO5 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:33,739 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(191), np.int64(1): np.int64(448)}
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] - Ticker LO5 - Selected features:
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   vnipc_t: 0.0871
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   TVV: 0.0870
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   ma14_t: 0.0792
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   Volatility: 0.0744
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   ma21_t: 0.0711
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   s_d7_t: 0.0670
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   SK: 0.0656
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   ATR: 0.0622
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   insec_t: 0.0589
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   ma7_t: 0.0589
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   PM: 0.0560
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   ret: 0.0404
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   variation_t: 0.0369
2025-05-19 23:20:34,059 - INFO - [src.data_preparation] -   HL: 0.0348
2025-05-19 23:20:34,064 - INFO - [src.data_preparation] - Ticker LO5 - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 'Volatility', 'ma21_t', 's_d7_t', 'SK', 'ATR', 'insec_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:34,158 - INFO - [src.data_preparation] - Ticker LO5 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:34,158 - INFO - [src.data_preparation] - Ticker LO5 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:34,159 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LO5
2025-05-19 23:20:34,159 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:34,159 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(147), np.int64(1): np.int64(316)}
2025-05-19 23:20:34,159 - INFO - [src.data_preparation] - Generating 169 synthetic minority samples
2025-05-19 23:20:34,167 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (632, 13, 15), y shape: (632,)
2025-05-19 23:20:34,167 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(316), np.int64(1): np.int64(316)}
2025-05-19 23:20:34,169 - INFO - [src.data_preparation] - Ticker LO5 - Final 3D shapes: X_train=(632, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:34,169 - INFO - [__main__] - Using best model for LO5: svm (F1: 0.8571)
2025-05-19 23:20:34,169 - INFO - [__main__] - Loading svm model for LO5...
2025-05-19 23:20:34,169 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:34,169 - INFO - [__main__] - Model size: 0.95 MB
2025-05-19 23:20:34,169 - INFO - [__main__] - Making predictions for LO5 using svm
2025-05-19 23:20:34,169 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:34,169 - INFO - [__main__] - Successfully got last prediction for LO5
2025-05-19 23:20:34,169 - INFO - [__main__] - 
Processing ticker: LSS
2025-05-19 23:20:34,174 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:34,174 - INFO - [__main__] - Getting last prediction point for ticker: LSS
2025-05-19 23:20:34,174 - INFO - [__main__] - ==================================================
2025-05-19 23:20:34,174 - INFO - [__main__] - Preparing test data for LSS...
2025-05-19 23:20:34,202 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:34,202 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:34,202 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:34,222 - INFO - [src.data_preparation] - Ticker LSS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:34,222 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(318), np.int64(1): np.int64(321)}
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] - Ticker LSS - Selected features:
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   SK: 0.0706
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   Volatility: 0.0629
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   TVV: 0.0618
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   vnipc_t: 0.0607
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   ret: 0.0596
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   LO: 0.0573
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   Median_HL: 0.0566
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   ATR: 0.0553
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   s_d7_t: 0.0553
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   HL: 0.0538
2025-05-19 23:20:34,589 - INFO - [src.data_preparation] -   PM: 0.0536
2025-05-19 23:20:34,599 - INFO - [src.data_preparation] - Ticker LSS - Using features: ['Date', 'SK', 'Volatility', 'insec_t', 'TVV', 'vnipc_t', 'ret', 'ma21_t', 'LO', 'Median_HL', 'variation_t', 'ATR', 's_d7_t', 'ma7_t', 'HL', 'PM']
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Ticker LSS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Ticker LSS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LSS
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(223), np.int64(1): np.int64(240)}
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Generating 17 synthetic minority samples
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (480, 13, 15), y shape: (480,)
2025-05-19 23:20:34,708 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(240)}
2025-05-19 23:20:34,719 - INFO - [src.data_preparation] - Ticker LSS - Final 3D shapes: X_train=(480, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:34,719 - INFO - [__main__] - Using best model for LSS: transformer (F1: 0.6087)
2025-05-19 23:20:34,719 - INFO - [__main__] - Loading transformer model for LSS...
2025-05-19 23:20:34,727 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:34,732 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:20:34,732 - INFO - [__main__] - Making predictions for LSS using transformer
2025-05-19 23:20:34,735 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:34,735 - INFO - [__main__] - Successfully got last prediction for LSS
2025-05-19 23:20:34,735 - INFO - [__main__] - 
Processing ticker: LTC
2025-05-19 23:20:34,737 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:34,737 - INFO - [__main__] - Getting last prediction point for ticker: LTC
2025-05-19 23:20:34,737 - INFO - [__main__] - ==================================================
2025-05-19 23:20:34,737 - INFO - [__main__] - Preparing test data for LTC...
2025-05-19 23:20:34,788 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:34,788 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:34,788 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:34,818 - INFO - [src.data_preparation] - Ticker LTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:34,818 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(225), np.int64(1): np.int64(414)}
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] - Ticker LTC - Selected features:
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   vnipc_t: 0.0758
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   s_d7_t: 0.0735
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   ma14_t: 0.0652
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   insec_t: 0.0615
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   ma21_t: 0.0598
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   ATR: 0.0576
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   ma7_t: 0.0568
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   Median_HL: 0.0500
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   variation_t: 0.0479
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] -   SR: 0.0434
2025-05-19 23:20:35,118 - INFO - [src.data_preparation] - Ticker LTC - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'SK', 'Volatility', 'ma14_t', 'insec_t', 'ma21_t', 'ATR', 'ma7_t', 'PM', 'ret', 'Median_HL', 'variation_t', 'SR']
2025-05-19 23:20:35,312 - INFO - [src.data_preparation] - Ticker LTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:35,312 - INFO - [src.data_preparation] - Ticker LTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:35,312 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LTC
2025-05-19 23:20:35,312 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:35,312 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(162), np.int64(1): np.int64(301)}
2025-05-19 23:20:35,312 - INFO - [src.data_preparation] - Generating 139 synthetic minority samples
2025-05-19 23:20:35,319 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (602, 13, 15), y shape: (602,)
2025-05-19 23:20:35,319 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(301), np.int64(1): np.int64(301)}
2025-05-19 23:20:35,324 - INFO - [src.data_preparation] - Ticker LTC - Final 3D shapes: X_train=(602, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:35,324 - INFO - [__main__] - Using best model for LTC: svm (F1: 0.7429)
2025-05-19 23:20:35,324 - INFO - [__main__] - Loading svm model for LTC...
2025-05-19 23:20:35,324 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:35,327 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:20:35,327 - INFO - [__main__] - Making predictions for LTC using svm
2025-05-19 23:20:35,327 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:35,328 - INFO - [__main__] - Successfully got last prediction for LTC
2025-05-19 23:20:35,328 - INFO - [__main__] - 
Processing ticker: LUT
2025-05-19 23:20:35,328 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:35,328 - INFO - [__main__] - Getting last prediction point for ticker: LUT
2025-05-19 23:20:35,328 - INFO - [__main__] - ==================================================
2025-05-19 23:20:35,328 - INFO - [__main__] - Preparing test data for LUT...
2025-05-19 23:20:35,355 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:35,355 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:35,355 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:35,371 - INFO - [src.data_preparation] - Ticker LUT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:35,371 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(239), np.int64(1): np.int64(399)}
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] - Ticker LUT - Selected features:
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   vnipc_t: 0.0819
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   s_d7_t: 0.0766
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   TVV: 0.0737
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   Volatility: 0.0730
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   insec_t: 0.0663
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   ma14_t: 0.0629
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   ma21_t: 0.0624
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   ma7_t: 0.0617
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   SK: 0.0611
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   ATR: 0.0552
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   Median_HL: 0.0527
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   ret: 0.0506
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   variation_t: 0.0477
2025-05-19 23:20:35,743 - INFO - [src.data_preparation] -   HL: 0.0381
2025-05-19 23:20:35,749 - INFO - [src.data_preparation] - Ticker LUT - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'Volatility', 'insec_t', 'ma14_t', 'ma21_t', 'ma7_t', 'SK', 'PM', 'ATR', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:35,849 - INFO - [src.data_preparation] - Ticker LUT - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:20:35,849 - INFO - [src.data_preparation] - Ticker LUT - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:35,849 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker LUT
2025-05-19 23:20:35,849 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:35,857 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(180), np.int64(1): np.int64(283)}
2025-05-19 23:20:35,857 - INFO - [src.data_preparation] - Generating 103 synthetic minority samples
2025-05-19 23:20:35,859 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (566, 13, 15), y shape: (566,)
2025-05-19 23:20:35,859 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(283), np.int64(1): np.int64(283)}
2025-05-19 23:20:35,859 - INFO - [src.data_preparation] - Ticker LUT - Final 3D shapes: X_train=(566, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:35,859 - INFO - [__main__] - Using best model for LUT: lstm (F1: 0.8718)
2025-05-19 23:20:35,859 - INFO - [__main__] - Loading lstm model for LUT...
2025-05-19 23:20:35,868 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:35,868 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:20:35,868 - INFO - [__main__] - Making predictions for LUT using lstm
2025-05-19 23:20:35,868 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:35,868 - INFO - [__main__] - Successfully got last prediction for LUT
2025-05-19 23:20:35,868 - INFO - [__main__] - 
Processing ticker: MAC
2025-05-19 23:20:35,868 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:35,868 - INFO - [__main__] - Getting last prediction point for ticker: MAC
2025-05-19 23:20:35,868 - INFO - [__main__] - ==================================================
2025-05-19 23:20:35,868 - INFO - [__main__] - Preparing test data for MAC...
2025-05-19 23:20:35,919 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:35,919 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:35,919 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:35,947 - INFO - [src.data_preparation] - Ticker MAC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:35,947 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(272), np.int64(1): np.int64(367)}
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] - Ticker MAC - Selected features:
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   vnipc_t: 0.0756
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   SK: 0.0699
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   insec_t: 0.0697
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   LO: 0.0646
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   HL: 0.0604
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   Volatility: 0.0586
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   ATR: 0.0580
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   ret: 0.0550
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   SR: 0.0549
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   Median_HL: 0.0546
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   variation_t: 0.0543
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   ma21_t: 0.0527
2025-05-19 23:20:36,332 - INFO - [src.data_preparation] -   ma14_t: 0.0524
2025-05-19 23:20:36,337 - INFO - [src.data_preparation] - Ticker MAC - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'LO', 's_d7_t', 'HL', 'TVV', 'Volatility', 'ATR', 'ret', 'SR', 'Median_HL', 'variation_t', 'ma21_t', 'ma14_t']
2025-05-19 23:20:36,429 - INFO - [src.data_preparation] - Ticker MAC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:36,429 - INFO - [src.data_preparation] - Ticker MAC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:36,433 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MAC
2025-05-19 23:20:36,433 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:36,433 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(192), np.int64(1): np.int64(271)}
2025-05-19 23:20:36,433 - INFO - [src.data_preparation] - Generating 79 synthetic minority samples
2025-05-19 23:20:36,438 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (542, 13, 15), y shape: (542,)
2025-05-19 23:20:36,438 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(271), np.int64(1): np.int64(271)}
2025-05-19 23:20:36,442 - INFO - [src.data_preparation] - Ticker MAC - Final 3D shapes: X_train=(542, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:36,442 - INFO - [__main__] - Using best model for MAC: transformer (F1: 0.6875)
2025-05-19 23:20:36,442 - INFO - [__main__] - Loading transformer model for MAC...
2025-05-19 23:20:36,453 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:36,458 - INFO - [__main__] - Model size: 0.46 MB
2025-05-19 23:20:36,458 - INFO - [__main__] - Making predictions for MAC using transformer
2025-05-19 23:20:36,458 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:36,462 - INFO - [__main__] - Successfully got last prediction for MAC
2025-05-19 23:20:36,462 - INFO - [__main__] - 
Processing ticker: MAS
2025-05-19 23:20:36,462 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:36,462 - INFO - [__main__] - Getting last prediction point for ticker: MAS
2025-05-19 23:20:36,462 - INFO - [__main__] - ==================================================
2025-05-19 23:20:36,462 - INFO - [__main__] - Preparing test data for MAS...
2025-05-19 23:20:36,513 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:36,513 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:36,513 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:36,548 - INFO - [src.data_preparation] - Ticker MAS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:36,548 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(264), np.int64(1): np.int64(375)}
2025-05-19 23:20:36,932 - INFO - [src.data_preparation] - Ticker MAS - Selected features:
2025-05-19 23:20:36,932 - INFO - [src.data_preparation] -   SK: 0.0749
2025-05-19 23:20:36,932 - INFO - [src.data_preparation] -   TVV: 0.0734
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   Volatility: 0.0723
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   vnipc_t: 0.0673
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   insec_t: 0.0613
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   ma14_t: 0.0600
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   SR: 0.0581
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   ATR: 0.0573
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   PM: 0.0550
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   HL: 0.0522
2025-05-19 23:20:36,933 - INFO - [src.data_preparation] -   variation_t: 0.0495
2025-05-19 23:20:36,937 - INFO - [src.data_preparation] - Ticker MAS - Using features: ['Date', 'SK', 'TVV', 'Volatility', 'vnipc_t', 's_d7_t', 'insec_t', 'ma14_t', 'SR', 'ATR', 'PM', 'ma21_t', 'Median_HL', 'ret', 'HL', 'variation_t']
2025-05-19 23:20:37,039 - INFO - [src.data_preparation] - Ticker MAS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:37,039 - INFO - [src.data_preparation] - Ticker MAS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:37,041 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MAS
2025-05-19 23:20:37,041 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:37,042 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:20:37,042 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:20:37,045 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:20:37,045 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:20:37,048 - INFO - [src.data_preparation] - Ticker MAS - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:37,048 - INFO - [__main__] - Using best model for MAS: svm (F1: 0.7429)
2025-05-19 23:20:37,049 - INFO - [__main__] - Loading svm model for MAS...
2025-05-19 23:20:37,050 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:37,050 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:20:37,051 - INFO - [__main__] - Making predictions for MAS using svm
2025-05-19 23:20:37,051 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:37,052 - INFO - [__main__] - Successfully got last prediction for MAS
2025-05-19 23:20:37,052 - INFO - [__main__] - 
Processing ticker: MBB
2025-05-19 23:20:37,052 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:37,052 - INFO - [__main__] - Getting last prediction point for ticker: MBB
2025-05-19 23:20:37,052 - INFO - [__main__] - ==================================================
2025-05-19 23:20:37,052 - INFO - [__main__] - Preparing test data for MBB...
2025-05-19 23:20:37,085 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:37,086 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:37,086 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:37,109 - INFO - [src.data_preparation] - Ticker MBB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:37,109 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(371)}
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] - Ticker MBB - Selected features:
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] -   insec_t: 0.0708
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] -   SK: 0.0692
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] -   Volatility: 0.0678
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] -   vnipc_t: 0.0664
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] -   s_d7_t: 0.0657
2025-05-19 23:20:37,491 - INFO - [src.data_preparation] -   TVV: 0.0631
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   ATR: 0.0601
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   ret: 0.0573
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   ma14_t: 0.0551
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   variation_t: 0.0550
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   ma7_t: 0.0535
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   ma21_t: 0.0532
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   SR: 0.0531
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   HL: 0.0523
2025-05-19 23:20:37,492 - INFO - [src.data_preparation] -   PM: 0.0501
2025-05-19 23:20:37,496 - INFO - [src.data_preparation] - Ticker MBB - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'vnipc_t', 's_d7_t', 'TVV', 'ATR', 'ret', 'ma14_t', 'variation_t', 'ma7_t', 'ma21_t', 'SR', 'HL', 'PM']
2025-05-19 23:20:37,599 - INFO - [src.data_preparation] - Ticker MBB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:37,599 - INFO - [src.data_preparation] - Ticker MBB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:37,599 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MBB
2025-05-19 23:20:37,599 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:37,599 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:20:37,599 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:20:37,611 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:20:37,611 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:20:37,616 - INFO - [src.data_preparation] - Ticker MBB - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:37,617 - INFO - [__main__] - Using best model for MBB: logistic_regression (F1: 0.5366)
2025-05-19 23:20:37,617 - INFO - [__main__] - Loading logistic_regression model for MBB...
2025-05-19 23:20:37,618 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:37,618 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:37,618 - INFO - [__main__] - Making predictions for MBB using logistic_regression
2025-05-19 23:20:37,619 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:37,620 - INFO - [__main__] - Successfully got last prediction for MBB
2025-05-19 23:20:37,620 - INFO - [__main__] - 
Processing ticker: MCC
2025-05-19 23:20:37,620 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:37,620 - INFO - [__main__] - Getting last prediction point for ticker: MCC
2025-05-19 23:20:37,620 - INFO - [__main__] - ==================================================
2025-05-19 23:20:37,620 - INFO - [__main__] - Preparing test data for MCC...
2025-05-19 23:20:37,660 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:37,661 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:37,661 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:37,681 - INFO - [src.data_preparation] - Ticker MCC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:37,681 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(136), np.int64(1): np.int64(503)}
2025-05-19 23:20:37,968 - INFO - [src.data_preparation] - Ticker MCC - Selected features:
2025-05-19 23:20:37,968 - INFO - [src.data_preparation] -   TVV: 0.0958
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   vnipc_t: 0.0857
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   ma21_t: 0.0790
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   ATR: 0.0727
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   HL: 0.0684
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   ma14_t: 0.0622
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   ma7_t: 0.0571
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   s_d7_t: 0.0563
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   Volatility: 0.0556
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   LO: 0.0510
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   SK: 0.0491
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   Median_HL: 0.0482
2025-05-19 23:20:37,969 - INFO - [src.data_preparation] -   insec_t: 0.0459
2025-05-19 23:20:37,970 - INFO - [src.data_preparation] -   PM: 0.0453
2025-05-19 23:20:37,970 - INFO - [src.data_preparation] -   variation_t: 0.0437
2025-05-19 23:20:37,973 - INFO - [src.data_preparation] - Ticker MCC - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'ATR', 'HL', 'ma14_t', 'ma7_t', 's_d7_t', 'Volatility', 'LO', 'SK', 'Median_HL', 'insec_t', 'PM', 'variation_t']
2025-05-19 23:20:38,096 - INFO - [src.data_preparation] - Ticker MCC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:38,097 - INFO - [src.data_preparation] - Ticker MCC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:38,098 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MCC
2025-05-19 23:20:38,099 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:38,099 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(122), np.int64(1): np.int64(341)}
2025-05-19 23:20:38,099 - INFO - [src.data_preparation] - Generating 219 synthetic minority samples
2025-05-19 23:20:38,113 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (682, 13, 15), y shape: (682,)
2025-05-19 23:20:38,113 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(341), np.int64(1): np.int64(341)}
2025-05-19 23:20:38,119 - INFO - [src.data_preparation] - Ticker MCC - Final 3D shapes: X_train=(682, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:38,120 - INFO - [__main__] - Using best model for MCC: svm (F1: 0.9647)
2025-05-19 23:20:38,120 - INFO - [__main__] - Loading svm model for MCC...
2025-05-19 23:20:38,120 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:38,120 - INFO - [__main__] - Model size: 0.55 MB
2025-05-19 23:20:38,120 - INFO - [__main__] - Making predictions for MCC using svm
2025-05-19 23:20:38,120 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:38,120 - INFO - [__main__] - Successfully got last prediction for MCC
2025-05-19 23:20:38,120 - INFO - [__main__] - 
Processing ticker: MCF
2025-05-19 23:20:38,120 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:38,120 - INFO - [__main__] - Getting last prediction point for ticker: MCF
2025-05-19 23:20:38,120 - INFO - [__main__] - ==================================================
2025-05-19 23:20:38,120 - INFO - [__main__] - Preparing test data for MCF...
2025-05-19 23:20:38,159 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:38,159 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:38,159 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:38,188 - INFO - [src.data_preparation] - Ticker MCF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:38,188 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(258), np.int64(1): np.int64(381)}
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] - Ticker MCF - Selected features:
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   ATR: 0.0707
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   vnipc_t: 0.0680
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   s_d7_t: 0.0670
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   insec_t: 0.0601
2025-05-19 23:20:38,509 - INFO - [src.data_preparation] -   TVV: 0.0600
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   PM: 0.0592
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   SK: 0.0583
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   ma21_t: 0.0573
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   Median_HL: 0.0560
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   ret: 0.0550
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   variation_t: 0.0547
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   ma14_t: 0.0531
2025-05-19 23:20:38,510 - INFO - [src.data_preparation] -   ma7_t: 0.0520
2025-05-19 23:20:38,513 - INFO - [src.data_preparation] - Ticker MCF - Using features: ['Date', 'ATR', 'vnipc_t', 's_d7_t', 'Volatility', 'HL', 'insec_t', 'TVV', 'PM', 'SK', 'ma21_t', 'Median_HL', 'ret', 'variation_t', 'ma14_t', 'ma7_t']
2025-05-19 23:20:38,602 - INFO - [src.data_preparation] - Ticker MCF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:38,602 - INFO - [src.data_preparation] - Ticker MCF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:38,608 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MCF
2025-05-19 23:20:38,609 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:38,609 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:20:38,609 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:20:38,609 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:20:38,609 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:20:38,622 - INFO - [src.data_preparation] - Ticker MCF - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:38,622 - INFO - [__main__] - Using best model for MCF: svm (F1: 0.7429)
2025-05-19 23:20:38,622 - INFO - [__main__] - Loading svm model for MCF...
2025-05-19 23:20:38,622 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:38,622 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:20:38,622 - INFO - [__main__] - Making predictions for MCF using svm
2025-05-19 23:20:38,627 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:38,627 - INFO - [__main__] - Successfully got last prediction for MCF
2025-05-19 23:20:38,627 - INFO - [__main__] - 
Processing ticker: MCG
2025-05-19 23:20:38,627 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:38,627 - INFO - [__main__] - Getting last prediction point for ticker: MCG
2025-05-19 23:20:38,627 - INFO - [__main__] - ==================================================
2025-05-19 23:20:38,627 - INFO - [__main__] - Preparing test data for MCG...
2025-05-19 23:20:38,662 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:38,662 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:38,662 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:38,681 - INFO - [src.data_preparation] - Ticker MCG - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:38,681 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(313), np.int64(1): np.int64(325)}
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] - Ticker MCG - Selected features:
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   vnipc_t: 0.0797
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   s_d7_t: 0.0742
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   Volatility: 0.0693
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   SK: 0.0686
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   insec_t: 0.0641
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   ma21_t: 0.0576
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   ATR: 0.0572
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   variation_t: 0.0556
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   ma14_t: 0.0537
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   HL: 0.0525
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   SR: 0.0500
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   ma7_t: 0.0500
2025-05-19 23:20:39,002 - INFO - [src.data_preparation] -   Median_HL: 0.0482
2025-05-19 23:20:39,007 - INFO - [src.data_preparation] - Ticker MCG - Using features: ['Date', 'vnipc_t', 's_d7_t', 'Volatility', 'SK', 'insec_t', 'TVV', 'ma21_t', 'ATR', 'variation_t', 'ma14_t', 'ret', 'HL', 'SR', 'ma7_t', 'Median_HL']
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Ticker MCG - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Ticker MCG - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MCG
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(224), np.int64(1): np.int64(239)}
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Generating 15 synthetic minority samples
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:20:39,089 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:20:39,101 - INFO - [src.data_preparation] - Ticker MCG - Final 3D shapes: X_train=(478, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:39,101 - INFO - [__main__] - Using best model for MCG: lstm (F1: 0.7692)
2025-05-19 23:20:39,101 - INFO - [__main__] - Loading lstm model for MCG...
2025-05-19 23:20:39,108 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:39,108 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:20:39,108 - INFO - [__main__] - Making predictions for MCG using lstm
2025-05-19 23:20:39,113 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:39,113 - INFO - [__main__] - Successfully got last prediction for MCG
2025-05-19 23:20:39,113 - INFO - [__main__] - 
Processing ticker: MCO
2025-05-19 23:20:39,113 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:39,117 - INFO - [__main__] - Getting last prediction point for ticker: MCO
2025-05-19 23:20:39,117 - INFO - [__main__] - ==================================================
2025-05-19 23:20:39,117 - INFO - [__main__] - Preparing test data for MCO...
2025-05-19 23:20:39,172 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:39,172 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:39,172 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:39,205 - INFO - [src.data_preparation] - Ticker MCO - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:39,207 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(251), np.int64(1): np.int64(388)}
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] - Ticker MCO - Selected features:
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   insec_t: 0.0836
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   vnipc_t: 0.0815
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   TVV: 0.0713
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   Volatility: 0.0709
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   SK: 0.0673
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   ma21_t: 0.0655
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   ma14_t: 0.0654
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:20:39,681 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:20:39,682 - INFO - [src.data_preparation] -   ATR: 0.0551
2025-05-19 23:20:39,682 - INFO - [src.data_preparation] -   Median_HL: 0.0543
2025-05-19 23:20:39,682 - INFO - [src.data_preparation] -   ret: 0.0511
2025-05-19 23:20:39,682 - INFO - [src.data_preparation] -   variation_t: 0.0464
2025-05-19 23:20:39,682 - INFO - [src.data_preparation] -   SR: 0.0378
2025-05-19 23:20:39,685 - INFO - [src.data_preparation] - Ticker MCO - Using features: ['Date', 'insec_t', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'ma21_t', 'ma14_t', 's_d7_t', 'ma7_t', 'PM', 'ATR', 'Median_HL', 'ret', 'variation_t', 'SR']
2025-05-19 23:20:39,855 - INFO - [src.data_preparation] - Ticker MCO - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:39,855 - INFO - [src.data_preparation] - Ticker MCO - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:39,858 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MCO
2025-05-19 23:20:39,858 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:39,858 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:20:39,858 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:20:39,865 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:20:39,865 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:20:39,870 - INFO - [src.data_preparation] - Ticker MCO - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:39,871 - INFO - [__main__] - Using best model for MCO: svm (F1: 0.5574)
2025-05-19 23:20:39,871 - INFO - [__main__] - Loading svm model for MCO...
2025-05-19 23:20:39,875 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:39,876 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:20:39,877 - INFO - [__main__] - Making predictions for MCO using svm
2025-05-19 23:20:39,878 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:39,879 - INFO - [__main__] - Successfully got last prediction for MCO
2025-05-19 23:20:39,879 - INFO - [__main__] - 
Processing ticker: MCP
2025-05-19 23:20:39,879 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:39,879 - INFO - [__main__] - Getting last prediction point for ticker: MCP
2025-05-19 23:20:39,879 - INFO - [__main__] - ==================================================
2025-05-19 23:20:39,880 - INFO - [__main__] - Preparing test data for MCP...
2025-05-19 23:20:39,943 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:39,943 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:39,943 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:39,981 - INFO - [src.data_preparation] - Ticker MCP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:39,981 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:20:40,547 - INFO - [src.data_preparation] - Ticker MCP - Selected features:
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   vnipc_t: 0.0815
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   ATR: 0.0673
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   insec_t: 0.0638
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   ma21_t: 0.0608
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   Volatility: 0.0578
2025-05-19 23:20:40,548 - INFO - [src.data_preparation] -   ma7_t: 0.0574
2025-05-19 23:20:40,549 - INFO - [src.data_preparation] -   ret: 0.0570
2025-05-19 23:20:40,549 - INFO - [src.data_preparation] -   variation_t: 0.0560
2025-05-19 23:20:40,549 - INFO - [src.data_preparation] -   SR: 0.0532
2025-05-19 23:20:40,549 - INFO - [src.data_preparation] -   ma14_t: 0.0526
2025-05-19 23:20:40,549 - INFO - [src.data_preparation] -   PM: 0.0518
2025-05-19 23:20:40,549 - INFO - [src.data_preparation] -   HL: 0.0516
2025-05-19 23:20:40,554 - INFO - [src.data_preparation] - Ticker MCP - Using features: ['Date', 'vnipc_t', 'SK', 'ATR', 'insec_t', 's_d7_t', 'TVV', 'ma21_t', 'Volatility', 'ma7_t', 'ret', 'variation_t', 'SR', 'ma14_t', 'PM', 'HL']
2025-05-19 23:20:40,728 - INFO - [src.data_preparation] - Ticker MCP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:40,728 - INFO - [src.data_preparation] - Ticker MCP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:40,730 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MCP
2025-05-19 23:20:40,730 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:40,730 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:20:40,730 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:20:40,737 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:20:40,737 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:20:40,744 - INFO - [src.data_preparation] - Ticker MCP - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:40,745 - INFO - [__main__] - Using best model for MCP: svm (F1: 0.7246)
2025-05-19 23:20:40,745 - INFO - [__main__] - Loading svm model for MCP...
2025-05-19 23:20:40,748 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:40,749 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:20:40,749 - INFO - [__main__] - Making predictions for MCP using svm
2025-05-19 23:20:40,750 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:40,750 - INFO - [__main__] - Successfully got last prediction for MCP
2025-05-19 23:20:40,750 - INFO - [__main__] - 
Processing ticker: MDC
2025-05-19 23:20:40,750 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:40,750 - INFO - [__main__] - Getting last prediction point for ticker: MDC
2025-05-19 23:20:40,750 - INFO - [__main__] - ==================================================
2025-05-19 23:20:40,750 - INFO - [__main__] - Preparing test data for MDC...
2025-05-19 23:20:40,808 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:40,808 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:40,808 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:40,848 - INFO - [src.data_preparation] - Ticker MDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:40,848 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(229), np.int64(1): np.int64(410)}
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] - Ticker MDC - Selected features:
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   vnipc_t: 0.0779
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   s_d7_t: 0.0708
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   ATR: 0.0676
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   SK: 0.0654
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   insec_t: 0.0614
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   TVV: 0.0607
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   ma21_t: 0.0605
2025-05-19 23:20:41,250 - INFO - [src.data_preparation] -   ma7_t: 0.0596
2025-05-19 23:20:41,251 - INFO - [src.data_preparation] -   ma14_t: 0.0591
2025-05-19 23:20:41,251 - INFO - [src.data_preparation] -   Median_HL: 0.0574
2025-05-19 23:20:41,251 - INFO - [src.data_preparation] -   PM: 0.0569
2025-05-19 23:20:41,251 - INFO - [src.data_preparation] -   HL: 0.0490
2025-05-19 23:20:41,251 - INFO - [src.data_preparation] -   SR: 0.0466
2025-05-19 23:20:41,251 - INFO - [src.data_preparation] -   variation_t: 0.0463
2025-05-19 23:20:41,254 - INFO - [src.data_preparation] - Ticker MDC - Using features: ['Date', 'vnipc_t', 's_d7_t', 'ATR', 'Volatility', 'SK', 'insec_t', 'TVV', 'ma21_t', 'ma7_t', 'ma14_t', 'Median_HL', 'PM', 'HL', 'SR', 'variation_t']
2025-05-19 23:20:41,369 - INFO - [src.data_preparation] - Ticker MDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:41,370 - INFO - [src.data_preparation] - Ticker MDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:41,372 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MDC
2025-05-19 23:20:41,372 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:41,372 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:20:41,372 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:20:41,381 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:20:41,381 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:20:41,385 - INFO - [src.data_preparation] - Ticker MDC - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:41,386 - INFO - [__main__] - Using best model for MDC: svm (F1: 0.7778)
2025-05-19 23:20:41,386 - INFO - [__main__] - Loading svm model for MDC...
2025-05-19 23:20:41,388 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:41,389 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:20:41,389 - INFO - [__main__] - Making predictions for MDC using svm
2025-05-19 23:20:41,391 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:41,392 - INFO - [__main__] - Successfully got last prediction for MDC
2025-05-19 23:20:41,393 - INFO - [__main__] - 
Processing ticker: MDF
2025-05-19 23:20:41,393 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:41,393 - INFO - [__main__] - Getting last prediction point for ticker: MDF
2025-05-19 23:20:41,393 - INFO - [__main__] - ==================================================
2025-05-19 23:20:41,393 - INFO - [__main__] - Preparing test data for MDF...
2025-05-19 23:20:41,443 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:41,443 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:41,444 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:41,473 - INFO - [src.data_preparation] - Ticker MDF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:41,473 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(174), np.int64(1): np.int64(465)}
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] - Ticker MDF - Selected features:
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   TVV: 0.0931
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   vnipc_t: 0.0817
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   ATR: 0.0751
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   ma21_t: 0.0734
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   ma14_t: 0.0731
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   ma7_t: 0.0600
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   SK: 0.0588
2025-05-19 23:20:41,924 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:20:41,925 - INFO - [src.data_preparation] -   Median_HL: 0.0540
2025-05-19 23:20:41,925 - INFO - [src.data_preparation] -   insec_t: 0.0523
2025-05-19 23:20:41,925 - INFO - [src.data_preparation] -   Volatility: 0.0516
2025-05-19 23:20:41,925 - INFO - [src.data_preparation] -   PM: 0.0475
2025-05-19 23:20:41,925 - INFO - [src.data_preparation] -   ret: 0.0424
2025-05-19 23:20:41,925 - INFO - [src.data_preparation] -   variation_t: 0.0414
2025-05-19 23:20:41,930 - INFO - [src.data_preparation] - Ticker MDF - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'ma21_t', 'ma14_t', 's_d7_t', 'ma7_t', 'SK', 'HL', 'Median_HL', 'insec_t', 'Volatility', 'PM', 'ret', 'variation_t']
2025-05-19 23:20:42,077 - INFO - [src.data_preparation] - Ticker MDF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:42,077 - INFO - [src.data_preparation] - Ticker MDF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:42,079 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MDF
2025-05-19 23:20:42,079 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:42,080 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(92), np.int64(1): np.int64(371)}
2025-05-19 23:20:42,080 - INFO - [src.data_preparation] - Generating 279 synthetic minority samples
2025-05-19 23:20:42,093 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (742, 13, 15), y shape: (742,)
2025-05-19 23:20:42,093 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(371), np.int64(1): np.int64(371)}
2025-05-19 23:20:42,098 - INFO - [src.data_preparation] - Ticker MDF - Final 3D shapes: X_train=(742, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:42,098 - INFO - [__main__] - Using best model for MDF: svm (F1: 0.7246)
2025-05-19 23:20:42,098 - INFO - [__main__] - Loading svm model for MDF...
2025-05-19 23:20:42,098 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:42,098 - INFO - [__main__] - Model size: 1.11 MB
2025-05-19 23:20:42,098 - INFO - [__main__] - Making predictions for MDF using svm
2025-05-19 23:20:42,098 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:42,098 - INFO - [__main__] - Successfully got last prediction for MDF
2025-05-19 23:20:42,098 - INFO - [__main__] - 
Processing ticker: MDG
2025-05-19 23:20:42,098 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:42,098 - INFO - [__main__] - Getting last prediction point for ticker: MDG
2025-05-19 23:20:42,098 - INFO - [__main__] - ==================================================
2025-05-19 23:20:42,098 - INFO - [__main__] - Preparing test data for MDG...
2025-05-19 23:20:42,149 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:42,149 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:42,149 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:42,180 - INFO - [src.data_preparation] - Ticker MDG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:42,180 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:20:42,632 - INFO - [src.data_preparation] - Ticker MDG - Selected features:
2025-05-19 23:20:42,632 - INFO - [src.data_preparation] -   TVV: 0.0751
2025-05-19 23:20:42,632 - INFO - [src.data_preparation] -   SK: 0.0707
2025-05-19 23:20:42,632 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   vnipc_t: 0.0658
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   SR: 0.0623
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   s_d7_t: 0.0582
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   LO: 0.0574
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   ATR: 0.0573
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   HL: 0.0562
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   ma21_t: 0.0558
2025-05-19 23:20:42,633 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:20:42,634 - INFO - [src.data_preparation] -   ma14_t: 0.0528
2025-05-19 23:20:42,634 - INFO - [src.data_preparation] -   variation_t: 0.0517
2025-05-19 23:20:42,634 - INFO - [src.data_preparation] -   ma7_t: 0.0510
2025-05-19 23:20:42,640 - INFO - [src.data_preparation] - Ticker MDG - Using features: ['Date', 'TVV', 'SK', 'Volatility', 'vnipc_t', 'insec_t', 'SR', 's_d7_t', 'LO', 'ATR', 'HL', 'ma21_t', 'ret', 'ma14_t', 'variation_t', 'ma7_t']
2025-05-19 23:20:42,795 - INFO - [src.data_preparation] - Ticker MDG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:42,795 - INFO - [src.data_preparation] - Ticker MDG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:42,797 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MDG
2025-05-19 23:20:42,797 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:42,797 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(259)}
2025-05-19 23:20:42,798 - INFO - [src.data_preparation] - Generating 55 synthetic minority samples
2025-05-19 23:20:42,801 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:20:42,801 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:20:42,812 - INFO - [src.data_preparation] - Ticker MDG - Final 3D shapes: X_train=(518, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:42,813 - INFO - [__main__] - Using best model for MDG: svm (F1: 0.8718)
2025-05-19 23:20:42,813 - INFO - [__main__] - Loading svm model for MDG...
2025-05-19 23:20:42,816 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:42,817 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:20:42,818 - INFO - [__main__] - Making predictions for MDG using svm
2025-05-19 23:20:42,819 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:42,819 - INFO - [__main__] - Successfully got last prediction for MDG
2025-05-19 23:20:42,819 - INFO - [__main__] - 
Processing ticker: MEC
2025-05-19 23:20:42,819 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:42,820 - INFO - [__main__] - Getting last prediction point for ticker: MEC
2025-05-19 23:20:42,820 - INFO - [__main__] - ==================================================
2025-05-19 23:20:42,820 - INFO - [__main__] - Preparing test data for MEC...
2025-05-19 23:20:42,900 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:42,900 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:42,900 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:42,929 - INFO - [src.data_preparation] - Ticker MEC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:42,929 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(238), np.int64(1): np.int64(401)}
2025-05-19 23:20:43,304 - INFO - [src.data_preparation] - Ticker MEC - Selected features:
2025-05-19 23:20:43,304 - INFO - [src.data_preparation] -   vnipc_t: 0.0831
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   TVV: 0.0755
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   ma21_t: 0.0714
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   insec_t: 0.0672
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   SK: 0.0614
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   ret: 0.0575
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   ma14_t: 0.0569
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   s_d7_t: 0.0554
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   ma7_t: 0.0550
2025-05-19 23:20:43,305 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:20:43,307 - INFO - [src.data_preparation] -   Median_HL: 0.0515
2025-05-19 23:20:43,307 - INFO - [src.data_preparation] -   PM: 0.0513
2025-05-19 23:20:43,307 - INFO - [src.data_preparation] -   HL: 0.0440
2025-05-19 23:20:43,309 - INFO - [src.data_preparation] - Ticker MEC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'insec_t', 'Volatility', 'SK', 'ret', 'ma14_t', 'ATR', 's_d7_t', 'ma7_t', 'variation_t', 'Median_HL', 'PM', 'HL']
2025-05-19 23:20:43,403 - INFO - [src.data_preparation] - Ticker MEC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:43,403 - INFO - [src.data_preparation] - Ticker MEC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:43,405 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MEC
2025-05-19 23:20:43,405 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:43,405 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(179), np.int64(1): np.int64(284)}
2025-05-19 23:20:43,405 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:20:43,410 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:20:43,411 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:20:43,414 - INFO - [src.data_preparation] - Ticker MEC - Final 3D shapes: X_train=(568, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:43,414 - INFO - [__main__] - Using best model for MEC: svm (F1: 0.6866)
2025-05-19 23:20:43,415 - INFO - [__main__] - Loading svm model for MEC...
2025-05-19 23:20:43,416 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:43,418 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:20:43,418 - INFO - [__main__] - Making predictions for MEC using svm
2025-05-19 23:20:43,419 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:43,419 - INFO - [__main__] - Successfully got last prediction for MEC
2025-05-19 23:20:43,419 - INFO - [__main__] - 
Processing ticker: MEF
2025-05-19 23:20:43,419 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:43,419 - INFO - [__main__] - Getting last prediction point for ticker: MEF
2025-05-19 23:20:43,420 - INFO - [__main__] - ==================================================
2025-05-19 23:20:43,420 - INFO - [__main__] - Preparing test data for MEF...
2025-05-19 23:20:43,458 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:43,458 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:43,458 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:43,478 - INFO - [src.data_preparation] - Ticker MEF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:43,478 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(6), np.int64(1): np.int64(633)}
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] - Ticker MEF - Selected features:
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   vnipc_t: 0.6456
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   ma21_t: 0.1073
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   ma14_t: 0.1060
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   ma7_t: 0.0326
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   s_d7_t: 0.0190
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   Median_HL: 0.0180
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   PM: 0.0177
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   MDD: 0.0159
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   SR: 0.0114
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   ATR: 0.0096
2025-05-19 23:20:43,637 - INFO - [src.data_preparation] -   LO: 0.0065
2025-05-19 23:20:43,638 - INFO - [src.data_preparation] -   Volatility: 0.0063
2025-05-19 23:20:43,638 - INFO - [src.data_preparation] -   SK: 0.0036
2025-05-19 23:20:43,638 - INFO - [src.data_preparation] -   ret: 0.0005
2025-05-19 23:20:43,638 - INFO - [src.data_preparation] -   TVV: 0.0001
2025-05-19 23:20:43,640 - INFO - [src.data_preparation] - Ticker MEF - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'Median_HL', 'PM', 'MDD', 'SR', 'ATR', 'LO', 'Volatility', 'SK', 'ret', 'TVV']
2025-05-19 23:20:43,740 - INFO - [src.data_preparation] - Ticker MEF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:43,740 - INFO - [src.data_preparation] - Ticker MEF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:43,742 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE for ticker MEF - insufficient samples per class or only one class
2025-05-19 23:20:43,746 - INFO - [src.data_preparation] - Ticker MEF - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:43,747 - INFO - [__main__] - Using best model for MEF: lstm (F1: 0.9885)
2025-05-19 23:20:43,747 - INFO - [__main__] - Loading lstm model for MEF...
2025-05-19 23:20:43,750 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:43,751 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:20:43,752 - INFO - [__main__] - Making predictions for MEF using lstm
2025-05-19 23:20:43,754 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:43,754 - INFO - [__main__] - Successfully got last prediction for MEF
2025-05-19 23:20:43,754 - INFO - [__main__] - 
Processing ticker: MHC
2025-05-19 23:20:43,755 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:43,755 - INFO - [__main__] - Getting last prediction point for ticker: MHC
2025-05-19 23:20:43,755 - INFO - [__main__] - ==================================================
2025-05-19 23:20:43,755 - INFO - [__main__] - Preparing test data for MHC...
2025-05-19 23:20:43,794 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:43,794 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:43,794 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:43,824 - INFO - [src.data_preparation] - Ticker MHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:43,825 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(315), np.int64(1): np.int64(324)}
2025-05-19 23:20:44,207 - INFO - [src.data_preparation] - Ticker MHC - Selected features:
2025-05-19 23:20:44,207 - INFO - [src.data_preparation] -   vnipc_t: 0.0735
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   SK: 0.0690
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   Volatility: 0.0665
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   insec_t: 0.0647
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   TVV: 0.0613
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   ma14_t: 0.0605
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   SR: 0.0592
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   ma21_t: 0.0581
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   s_d7_t: 0.0580
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   ATR: 0.0579
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   HL: 0.0567
2025-05-19 23:20:44,208 - INFO - [src.data_preparation] -   ma7_t: 0.0564
2025-05-19 23:20:44,209 - INFO - [src.data_preparation] -   Median_HL: 0.0533
2025-05-19 23:20:44,209 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:20:44,209 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:20:44,211 - INFO - [src.data_preparation] - Ticker MHC - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'insec_t', 'TVV', 'ma14_t', 'SR', 'ma21_t', 's_d7_t', 'ATR', 'HL', 'ma7_t', 'Median_HL', 'PM', 'ret']
2025-05-19 23:20:44,308 - INFO - [src.data_preparation] - Ticker MHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:44,308 - INFO - [src.data_preparation] - Ticker MHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:44,310 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MHC
2025-05-19 23:20:44,310 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:44,310 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(224), np.int64(1): np.int64(239)}
2025-05-19 23:20:44,310 - INFO - [src.data_preparation] - Generating 15 synthetic minority samples
2025-05-19 23:20:44,311 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:20:44,312 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:20:44,315 - INFO - [src.data_preparation] - Ticker MHC - Final 3D shapes: X_train=(478, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:44,315 - INFO - [__main__] - Using best model for MHC: svm (F1: 0.5574)
2025-05-19 23:20:44,315 - INFO - [__main__] - Loading svm model for MHC...
2025-05-19 23:20:44,317 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:44,318 - INFO - [__main__] - Model size: 0.72 MB
2025-05-19 23:20:44,318 - INFO - [__main__] - Making predictions for MHC using svm
2025-05-19 23:20:44,318 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:44,318 - INFO - [__main__] - Successfully got last prediction for MHC
2025-05-19 23:20:44,318 - INFO - [__main__] - 
Processing ticker: MHL
2025-05-19 23:20:44,319 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:44,319 - INFO - [__main__] - Getting last prediction point for ticker: MHL
2025-05-19 23:20:44,319 - INFO - [__main__] - ==================================================
2025-05-19 23:20:44,319 - INFO - [__main__] - Preparing test data for MHL...
2025-05-19 23:20:44,351 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:44,351 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:44,351 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:44,371 - INFO - [src.data_preparation] - Ticker MHL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:44,371 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(140), np.int64(1): np.int64(499)}
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] - Ticker MHL - Selected features:
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   ATR: 0.1033
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   TVV: 0.0894
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   vnipc_t: 0.0853
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   Volatility: 0.0757
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   s_d7_t: 0.0721
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   SK: 0.0633
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   HL: 0.0605
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   ma21_t: 0.0567
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   ma14_t: 0.0541
2025-05-19 23:20:44,619 - INFO - [src.data_preparation] -   ma7_t: 0.0487
2025-05-19 23:20:44,620 - INFO - [src.data_preparation] -   insec_t: 0.0481
2025-05-19 23:20:44,620 - INFO - [src.data_preparation] -   Median_HL: 0.0464
2025-05-19 23:20:44,620 - INFO - [src.data_preparation] -   variation_t: 0.0411
2025-05-19 23:20:44,620 - INFO - [src.data_preparation] -   ret: 0.0393
2025-05-19 23:20:44,620 - INFO - [src.data_preparation] -   PM: 0.0370
2025-05-19 23:20:44,623 - INFO - [src.data_preparation] - Ticker MHL - Using features: ['Date', 'ATR', 'TVV', 'vnipc_t', 'Volatility', 's_d7_t', 'SK', 'HL', 'ma21_t', 'ma14_t', 'ma7_t', 'insec_t', 'Median_HL', 'variation_t', 'ret', 'PM']
2025-05-19 23:20:44,724 - INFO - [src.data_preparation] - Ticker MHL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:44,724 - INFO - [src.data_preparation] - Ticker MHL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:44,727 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MHL
2025-05-19 23:20:44,727 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:44,727 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(100), np.int64(1): np.int64(363)}
2025-05-19 23:20:44,727 - INFO - [src.data_preparation] - Generating 263 synthetic minority samples
2025-05-19 23:20:44,738 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (726, 13, 15), y shape: (726,)
2025-05-19 23:20:44,738 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(363), np.int64(1): np.int64(363)}
2025-05-19 23:20:44,744 - INFO - [src.data_preparation] - Ticker MHL - Final 3D shapes: X_train=(726, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:44,744 - INFO - [__main__] - Using best model for MHL: lstm (F1: 0.9885)
2025-05-19 23:20:44,744 - INFO - [__main__] - Loading lstm model for MHL...
2025-05-19 23:20:44,749 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:44,750 - INFO - [__main__] - Model size: 0.17 MB
2025-05-19 23:20:44,750 - INFO - [__main__] - Making predictions for MHL using lstm
2025-05-19 23:20:44,753 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:44,753 - INFO - [__main__] - Successfully got last prediction for MHL
2025-05-19 23:20:44,753 - INFO - [__main__] - 
Processing ticker: MIC
2025-05-19 23:20:44,754 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:44,754 - INFO - [__main__] - Getting last prediction point for ticker: MIC
2025-05-19 23:20:44,754 - INFO - [__main__] - ==================================================
2025-05-19 23:20:44,754 - INFO - [__main__] - Preparing test data for MIC...
2025-05-19 23:20:44,822 - INFO - [src.data_preparation] - After processing - X shape: (609, 19), y shape: (609,)
2025-05-19 23:20:44,822 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:44,822 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:44,859 - INFO - [src.data_preparation] - Ticker MIC - Original shapes: X=(609, 18), y=(609,)
2025-05-19 23:20:44,859 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(223), np.int64(1): np.int64(386)}
2025-05-19 23:20:45,225 - INFO - [src.data_preparation] - Ticker MIC - Selected features:
2025-05-19 23:20:45,225 - INFO - [src.data_preparation] -   vnipc_t: 0.0751
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   ma14_t: 0.0701
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   ma21_t: 0.0689
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   TVV: 0.0684
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   ma7_t: 0.0675
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   ATR: 0.0650
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   Median_HL: 0.0631
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   PM: 0.0621
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   s_d7_t: 0.0598
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   Volatility: 0.0573
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   insec_t: 0.0523
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   SK: 0.0520
2025-05-19 23:20:45,226 - INFO - [src.data_preparation] -   ret: 0.0462
2025-05-19 23:20:45,227 - INFO - [src.data_preparation] -   HL: 0.0456
2025-05-19 23:20:45,227 - INFO - [src.data_preparation] -   variation_t: 0.0455
2025-05-19 23:20:45,230 - INFO - [src.data_preparation] - Ticker MIC - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'TVV', 'ma7_t', 'ATR', 'Median_HL', 'PM', 's_d7_t', 'Volatility', 'insec_t', 'SK', 'ret', 'HL', 'variation_t']
2025-05-19 23:20:45,322 - INFO - [src.data_preparation] - Ticker MIC - 2D shapes: X_train=(434, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:20:45,322 - INFO - [src.data_preparation] - Ticker MIC - 3D shapes: X_train=(434, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:45,324 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MIC
2025-05-19 23:20:45,324 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (434, 13, 15), y shape: (434,)
2025-05-19 23:20:45,324 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(141), np.int64(1): np.int64(293)}
2025-05-19 23:20:45,324 - INFO - [src.data_preparation] - Generating 152 synthetic minority samples
2025-05-19 23:20:45,330 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (586, 13, 15), y shape: (586,)
2025-05-19 23:20:45,330 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(293), np.int64(1): np.int64(293)}
2025-05-19 23:20:45,333 - INFO - [src.data_preparation] - Ticker MIC - Final 3D shapes: X_train=(586, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:20:45,333 - INFO - [__main__] - Using best model for MIC: svm (F1: 0.6129)
2025-05-19 23:20:45,333 - INFO - [__main__] - Loading svm model for MIC...
2025-05-19 23:20:45,334 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:45,335 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:20:45,335 - INFO - [__main__] - Making predictions for MIC using svm
2025-05-19 23:20:45,335 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:45,335 - INFO - [__main__] - Successfully got last prediction for MIC
2025-05-19 23:20:45,337 - INFO - [__main__] - 
Processing ticker: MIM
2025-05-19 23:20:45,337 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:45,337 - INFO - [__main__] - Getting last prediction point for ticker: MIM
2025-05-19 23:20:45,337 - INFO - [__main__] - ==================================================
2025-05-19 23:20:45,337 - INFO - [__main__] - Preparing test data for MIM...
2025-05-19 23:20:45,365 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:20:45,365 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:45,365 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:45,385 - INFO - [src.data_preparation] - Ticker MIM - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:20:45,385 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(116), np.int64(1): np.int64(521)}
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] - Ticker MIM - Selected features:
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   vnipc_t: 0.1061
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   ma21_t: 0.0867
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   s_d7_t: 0.0791
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   ma14_t: 0.0732
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   ma7_t: 0.0731
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   Volatility: 0.0672
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   TVV: 0.0633
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   Median_HL: 0.0600
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   ATR: 0.0577
2025-05-19 23:20:45,608 - INFO - [src.data_preparation] -   PM: 0.0542
2025-05-19 23:20:45,609 - INFO - [src.data_preparation] -   SK: 0.0514
2025-05-19 23:20:45,609 - INFO - [src.data_preparation] -   insec_t: 0.0451
2025-05-19 23:20:45,609 - INFO - [src.data_preparation] -   HL: 0.0447
2025-05-19 23:20:45,609 - INFO - [src.data_preparation] -   variation_t: 0.0362
2025-05-19 23:20:45,609 - INFO - [src.data_preparation] -   ret: 0.0315
2025-05-19 23:20:45,612 - INFO - [src.data_preparation] - Ticker MIM - Using features: ['Date', 'vnipc_t', 'ma21_t', 's_d7_t', 'ma14_t', 'ma7_t', 'Volatility', 'TVV', 'Median_HL', 'ATR', 'PM', 'SK', 'insec_t', 'HL', 'variation_t', 'ret']
2025-05-19 23:20:45,698 - INFO - [src.data_preparation] - Ticker MIM - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:20:45,698 - INFO - [src.data_preparation] - Ticker MIM - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:45,700 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MIM
2025-05-19 23:20:45,700 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:45,700 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(95), np.int64(1): np.int64(368)}
2025-05-19 23:20:45,700 - INFO - [src.data_preparation] - Generating 273 synthetic minority samples
2025-05-19 23:20:45,710 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (736, 13, 15), y shape: (736,)
2025-05-19 23:20:45,710 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(368), np.int64(1): np.int64(368)}
2025-05-19 23:20:45,714 - INFO - [src.data_preparation] - Ticker MIM - Final 3D shapes: X_train=(736, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:45,715 - INFO - [__main__] - Using best model for MIM: lstm (F1: 0.9885)
2025-05-19 23:20:45,715 - INFO - [__main__] - Loading lstm model for MIM...
2025-05-19 23:20:45,719 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:45,720 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:20:45,720 - INFO - [__main__] - Making predictions for MIM using lstm
2025-05-19 23:20:45,724 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:45,725 - INFO - [__main__] - Successfully got last prediction for MIM
2025-05-19 23:20:45,725 - INFO - [__main__] - 
Processing ticker: MKV
2025-05-19 23:20:45,725 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:45,725 - INFO - [__main__] - Getting last prediction point for ticker: MKV
2025-05-19 23:20:45,726 - INFO - [__main__] - ==================================================
2025-05-19 23:20:45,726 - INFO - [__main__] - Preparing test data for MKV...
2025-05-19 23:20:45,755 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:45,755 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:45,755 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:45,778 - INFO - [src.data_preparation] - Ticker MKV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:45,778 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(141), np.int64(1): np.int64(498)}
2025-05-19 23:20:46,066 - INFO - [src.data_preparation] - Ticker MKV - Selected features:
2025-05-19 23:20:46,066 - INFO - [src.data_preparation] -   vnipc_t: 0.0939
2025-05-19 23:20:46,066 - INFO - [src.data_preparation] -   TVV: 0.0910
2025-05-19 23:20:46,066 - INFO - [src.data_preparation] -   ma21_t: 0.0807
2025-05-19 23:20:46,066 - INFO - [src.data_preparation] -   ma14_t: 0.0795
2025-05-19 23:20:46,066 - INFO - [src.data_preparation] -   ATR: 0.0785
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   ma7_t: 0.0631
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   Volatility: 0.0550
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   insec_t: 0.0534
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   Median_HL: 0.0525
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   PM: 0.0519
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   SK: 0.0472
2025-05-19 23:20:46,067 - INFO - [src.data_preparation] -   ret: 0.0457
2025-05-19 23:20:46,068 - INFO - [src.data_preparation] -   variation_t: 0.0428
2025-05-19 23:20:46,068 - INFO - [src.data_preparation] -   HL: 0.0420
2025-05-19 23:20:46,070 - INFO - [src.data_preparation] - Ticker MKV - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'ATR', 'ma7_t', 's_d7_t', 'Volatility', 'insec_t', 'Median_HL', 'PM', 'SK', 'ret', 'variation_t', 'HL']
2025-05-19 23:20:46,166 - INFO - [src.data_preparation] - Ticker MKV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:46,166 - INFO - [src.data_preparation] - Ticker MKV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:46,169 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MKV
2025-05-19 23:20:46,169 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:46,169 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(71), np.int64(1): np.int64(392)}
2025-05-19 23:20:46,169 - INFO - [src.data_preparation] - Generating 321 synthetic minority samples
2025-05-19 23:20:46,183 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (784, 13, 15), y shape: (784,)
2025-05-19 23:20:46,183 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(392), np.int64(1): np.int64(392)}
2025-05-19 23:20:46,192 - INFO - [src.data_preparation] - Ticker MKV - Final 3D shapes: X_train=(784, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:46,193 - INFO - [__main__] - Using best model for MKV: transformer (F1: 0.7429)
2025-05-19 23:20:46,194 - INFO - [__main__] - Loading transformer model for MKV...
2025-05-19 23:20:46,210 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:20:46,219 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:20:46,219 - INFO - [__main__] - Making predictions for MKV using transformer
2025-05-19 23:20:46,222 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:46,223 - INFO - [__main__] - Successfully got last prediction for MKV
2025-05-19 23:20:46,223 - INFO - [__main__] - 
Processing ticker: MPC
2025-05-19 23:20:46,223 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:46,223 - INFO - [__main__] - Getting last prediction point for ticker: MPC
2025-05-19 23:20:46,223 - INFO - [__main__] - ==================================================
2025-05-19 23:20:46,223 - INFO - [__main__] - Preparing test data for MPC...
2025-05-19 23:20:46,278 - INFO - [src.data_preparation] - After processing - X shape: (508, 19), y shape: (508,)
2025-05-19 23:20:46,278 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:46,278 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:46,304 - INFO - [src.data_preparation] - Ticker MPC - Original shapes: X=(508, 18), y=(508,)
2025-05-19 23:20:46,304 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(238), np.int64(1): np.int64(270)}
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] - Ticker MPC - Selected features:
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   SK: 0.0703
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   vnipc_t: 0.0642
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   HL: 0.0642
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   insec_t: 0.0641
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   TVV: 0.0620
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   LO: 0.0610
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   ATR: 0.0593
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   ret: 0.0574
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   s_d7_t: 0.0564
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   ma21_t: 0.0559
2025-05-19 23:20:46,629 - INFO - [src.data_preparation] -   ma14_t: 0.0534
2025-05-19 23:20:46,630 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:20:46,630 - INFO - [src.data_preparation] -   SR: 0.0524
2025-05-19 23:20:46,632 - INFO - [src.data_preparation] - Ticker MPC - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'HL', 'insec_t', 'TVV', 'LO', 'ATR', 'ret', 's_d7_t', 'PM', 'ma21_t', 'ma14_t', 'variation_t', 'SR']
2025-05-19 23:20:46,718 - INFO - [src.data_preparation] - Ticker MPC - 2D shapes: X_train=(332, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:46,718 - INFO - [src.data_preparation] - Ticker MPC - 3D shapes: X_train=(332, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:46,719 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MPC
2025-05-19 23:20:46,719 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (332, 13, 15), y shape: (332,)
2025-05-19 23:20:46,720 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(143), np.int64(1): np.int64(189)}
2025-05-19 23:20:46,720 - INFO - [src.data_preparation] - Generating 46 synthetic minority samples
2025-05-19 23:20:46,722 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (378, 13, 15), y shape: (378,)
2025-05-19 23:20:46,722 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(189)}
2025-05-19 23:20:46,724 - INFO - [src.data_preparation] - Ticker MPC - Final 3D shapes: X_train=(378, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:46,725 - INFO - [__main__] - Using best model for MPC: svm (F1: 0.4828)
2025-05-19 23:20:46,725 - INFO - [__main__] - Loading svm model for MPC...
2025-05-19 23:20:46,726 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:46,726 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:20:46,726 - INFO - [__main__] - Making predictions for MPC using svm
2025-05-19 23:20:46,727 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:46,728 - INFO - [__main__] - Successfully got last prediction for MPC
2025-05-19 23:20:46,728 - INFO - [__main__] - 
Processing ticker: MSN
2025-05-19 23:20:46,728 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:46,728 - INFO - [__main__] - Getting last prediction point for ticker: MSN
2025-05-19 23:20:46,728 - INFO - [__main__] - ==================================================
2025-05-19 23:20:46,728 - INFO - [__main__] - Preparing test data for MSN...
2025-05-19 23:20:46,757 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:46,758 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:46,758 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:46,778 - INFO - [src.data_preparation] - Ticker MSN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:46,779 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(324), np.int64(1): np.int64(315)}
2025-05-19 23:20:47,137 - INFO - [src.data_preparation] - Ticker MSN - Selected features:
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   vnipc_t: 0.0723
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   TVV: 0.0702
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   HL: 0.0609
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   variation_t: 0.0581
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   ATR: 0.0571
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   ret: 0.0551
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   SR: 0.0532
2025-05-19 23:20:47,138 - INFO - [src.data_preparation] -   LO: 0.0529
2025-05-19 23:20:47,139 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:20:47,139 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:20:47,139 - INFO - [src.data_preparation] -   ma14_t: 0.0509
2025-05-19 23:20:47,141 - INFO - [src.data_preparation] - Ticker MSN - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'insec_t', 's_d7_t', 'SK', 'HL', 'variation_t', 'ATR', 'ret', 'SR', 'LO', 'PM', 'Median_HL', 'ma14_t']
2025-05-19 23:20:47,264 - INFO - [src.data_preparation] - Ticker MSN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:47,264 - INFO - [src.data_preparation] - Ticker MSN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:47,266 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MSN
2025-05-19 23:20:47,266 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:47,266 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(223)}
2025-05-19 23:20:47,266 - INFO - [src.data_preparation] - Generating 17 synthetic minority samples
2025-05-19 23:20:47,268 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (480, 13, 15), y shape: (480,)
2025-05-19 23:20:47,268 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(240)}
2025-05-19 23:20:47,271 - INFO - [src.data_preparation] - Ticker MSN - Final 3D shapes: X_train=(480, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:47,271 - INFO - [__main__] - Using best model for MSN: lstm (F1: 0.6667)
2025-05-19 23:20:47,271 - INFO - [__main__] - Loading lstm model for MSN...
2025-05-19 23:20:47,277 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:47,279 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:20:47,279 - INFO - [__main__] - Making predictions for MSN using lstm
2025-05-19 23:20:47,284 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:47,284 - INFO - [__main__] - Successfully got last prediction for MSN
2025-05-19 23:20:47,284 - INFO - [__main__] - 
Processing ticker: MTC
2025-05-19 23:20:47,284 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:47,284 - INFO - [__main__] - Getting last prediction point for ticker: MTC
2025-05-19 23:20:47,284 - INFO - [__main__] - ==================================================
2025-05-19 23:20:47,285 - INFO - [__main__] - Preparing test data for MTC...
2025-05-19 23:20:47,341 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:47,341 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:47,341 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:47,380 - INFO - [src.data_preparation] - Ticker MTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:47,380 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(57), np.int64(1): np.int64(582)}
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] - Ticker MTC - Selected features:
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   vnipc_t: 0.1358
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   Median_HL: 0.1254
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   PM: 0.1063
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   ma14_t: 0.0960
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   SR: 0.0809
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   ma21_t: 0.0786
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   LO: 0.0655
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   ma7_t: 0.0616
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   s_d7_t: 0.0294
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   ret: 0.0261
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   variation_t: 0.0257
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   HL: 0.0257
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   Volatility: 0.0223
2025-05-19 23:20:47,618 - INFO - [src.data_preparation] -   insec_t: 0.0222
2025-05-19 23:20:47,623 - INFO - [src.data_preparation] - Ticker MTC - Using features: ['Date', 'vnipc_t', 'Median_HL', 'PM', 'ma14_t', 'SR', 'ma21_t', 'LO', 'ma7_t', 'ATR', 's_d7_t', 'ret', 'variation_t', 'HL', 'Volatility', 'insec_t']
2025-05-19 23:20:47,714 - INFO - [src.data_preparation] - Ticker MTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:47,714 - INFO - [src.data_preparation] - Ticker MTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:47,716 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MTC
2025-05-19 23:20:47,716 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:47,716 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(27), np.int64(1): np.int64(436)}
2025-05-19 23:20:47,716 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:20:47,719 - INFO - [src.data_preparation] - Ticker MTC - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:47,719 - INFO - [__main__] - Using best model for MTC: lstm (F1: 0.9524)
2025-05-19 23:20:47,719 - INFO - [__main__] - Loading lstm model for MTC...
2025-05-19 23:20:47,723 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:47,724 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:20:47,724 - INFO - [__main__] - Making predictions for MTC using lstm
2025-05-19 23:20:47,725 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:47,725 - INFO - [__main__] - Successfully got last prediction for MTC
2025-05-19 23:20:47,725 - INFO - [__main__] - 
Processing ticker: MTG
2025-05-19 23:20:47,725 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:47,725 - INFO - [__main__] - Getting last prediction point for ticker: MTG
2025-05-19 23:20:47,725 - INFO - [__main__] - ==================================================
2025-05-19 23:20:47,725 - INFO - [__main__] - Preparing test data for MTG...
2025-05-19 23:20:47,777 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:20:47,777 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:47,777 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:47,799 - INFO - [src.data_preparation] - Ticker MTG - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:20:47,799 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(241), np.int64(1): np.int64(396)}
2025-05-19 23:20:48,166 - INFO - [src.data_preparation] - Ticker MTG - Selected features:
2025-05-19 23:20:48,166 - INFO - [src.data_preparation] -   TVV: 0.0778
2025-05-19 23:20:48,166 - INFO - [src.data_preparation] -   vnipc_t: 0.0696
2025-05-19 23:20:48,166 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:20:48,166 - INFO - [src.data_preparation] -   s_d7_t: 0.0683
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   insec_t: 0.0657
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   ATR: 0.0635
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   ma21_t: 0.0632
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   SK: 0.0627
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   ma14_t: 0.0620
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   ma7_t: 0.0583
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   PM: 0.0553
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   Median_HL: 0.0535
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   HL: 0.0493
2025-05-19 23:20:48,167 - INFO - [src.data_preparation] -   variation_t: 0.0486
2025-05-19 23:20:48,173 - INFO - [src.data_preparation] - Ticker MTG - Using features: ['Date', 'TVV', 'vnipc_t', 'Volatility', 's_d7_t', 'insec_t', 'ATR', 'ma21_t', 'SK', 'ma14_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'HL', 'variation_t']
2025-05-19 23:20:48,317 - INFO - [src.data_preparation] - Ticker MTG - 2D shapes: X_train=(461, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:48,317 - INFO - [src.data_preparation] - Ticker MTG - 3D shapes: X_train=(461, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:48,320 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MTG
2025-05-19 23:20:48,320 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (461, 13, 15), y shape: (461,)
2025-05-19 23:20:48,320 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(160), np.int64(1): np.int64(301)}
2025-05-19 23:20:48,320 - INFO - [src.data_preparation] - Generating 141 synthetic minority samples
2025-05-19 23:20:48,327 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (602, 13, 15), y shape: (602,)
2025-05-19 23:20:48,327 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(301), np.int64(1): np.int64(301)}
2025-05-19 23:20:48,332 - INFO - [src.data_preparation] - Ticker MTG - Final 3D shapes: X_train=(602, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:48,332 - INFO - [__main__] - Using best model for MTG: svm (F1: 0.7246)
2025-05-19 23:20:48,332 - INFO - [__main__] - Loading svm model for MTG...
2025-05-19 23:20:48,335 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:48,336 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:20:48,336 - INFO - [__main__] - Making predictions for MTG using svm
2025-05-19 23:20:48,337 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:48,337 - INFO - [__main__] - Successfully got last prediction for MTG
2025-05-19 23:20:48,338 - INFO - [__main__] - 
Processing ticker: MTH
2025-05-19 23:20:48,338 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:48,338 - INFO - [__main__] - Getting last prediction point for ticker: MTH
2025-05-19 23:20:48,339 - INFO - [__main__] - ==================================================
2025-05-19 23:20:48,339 - INFO - [__main__] - Preparing test data for MTH...
2025-05-19 23:20:48,375 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:48,375 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:48,375 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:48,400 - INFO - [src.data_preparation] - Ticker MTH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:48,401 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(164), np.int64(1): np.int64(475)}
2025-05-19 23:20:48,777 - INFO - [src.data_preparation] - Ticker MTH - Selected features:
2025-05-19 23:20:48,777 - INFO - [src.data_preparation] -   TVV: 0.0836
2025-05-19 23:20:48,777 - INFO - [src.data_preparation] -   vnipc_t: 0.0811
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   ma21_t: 0.0758
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   ATR: 0.0705
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   s_d7_t: 0.0681
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   ma14_t: 0.0645
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   SK: 0.0628
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   ma7_t: 0.0597
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   Volatility: 0.0560
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   ret: 0.0488
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   insec_t: 0.0477
2025-05-19 23:20:48,778 - INFO - [src.data_preparation] -   variation_t: 0.0401
2025-05-19 23:20:48,782 - INFO - [src.data_preparation] - Ticker MTH - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'ATR', 's_d7_t', 'ma14_t', 'SK', 'ma7_t', 'HL', 'Volatility', 'Median_HL', 'PM', 'ret', 'insec_t', 'variation_t']
2025-05-19 23:20:48,945 - INFO - [src.data_preparation] - Ticker MTH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:48,945 - INFO - [src.data_preparation] - Ticker MTH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:48,947 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MTH
2025-05-19 23:20:48,947 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:48,947 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(139), np.int64(1): np.int64(324)}
2025-05-19 23:20:48,947 - INFO - [src.data_preparation] - Generating 185 synthetic minority samples
2025-05-19 23:20:48,955 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (648, 13, 15), y shape: (648,)
2025-05-19 23:20:48,955 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(324), np.int64(1): np.int64(324)}
2025-05-19 23:20:48,961 - INFO - [src.data_preparation] - Ticker MTH - Final 3D shapes: X_train=(648, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:48,961 - INFO - [__main__] - Using best model for MTH: svm (F1: 0.9136)
2025-05-19 23:20:48,962 - INFO - [__main__] - Loading svm model for MTH...
2025-05-19 23:20:48,963 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:48,964 - INFO - [__main__] - Model size: 0.98 MB
2025-05-19 23:20:48,964 - INFO - [__main__] - Making predictions for MTH using svm
2025-05-19 23:20:48,965 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:48,965 - INFO - [__main__] - Successfully got last prediction for MTH
2025-05-19 23:20:48,965 - INFO - [__main__] - 
Processing ticker: MTP
2025-05-19 23:20:48,965 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:48,965 - INFO - [__main__] - Getting last prediction point for ticker: MTP
2025-05-19 23:20:48,965 - INFO - [__main__] - ==================================================
2025-05-19 23:20:48,965 - INFO - [__main__] - Preparing test data for MTP...
2025-05-19 23:20:49,005 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:49,005 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:49,005 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:49,034 - INFO - [src.data_preparation] - Ticker MTP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:49,035 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(171), np.int64(1): np.int64(468)}
2025-05-19 23:20:49,416 - INFO - [src.data_preparation] - Ticker MTP - Selected features:
2025-05-19 23:20:49,416 - INFO - [src.data_preparation] -   vnipc_t: 0.0824
2025-05-19 23:20:49,416 - INFO - [src.data_preparation] -   ATR: 0.0782
2025-05-19 23:20:49,416 - INFO - [src.data_preparation] -   ma7_t: 0.0695
2025-05-19 23:20:49,416 - INFO - [src.data_preparation] -   ma21_t: 0.0670
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   Volatility: 0.0647
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   SK: 0.0605
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   Median_HL: 0.0593
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   ma14_t: 0.0587
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   PM: 0.0587
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   HL: 0.0569
2025-05-19 23:20:49,417 - INFO - [src.data_preparation] -   insec_t: 0.0479
2025-05-19 23:20:49,418 - INFO - [src.data_preparation] -   SR: 0.0473
2025-05-19 23:20:49,418 - INFO - [src.data_preparation] -   ret: 0.0393
2025-05-19 23:20:49,423 - INFO - [src.data_preparation] - Ticker MTP - Using features: ['Date', 'vnipc_t', 'ATR', 'ma7_t', 'ma21_t', 'Volatility', 'TVV', 's_d7_t', 'SK', 'Median_HL', 'ma14_t', 'PM', 'HL', 'insec_t', 'SR', 'ret']
2025-05-19 23:20:49,548 - INFO - [src.data_preparation] - Ticker MTP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:49,549 - INFO - [src.data_preparation] - Ticker MTP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:49,552 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker MTP
2025-05-19 23:20:49,552 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:49,552 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(107), np.int64(1): np.int64(356)}
2025-05-19 23:20:49,552 - INFO - [src.data_preparation] - Generating 249 synthetic minority samples
2025-05-19 23:20:49,567 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (712, 13, 15), y shape: (712,)
2025-05-19 23:20:49,567 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(356), np.int64(1): np.int64(356)}
2025-05-19 23:20:49,572 - INFO - [src.data_preparation] - Ticker MTP - Final 3D shapes: X_train=(712, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:49,573 - INFO - [__main__] - Using best model for MTP: svm (F1: 0.8571)
2025-05-19 23:20:49,573 - INFO - [__main__] - Loading svm model for MTP...
2025-05-19 23:20:49,575 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:49,576 - INFO - [__main__] - Model size: 1.07 MB
2025-05-19 23:20:49,576 - INFO - [__main__] - Making predictions for MTP using svm
2025-05-19 23:20:49,577 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:49,579 - INFO - [__main__] - Successfully got last prediction for MTP
2025-05-19 23:20:49,579 - INFO - [__main__] - 
Processing ticker: NAG
2025-05-19 23:20:49,579 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:49,580 - INFO - [__main__] - Getting last prediction point for ticker: NAG
2025-05-19 23:20:49,580 - INFO - [__main__] - ==================================================
2025-05-19 23:20:49,580 - INFO - [__main__] - Preparing test data for NAG...
2025-05-19 23:20:49,623 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:49,623 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:49,623 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:49,655 - INFO - [src.data_preparation] - Ticker NAG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:49,655 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:20:50,153 - INFO - [src.data_preparation] - Ticker NAG - Selected features:
2025-05-19 23:20:50,153 - INFO - [src.data_preparation] -   SK: 0.0713
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   vnipc_t: 0.0697
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   insec_t: 0.0693
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   HL: 0.0659
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   TVV: 0.0648
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   ATR: 0.0630
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   variation_t: 0.0591
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   LO: 0.0562
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   ma21_t: 0.0557
2025-05-19 23:20:50,154 - INFO - [src.data_preparation] -   ret: 0.0551
2025-05-19 23:20:50,155 - INFO - [src.data_preparation] -   ma14_t: 0.0510
2025-05-19 23:20:50,155 - INFO - [src.data_preparation] -   SR: 0.0495
2025-05-19 23:20:50,155 - INFO - [src.data_preparation] -   ma7_t: 0.0458
2025-05-19 23:20:50,158 - INFO - [src.data_preparation] - Ticker NAG - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'HL', 'Volatility', 'TVV', 's_d7_t', 'ATR', 'variation_t', 'LO', 'ma21_t', 'ret', 'ma14_t', 'SR', 'ma7_t']
2025-05-19 23:20:50,277 - INFO - [src.data_preparation] - Ticker NAG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:50,277 - INFO - [src.data_preparation] - Ticker NAG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:50,280 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NAG
2025-05-19 23:20:50,280 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:50,280 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(185), np.int64(1): np.int64(278)}
2025-05-19 23:20:50,280 - INFO - [src.data_preparation] - Generating 93 synthetic minority samples
2025-05-19 23:20:50,280 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (556, 13, 15), y shape: (556,)
2025-05-19 23:20:50,280 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(278), np.int64(1): np.int64(278)}
2025-05-19 23:20:50,288 - INFO - [src.data_preparation] - Ticker NAG - Final 3D shapes: X_train=(556, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:50,288 - INFO - [__main__] - Using best model for NAG: svm (F1: 0.7246)
2025-05-19 23:20:50,288 - INFO - [__main__] - Loading svm model for NAG...
2025-05-19 23:20:50,288 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:50,288 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:20:50,288 - INFO - [__main__] - Making predictions for NAG using svm
2025-05-19 23:20:50,292 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:50,292 - INFO - [__main__] - Successfully got last prediction for NAG
2025-05-19 23:20:50,292 - INFO - [__main__] - 
Processing ticker: NAV
2025-05-19 23:20:50,292 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:50,292 - INFO - [__main__] - Getting last prediction point for ticker: NAV
2025-05-19 23:20:50,292 - INFO - [__main__] - ==================================================
2025-05-19 23:20:50,292 - INFO - [__main__] - Preparing test data for NAV...
2025-05-19 23:20:50,328 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:50,328 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:50,328 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:50,347 - INFO - [src.data_preparation] - Ticker NAV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:50,347 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:20:50,670 - INFO - [src.data_preparation] - Ticker NAV - Selected features:
2025-05-19 23:20:50,670 - INFO - [src.data_preparation] -   SK: 0.0743
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   vnipc_t: 0.0720
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   insec_t: 0.0716
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   TVV: 0.0665
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   SR: 0.0646
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   s_d7_t: 0.0611
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   ATR: 0.0587
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   ret: 0.0572
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   LO: 0.0545
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   ma14_t: 0.0543
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   ma21_t: 0.0513
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:20:50,671 - INFO - [src.data_preparation] -   PM: 0.0500
2025-05-19 23:20:50,674 - INFO - [src.data_preparation] - Ticker NAV - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'TVV', 'SR', 'Volatility', 's_d7_t', 'ATR', 'ret', 'LO', 'ma14_t', 'variation_t', 'ma21_t', 'ma7_t', 'PM']
2025-05-19 23:20:50,805 - INFO - [src.data_preparation] - Ticker NAV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:50,805 - INFO - [src.data_preparation] - Ticker NAV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:50,809 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NAV
2025-05-19 23:20:50,809 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:50,809 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:20:50,809 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:20:50,814 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:20:50,814 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:20:50,819 - INFO - [src.data_preparation] - Ticker NAV - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:50,819 - INFO - [__main__] - Using best model for NAV: lstm (F1: 0.7429)
2025-05-19 23:20:50,820 - INFO - [__main__] - Loading lstm model for NAV...
2025-05-19 23:20:50,827 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:50,830 - INFO - [__main__] - Model size: 0.27 MB
2025-05-19 23:20:50,830 - INFO - [__main__] - Making predictions for NAV using lstm
2025-05-19 23:20:50,835 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:50,836 - INFO - [__main__] - Successfully got last prediction for NAV
2025-05-19 23:20:50,836 - INFO - [__main__] - 
Processing ticker: NBB
2025-05-19 23:20:50,836 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:50,836 - INFO - [__main__] - Getting last prediction point for ticker: NBB
2025-05-19 23:20:50,836 - INFO - [__main__] - ==================================================
2025-05-19 23:20:50,836 - INFO - [__main__] - Preparing test data for NBB...
2025-05-19 23:20:50,893 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:50,893 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:50,893 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:50,924 - INFO - [src.data_preparation] - Ticker NBB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:50,924 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(314), np.int64(1): np.int64(325)}
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] - Ticker NBB - Selected features:
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   vnipc_t: 0.0804
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   insec_t: 0.0691
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   s_d7_t: 0.0652
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   SK: 0.0649
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   Volatility: 0.0635
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   LO: 0.0621
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   TVV: 0.0605
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   HL: 0.0602
2025-05-19 23:20:51,289 - INFO - [src.data_preparation] -   SR: 0.0577
2025-05-19 23:20:51,290 - INFO - [src.data_preparation] -   variation_t: 0.0573
2025-05-19 23:20:51,290 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:20:51,290 - INFO - [src.data_preparation] -   ma14_t: 0.0504
2025-05-19 23:20:51,290 - INFO - [src.data_preparation] -   PM: 0.0483
2025-05-19 23:20:51,290 - INFO - [src.data_preparation] -   ma21_t: 0.0479
2025-05-19 23:20:51,292 - INFO - [src.data_preparation] - Ticker NBB - Using features: ['Date', 'vnipc_t', 'insec_t', 's_d7_t', 'SK', 'Volatility', 'LO', 'ATR', 'TVV', 'HL', 'SR', 'variation_t', 'ret', 'ma14_t', 'PM', 'ma21_t']
2025-05-19 23:20:51,382 - INFO - [src.data_preparation] - Ticker NBB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:51,382 - INFO - [src.data_preparation] - Ticker NBB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:51,383 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NBB
2025-05-19 23:20:51,383 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:51,383 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(225), np.int64(1): np.int64(238)}
2025-05-19 23:20:51,383 - INFO - [src.data_preparation] - Generating 13 synthetic minority samples
2025-05-19 23:20:51,384 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (476, 13, 15), y shape: (476,)
2025-05-19 23:20:51,385 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(238)}
2025-05-19 23:20:51,388 - INFO - [src.data_preparation] - Ticker NBB - Final 3D shapes: X_train=(476, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:51,388 - INFO - [__main__] - Using best model for NBB: svm (F1: 0.6349)
2025-05-19 23:20:51,388 - INFO - [__main__] - Loading svm model for NBB...
2025-05-19 23:20:51,389 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:51,390 - INFO - [__main__] - Model size: 0.68 MB
2025-05-19 23:20:51,390 - INFO - [__main__] - Making predictions for NBB using svm
2025-05-19 23:20:51,390 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:51,391 - INFO - [__main__] - Successfully got last prediction for NBB
2025-05-19 23:20:51,391 - INFO - [__main__] - 
Processing ticker: NBC
2025-05-19 23:20:51,391 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:51,391 - INFO - [__main__] - Getting last prediction point for ticker: NBC
2025-05-19 23:20:51,391 - INFO - [__main__] - ==================================================
2025-05-19 23:20:51,391 - INFO - [__main__] - Preparing test data for NBC...
2025-05-19 23:20:51,426 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:51,426 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:51,426 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:51,445 - INFO - [src.data_preparation] - Ticker NBC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:51,445 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:20:51,769 - INFO - [src.data_preparation] - Ticker NBC - Selected features:
2025-05-19 23:20:51,769 - INFO - [src.data_preparation] -   vnipc_t: 0.0801
2025-05-19 23:20:51,769 - INFO - [src.data_preparation] -   insec_t: 0.0719
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   Volatility: 0.0670
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   SK: 0.0648
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   TVV: 0.0575
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   HL: 0.0560
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   SR: 0.0554
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   ma21_t: 0.0553
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   PM: 0.0541
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   variation_t: 0.0533
2025-05-19 23:20:51,770 - INFO - [src.data_preparation] -   LO: 0.0522
2025-05-19 23:20:51,774 - INFO - [src.data_preparation] - Ticker NBC - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'SK', 's_d7_t', 'ATR', 'TVV', 'HL', 'SR', 'ma21_t', 'ma14_t', 'PM', 'Median_HL', 'variation_t', 'LO']
2025-05-19 23:20:51,882 - INFO - [src.data_preparation] - Ticker NBC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:51,882 - INFO - [src.data_preparation] - Ticker NBC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:51,884 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NBC
2025-05-19 23:20:51,884 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:51,884 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:20:51,884 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:20:51,887 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:20:51,888 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:20:51,892 - INFO - [src.data_preparation] - Ticker NBC - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:51,892 - INFO - [__main__] - Using best model for NBC: svm (F1: 0.3500)
2025-05-19 23:20:51,892 - INFO - [__main__] - Loading svm model for NBC...
2025-05-19 23:20:51,894 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:51,895 - INFO - [__main__] - Model size: 0.72 MB
2025-05-19 23:20:51,895 - INFO - [__main__] - Making predictions for NBC using svm
2025-05-19 23:20:51,895 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:51,896 - INFO - [__main__] - Successfully got last prediction for NBC
2025-05-19 23:20:51,896 - INFO - [__main__] - 
Processing ticker: NBP
2025-05-19 23:20:51,896 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:51,896 - INFO - [__main__] - Getting last prediction point for ticker: NBP
2025-05-19 23:20:51,896 - INFO - [__main__] - ==================================================
2025-05-19 23:20:51,896 - INFO - [__main__] - Preparing test data for NBP...
2025-05-19 23:20:51,924 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:51,924 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:51,924 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:51,944 - INFO - [src.data_preparation] - Ticker NBP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:51,944 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(240), np.int64(1): np.int64(399)}
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] - Ticker NBP - Selected features:
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] -   s_d7_t: 0.0785
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] -   vnipc_t: 0.0753
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] -   TVV: 0.0742
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] -   SK: 0.0668
2025-05-19 23:20:52,320 - INFO - [src.data_preparation] -   ATR: 0.0667
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   ma7_t: 0.0599
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   insec_t: 0.0598
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   Median_HL: 0.0547
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   ma21_t: 0.0524
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   ret: 0.0513
2025-05-19 23:20:52,321 - INFO - [src.data_preparation] -   HL: 0.0493
2025-05-19 23:20:52,325 - INFO - [src.data_preparation] - Ticker NBP - Using features: ['Date', 's_d7_t', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'ATR', 'ma7_t', 'insec_t', 'PM', 'Median_HL', 'ma14_t', 'ma21_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:20:52,434 - INFO - [src.data_preparation] - Ticker NBP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:52,434 - INFO - [src.data_preparation] - Ticker NBP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:52,436 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NBP
2025-05-19 23:20:52,436 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:52,436 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:20:52,436 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:20:52,441 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:20:52,442 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:20:52,447 - INFO - [src.data_preparation] - Ticker NBP - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:52,448 - INFO - [__main__] - Using best model for NBP: svm (F1: 0.7429)
2025-05-19 23:20:52,448 - INFO - [__main__] - Loading svm model for NBP...
2025-05-19 23:20:52,450 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:52,451 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:20:52,451 - INFO - [__main__] - Making predictions for NBP using svm
2025-05-19 23:20:52,452 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:52,452 - INFO - [__main__] - Successfully got last prediction for NBP
2025-05-19 23:20:52,452 - INFO - [__main__] - 
Processing ticker: NBW
2025-05-19 23:20:52,452 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:52,452 - INFO - [__main__] - Getting last prediction point for ticker: NBW
2025-05-19 23:20:52,452 - INFO - [__main__] - ==================================================
2025-05-19 23:20:52,452 - INFO - [__main__] - Preparing test data for NBW...
2025-05-19 23:20:52,502 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:52,503 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:52,503 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:52,524 - INFO - [src.data_preparation] - Ticker NBW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:52,524 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(182), np.int64(1): np.int64(457)}
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] - Ticker NBW - Selected features:
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   vnipc_t: 0.0836
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   ATR: 0.0718
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   ma21_t: 0.0716
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   s_d7_t: 0.0706
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   ma14_t: 0.0689
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   ma7_t: 0.0668
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   SK: 0.0660
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   TVV: 0.0659
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   PM: 0.0628
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   Median_HL: 0.0620
2025-05-19 23:20:52,825 - INFO - [src.data_preparation] -   Volatility: 0.0556
2025-05-19 23:20:52,827 - INFO - [src.data_preparation] -   insec_t: 0.0478
2025-05-19 23:20:52,827 - INFO - [src.data_preparation] -   HL: 0.0460
2025-05-19 23:20:52,827 - INFO - [src.data_preparation] -   ret: 0.0444
2025-05-19 23:20:52,827 - INFO - [src.data_preparation] -   variation_t: 0.0440
2025-05-19 23:20:52,830 - INFO - [src.data_preparation] - Ticker NBW - Using features: ['Date', 'vnipc_t', 'ATR', 'ma21_t', 's_d7_t', 'ma14_t', 'ma7_t', 'SK', 'TVV', 'PM', 'Median_HL', 'Volatility', 'insec_t', 'HL', 'ret', 'variation_t']
2025-05-19 23:20:52,911 - INFO - [src.data_preparation] - Ticker NBW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:52,912 - INFO - [src.data_preparation] - Ticker NBW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:52,913 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NBW
2025-05-19 23:20:52,913 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:52,913 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(115), np.int64(1): np.int64(348)}
2025-05-19 23:20:52,913 - INFO - [src.data_preparation] - Generating 233 synthetic minority samples
2025-05-19 23:20:52,923 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (696, 13, 15), y shape: (696,)
2025-05-19 23:20:52,923 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(348), np.int64(1): np.int64(348)}
2025-05-19 23:20:52,928 - INFO - [src.data_preparation] - Ticker NBW - Final 3D shapes: X_train=(696, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:52,928 - INFO - [__main__] - Using best model for NBW: svm (F1: 0.7429)
2025-05-19 23:20:52,928 - INFO - [__main__] - Loading svm model for NBW...
2025-05-19 23:20:52,930 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:52,931 - INFO - [__main__] - Model size: 1.05 MB
2025-05-19 23:20:52,931 - INFO - [__main__] - Making predictions for NBW using svm
2025-05-19 23:20:52,932 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:52,932 - INFO - [__main__] - Successfully got last prediction for NBW
2025-05-19 23:20:52,932 - INFO - [__main__] - 
Processing ticker: ND2
2025-05-19 23:20:52,932 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:52,932 - INFO - [__main__] - Getting last prediction point for ticker: ND2
2025-05-19 23:20:52,932 - INFO - [__main__] - ==================================================
2025-05-19 23:20:52,933 - INFO - [__main__] - Preparing test data for ND2...
2025-05-19 23:20:52,963 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:52,964 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:52,964 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:52,983 - INFO - [src.data_preparation] - Ticker ND2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:52,983 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(193), np.int64(1): np.int64(446)}
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] - Ticker ND2 - Selected features:
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   vnipc_t: 0.0757
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   TVV: 0.0723
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   ATR: 0.0710
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   Volatility: 0.0699
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   SK: 0.0660
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   insec_t: 0.0649
2025-05-19 23:20:53,283 - INFO - [src.data_preparation] -   ma14_t: 0.0584
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   ma7_t: 0.0580
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   SR: 0.0549
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   ma21_t: 0.0535
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   variation_t: 0.0514
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   PM: 0.0499
2025-05-19 23:20:53,284 - INFO - [src.data_preparation] -   HL: 0.0493
2025-05-19 23:20:53,287 - INFO - [src.data_preparation] - Ticker ND2 - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'Volatility', 's_d7_t', 'SK', 'insec_t', 'ma14_t', 'ma7_t', 'SR', 'ma21_t', 'ret', 'variation_t', 'PM', 'HL']
2025-05-19 23:20:53,376 - INFO - [src.data_preparation] - Ticker ND2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:53,376 - INFO - [src.data_preparation] - Ticker ND2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:53,377 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ND2
2025-05-19 23:20:53,378 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:53,378 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(137), np.int64(1): np.int64(326)}
2025-05-19 23:20:53,378 - INFO - [src.data_preparation] - Generating 189 synthetic minority samples
2025-05-19 23:20:53,385 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (652, 13, 15), y shape: (652,)
2025-05-19 23:20:53,385 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(326), np.int64(1): np.int64(326)}
2025-05-19 23:20:53,389 - INFO - [src.data_preparation] - Ticker ND2 - Final 3D shapes: X_train=(652, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:53,389 - INFO - [__main__] - Using best model for ND2: svm (F1: 0.7778)
2025-05-19 23:20:53,389 - INFO - [__main__] - Loading svm model for ND2...
2025-05-19 23:20:53,390 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:53,391 - INFO - [__main__] - Model size: 0.98 MB
2025-05-19 23:20:53,392 - INFO - [__main__] - Making predictions for ND2 using svm
2025-05-19 23:20:53,392 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:53,393 - INFO - [__main__] - Successfully got last prediction for ND2
2025-05-19 23:20:53,393 - INFO - [__main__] - 
Processing ticker: NDC
2025-05-19 23:20:53,393 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:53,393 - INFO - [__main__] - Getting last prediction point for ticker: NDC
2025-05-19 23:20:53,393 - INFO - [__main__] - ==================================================
2025-05-19 23:20:53,393 - INFO - [__main__] - Preparing test data for NDC...
2025-05-19 23:20:53,420 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:53,421 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:53,421 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:53,438 - INFO - [src.data_preparation] - Ticker NDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:53,440 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(193), np.int64(1): np.int64(446)}
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] - Ticker NDC - Selected features:
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   vnipc_t: 0.0844
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   TVV: 0.0812
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   SK: 0.0653
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   ma21_t: 0.0645
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   ma14_t: 0.0636
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   Volatility: 0.0617
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   ATR: 0.0605
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   s_d7_t: 0.0587
2025-05-19 23:20:53,743 - INFO - [src.data_preparation] -   insec_t: 0.0586
2025-05-19 23:20:53,744 - INFO - [src.data_preparation] -   ma7_t: 0.0568
2025-05-19 23:20:53,744 - INFO - [src.data_preparation] -   HL: 0.0559
2025-05-19 23:20:53,744 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:20:53,744 - INFO - [src.data_preparation] -   ret: 0.0493
2025-05-19 23:20:53,744 - INFO - [src.data_preparation] -   Median_HL: 0.0488
2025-05-19 23:20:53,744 - INFO - [src.data_preparation] -   variation_t: 0.0479
2025-05-19 23:20:53,747 - INFO - [src.data_preparation] - Ticker NDC - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'ma21_t', 'ma14_t', 'Volatility', 'ATR', 's_d7_t', 'insec_t', 'ma7_t', 'HL', 'PM', 'ret', 'Median_HL', 'variation_t']
2025-05-19 23:20:53,851 - INFO - [src.data_preparation] - Ticker NDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:53,851 - INFO - [src.data_preparation] - Ticker NDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:53,853 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NDC
2025-05-19 23:20:53,853 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:53,853 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(131), np.int64(1): np.int64(332)}
2025-05-19 23:20:53,853 - INFO - [src.data_preparation] - Generating 201 synthetic minority samples
2025-05-19 23:20:53,865 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (664, 13, 15), y shape: (664,)
2025-05-19 23:20:53,865 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(332), np.int64(1): np.int64(332)}
2025-05-19 23:20:53,872 - INFO - [src.data_preparation] - Ticker NDC - Final 3D shapes: X_train=(664, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:53,872 - INFO - [__main__] - Using best model for NDC: svm (F1: 0.7429)
2025-05-19 23:20:53,873 - INFO - [__main__] - Loading svm model for NDC...
2025-05-19 23:20:53,875 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:53,876 - INFO - [__main__] - Model size: 1.00 MB
2025-05-19 23:20:53,876 - INFO - [__main__] - Making predictions for NDC using svm
2025-05-19 23:20:53,877 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:53,877 - INFO - [__main__] - Successfully got last prediction for NDC
2025-05-19 23:20:53,877 - INFO - [__main__] - 
Processing ticker: NDN
2025-05-19 23:20:53,877 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:53,878 - INFO - [__main__] - Getting last prediction point for ticker: NDN
2025-05-19 23:20:53,878 - INFO - [__main__] - ==================================================
2025-05-19 23:20:53,878 - INFO - [__main__] - Preparing test data for NDN...
2025-05-19 23:20:53,927 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:53,927 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:53,927 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:53,953 - INFO - [src.data_preparation] - Ticker NDN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:53,953 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] - Ticker NDN - Selected features:
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   Volatility: 0.0750
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   insec_t: 0.0666
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   ret: 0.0630
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   TVV: 0.0627
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   Median_HL: 0.0572
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   variation_t: 0.0552
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   ma21_t: 0.0535
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   ma14_t: 0.0527
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   HL: 0.0521
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   LO: 0.0511
2025-05-19 23:20:54,342 - INFO - [src.data_preparation] -   PM: 0.0510
2025-05-19 23:20:54,345 - INFO - [src.data_preparation] - Ticker NDN - Using features: ['Date', 'Volatility', 'vnipc_t', 'insec_t', 'SK', 's_d7_t', 'ret', 'TVV', 'ATR', 'Median_HL', 'variation_t', 'ma21_t', 'ma14_t', 'HL', 'LO', 'PM']
2025-05-19 23:20:54,441 - INFO - [src.data_preparation] - Ticker NDN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:54,442 - INFO - [src.data_preparation] - Ticker NDN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:54,444 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NDN
2025-05-19 23:20:54,444 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:54,444 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:20:54,444 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:20:54,448 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:20:54,448 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:20:54,453 - INFO - [src.data_preparation] - Ticker NDN - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:54,453 - INFO - [__main__] - Using best model for NDN: transformer (F1: 0.5000)
2025-05-19 23:20:54,454 - INFO - [__main__] - Loading transformer model for NDN...
2025-05-19 23:20:54,468 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:54,471 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:20:54,472 - INFO - [__main__] - Making predictions for NDN using transformer
2025-05-19 23:20:54,474 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:54,474 - INFO - [__main__] - Successfully got last prediction for NDN
2025-05-19 23:20:54,475 - INFO - [__main__] - 
Processing ticker: NET
2025-05-19 23:20:54,475 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:54,475 - INFO - [__main__] - Getting last prediction point for ticker: NET
2025-05-19 23:20:54,475 - INFO - [__main__] - ==================================================
2025-05-19 23:20:54,475 - INFO - [__main__] - Preparing test data for NET...
2025-05-19 23:20:54,537 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:54,537 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:54,537 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:54,569 - INFO - [src.data_preparation] - Ticker NET - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:54,570 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] - Ticker NET - Selected features:
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] -   Volatility: 0.0727
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] -   vnipc_t: 0.0706
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] -   SK: 0.0694
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] -   insec_t: 0.0683
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:20:54,955 - INFO - [src.data_preparation] -   SR: 0.0616
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   s_d7_t: 0.0603
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   ATR: 0.0577
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   LO: 0.0569
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   HL: 0.0564
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   ret: 0.0558
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   ma14_t: 0.0552
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   ma21_t: 0.0529
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   variation_t: 0.0508
2025-05-19 23:20:54,956 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:20:54,959 - INFO - [src.data_preparation] - Ticker NET - Using features: ['Date', 'Volatility', 'vnipc_t', 'SK', 'insec_t', 'TVV', 'SR', 's_d7_t', 'ATR', 'LO', 'HL', 'ret', 'ma14_t', 'ma21_t', 'variation_t', 'PM']
2025-05-19 23:20:55,074 - INFO - [src.data_preparation] - Ticker NET - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:55,074 - INFO - [src.data_preparation] - Ticker NET - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:55,077 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NET
2025-05-19 23:20:55,078 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:55,078 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:20:55,078 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:20:55,079 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:20:55,080 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:20:55,083 - INFO - [src.data_preparation] - Ticker NET - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:55,083 - INFO - [__main__] - Using best model for NET: transformer (F1: 0.5000)
2025-05-19 23:20:55,083 - INFO - [__main__] - Loading transformer model for NET...
2025-05-19 23:20:55,104 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:20:55,111 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:20:55,112 - INFO - [__main__] - Making predictions for NET using transformer
2025-05-19 23:20:55,115 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:55,115 - INFO - [__main__] - Successfully got last prediction for NET
2025-05-19 23:20:55,115 - INFO - [__main__] - 
Processing ticker: NGC
2025-05-19 23:20:55,115 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:55,117 - INFO - [__main__] - Getting last prediction point for ticker: NGC
2025-05-19 23:20:55,117 - INFO - [__main__] - ==================================================
2025-05-19 23:20:55,117 - INFO - [__main__] - Preparing test data for NGC...
2025-05-19 23:20:55,160 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:55,160 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:55,160 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:55,198 - INFO - [src.data_preparation] - Ticker NGC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:55,198 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(168), np.int64(1): np.int64(470)}
2025-05-19 23:20:55,539 - INFO - [src.data_preparation] - Ticker NGC - Selected features:
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   vnipc_t: 0.0951
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   TVV: 0.0847
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   ma21_t: 0.0769
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   ATR: 0.0715
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   ma14_t: 0.0681
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   ma7_t: 0.0666
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   Volatility: 0.0599
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   SK: 0.0548
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   PM: 0.0540
2025-05-19 23:20:55,540 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:20:55,541 - INFO - [src.data_preparation] -   LO: 0.0460
2025-05-19 23:20:55,541 - INFO - [src.data_preparation] -   insec_t: 0.0437
2025-05-19 23:20:55,541 - INFO - [src.data_preparation] -   HL: 0.0397
2025-05-19 23:20:55,541 - INFO - [src.data_preparation] -   variation_t: 0.0378
2025-05-19 23:20:55,543 - INFO - [src.data_preparation] - Ticker NGC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ATR', 'ma14_t', 'ma7_t', 's_d7_t', 'Volatility', 'SK', 'PM', 'Median_HL', 'LO', 'insec_t', 'HL', 'variation_t']
2025-05-19 23:20:55,639 - INFO - [src.data_preparation] - Ticker NGC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:55,640 - INFO - [src.data_preparation] - Ticker NGC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:55,642 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NGC
2025-05-19 23:20:55,642 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:20:55,642 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(135), np.int64(1): np.int64(327)}
2025-05-19 23:20:55,642 - INFO - [src.data_preparation] - Generating 192 synthetic minority samples
2025-05-19 23:20:55,651 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (654, 13, 15), y shape: (654,)
2025-05-19 23:20:55,651 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(327), np.int64(1): np.int64(327)}
2025-05-19 23:20:55,654 - INFO - [src.data_preparation] - Ticker NGC - Final 3D shapes: X_train=(654, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:55,655 - INFO - [__main__] - Using best model for NGC: svm (F1: 0.9767)
2025-05-19 23:20:55,655 - INFO - [__main__] - Loading svm model for NGC...
2025-05-19 23:20:55,657 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:55,658 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:20:55,658 - INFO - [__main__] - Making predictions for NGC using svm
2025-05-19 23:20:55,658 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:55,660 - INFO - [__main__] - Successfully got last prediction for NGC
2025-05-19 23:20:55,660 - INFO - [__main__] - 
Processing ticker: NHA
2025-05-19 23:20:55,660 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:55,660 - INFO - [__main__] - Getting last prediction point for ticker: NHA
2025-05-19 23:20:55,660 - INFO - [__main__] - ==================================================
2025-05-19 23:20:55,660 - INFO - [__main__] - Preparing test data for NHA...
2025-05-19 23:20:55,701 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:55,701 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:55,701 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:55,723 - INFO - [src.data_preparation] - Ticker NHA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:55,723 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(292), np.int64(1): np.int64(347)}
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] - Ticker NHA - Selected features:
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   SK: 0.0831
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   vnipc_t: 0.0727
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   TVV: 0.0726
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   insec_t: 0.0695
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   ATR: 0.0629
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   HL: 0.0591
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   ret: 0.0587
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   s_d7_t: 0.0553
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   SR: 0.0547
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   ma7_t: 0.0546
2025-05-19 23:20:56,075 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:20:56,077 - INFO - [src.data_preparation] -   ma14_t: 0.0526
2025-05-19 23:20:56,077 - INFO - [src.data_preparation] -   PM: 0.0493
2025-05-19 23:20:56,077 - INFO - [src.data_preparation] -   ma21_t: 0.0469
2025-05-19 23:20:56,080 - INFO - [src.data_preparation] - Ticker NHA - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 'ATR', 'HL', 'ret', 's_d7_t', 'SR', 'ma7_t', 'variation_t', 'ma14_t', 'PM', 'ma21_t']
2025-05-19 23:20:56,174 - INFO - [src.data_preparation] - Ticker NHA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:56,174 - INFO - [src.data_preparation] - Ticker NHA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:56,177 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NHA
2025-05-19 23:20:56,177 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:56,178 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(258)}
2025-05-19 23:20:56,178 - INFO - [src.data_preparation] - Generating 53 synthetic minority samples
2025-05-19 23:20:56,181 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:20:56,181 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:20:56,187 - INFO - [src.data_preparation] - Ticker NHA - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:56,187 - INFO - [__main__] - Using best model for NHA: logistic_regression (F1: 0.2143)
2025-05-19 23:20:56,187 - INFO - [__main__] - Loading logistic_regression model for NHA...
2025-05-19 23:20:56,189 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:56,189 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:56,189 - INFO - [__main__] - Making predictions for NHA using logistic_regression
2025-05-19 23:20:56,189 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:56,190 - INFO - [__main__] - Successfully got last prediction for NHA
2025-05-19 23:20:56,190 - INFO - [__main__] - 
Processing ticker: NHC
2025-05-19 23:20:56,190 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:56,190 - INFO - [__main__] - Getting last prediction point for ticker: NHC
2025-05-19 23:20:56,190 - INFO - [__main__] - ==================================================
2025-05-19 23:20:56,190 - INFO - [__main__] - Preparing test data for NHC...
2025-05-19 23:20:56,231 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:56,232 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:56,232 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:56,252 - INFO - [src.data_preparation] - Ticker NHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:56,252 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(206), np.int64(1): np.int64(433)}
2025-05-19 23:20:56,533 - INFO - [src.data_preparation] - Ticker NHC - Selected features:
2025-05-19 23:20:56,533 - INFO - [src.data_preparation] -   vnipc_t: 0.0899
2025-05-19 23:20:56,533 - INFO - [src.data_preparation] -   ma21_t: 0.0711
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   TVV: 0.0680
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   ma14_t: 0.0669
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   ATR: 0.0666
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   SK: 0.0620
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   ma7_t: 0.0592
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   SR: 0.0519
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   insec_t: 0.0502
2025-05-19 23:20:56,534 - INFO - [src.data_preparation] -   HL: 0.0474
2025-05-19 23:20:56,535 - INFO - [src.data_preparation] -   ret: 0.0464
2025-05-19 23:20:56,537 - INFO - [src.data_preparation] - Ticker NHC - Using features: ['Date', 'vnipc_t', 'ma21_t', 'Volatility', 'TVV', 'ma14_t', 'ATR', 's_d7_t', 'SK', 'ma7_t', 'Median_HL', 'PM', 'SR', 'insec_t', 'HL', 'ret']
2025-05-19 23:20:56,632 - INFO - [src.data_preparation] - Ticker NHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:56,632 - INFO - [src.data_preparation] - Ticker NHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:56,634 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NHC
2025-05-19 23:20:56,634 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:56,634 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(157), np.int64(1): np.int64(306)}
2025-05-19 23:20:56,634 - INFO - [src.data_preparation] - Generating 149 synthetic minority samples
2025-05-19 23:20:56,645 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (612, 13, 15), y shape: (612,)
2025-05-19 23:20:56,645 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(306), np.int64(1): np.int64(306)}
2025-05-19 23:20:56,650 - INFO - [src.data_preparation] - Ticker NHC - Final 3D shapes: X_train=(612, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:56,651 - INFO - [__main__] - Using best model for NHC: lstm (F1: 0.8421)
2025-05-19 23:20:56,651 - INFO - [__main__] - Loading lstm model for NHC...
2025-05-19 23:20:56,656 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:56,658 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:20:56,658 - INFO - [__main__] - Making predictions for NHC using lstm
2025-05-19 23:20:56,661 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:56,661 - INFO - [__main__] - Successfully got last prediction for NHC
2025-05-19 23:20:56,661 - INFO - [__main__] - 
Processing ticker: NKG
2025-05-19 23:20:56,661 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:56,661 - INFO - [__main__] - Getting last prediction point for ticker: NKG
2025-05-19 23:20:56,661 - INFO - [__main__] - ==================================================
2025-05-19 23:20:56,661 - INFO - [__main__] - Preparing test data for NKG...
2025-05-19 23:20:56,718 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:56,718 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:56,718 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:56,752 - INFO - [src.data_preparation] - Ticker NKG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:56,752 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(321), np.int64(1): np.int64(318)}
2025-05-19 23:20:57,249 - INFO - [src.data_preparation] - Ticker NKG - Selected features:
2025-05-19 23:20:57,249 - INFO - [src.data_preparation] -   insec_t: 0.0801
2025-05-19 23:20:57,249 - INFO - [src.data_preparation] -   SK: 0.0738
2025-05-19 23:20:57,249 - INFO - [src.data_preparation] -   vnipc_t: 0.0716
2025-05-19 23:20:57,249 - INFO - [src.data_preparation] -   TVV: 0.0667
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   Volatility: 0.0665
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   ret: 0.0578
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   s_d7_t: 0.0574
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   ma7_t: 0.0561
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   variation_t: 0.0527
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   HL: 0.0526
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   ma14_t: 0.0521
2025-05-19 23:20:57,250 - INFO - [src.data_preparation] -   SR: 0.0515
2025-05-19 23:20:57,251 - INFO - [src.data_preparation] -   LO: 0.0493
2025-05-19 23:20:57,251 - INFO - [src.data_preparation] -   ma21_t: 0.0475
2025-05-19 23:20:57,254 - INFO - [src.data_preparation] - Ticker NKG - Using features: ['Date', 'insec_t', 'SK', 'vnipc_t', 'TVV', 'Volatility', 'ATR', 'ret', 's_d7_t', 'ma7_t', 'variation_t', 'HL', 'ma14_t', 'SR', 'LO', 'ma21_t']
2025-05-19 23:20:57,362 - INFO - [src.data_preparation] - Ticker NKG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:57,363 - INFO - [src.data_preparation] - Ticker NKG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:57,364 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NKG
2025-05-19 23:20:57,364 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:57,364 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(231), np.int64(1): np.int64(232)}
2025-05-19 23:20:57,364 - INFO - [src.data_preparation] - Generating 1 synthetic minority samples
2025-05-19 23:20:57,365 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:20:57,365 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:20:57,368 - INFO - [src.data_preparation] - Ticker NKG - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:57,368 - INFO - [__main__] - Using best model for NKG: lstm (F1: 0.5574)
2025-05-19 23:20:57,368 - INFO - [__main__] - Loading lstm model for NKG...
2025-05-19 23:20:57,374 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:20:57,377 - INFO - [__main__] - Model size: 0.43 MB
2025-05-19 23:20:57,377 - INFO - [__main__] - Making predictions for NKG using lstm
2025-05-19 23:20:57,383 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:20:57,383 - INFO - [__main__] - Successfully got last prediction for NKG
2025-05-19 23:20:57,383 - INFO - [__main__] - 
Processing ticker: NNC
2025-05-19 23:20:57,383 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:57,383 - INFO - [__main__] - Getting last prediction point for ticker: NNC
2025-05-19 23:20:57,383 - INFO - [__main__] - ==================================================
2025-05-19 23:20:57,384 - INFO - [__main__] - Preparing test data for NNC...
2025-05-19 23:20:57,448 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:57,448 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:57,448 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:57,486 - INFO - [src.data_preparation] - Ticker NNC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:57,486 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:20:57,890 - INFO - [src.data_preparation] - Ticker NNC - Selected features:
2025-05-19 23:20:57,890 - INFO - [src.data_preparation] -   insec_t: 0.0791
2025-05-19 23:20:57,890 - INFO - [src.data_preparation] -   TVV: 0.0717
2025-05-19 23:20:57,890 - INFO - [src.data_preparation] -   vnipc_t: 0.0696
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   Volatility: 0.0664
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   SK: 0.0650
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   ATR: 0.0591
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   HL: 0.0571
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   ma7_t: 0.0571
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   Median_HL: 0.0567
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   PM: 0.0541
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   LO: 0.0516
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   ma14_t: 0.0506
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   variation_t: 0.0496
2025-05-19 23:20:57,891 - INFO - [src.data_preparation] -   ma21_t: 0.0494
2025-05-19 23:20:57,895 - INFO - [src.data_preparation] - Ticker NNC - Using features: ['Date', 'insec_t', 'TVV', 'vnipc_t', 'Volatility', 'SK', 's_d7_t', 'ATR', 'HL', 'ma7_t', 'Median_HL', 'PM', 'LO', 'ma14_t', 'variation_t', 'ma21_t']
2025-05-19 23:20:58,019 - INFO - [src.data_preparation] - Ticker NNC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:58,019 - INFO - [src.data_preparation] - Ticker NNC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:58,021 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NNC
2025-05-19 23:20:58,021 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:58,022 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:20:58,022 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:20:58,025 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:20:58,025 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:20:58,029 - INFO - [src.data_preparation] - Ticker NNC - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:58,029 - INFO - [__main__] - Using best model for NNC: transformer (F1: 0.6800)
2025-05-19 23:20:58,029 - INFO - [__main__] - Loading transformer model for NNC...
2025-05-19 23:20:58,047 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:20:58,053 - INFO - [__main__] - Model size: 0.36 MB
2025-05-19 23:20:58,053 - INFO - [__main__] - Making predictions for NNC using transformer
2025-05-19 23:20:58,057 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:58,058 - INFO - [__main__] - Successfully got last prediction for NNC
2025-05-19 23:20:58,058 - INFO - [__main__] - 
Processing ticker: NNT
2025-05-19 23:20:58,059 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:58,059 - INFO - [__main__] - Getting last prediction point for ticker: NNT
2025-05-19 23:20:58,059 - INFO - [__main__] - ==================================================
2025-05-19 23:20:58,059 - INFO - [__main__] - Preparing test data for NNT...
2025-05-19 23:20:58,125 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:58,125 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:58,126 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:58,156 - INFO - [src.data_preparation] - Ticker NNT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:58,157 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(187), np.int64(1): np.int64(452)}
2025-05-19 23:20:58,541 - INFO - [src.data_preparation] - Ticker NNT - Selected features:
2025-05-19 23:20:58,542 - INFO - [src.data_preparation] -   ma21_t: 0.1053
2025-05-19 23:20:58,542 - INFO - [src.data_preparation] -   ma14_t: 0.0923
2025-05-19 23:20:58,542 - INFO - [src.data_preparation] -   vnipc_t: 0.0863
2025-05-19 23:20:58,542 - INFO - [src.data_preparation] -   ma7_t: 0.0850
2025-05-19 23:20:58,542 - INFO - [src.data_preparation] -   ATR: 0.0756
2025-05-19 23:20:58,542 - INFO - [src.data_preparation] -   SR: 0.0579
2025-05-19 23:20:58,543 - INFO - [src.data_preparation] -   TVV: 0.0566
2025-05-19 23:20:58,543 - INFO - [src.data_preparation] -   LO: 0.0541
2025-05-19 23:20:58,543 - INFO - [src.data_preparation] -   Volatility: 0.0527
2025-05-19 23:20:58,543 - INFO - [src.data_preparation] -   s_d7_t: 0.0503
2025-05-19 23:20:58,543 - INFO - [src.data_preparation] -   PM: 0.0497
2025-05-19 23:20:58,543 - INFO - [src.data_preparation] -   SK: 0.0493
2025-05-19 23:20:58,544 - INFO - [src.data_preparation] -   Median_HL: 0.0481
2025-05-19 23:20:58,544 - INFO - [src.data_preparation] -   ret: 0.0362
2025-05-19 23:20:58,544 - INFO - [src.data_preparation] -   variation_t: 0.0352
2025-05-19 23:20:58,549 - INFO - [src.data_preparation] - Ticker NNT - Using features: ['Date', 'ma21_t', 'ma14_t', 'vnipc_t', 'ma7_t', 'ATR', 'SR', 'TVV', 'LO', 'Volatility', 's_d7_t', 'PM', 'SK', 'Median_HL', 'ret', 'variation_t']
2025-05-19 23:20:58,772 - INFO - [src.data_preparation] - Ticker NNT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:58,772 - INFO - [src.data_preparation] - Ticker NNT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:58,775 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NNT
2025-05-19 23:20:58,777 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:58,777 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(122), np.int64(1): np.int64(341)}
2025-05-19 23:20:58,777 - INFO - [src.data_preparation] - Generating 219 synthetic minority samples
2025-05-19 23:20:58,797 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (682, 13, 15), y shape: (682,)
2025-05-19 23:20:58,798 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(341), np.int64(1): np.int64(341)}
2025-05-19 23:20:58,808 - INFO - [src.data_preparation] - Ticker NNT - Final 3D shapes: X_train=(682, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:58,808 - INFO - [__main__] - Using best model for NNT: svm (F1: 0.2105)
2025-05-19 23:20:58,809 - INFO - [__main__] - Loading svm model for NNT...
2025-05-19 23:20:58,812 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:58,812 - INFO - [__main__] - Model size: 0.62 MB
2025-05-19 23:20:58,813 - INFO - [__main__] - Making predictions for NNT using svm
2025-05-19 23:20:58,814 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:58,814 - INFO - [__main__] - Successfully got last prediction for NNT
2025-05-19 23:20:58,814 - INFO - [__main__] - 
Processing ticker: NOS
2025-05-19 23:20:58,815 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:58,815 - INFO - [__main__] - Getting last prediction point for ticker: NOS
2025-05-19 23:20:58,815 - INFO - [__main__] - ==================================================
2025-05-19 23:20:58,815 - INFO - [__main__] - Preparing test data for NOS...
2025-05-19 23:20:58,925 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:58,925 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:58,926 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:58,966 - INFO - [src.data_preparation] - Ticker NOS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:58,966 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(174), np.int64(1): np.int64(465)}
2025-05-19 23:20:59,239 - INFO - [src.data_preparation] - Ticker NOS - Selected features:
2025-05-19 23:20:59,239 - INFO - [src.data_preparation] -   vnipc_t: 0.0979
2025-05-19 23:20:59,239 - INFO - [src.data_preparation] -   TVV: 0.0926
2025-05-19 23:20:59,239 - INFO - [src.data_preparation] -   ma21_t: 0.0901
2025-05-19 23:20:59,239 - INFO - [src.data_preparation] -   ma14_t: 0.0888
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   Volatility: 0.0745
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   ma7_t: 0.0684
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   insec_t: 0.0628
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   SK: 0.0596
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   Median_HL: 0.0545
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   ATR: 0.0535
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   PM: 0.0479
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   ret: 0.0400
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   variation_t: 0.0351
2025-05-19 23:20:59,240 - INFO - [src.data_preparation] -   SR: 0.0239
2025-05-19 23:20:59,243 - INFO - [src.data_preparation] - Ticker NOS - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'Volatility', 'ma7_t', 'insec_t', 'SK', 's_d7_t', 'Median_HL', 'ATR', 'PM', 'ret', 'variation_t', 'SR']
2025-05-19 23:20:59,344 - INFO - [src.data_preparation] - Ticker NOS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:59,344 - INFO - [src.data_preparation] - Ticker NOS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:59,346 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NOS
2025-05-19 23:20:59,346 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:20:59,346 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(108), np.int64(1): np.int64(355)}
2025-05-19 23:20:59,346 - INFO - [src.data_preparation] - Generating 247 synthetic minority samples
2025-05-19 23:20:59,357 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (710, 13, 15), y shape: (710,)
2025-05-19 23:20:59,357 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(355), np.int64(1): np.int64(355)}
2025-05-19 23:20:59,362 - INFO - [src.data_preparation] - Ticker NOS - Final 3D shapes: X_train=(710, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:59,362 - INFO - [__main__] - Using best model for NOS: svm (F1: 0.7606)
2025-05-19 23:20:59,362 - INFO - [__main__] - Loading svm model for NOS...
2025-05-19 23:20:59,365 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:59,365 - INFO - [__main__] - Model size: 1.07 MB
2025-05-19 23:20:59,366 - INFO - [__main__] - Making predictions for NOS using svm
2025-05-19 23:20:59,366 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:59,367 - INFO - [__main__] - Successfully got last prediction for NOS
2025-05-19 23:20:59,367 - INFO - [__main__] - 
Processing ticker: NSC
2025-05-19 23:20:59,367 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:59,367 - INFO - [__main__] - Getting last prediction point for ticker: NSC
2025-05-19 23:20:59,367 - INFO - [__main__] - ==================================================
2025-05-19 23:20:59,367 - INFO - [__main__] - Preparing test data for NSC...
2025-05-19 23:20:59,407 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:20:59,407 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:59,407 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:59,430 - INFO - [src.data_preparation] - Ticker NSC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:20:59,431 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(309), np.int64(1): np.int64(329)}
2025-05-19 23:20:59,772 - INFO - [src.data_preparation] - Ticker NSC - Selected features:
2025-05-19 23:20:59,772 - INFO - [src.data_preparation] -   vnipc_t: 0.0745
2025-05-19 23:20:59,772 - INFO - [src.data_preparation] -   SK: 0.0705
2025-05-19 23:20:59,772 - INFO - [src.data_preparation] -   HL: 0.0680
2025-05-19 23:20:59,772 - INFO - [src.data_preparation] -   insec_t: 0.0665
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   SR: 0.0636
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   ATR: 0.0618
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   s_d7_t: 0.0607
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   TVV: 0.0590
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   LO: 0.0576
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   PM: 0.0535
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   variation_t: 0.0527
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   ret: 0.0526
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   ma14_t: 0.0514
2025-05-19 23:20:59,773 - INFO - [src.data_preparation] -   Median_HL: 0.0503
2025-05-19 23:20:59,776 - INFO - [src.data_preparation] - Ticker NSC - Using features: ['Date', 'vnipc_t', 'SK', 'HL', 'insec_t', 'Volatility', 'SR', 'ATR', 's_d7_t', 'TVV', 'LO', 'PM', 'variation_t', 'ret', 'ma14_t', 'Median_HL']
2025-05-19 23:20:59,862 - INFO - [src.data_preparation] - Ticker NSC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:20:59,862 - INFO - [src.data_preparation] - Ticker NSC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:59,863 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NSC
2025-05-19 23:20:59,863 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:20:59,865 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(223), np.int64(1): np.int64(239)}
2025-05-19 23:20:59,865 - INFO - [src.data_preparation] - Generating 16 synthetic minority samples
2025-05-19 23:20:59,865 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:20:59,865 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:20:59,868 - INFO - [src.data_preparation] - Ticker NSC - Final 3D shapes: X_train=(478, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:20:59,869 - INFO - [__main__] - Using best model for NSC: logistic_regression (F1: 0.7317)
2025-05-19 23:20:59,869 - INFO - [__main__] - Loading logistic_regression model for NSC...
2025-05-19 23:20:59,870 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:20:59,870 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:20:59,870 - INFO - [__main__] - Making predictions for NSC using logistic_regression
2025-05-19 23:20:59,870 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:20:59,870 - INFO - [__main__] - Successfully got last prediction for NSC
2025-05-19 23:20:59,871 - INFO - [__main__] - 
Processing ticker: NST
2025-05-19 23:20:59,871 - INFO - [__main__] - 
==================================================
2025-05-19 23:20:59,871 - INFO - [__main__] - Getting last prediction point for ticker: NST
2025-05-19 23:20:59,871 - INFO - [__main__] - ==================================================
2025-05-19 23:20:59,871 - INFO - [__main__] - Preparing test data for NST...
2025-05-19 23:20:59,899 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:20:59,899 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:20:59,899 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:20:59,918 - INFO - [src.data_preparation] - Ticker NST - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:20:59,918 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(262), np.int64(1): np.int64(377)}
2025-05-19 23:21:00,216 - INFO - [src.data_preparation] - Ticker NST - Selected features:
2025-05-19 23:21:00,216 - INFO - [src.data_preparation] -   SK: 0.0800
2025-05-19 23:21:00,216 - INFO - [src.data_preparation] -   vnipc_t: 0.0754
2025-05-19 23:21:00,216 - INFO - [src.data_preparation] -   SR: 0.0684
2025-05-19 23:21:00,216 - INFO - [src.data_preparation] -   ATR: 0.0645
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   Volatility: 0.0637
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   PM: 0.0514
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   ret: 0.0513
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   ma14_t: 0.0506
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:21:00,217 - INFO - [src.data_preparation] -   Median_HL: 0.0502
2025-05-19 23:21:00,219 - INFO - [src.data_preparation] - Ticker NST - Using features: ['Date', 'SK', 'vnipc_t', 'SR', 'ATR', 's_d7_t', 'Volatility', 'TVV', 'HL', 'ma21_t', 'variation_t', 'PM', 'ret', 'ma14_t', 'ma7_t', 'Median_HL']
2025-05-19 23:21:00,299 - INFO - [src.data_preparation] - Ticker NST - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:00,300 - INFO - [src.data_preparation] - Ticker NST - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:00,301 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NST
2025-05-19 23:21:00,301 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:00,301 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(181), np.int64(1): np.int64(282)}
2025-05-19 23:21:00,301 - INFO - [src.data_preparation] - Generating 101 synthetic minority samples
2025-05-19 23:21:00,308 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:21:00,308 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:21:00,311 - INFO - [src.data_preparation] - Ticker NST - Final 3D shapes: X_train=(564, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:00,311 - INFO - [__main__] - Using best model for NST: svm (F1: 0.7059)
2025-05-19 23:21:00,311 - INFO - [__main__] - Loading svm model for NST...
2025-05-19 23:21:00,312 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:00,313 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:21:00,313 - INFO - [__main__] - Making predictions for NST using svm
2025-05-19 23:21:00,314 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:00,314 - INFO - [__main__] - Successfully got last prediction for NST
2025-05-19 23:21:00,314 - INFO - [__main__] - 
Processing ticker: NT2
2025-05-19 23:21:00,314 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:00,314 - INFO - [__main__] - Getting last prediction point for ticker: NT2
2025-05-19 23:21:00,314 - INFO - [__main__] - ==================================================
2025-05-19 23:21:00,314 - INFO - [__main__] - Preparing test data for NT2...
2025-05-19 23:21:00,341 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:00,341 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:00,341 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:00,360 - INFO - [src.data_preparation] - Ticker NT2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:00,361 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] - Ticker NT2 - Selected features:
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   Volatility: 0.0811
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   insec_t: 0.0708
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   vnipc_t: 0.0687
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   SK: 0.0646
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   ATR: 0.0643
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:21:00,669 - INFO - [src.data_preparation] -   ret: 0.0567
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   TVV: 0.0557
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   HL: 0.0557
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   SR: 0.0537
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   ma21_t: 0.0532
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   LO: 0.0528
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   ma7_t: 0.0525
2025-05-19 23:21:00,670 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:21:00,673 - INFO - [src.data_preparation] - Ticker NT2 - Using features: ['Date', 'Volatility', 'insec_t', 'vnipc_t', 'SK', 'ATR', 's_d7_t', 'ma14_t', 'ret', 'TVV', 'HL', 'SR', 'ma21_t', 'LO', 'ma7_t', 'Median_HL']
2025-05-19 23:21:00,793 - INFO - [src.data_preparation] - Ticker NT2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:00,793 - INFO - [src.data_preparation] - Ticker NT2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:00,798 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NT2
2025-05-19 23:21:00,799 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:00,799 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:21:00,800 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:21:00,803 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:21:00,803 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:21:00,811 - INFO - [src.data_preparation] - Ticker NT2 - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:00,811 - INFO - [__main__] - Using best model for NT2: svm (F1: 0.6250)
2025-05-19 23:21:00,811 - INFO - [__main__] - Loading svm model for NT2...
2025-05-19 23:21:00,814 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:00,815 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:21:00,815 - INFO - [__main__] - Making predictions for NT2 using svm
2025-05-19 23:21:00,816 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:00,817 - INFO - [__main__] - Successfully got last prediction for NT2
2025-05-19 23:21:00,817 - INFO - [__main__] - 
Processing ticker: NTB
2025-05-19 23:21:00,817 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:00,817 - INFO - [__main__] - Getting last prediction point for ticker: NTB
2025-05-19 23:21:00,817 - INFO - [__main__] - ==================================================
2025-05-19 23:21:00,817 - INFO - [__main__] - Preparing test data for NTB...
2025-05-19 23:21:00,860 - INFO - [src.data_preparation] - After processing - X shape: (615, 19), y shape: (615,)
2025-05-19 23:21:00,860 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:00,860 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:00,881 - INFO - [src.data_preparation] - Ticker NTB - Original shapes: X=(615, 18), y=(615,)
2025-05-19 23:21:00,882 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(178), np.int64(1): np.int64(437)}
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] - Ticker NTB - Selected features:
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] -   vnipc_t: 0.1124
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] -   TVV: 0.0838
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] -   insec_t: 0.0795
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] -   ma21_t: 0.0743
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] -   ma14_t: 0.0714
2025-05-19 23:21:01,100 - INFO - [src.data_preparation] -   ma7_t: 0.0639
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   PM: 0.0626
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   Median_HL: 0.0622
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   SK: 0.0604
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   Volatility: 0.0600
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   ATR: 0.0533
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   variation_t: 0.0362
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   ret: 0.0317
2025-05-19 23:21:01,101 - INFO - [src.data_preparation] -   SR: 0.0298
2025-05-19 23:21:01,103 - INFO - [src.data_preparation] - Ticker NTB - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'PM', 'Median_HL', 'SK', 'Volatility', 'ATR', 'variation_t', 'ret', 'SR']
2025-05-19 23:21:01,196 - INFO - [src.data_preparation] - Ticker NTB - 2D shapes: X_train=(439, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:01,196 - INFO - [src.data_preparation] - Ticker NTB - 3D shapes: X_train=(439, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:01,199 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NTB
2025-05-19 23:21:01,199 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (439, 13, 15), y shape: (439,)
2025-05-19 23:21:01,199 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(136), np.int64(1): np.int64(303)}
2025-05-19 23:21:01,199 - INFO - [src.data_preparation] - Generating 167 synthetic minority samples
2025-05-19 23:21:01,206 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (606, 13, 15), y shape: (606,)
2025-05-19 23:21:01,206 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(303), np.int64(1): np.int64(303)}
2025-05-19 23:21:01,209 - INFO - [src.data_preparation] - Ticker NTB - Final 3D shapes: X_train=(606, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:01,210 - INFO - [__main__] - Using best model for NTB: lstm (F1: 0.9885)
2025-05-19 23:21:01,210 - INFO - [__main__] - Loading lstm model for NTB...
2025-05-19 23:21:01,214 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:01,215 - INFO - [__main__] - Model size: 0.12 MB
2025-05-19 23:21:01,215 - INFO - [__main__] - Making predictions for NTB using lstm
2025-05-19 23:21:01,220 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:01,220 - INFO - [__main__] - Successfully got last prediction for NTB
2025-05-19 23:21:01,220 - INFO - [__main__] - 
Processing ticker: NTL
2025-05-19 23:21:01,221 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:01,221 - INFO - [__main__] - Getting last prediction point for ticker: NTL
2025-05-19 23:21:01,221 - INFO - [__main__] - ==================================================
2025-05-19 23:21:01,221 - INFO - [__main__] - Preparing test data for NTL...
2025-05-19 23:21:01,273 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:01,273 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:01,273 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:01,305 - INFO - [src.data_preparation] - Ticker NTL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:01,306 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:21:01,695 - INFO - [src.data_preparation] - Ticker NTL - Selected features:
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   insec_t: 0.0727
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   vnipc_t: 0.0724
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   SK: 0.0683
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   TVV: 0.0679
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   HL: 0.0676
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   ret: 0.0589
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   variation_t: 0.0569
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   PM: 0.0548
2025-05-19 23:21:01,696 - INFO - [src.data_preparation] -   SR: 0.0544
2025-05-19 23:21:01,697 - INFO - [src.data_preparation] -   LO: 0.0528
2025-05-19 23:21:01,697 - INFO - [src.data_preparation] -   ATR: 0.0519
2025-05-19 23:21:01,697 - INFO - [src.data_preparation] -   ma14_t: 0.0510
2025-05-19 23:21:01,697 - INFO - [src.data_preparation] -   Median_HL: 0.0481
2025-05-19 23:21:01,702 - INFO - [src.data_preparation] - Ticker NTL - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 'TVV', 'HL', 'Volatility', 's_d7_t', 'ret', 'variation_t', 'PM', 'SR', 'LO', 'ATR', 'ma14_t', 'Median_HL']
2025-05-19 23:21:01,815 - INFO - [src.data_preparation] - Ticker NTL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:01,815 - INFO - [src.data_preparation] - Ticker NTL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:01,817 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NTL
2025-05-19 23:21:01,818 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:01,818 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:21:01,818 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:21:01,818 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:21:01,819 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:21:01,822 - INFO - [src.data_preparation] - Ticker NTL - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:01,822 - INFO - [__main__] - Using best model for NTL: logistic_regression (F1: 0.6780)
2025-05-19 23:21:01,822 - INFO - [__main__] - Loading logistic_regression model for NTL...
2025-05-19 23:21:01,823 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:01,823 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:01,823 - INFO - [__main__] - Making predictions for NTL using logistic_regression
2025-05-19 23:21:01,824 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:01,825 - INFO - [__main__] - Successfully got last prediction for NTL
2025-05-19 23:21:01,825 - INFO - [__main__] - 
Processing ticker: NTP
2025-05-19 23:21:01,825 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:01,825 - INFO - [__main__] - Getting last prediction point for ticker: NTP
2025-05-19 23:21:01,825 - INFO - [__main__] - ==================================================
2025-05-19 23:21:01,825 - INFO - [__main__] - Preparing test data for NTP...
2025-05-19 23:21:01,859 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:01,859 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:01,859 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:01,883 - INFO - [src.data_preparation] - Ticker NTP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:01,884 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] - Ticker NTP - Selected features:
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   insec_t: 0.0723
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   vnipc_t: 0.0690
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   SK: 0.0668
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   LO: 0.0611
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   HL: 0.0604
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   TVV: 0.0602
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   SR: 0.0597
2025-05-19 23:21:02,258 - INFO - [src.data_preparation] -   s_d7_t: 0.0587
2025-05-19 23:21:02,259 - INFO - [src.data_preparation] -   variation_t: 0.0585
2025-05-19 23:21:02,259 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:21:02,259 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:21:02,259 - INFO - [src.data_preparation] -   ATR: 0.0547
2025-05-19 23:21:02,259 - INFO - [src.data_preparation] -   ma14_t: 0.0532
2025-05-19 23:21:02,259 - INFO - [src.data_preparation] -   ma7_t: 0.0506
2025-05-19 23:21:02,261 - INFO - [src.data_preparation] - Ticker NTP - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 'Volatility', 'LO', 'HL', 'TVV', 'SR', 's_d7_t', 'variation_t', 'ma21_t', 'ret', 'ATR', 'ma14_t', 'ma7_t']
2025-05-19 23:21:02,354 - INFO - [src.data_preparation] - Ticker NTP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:02,354 - INFO - [src.data_preparation] - Ticker NTP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:02,355 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NTP
2025-05-19 23:21:02,355 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:02,355 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:21:02,355 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:21:02,358 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:21:02,358 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:21:02,361 - INFO - [src.data_preparation] - Ticker NTP - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:02,361 - INFO - [__main__] - Using best model for NTP: logistic_regression (F1: 0.3684)
2025-05-19 23:21:02,361 - INFO - [__main__] - Loading logistic_regression model for NTP...
2025-05-19 23:21:02,362 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:02,362 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:02,362 - INFO - [__main__] - Making predictions for NTP using logistic_regression
2025-05-19 23:21:02,363 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:02,363 - INFO - [__main__] - Successfully got last prediction for NTP
2025-05-19 23:21:02,363 - INFO - [__main__] - 
Processing ticker: NTW
2025-05-19 23:21:02,363 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:02,363 - INFO - [__main__] - Getting last prediction point for ticker: NTW
2025-05-19 23:21:02,363 - INFO - [__main__] - ==================================================
2025-05-19 23:21:02,363 - INFO - [__main__] - Preparing test data for NTW...
2025-05-19 23:21:02,392 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:02,392 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:02,392 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:02,415 - INFO - [src.data_preparation] - Ticker NTW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:02,415 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(385)}
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] - Ticker NTW - Selected features:
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   ATR: 0.0694
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   SK: 0.0690
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   Volatility: 0.0686
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   vnipc_t: 0.0645
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   ma21_t: 0.0634
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   ma14_t: 0.0615
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   insec_t: 0.0600
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   Median_HL: 0.0589
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   ma7_t: 0.0570
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   TVV: 0.0570
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   SR: 0.0557
2025-05-19 23:21:02,738 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:21:02,740 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:21:02,741 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:21:02,742 - INFO - [src.data_preparation] - Ticker NTW - Using features: ['Date', 'ATR', 'SK', 'Volatility', 'vnipc_t', 'ma21_t', 'ma14_t', 's_d7_t', 'insec_t', 'Median_HL', 'ma7_t', 'TVV', 'SR', 'HL', 'PM', 'variation_t']
2025-05-19 23:21:02,836 - INFO - [src.data_preparation] - Ticker NTW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:02,836 - INFO - [src.data_preparation] - Ticker NTW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:02,838 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NTW
2025-05-19 23:21:02,838 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:02,838 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:21:02,838 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:21:02,841 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:21:02,842 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:21:02,845 - INFO - [src.data_preparation] - Ticker NTW - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:02,845 - INFO - [__main__] - Using best model for NTW: svm (F1: 0.7945)
2025-05-19 23:21:02,845 - INFO - [__main__] - Loading svm model for NTW...
2025-05-19 23:21:02,847 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:02,848 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:21:02,848 - INFO - [__main__] - Making predictions for NTW using svm
2025-05-19 23:21:02,848 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:02,848 - INFO - [__main__] - Successfully got last prediction for NTW
2025-05-19 23:21:02,848 - INFO - [__main__] - 
Processing ticker: NVB
2025-05-19 23:21:02,848 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:02,848 - INFO - [__main__] - Getting last prediction point for ticker: NVB
2025-05-19 23:21:02,848 - INFO - [__main__] - ==================================================
2025-05-19 23:21:02,848 - INFO - [__main__] - Preparing test data for NVB...
2025-05-19 23:21:02,882 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:02,882 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:02,882 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:02,900 - INFO - [src.data_preparation] - Ticker NVB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:02,900 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(300), np.int64(1): np.int64(339)}
2025-05-19 23:21:03,229 - INFO - [src.data_preparation] - Ticker NVB - Selected features:
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   vnipc_t: 0.0791
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   SK: 0.0710
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   TVV: 0.0668
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   insec_t: 0.0631
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   ATR: 0.0622
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   Volatility: 0.0613
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   s_d7_t: 0.0599
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   ret: 0.0589
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   variation_t: 0.0570
2025-05-19 23:21:03,230 - INFO - [src.data_preparation] -   HL: 0.0546
2025-05-19 23:21:03,231 - INFO - [src.data_preparation] -   SR: 0.0495
2025-05-19 23:21:03,231 - INFO - [src.data_preparation] -   ma14_t: 0.0493
2025-05-19 23:21:03,231 - INFO - [src.data_preparation] -   Median_HL: 0.0491
2025-05-19 23:21:03,231 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:21:03,233 - INFO - [src.data_preparation] - Ticker NVB - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'insec_t', 'ATR', 'Volatility', 's_d7_t', 'ret', 'ma21_t', 'variation_t', 'HL', 'SR', 'ma14_t', 'Median_HL', 'PM']
2025-05-19 23:21:03,325 - INFO - [src.data_preparation] - Ticker NVB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:03,325 - INFO - [src.data_preparation] - Ticker NVB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:03,326 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NVB
2025-05-19 23:21:03,327 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:03,327 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:21:03,327 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:21:03,330 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:21:03,331 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:21:03,334 - INFO - [src.data_preparation] - Ticker NVB - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:03,334 - INFO - [__main__] - Using best model for NVB: lstm (F1: 0.7143)
2025-05-19 23:21:03,334 - INFO - [__main__] - Loading lstm model for NVB...
2025-05-19 23:21:03,339 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:03,340 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:21:03,340 - INFO - [__main__] - Making predictions for NVB using lstm
2025-05-19 23:21:03,343 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:03,344 - INFO - [__main__] - Successfully got last prediction for NVB
2025-05-19 23:21:03,344 - INFO - [__main__] - 
Processing ticker: NVT
2025-05-19 23:21:03,344 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:03,344 - INFO - [__main__] - Getting last prediction point for ticker: NVT
2025-05-19 23:21:03,344 - INFO - [__main__] - ==================================================
2025-05-19 23:21:03,344 - INFO - [__main__] - Preparing test data for NVT...
2025-05-19 23:21:03,393 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:03,393 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:03,393 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:03,422 - INFO - [src.data_preparation] - Ticker NVT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:03,422 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(333), np.int64(1): np.int64(306)}
2025-05-19 23:21:03,795 - INFO - [src.data_preparation] - Ticker NVT - Selected features:
2025-05-19 23:21:03,795 - INFO - [src.data_preparation] -   insec_t: 0.0795
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   SK: 0.0682
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   Volatility: 0.0681
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   HL: 0.0623
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   vnipc_t: 0.0614
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   ma21_t: 0.0575
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   s_d7_t: 0.0566
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   variation_t: 0.0559
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   SR: 0.0542
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   ma7_t: 0.0521
2025-05-19 23:21:03,796 - INFO - [src.data_preparation] -   LO: 0.0516
2025-05-19 23:21:03,797 - INFO - [src.data_preparation] -   Median_HL: 0.0491
2025-05-19 23:21:03,799 - INFO - [src.data_preparation] - Ticker NVT - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'TVV', 'HL', 'ATR', 'vnipc_t', 'ma21_t', 's_d7_t', 'variation_t', 'SR', 'ret', 'ma7_t', 'LO', 'Median_HL']
2025-05-19 23:21:03,887 - INFO - [src.data_preparation] - Ticker NVT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:03,887 - INFO - [src.data_preparation] - Ticker NVT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:03,888 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker NVT
2025-05-19 23:21:03,888 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:03,888 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(230)}
2025-05-19 23:21:03,888 - INFO - [src.data_preparation] - Generating 3 synthetic minority samples
2025-05-19 23:21:03,890 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (466, 13, 15), y shape: (466,)
2025-05-19 23:21:03,890 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(233)}
2025-05-19 23:21:03,892 - INFO - [src.data_preparation] - Ticker NVT - Final 3D shapes: X_train=(466, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:03,893 - INFO - [__main__] - Using best model for NVT: lstm (F1: 0.5818)
2025-05-19 23:21:03,893 - INFO - [__main__] - Loading lstm model for NVT...
2025-05-19 23:21:03,897 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:03,898 - INFO - [__main__] - Model size: 0.19 MB
2025-05-19 23:21:03,898 - INFO - [__main__] - Making predictions for NVT using lstm
2025-05-19 23:21:03,901 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:03,901 - INFO - [__main__] - Successfully got last prediction for NVT
2025-05-19 23:21:03,901 - INFO - [__main__] - 
Processing ticker: OCH
2025-05-19 23:21:03,901 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:03,901 - INFO - [__main__] - Getting last prediction point for ticker: OCH
2025-05-19 23:21:03,901 - INFO - [__main__] - ==================================================
2025-05-19 23:21:03,901 - INFO - [__main__] - Preparing test data for OCH...
2025-05-19 23:21:03,949 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:03,949 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:03,949 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:03,985 - INFO - [src.data_preparation] - Ticker OCH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:03,986 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:21:04,466 - INFO - [src.data_preparation] - Ticker OCH - Selected features:
2025-05-19 23:21:04,466 - INFO - [src.data_preparation] -   vnipc_t: 0.0818
2025-05-19 23:21:04,466 - INFO - [src.data_preparation] -   insec_t: 0.0713
2025-05-19 23:21:04,466 - INFO - [src.data_preparation] -   ATR: 0.0712
2025-05-19 23:21:04,466 - INFO - [src.data_preparation] -   SK: 0.0690
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   ma14_t: 0.0675
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   Volatility: 0.0669
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   s_d7_t: 0.0655
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   TVV: 0.0652
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   ma21_t: 0.0628
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:21:04,467 - INFO - [src.data_preparation] -   PM: 0.0555
2025-05-19 23:21:04,468 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:21:04,468 - INFO - [src.data_preparation] -   ret: 0.0443
2025-05-19 23:21:04,468 - INFO - [src.data_preparation] -   variation_t: 0.0442
2025-05-19 23:21:04,468 - INFO - [src.data_preparation] -   HL: 0.0432
2025-05-19 23:21:04,471 - INFO - [src.data_preparation] - Ticker OCH - Using features: ['Date', 'vnipc_t', 'insec_t', 'ATR', 'SK', 'ma14_t', 'Volatility', 's_d7_t', 'TVV', 'ma21_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:04,587 - INFO - [src.data_preparation] - Ticker OCH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:04,587 - INFO - [src.data_preparation] - Ticker OCH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:04,589 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker OCH
2025-05-19 23:21:04,589 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:04,589 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(179), np.int64(1): np.int64(284)}
2025-05-19 23:21:04,590 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:21:04,595 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:21:04,595 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:21:04,600 - INFO - [src.data_preparation] - Ticker OCH - Final 3D shapes: X_train=(568, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:04,600 - INFO - [__main__] - Using best model for OCH: logistic_regression (F1: 0.7097)
2025-05-19 23:21:04,600 - INFO - [__main__] - Loading logistic_regression model for OCH...
2025-05-19 23:21:04,601 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:04,601 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:04,601 - INFO - [__main__] - Making predictions for OCH using logistic_regression
2025-05-19 23:21:04,602 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:04,602 - INFO - [__main__] - Successfully got last prediction for OCH
2025-05-19 23:21:04,602 - INFO - [__main__] - 
Processing ticker: OGC
2025-05-19 23:21:04,602 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:04,602 - INFO - [__main__] - Getting last prediction point for ticker: OGC
2025-05-19 23:21:04,602 - INFO - [__main__] - ==================================================
2025-05-19 23:21:04,602 - INFO - [__main__] - Preparing test data for OGC...
2025-05-19 23:21:04,635 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:04,635 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:04,635 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:04,665 - INFO - [src.data_preparation] - Ticker OGC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:04,665 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(329), np.int64(1): np.int64(310)}
2025-05-19 23:21:05,103 - INFO - [src.data_preparation] - Ticker OGC - Selected features:
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   vnipc_t: 0.0707
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   SK: 0.0655
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   Volatility: 0.0622
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   variation_t: 0.0621
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   insec_t: 0.0613
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   HL: 0.0608
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   TVV: 0.0588
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   ma14_t: 0.0584
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   s_d7_t: 0.0582
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   Median_HL: 0.0575
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   ret: 0.0573
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   ma21_t: 0.0561
2025-05-19 23:21:05,104 - INFO - [src.data_preparation] -   ma7_t: 0.0555
2025-05-19 23:21:05,105 - INFO - [src.data_preparation] -   ATR: 0.0535
2025-05-19 23:21:05,105 - INFO - [src.data_preparation] -   SR: 0.0535
2025-05-19 23:21:05,108 - INFO - [src.data_preparation] - Ticker OGC - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'variation_t', 'insec_t', 'HL', 'TVV', 'ma14_t', 's_d7_t', 'Median_HL', 'ret', 'ma21_t', 'ma7_t', 'ATR', 'SR']
2025-05-19 23:21:05,193 - INFO - [src.data_preparation] - Ticker OGC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:05,194 - INFO - [src.data_preparation] - Ticker OGC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:05,196 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker OGC
2025-05-19 23:21:05,196 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:05,196 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(225), np.int64(1): np.int64(238)}
2025-05-19 23:21:05,196 - INFO - [src.data_preparation] - Generating 13 synthetic minority samples
2025-05-19 23:21:05,197 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (476, 13, 15), y shape: (476,)
2025-05-19 23:21:05,198 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(238)}
2025-05-19 23:21:05,201 - INFO - [src.data_preparation] - Ticker OGC - Final 3D shapes: X_train=(476, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:05,201 - INFO - [__main__] - Using best model for OGC: transformer (F1: 0.5000)
2025-05-19 23:21:05,201 - INFO - [__main__] - Loading transformer model for OGC...
2025-05-19 23:21:05,223 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:05,231 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:21:05,231 - INFO - [__main__] - Making predictions for OGC using transformer
2025-05-19 23:21:05,234 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:05,235 - INFO - [__main__] - Successfully got last prediction for OGC
2025-05-19 23:21:05,235 - INFO - [__main__] - 
Processing ticker: ONE
2025-05-19 23:21:05,235 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:05,235 - INFO - [__main__] - Getting last prediction point for ticker: ONE
2025-05-19 23:21:05,235 - INFO - [__main__] - ==================================================
2025-05-19 23:21:05,235 - INFO - [__main__] - Preparing test data for ONE...
2025-05-19 23:21:05,285 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:05,286 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:05,286 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:05,307 - INFO - [src.data_preparation] - Ticker ONE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:05,308 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(230), np.int64(1): np.int64(409)}
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] - Ticker ONE - Selected features:
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   ATR: 0.0758
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   TVV: 0.0731
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   SK: 0.0687
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   Volatility: 0.0676
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   insec_t: 0.0663
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   HL: 0.0631
2025-05-19 23:21:05,648 - INFO - [src.data_preparation] -   s_d7_t: 0.0629
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   ma21_t: 0.0524
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   SR: 0.0523
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   ret: 0.0506
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   variation_t: 0.0479
2025-05-19 23:21:05,649 - INFO - [src.data_preparation] -   ma14_t: 0.0476
2025-05-19 23:21:05,652 - INFO - [src.data_preparation] - Ticker ONE - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 'SK', 'Volatility', 'insec_t', 'HL', 's_d7_t', 'ma7_t', 'ma21_t', 'SR', 'ret', 'PM', 'variation_t', 'ma14_t']
2025-05-19 23:21:05,744 - INFO - [src.data_preparation] - Ticker ONE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:05,744 - INFO - [src.data_preparation] - Ticker ONE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:05,747 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ONE
2025-05-19 23:21:05,747 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:05,747 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(156), np.int64(1): np.int64(307)}
2025-05-19 23:21:05,747 - INFO - [src.data_preparation] - Generating 151 synthetic minority samples
2025-05-19 23:21:05,754 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (614, 13, 15), y shape: (614,)
2025-05-19 23:21:05,754 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(307), np.int64(1): np.int64(307)}
2025-05-19 23:21:05,757 - INFO - [src.data_preparation] - Ticker ONE - Final 3D shapes: X_train=(614, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:05,758 - INFO - [__main__] - Using best model for ONE: svm (F1: 0.6866)
2025-05-19 23:21:05,758 - INFO - [__main__] - Loading svm model for ONE...
2025-05-19 23:21:05,759 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:05,759 - INFO - [__main__] - Model size: 0.93 MB
2025-05-19 23:21:05,760 - INFO - [__main__] - Making predictions for ONE using svm
2025-05-19 23:21:05,760 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:05,761 - INFO - [__main__] - Successfully got last prediction for ONE
2025-05-19 23:21:05,761 - INFO - [__main__] - 
Processing ticker: OPC
2025-05-19 23:21:05,761 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:05,761 - INFO - [__main__] - Getting last prediction point for ticker: OPC
2025-05-19 23:21:05,761 - INFO - [__main__] - ==================================================
2025-05-19 23:21:05,761 - INFO - [__main__] - Preparing test data for OPC...
2025-05-19 23:21:05,791 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:05,791 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:05,791 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:05,811 - INFO - [src.data_preparation] - Ticker OPC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:05,811 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(267), np.int64(1): np.int64(372)}
2025-05-19 23:21:06,142 - INFO - [src.data_preparation] - Ticker OPC - Selected features:
2025-05-19 23:21:06,142 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:21:06,142 - INFO - [src.data_preparation] -   SR: 0.0676
2025-05-19 23:21:06,142 - INFO - [src.data_preparation] -   Volatility: 0.0672
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   HL: 0.0671
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   insec_t: 0.0639
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   s_d7_t: 0.0600
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   SK: 0.0599
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   ATR: 0.0598
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   LO: 0.0589
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   variation_t: 0.0550
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   ma21_t: 0.0550
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   ma14_t: 0.0518
2025-05-19 23:21:06,143 - INFO - [src.data_preparation] -   ret: 0.0512
2025-05-19 23:21:06,144 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:21:06,145 - INFO - [src.data_preparation] - Ticker OPC - Using features: ['Date', 'vnipc_t', 'SR', 'Volatility', 'HL', 'TVV', 'insec_t', 's_d7_t', 'SK', 'ATR', 'LO', 'variation_t', 'ma21_t', 'ma14_t', 'ret', 'Median_HL']
2025-05-19 23:21:06,237 - INFO - [src.data_preparation] - Ticker OPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:06,237 - INFO - [src.data_preparation] - Ticker OPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:06,239 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker OPC
2025-05-19 23:21:06,239 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:06,239 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(187), np.int64(1): np.int64(276)}
2025-05-19 23:21:06,239 - INFO - [src.data_preparation] - Generating 89 synthetic minority samples
2025-05-19 23:21:06,243 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (552, 13, 15), y shape: (552,)
2025-05-19 23:21:06,243 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(276), np.int64(1): np.int64(276)}
2025-05-19 23:21:06,247 - INFO - [src.data_preparation] - Ticker OPC - Final 3D shapes: X_train=(552, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:06,248 - INFO - [__main__] - Using best model for OPC: svm (F1: 0.6522)
2025-05-19 23:21:06,248 - INFO - [__main__] - Loading svm model for OPC...
2025-05-19 23:21:06,249 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:06,250 - INFO - [__main__] - Model size: 0.73 MB
2025-05-19 23:21:06,250 - INFO - [__main__] - Making predictions for OPC using svm
2025-05-19 23:21:06,250 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:06,251 - INFO - [__main__] - Successfully got last prediction for OPC
2025-05-19 23:21:06,251 - INFO - [__main__] - 
Processing ticker: ORS
2025-05-19 23:21:06,251 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:06,251 - INFO - [__main__] - Getting last prediction point for ticker: ORS
2025-05-19 23:21:06,251 - INFO - [__main__] - ==================================================
2025-05-19 23:21:06,251 - INFO - [__main__] - Preparing test data for ORS...
2025-05-19 23:21:06,280 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:06,280 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:06,280 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:06,299 - INFO - [src.data_preparation] - Ticker ORS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:06,299 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(371)}
2025-05-19 23:21:06,646 - INFO - [src.data_preparation] - Ticker ORS - Selected features:
2025-05-19 23:21:06,646 - INFO - [src.data_preparation] -   SK: 0.0756
2025-05-19 23:21:06,646 - INFO - [src.data_preparation] -   TVV: 0.0754
2025-05-19 23:21:06,646 - INFO - [src.data_preparation] -   insec_t: 0.0708
2025-05-19 23:21:06,646 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:21:06,646 - INFO - [src.data_preparation] -   Volatility: 0.0651
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   ATR: 0.0639
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   s_d7_t: 0.0595
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   SR: 0.0587
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   ma7_t: 0.0560
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   ma21_t: 0.0536
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   ret: 0.0522
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   PM: 0.0520
2025-05-19 23:21:06,647 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:21:06,650 - INFO - [src.data_preparation] - Ticker ORS - Using features: ['Date', 'SK', 'TVV', 'insec_t', 'vnipc_t', 'Volatility', 'ATR', 's_d7_t', 'SR', 'ma7_t', 'ma14_t', 'ma21_t', 'Median_HL', 'ret', 'PM', 'variation_t']
2025-05-19 23:21:06,789 - INFO - [src.data_preparation] - Ticker ORS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:06,789 - INFO - [src.data_preparation] - Ticker ORS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:06,791 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ORS
2025-05-19 23:21:06,791 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:06,791 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(178), np.int64(1): np.int64(285)}
2025-05-19 23:21:06,791 - INFO - [src.data_preparation] - Generating 107 synthetic minority samples
2025-05-19 23:21:06,796 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (570, 13, 15), y shape: (570,)
2025-05-19 23:21:06,797 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(285), np.int64(1): np.int64(285)}
2025-05-19 23:21:06,800 - INFO - [src.data_preparation] - Ticker ORS - Final 3D shapes: X_train=(570, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:06,800 - INFO - [__main__] - Using best model for ORS: svm (F1: 0.6032)
2025-05-19 23:21:06,800 - INFO - [__main__] - Loading svm model for ORS...
2025-05-19 23:21:06,802 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:06,803 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:21:06,803 - INFO - [__main__] - Making predictions for ORS using svm
2025-05-19 23:21:06,803 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:06,804 - INFO - [__main__] - Successfully got last prediction for ORS
2025-05-19 23:21:06,804 - INFO - [__main__] - 
Processing ticker: PAC
2025-05-19 23:21:06,805 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:06,805 - INFO - [__main__] - Getting last prediction point for ticker: PAC
2025-05-19 23:21:06,805 - INFO - [__main__] - ==================================================
2025-05-19 23:21:06,805 - INFO - [__main__] - Preparing test data for PAC...
2025-05-19 23:21:06,835 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:06,835 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:06,835 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:06,860 - INFO - [src.data_preparation] - Ticker PAC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:06,861 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:21:07,185 - INFO - [src.data_preparation] - Ticker PAC - Selected features:
2025-05-19 23:21:07,185 - INFO - [src.data_preparation] -   Volatility: 0.0761
2025-05-19 23:21:07,185 - INFO - [src.data_preparation] -   SK: 0.0707
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   LO: 0.0690
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   insec_t: 0.0664
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   s_d7_t: 0.0643
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   HL: 0.0642
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   vnipc_t: 0.0625
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   SR: 0.0606
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   TVV: 0.0570
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   ATR: 0.0529
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   Median_HL: 0.0523
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   PM: 0.0512
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   ma21_t: 0.0509
2025-05-19 23:21:07,186 - INFO - [src.data_preparation] -   ma7_t: 0.0499
2025-05-19 23:21:07,189 - INFO - [src.data_preparation] - Ticker PAC - Using features: ['Date', 'Volatility', 'SK', 'LO', 'insec_t', 's_d7_t', 'HL', 'vnipc_t', 'SR', 'TVV', 'ATR', 'ret', 'Median_HL', 'PM', 'ma21_t', 'ma7_t']
2025-05-19 23:21:07,277 - INFO - [src.data_preparation] - Ticker PAC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:07,277 - INFO - [src.data_preparation] - Ticker PAC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:07,279 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PAC
2025-05-19 23:21:07,279 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:07,279 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:21:07,279 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:21:07,282 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:21:07,282 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:21:07,285 - INFO - [src.data_preparation] - Ticker PAC - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:07,285 - INFO - [__main__] - Using best model for PAC: logistic_regression (F1: 0.5614)
2025-05-19 23:21:07,285 - INFO - [__main__] - Loading logistic_regression model for PAC...
2025-05-19 23:21:07,286 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:07,286 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:07,286 - INFO - [__main__] - Making predictions for PAC using logistic_regression
2025-05-19 23:21:07,287 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:07,287 - INFO - [__main__] - Successfully got last prediction for PAC
2025-05-19 23:21:07,287 - INFO - [__main__] - 
Processing ticker: PAN
2025-05-19 23:21:07,288 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:07,288 - INFO - [__main__] - Getting last prediction point for ticker: PAN
2025-05-19 23:21:07,288 - INFO - [__main__] - ==================================================
2025-05-19 23:21:07,288 - INFO - [__main__] - Preparing test data for PAN...
2025-05-19 23:21:07,313 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:07,313 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:07,313 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:07,330 - INFO - [src.data_preparation] - Ticker PAN - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:07,331 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(340)}
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] - Ticker PAN - Selected features:
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   SK: 0.0691
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   insec_t: 0.0669
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   Volatility: 0.0647
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   TVV: 0.0634
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   vnipc_t: 0.0614
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   SR: 0.0591
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   HL: 0.0585
2025-05-19 23:21:07,721 - INFO - [src.data_preparation] -   s_d7_t: 0.0581
2025-05-19 23:21:07,722 - INFO - [src.data_preparation] -   PM: 0.0569
2025-05-19 23:21:07,722 - INFO - [src.data_preparation] -   ma14_t: 0.0555
2025-05-19 23:21:07,722 - INFO - [src.data_preparation] -   Median_HL: 0.0545
2025-05-19 23:21:07,722 - INFO - [src.data_preparation] -   LO: 0.0537
2025-05-19 23:21:07,722 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:21:07,722 - INFO - [src.data_preparation] -   variation_t: 0.0531
2025-05-19 23:21:07,726 - INFO - [src.data_preparation] - Ticker PAN - Using features: ['Date', 'SK', 'insec_t', 'Volatility', 'TVV', 'vnipc_t', 'SR', 'ATR', 'HL', 's_d7_t', 'PM', 'ma14_t', 'Median_HL', 'LO', 'ret', 'variation_t']
2025-05-19 23:21:07,851 - INFO - [src.data_preparation] - Ticker PAN - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:07,851 - INFO - [src.data_preparation] - Ticker PAN - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:07,853 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PAN
2025-05-19 23:21:07,853 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:07,853 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(242)}
2025-05-19 23:21:07,854 - INFO - [src.data_preparation] - Generating 22 synthetic minority samples
2025-05-19 23:21:07,855 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:21:07,856 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:21:07,860 - INFO - [src.data_preparation] - Ticker PAN - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:07,860 - INFO - [__main__] - Using best model for PAN: logistic_regression (F1: 0.5957)
2025-05-19 23:21:07,860 - INFO - [__main__] - Loading logistic_regression model for PAN...
2025-05-19 23:21:07,861 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:07,861 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:07,861 - INFO - [__main__] - Making predictions for PAN using logistic_regression
2025-05-19 23:21:07,861 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:07,862 - INFO - [__main__] - Successfully got last prediction for PAN
2025-05-19 23:21:07,862 - INFO - [__main__] - 
Processing ticker: PCG
2025-05-19 23:21:07,862 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:07,862 - INFO - [__main__] - Getting last prediction point for ticker: PCG
2025-05-19 23:21:07,862 - INFO - [__main__] - ==================================================
2025-05-19 23:21:07,862 - INFO - [__main__] - Preparing test data for PCG...
2025-05-19 23:21:07,914 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:07,914 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:07,914 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:07,949 - INFO - [src.data_preparation] - Ticker PCG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:07,950 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(249), np.int64(1): np.int64(390)}
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] - Ticker PCG - Selected features:
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   s_d7_t: 0.0745
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   TVV: 0.0709
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   ma14_t: 0.0695
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   vnipc_t: 0.0694
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   ma21_t: 0.0661
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   Volatility: 0.0644
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   ma7_t: 0.0605
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   insec_t: 0.0591
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   ATR: 0.0538
2025-05-19 23:21:08,305 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:21:08,306 - INFO - [src.data_preparation] -   PM: 0.0533
2025-05-19 23:21:08,306 - INFO - [src.data_preparation] -   Median_HL: 0.0526
2025-05-19 23:21:08,306 - INFO - [src.data_preparation] -   SR: 0.0444
2025-05-19 23:21:08,306 - INFO - [src.data_preparation] -   LO: 0.0433
2025-05-19 23:21:08,308 - INFO - [src.data_preparation] - Ticker PCG - Using features: ['Date', 's_d7_t', 'TVV', 'ma14_t', 'vnipc_t', 'ma21_t', 'Volatility', 'SK', 'ma7_t', 'insec_t', 'ATR', 'ret', 'PM', 'Median_HL', 'SR', 'LO']
2025-05-19 23:21:08,403 - INFO - [src.data_preparation] - Ticker PCG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:08,403 - INFO - [src.data_preparation] - Ticker PCG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:08,405 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PCG
2025-05-19 23:21:08,405 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:08,405 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(161), np.int64(1): np.int64(302)}
2025-05-19 23:21:08,405 - INFO - [src.data_preparation] - Generating 141 synthetic minority samples
2025-05-19 23:21:08,412 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (604, 13, 15), y shape: (604,)
2025-05-19 23:21:08,412 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(302), np.int64(1): np.int64(302)}
2025-05-19 23:21:08,416 - INFO - [src.data_preparation] - Ticker PCG - Final 3D shapes: X_train=(604, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:08,416 - INFO - [__main__] - Using best model for PCG: transformer (F1: 0.6000)
2025-05-19 23:21:08,416 - INFO - [__main__] - Loading transformer model for PCG...
2025-05-19 23:21:08,426 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:08,429 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:21:08,429 - INFO - [__main__] - Making predictions for PCG using transformer
2025-05-19 23:21:08,430 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:08,431 - INFO - [__main__] - Successfully got last prediction for PCG
2025-05-19 23:21:08,431 - INFO - [__main__] - 
Processing ticker: PCT
2025-05-19 23:21:08,431 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:08,431 - INFO - [__main__] - Getting last prediction point for ticker: PCT
2025-05-19 23:21:08,431 - INFO - [__main__] - ==================================================
2025-05-19 23:21:08,431 - INFO - [__main__] - Preparing test data for PCT...
2025-05-19 23:21:08,477 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:08,477 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:08,477 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:08,512 - INFO - [src.data_preparation] - Ticker PCT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:08,513 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(237), np.int64(1): np.int64(402)}
2025-05-19 23:21:08,944 - INFO - [src.data_preparation] - Ticker PCT - Selected features:
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   vnipc_t: 0.0825
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   TVV: 0.0675
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   insec_t: 0.0660
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   ma21_t: 0.0638
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   ma14_t: 0.0631
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   ATR: 0.0627
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   Volatility: 0.0626
2025-05-19 23:21:08,945 - INFO - [src.data_preparation] -   ma7_t: 0.0575
2025-05-19 23:21:08,946 - INFO - [src.data_preparation] -   variation_t: 0.0562
2025-05-19 23:21:08,946 - INFO - [src.data_preparation] -   ret: 0.0556
2025-05-19 23:21:08,946 - INFO - [src.data_preparation] -   SK: 0.0550
2025-05-19 23:21:08,946 - INFO - [src.data_preparation] -   Median_HL: 0.0496
2025-05-19 23:21:08,946 - INFO - [src.data_preparation] -   HL: 0.0475
2025-05-19 23:21:08,946 - INFO - [src.data_preparation] -   SR: 0.0465
2025-05-19 23:21:08,950 - INFO - [src.data_preparation] - Ticker PCT - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 's_d7_t', 'ma21_t', 'ma14_t', 'ATR', 'Volatility', 'ma7_t', 'variation_t', 'ret', 'SK', 'Median_HL', 'HL', 'SR']
2025-05-19 23:21:09,109 - INFO - [src.data_preparation] - Ticker PCT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:09,109 - INFO - [src.data_preparation] - Ticker PCT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:09,113 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PCT
2025-05-19 23:21:09,113 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:09,113 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(163), np.int64(1): np.int64(300)}
2025-05-19 23:21:09,114 - INFO - [src.data_preparation] - Generating 137 synthetic minority samples
2025-05-19 23:21:09,125 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (600, 13, 15), y shape: (600,)
2025-05-19 23:21:09,126 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(300), np.int64(1): np.int64(300)}
2025-05-19 23:21:09,132 - INFO - [src.data_preparation] - Ticker PCT - Final 3D shapes: X_train=(600, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:09,133 - INFO - [__main__] - Using best model for PCT: svm (F1: 0.7246)
2025-05-19 23:21:09,133 - INFO - [__main__] - Loading svm model for PCT...
2025-05-19 23:21:09,137 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:09,138 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:21:09,138 - INFO - [__main__] - Making predictions for PCT using svm
2025-05-19 23:21:09,140 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:09,141 - INFO - [__main__] - Successfully got last prediction for PCT
2025-05-19 23:21:09,141 - INFO - [__main__] - 
Processing ticker: PDC
2025-05-19 23:21:09,141 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:09,141 - INFO - [__main__] - Getting last prediction point for ticker: PDC
2025-05-19 23:21:09,141 - INFO - [__main__] - ==================================================
2025-05-19 23:21:09,141 - INFO - [__main__] - Preparing test data for PDC...
2025-05-19 23:21:09,188 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:09,188 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:09,188 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:09,227 - INFO - [src.data_preparation] - Ticker PDC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:09,227 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(236), np.int64(1): np.int64(402)}
2025-05-19 23:21:09,618 - INFO - [src.data_preparation] - Ticker PDC - Selected features:
2025-05-19 23:21:09,618 - INFO - [src.data_preparation] -   Volatility: 0.0877
2025-05-19 23:21:09,618 - INFO - [src.data_preparation] -   vnipc_t: 0.0856
2025-05-19 23:21:09,618 - INFO - [src.data_preparation] -   TVV: 0.0730
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   ATR: 0.0707
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   ma21_t: 0.0638
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   ma14_t: 0.0628
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   SK: 0.0605
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   ma7_t: 0.0603
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   insec_t: 0.0600
2025-05-19 23:21:09,619 - INFO - [src.data_preparation] -   Median_HL: 0.0513
2025-05-19 23:21:09,620 - INFO - [src.data_preparation] -   variation_t: 0.0495
2025-05-19 23:21:09,620 - INFO - [src.data_preparation] -   ret: 0.0489
2025-05-19 23:21:09,620 - INFO - [src.data_preparation] -   PM: 0.0429
2025-05-19 23:21:09,620 - INFO - [src.data_preparation] -   HL: 0.0417
2025-05-19 23:21:09,623 - INFO - [src.data_preparation] - Ticker PDC - Using features: ['Date', 'Volatility', 'vnipc_t', 'TVV', 'ATR', 's_d7_t', 'ma21_t', 'ma14_t', 'SK', 'ma7_t', 'insec_t', 'Median_HL', 'variation_t', 'ret', 'PM', 'HL']
2025-05-19 23:21:09,723 - INFO - [src.data_preparation] - Ticker PDC - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:21:09,723 - INFO - [src.data_preparation] - Ticker PDC - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:09,725 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PDC
2025-05-19 23:21:09,725 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:09,725 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(146), np.int64(1): np.int64(317)}
2025-05-19 23:21:09,725 - INFO - [src.data_preparation] - Generating 171 synthetic minority samples
2025-05-19 23:21:09,738 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (634, 13, 15), y shape: (634,)
2025-05-19 23:21:09,739 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(317), np.int64(1): np.int64(317)}
2025-05-19 23:21:09,747 - INFO - [src.data_preparation] - Ticker PDC - Final 3D shapes: X_train=(634, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:09,747 - INFO - [__main__] - Using best model for PDC: svm (F1: 0.7059)
2025-05-19 23:21:09,747 - INFO - [__main__] - Loading svm model for PDC...
2025-05-19 23:21:09,750 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:09,751 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:21:09,752 - INFO - [__main__] - Making predictions for PDC using svm
2025-05-19 23:21:09,753 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:09,753 - INFO - [__main__] - Successfully got last prediction for PDC
2025-05-19 23:21:09,753 - INFO - [__main__] - 
Processing ticker: PDN
2025-05-19 23:21:09,754 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:09,754 - INFO - [__main__] - Getting last prediction point for ticker: PDN
2025-05-19 23:21:09,754 - INFO - [__main__] - ==================================================
2025-05-19 23:21:09,754 - INFO - [__main__] - Preparing test data for PDN...
2025-05-19 23:21:09,801 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:09,801 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:09,801 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:09,826 - INFO - [src.data_preparation] - Ticker PDN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:09,826 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:21:10,182 - INFO - [src.data_preparation] - Ticker PDN - Selected features:
2025-05-19 23:21:10,182 - INFO - [src.data_preparation] -   SK: 0.0804
2025-05-19 23:21:10,182 - INFO - [src.data_preparation] -   vnipc_t: 0.0757
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   insec_t: 0.0700
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   Volatility: 0.0684
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   SR: 0.0645
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   TVV: 0.0637
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   variation_t: 0.0635
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   ret: 0.0606
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   LO: 0.0598
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   HL: 0.0593
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   s_d7_t: 0.0552
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   ATR: 0.0516
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   ma21_t: 0.0462
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   ma14_t: 0.0461
2025-05-19 23:21:10,183 - INFO - [src.data_preparation] -   ma7_t: 0.0461
2025-05-19 23:21:10,187 - INFO - [src.data_preparation] - Ticker PDN - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'Volatility', 'SR', 'TVV', 'variation_t', 'ret', 'LO', 'HL', 's_d7_t', 'ATR', 'ma21_t', 'ma14_t', 'ma7_t']
2025-05-19 23:21:10,285 - INFO - [src.data_preparation] - Ticker PDN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:10,285 - INFO - [src.data_preparation] - Ticker PDN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:10,287 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PDN
2025-05-19 23:21:10,287 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:10,287 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:21:10,287 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:21:10,290 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:21:10,290 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:21:10,293 - INFO - [src.data_preparation] - Ticker PDN - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:10,293 - INFO - [__main__] - Using best model for PDN: svm (F1: 0.4348)
2025-05-19 23:21:10,293 - INFO - [__main__] - Loading svm model for PDN...
2025-05-19 23:21:10,294 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:10,294 - INFO - [__main__] - Model size: 0.50 MB
2025-05-19 23:21:10,294 - INFO - [__main__] - Making predictions for PDN using svm
2025-05-19 23:21:10,295 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:10,295 - INFO - [__main__] - Successfully got last prediction for PDN
2025-05-19 23:21:10,295 - INFO - [__main__] - 
Processing ticker: PDR
2025-05-19 23:21:10,295 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:10,295 - INFO - [__main__] - Getting last prediction point for ticker: PDR
2025-05-19 23:21:10,295 - INFO - [__main__] - ==================================================
2025-05-19 23:21:10,296 - INFO - [__main__] - Preparing test data for PDR...
2025-05-19 23:21:10,325 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:10,325 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:10,326 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:10,344 - INFO - [src.data_preparation] - Ticker PDR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:10,344 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:21:10,668 - INFO - [src.data_preparation] - Ticker PDR - Selected features:
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   vnipc_t: 0.0714
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   Volatility: 0.0673
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   TVV: 0.0671
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   SK: 0.0634
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   insec_t: 0.0603
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   LO: 0.0602
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   variation_t: 0.0591
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   ATR: 0.0581
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   ma14_t: 0.0553
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   Median_HL: 0.0551
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   ma21_t: 0.0543
2025-05-19 23:21:10,669 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:21:10,670 - INFO - [src.data_preparation] -   SR: 0.0532
2025-05-19 23:21:10,672 - INFO - [src.data_preparation] - Ticker PDR - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'SK', 's_d7_t', 'insec_t', 'LO', 'variation_t', 'ATR', 'ma14_t', 'Median_HL', 'ret', 'ma21_t', 'HL', 'SR']
2025-05-19 23:21:10,769 - INFO - [src.data_preparation] - Ticker PDR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:10,770 - INFO - [src.data_preparation] - Ticker PDR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:10,771 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PDR
2025-05-19 23:21:10,771 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:10,771 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:21:10,772 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:21:10,775 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:21:10,775 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:21:10,778 - INFO - [src.data_preparation] - Ticker PDR - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:10,778 - INFO - [__main__] - Using best model for PDR: logistic_regression (F1: 0.6102)
2025-05-19 23:21:10,779 - INFO - [__main__] - Loading logistic_regression model for PDR...
2025-05-19 23:21:10,779 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:10,779 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:10,779 - INFO - [__main__] - Making predictions for PDR using logistic_regression
2025-05-19 23:21:10,779 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:10,779 - INFO - [__main__] - Successfully got last prediction for PDR
2025-05-19 23:21:10,779 - INFO - [__main__] - 
Processing ticker: PEC
2025-05-19 23:21:10,781 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:10,781 - INFO - [__main__] - Getting last prediction point for ticker: PEC
2025-05-19 23:21:10,781 - INFO - [__main__] - ==================================================
2025-05-19 23:21:10,781 - INFO - [__main__] - Preparing test data for PEC...
2025-05-19 23:21:10,815 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:10,815 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:10,815 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:10,840 - INFO - [src.data_preparation] - Ticker PEC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:10,841 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(66), np.int64(1): np.int64(573)}
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] - Ticker PEC - Selected features:
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   vnipc_t: 0.1781
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   ma21_t: 0.1031
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   ma14_t: 0.0988
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   TVV: 0.0772
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   ma7_t: 0.0647
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   ATR: 0.0608
2025-05-19 23:21:11,130 - INFO - [src.data_preparation] -   s_d7_t: 0.0536
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   Volatility: 0.0484
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   Median_HL: 0.0477
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   PM: 0.0446
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   SK: 0.0341
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   variation_t: 0.0330
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   HL: 0.0307
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   LO: 0.0261
2025-05-19 23:21:11,131 - INFO - [src.data_preparation] -   SR: 0.0259
2025-05-19 23:21:11,134 - INFO - [src.data_preparation] - Ticker PEC - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'TVV', 'ma7_t', 'ATR', 's_d7_t', 'Volatility', 'Median_HL', 'PM', 'SK', 'variation_t', 'HL', 'LO', 'SR']
2025-05-19 23:21:11,277 - INFO - [src.data_preparation] - Ticker PEC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:11,278 - INFO - [src.data_preparation] - Ticker PEC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:11,281 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PEC
2025-05-19 23:21:11,282 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:11,282 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(52), np.int64(1): np.int64(411)}
2025-05-19 23:21:11,282 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:21:11,289 - INFO - [src.data_preparation] - Ticker PEC - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:11,289 - INFO - [__main__] - Using best model for PEC: logistic_regression (F1: 0.9762)
2025-05-19 23:21:11,289 - INFO - [__main__] - Loading logistic_regression model for PEC...
2025-05-19 23:21:11,291 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:11,291 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:11,291 - INFO - [__main__] - Making predictions for PEC using logistic_regression
2025-05-19 23:21:11,291 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:11,293 - INFO - [__main__] - Successfully got last prediction for PEC
2025-05-19 23:21:11,293 - INFO - [__main__] - 
Processing ticker: PET
2025-05-19 23:21:11,293 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:11,293 - INFO - [__main__] - Getting last prediction point for ticker: PET
2025-05-19 23:21:11,293 - INFO - [__main__] - ==================================================
2025-05-19 23:21:11,293 - INFO - [__main__] - Preparing test data for PET...
2025-05-19 23:21:11,350 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:11,350 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:11,350 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:11,390 - INFO - [src.data_preparation] - Ticker PET - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:11,391 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:21:11,801 - INFO - [src.data_preparation] - Ticker PET - Selected features:
2025-05-19 23:21:11,801 - INFO - [src.data_preparation] -   Volatility: 0.0713
2025-05-19 23:21:11,801 - INFO - [src.data_preparation] -   vnipc_t: 0.0693
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   TVV: 0.0687
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   SK: 0.0653
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   s_d7_t: 0.0646
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   ATR: 0.0642
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   insec_t: 0.0630
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   ma7_t: 0.0575
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   PM: 0.0564
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   ma14_t: 0.0558
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   ret: 0.0550
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   Median_HL: 0.0536
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   HL: 0.0534
2025-05-19 23:21:11,802 - INFO - [src.data_preparation] -   LO: 0.0489
2025-05-19 23:21:11,808 - INFO - [src.data_preparation] - Ticker PET - Using features: ['Date', 'Volatility', 'vnipc_t', 'TVV', 'SK', 's_d7_t', 'ATR', 'insec_t', 'ma7_t', 'PM', 'ma21_t', 'ma14_t', 'ret', 'Median_HL', 'HL', 'LO']
2025-05-19 23:21:11,939 - INFO - [src.data_preparation] - Ticker PET - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:11,940 - INFO - [src.data_preparation] - Ticker PET - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:11,943 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PET
2025-05-19 23:21:11,943 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:11,943 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(214), np.int64(1): np.int64(249)}
2025-05-19 23:21:11,944 - INFO - [src.data_preparation] - Generating 35 synthetic minority samples
2025-05-19 23:21:11,946 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (498, 13, 15), y shape: (498,)
2025-05-19 23:21:11,946 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(249), np.int64(1): np.int64(249)}
2025-05-19 23:21:11,951 - INFO - [src.data_preparation] - Ticker PET - Final 3D shapes: X_train=(498, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:11,951 - INFO - [__main__] - Using best model for PET: transformer (F1: 0.6250)
2025-05-19 23:21:11,951 - INFO - [__main__] - Loading transformer model for PET...
2025-05-19 23:21:11,970 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:11,978 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:21:11,978 - INFO - [__main__] - Making predictions for PET using transformer
2025-05-19 23:21:11,981 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:11,982 - INFO - [__main__] - Successfully got last prediction for PET
2025-05-19 23:21:11,982 - INFO - [__main__] - 
Processing ticker: PFL
2025-05-19 23:21:11,982 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:11,982 - INFO - [__main__] - Getting last prediction point for ticker: PFL
2025-05-19 23:21:11,983 - INFO - [__main__] - ==================================================
2025-05-19 23:21:11,983 - INFO - [__main__] - Preparing test data for PFL...
2025-05-19 23:21:12,051 - INFO - [src.data_preparation] - After processing - X shape: (635, 19), y shape: (635,)
2025-05-19 23:21:12,053 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:12,053 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:12,089 - INFO - [src.data_preparation] - Ticker PFL - Original shapes: X=(635, 18), y=(635,)
2025-05-19 23:21:12,089 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(237), np.int64(1): np.int64(398)}
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] - Ticker PFL - Selected features:
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   vnipc_t: 0.0808
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   TVV: 0.0806
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   insec_t: 0.0782
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   Volatility: 0.0727
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   SK: 0.0703
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   ma14_t: 0.0693
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   ma21_t: 0.0681
2025-05-19 23:21:12,499 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   ma7_t: 0.0582
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   Median_HL: 0.0566
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   ATR: 0.0515
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   ret: 0.0507
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   PM: 0.0473
2025-05-19 23:21:12,500 - INFO - [src.data_preparation] -   SR: 0.0286
2025-05-19 23:21:12,505 - INFO - [src.data_preparation] - Ticker PFL - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 'SK', 'ma14_t', 'ma21_t', 's_d7_t', 'ma7_t', 'Median_HL', 'variation_t', 'ATR', 'ret', 'PM', 'SR']
2025-05-19 23:21:12,613 - INFO - [src.data_preparation] - Ticker PFL - 2D shapes: X_train=(459, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:12,613 - INFO - [src.data_preparation] - Ticker PFL - 3D shapes: X_train=(459, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:12,617 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PFL
2025-05-19 23:21:12,617 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (459, 13, 15), y shape: (459,)
2025-05-19 23:21:12,617 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(160), np.int64(1): np.int64(299)}
2025-05-19 23:21:12,617 - INFO - [src.data_preparation] - Generating 139 synthetic minority samples
2025-05-19 23:21:12,623 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (598, 13, 15), y shape: (598,)
2025-05-19 23:21:12,623 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(299), np.int64(1): np.int64(299)}
2025-05-19 23:21:12,628 - INFO - [src.data_preparation] - Ticker PFL - Final 3D shapes: X_train=(598, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:12,628 - INFO - [__main__] - Using best model for PFL: svm (F1: 0.7778)
2025-05-19 23:21:12,629 - INFO - [__main__] - Loading svm model for PFL...
2025-05-19 23:21:12,631 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:12,633 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:21:12,633 - INFO - [__main__] - Making predictions for PFL using svm
2025-05-19 23:21:12,634 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:12,634 - INFO - [__main__] - Successfully got last prediction for PFL
2025-05-19 23:21:12,634 - INFO - [__main__] - 
Processing ticker: PGC
2025-05-19 23:21:12,634 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:12,634 - INFO - [__main__] - Getting last prediction point for ticker: PGC
2025-05-19 23:21:12,635 - INFO - [__main__] - ==================================================
2025-05-19 23:21:12,635 - INFO - [__main__] - Preparing test data for PGC...
2025-05-19 23:21:12,669 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:12,669 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:12,669 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:12,697 - INFO - [src.data_preparation] - Ticker PGC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:12,697 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] - Ticker PGC - Selected features:
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   ATR: 0.0705
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   s_d7_t: 0.0678
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   insec_t: 0.0651
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   vnipc_t: 0.0627
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   TVV: 0.0625
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   SR: 0.0619
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   SK: 0.0610
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   LO: 0.0609
2025-05-19 23:21:13,190 - INFO - [src.data_preparation] -   HL: 0.0602
2025-05-19 23:21:13,191 - INFO - [src.data_preparation] -   ret: 0.0562
2025-05-19 23:21:13,191 - INFO - [src.data_preparation] -   ma14_t: 0.0541
2025-05-19 23:21:13,191 - INFO - [src.data_preparation] -   ma7_t: 0.0526
2025-05-19 23:21:13,191 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:21:13,191 - INFO - [src.data_preparation] -   ma21_t: 0.0497
2025-05-19 23:21:13,194 - INFO - [src.data_preparation] - Ticker PGC - Using features: ['Date', 'ATR', 'Volatility', 's_d7_t', 'insec_t', 'vnipc_t', 'TVV', 'SR', 'SK', 'LO', 'HL', 'ret', 'ma14_t', 'ma7_t', 'PM', 'ma21_t']
2025-05-19 23:21:13,328 - INFO - [src.data_preparation] - Ticker PGC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:13,328 - INFO - [src.data_preparation] - Ticker PGC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:13,331 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PGC
2025-05-19 23:21:13,331 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:13,331 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:21:13,331 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:21:13,336 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:21:13,336 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:21:13,341 - INFO - [src.data_preparation] - Ticker PGC - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:13,342 - INFO - [__main__] - Using best model for PGC: transformer (F1: 0.7606)
2025-05-19 23:21:13,342 - INFO - [__main__] - Loading transformer model for PGC...
2025-05-19 23:21:13,366 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:13,371 - INFO - [__main__] - Model size: 0.29 MB
2025-05-19 23:21:13,371 - INFO - [__main__] - Making predictions for PGC using transformer
2025-05-19 23:21:13,374 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:13,374 - INFO - [__main__] - Successfully got last prediction for PGC
2025-05-19 23:21:13,375 - INFO - [__main__] - 
Processing ticker: PGD
2025-05-19 23:21:13,375 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:13,375 - INFO - [__main__] - Getting last prediction point for ticker: PGD
2025-05-19 23:21:13,375 - INFO - [__main__] - ==================================================
2025-05-19 23:21:13,375 - INFO - [__main__] - Preparing test data for PGD...
2025-05-19 23:21:13,426 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:13,426 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:13,426 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:13,461 - INFO - [src.data_preparation] - Ticker PGD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:13,461 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] - Ticker PGD - Selected features:
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   insec_t: 0.0797
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   SK: 0.0675
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   HL: 0.0627
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   LO: 0.0563
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   TVV: 0.0553
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   ATR: 0.0548
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:21:14,001 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:21:14,003 - INFO - [src.data_preparation] -   ma21_t: 0.0536
2025-05-19 23:21:14,003 - INFO - [src.data_preparation] -   SR: 0.0534
2025-05-19 23:21:14,003 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:21:14,003 - INFO - [src.data_preparation] -   ret: 0.0507
2025-05-19 23:21:14,008 - INFO - [src.data_preparation] - Ticker PGD - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 's_d7_t', 'HL', 'Volatility', 'LO', 'TVV', 'ATR', 'PM', 'Median_HL', 'ma21_t', 'SR', 'variation_t', 'ret']
2025-05-19 23:21:14,112 - INFO - [src.data_preparation] - Ticker PGD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:14,112 - INFO - [src.data_preparation] - Ticker PGD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:14,114 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PGD
2025-05-19 23:21:14,114 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:14,114 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(217), np.int64(1): np.int64(246)}
2025-05-19 23:21:14,114 - INFO - [src.data_preparation] - Generating 29 synthetic minority samples
2025-05-19 23:21:14,116 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (492, 13, 15), y shape: (492,)
2025-05-19 23:21:14,116 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(246), np.int64(1): np.int64(246)}
2025-05-19 23:21:14,119 - INFO - [src.data_preparation] - Ticker PGD - Final 3D shapes: X_train=(492, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:14,120 - INFO - [__main__] - Using best model for PGD: svm (F1: 0.6102)
2025-05-19 23:21:14,120 - INFO - [__main__] - Loading svm model for PGD...
2025-05-19 23:21:14,121 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:14,121 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:21:14,121 - INFO - [__main__] - Making predictions for PGD using svm
2025-05-19 23:21:14,121 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:14,121 - INFO - [__main__] - Successfully got last prediction for PGD
2025-05-19 23:21:14,121 - INFO - [__main__] - 
Processing ticker: PGI
2025-05-19 23:21:14,121 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:14,121 - INFO - [__main__] - Getting last prediction point for ticker: PGI
2025-05-19 23:21:14,121 - INFO - [__main__] - ==================================================
2025-05-19 23:21:14,121 - INFO - [__main__] - Preparing test data for PGI...
2025-05-19 23:21:14,156 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:14,157 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:14,157 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:14,178 - INFO - [src.data_preparation] - Ticker PGI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:14,179 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:21:14,737 - INFO - [src.data_preparation] - Ticker PGI - Selected features:
2025-05-19 23:21:14,737 - INFO - [src.data_preparation] -   vnipc_t: 0.0793
2025-05-19 23:21:14,737 - INFO - [src.data_preparation] -   Volatility: 0.0693
2025-05-19 23:21:14,737 - INFO - [src.data_preparation] -   s_d7_t: 0.0687
2025-05-19 23:21:14,737 - INFO - [src.data_preparation] -   SK: 0.0687
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   insec_t: 0.0680
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   ATR: 0.0618
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   LO: 0.0570
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   SR: 0.0565
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   ret: 0.0563
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:21:14,738 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:21:14,739 - INFO - [src.data_preparation] -   PM: 0.0519
2025-05-19 23:21:14,739 - INFO - [src.data_preparation] -   HL: 0.0518
2025-05-19 23:21:14,739 - INFO - [src.data_preparation] -   ma21_t: 0.0477
2025-05-19 23:21:14,742 - INFO - [src.data_preparation] - Ticker PGI - Using features: ['Date', 'vnipc_t', 'Volatility', 's_d7_t', 'SK', 'insec_t', 'TVV', 'ATR', 'LO', 'SR', 'ret', 'ma14_t', 'variation_t', 'PM', 'HL', 'ma21_t']
2025-05-19 23:21:14,873 - INFO - [src.data_preparation] - Ticker PGI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:14,874 - INFO - [src.data_preparation] - Ticker PGI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:14,876 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PGI
2025-05-19 23:21:14,876 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:14,876 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:21:14,876 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:21:14,880 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:21:14,880 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:21:14,884 - INFO - [src.data_preparation] - Ticker PGI - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:14,885 - INFO - [__main__] - Using best model for PGI: svm (F1: 0.6462)
2025-05-19 23:21:14,885 - INFO - [__main__] - Loading svm model for PGI...
2025-05-19 23:21:14,887 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:14,887 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:21:14,887 - INFO - [__main__] - Making predictions for PGI using svm
2025-05-19 23:21:14,888 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:14,888 - INFO - [__main__] - Successfully got last prediction for PGI
2025-05-19 23:21:14,889 - INFO - [__main__] - 
Processing ticker: PGS
2025-05-19 23:21:14,889 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:14,889 - INFO - [__main__] - Getting last prediction point for ticker: PGS
2025-05-19 23:21:14,889 - INFO - [__main__] - ==================================================
2025-05-19 23:21:14,889 - INFO - [__main__] - Preparing test data for PGS...
2025-05-19 23:21:14,929 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:14,929 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:14,929 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:14,953 - INFO - [src.data_preparation] - Ticker PGS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:14,953 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] - Ticker PGS - Selected features:
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   SK: 0.0725
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   vnipc_t: 0.0711
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   insec_t: 0.0632
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   ret: 0.0606
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   SR: 0.0599
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   HL: 0.0590
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   ATR: 0.0587
2025-05-19 23:21:15,262 - INFO - [src.data_preparation] -   LO: 0.0584
2025-05-19 23:21:15,263 - INFO - [src.data_preparation] -   ma7_t: 0.0558
2025-05-19 23:21:15,263 - INFO - [src.data_preparation] -   variation_t: 0.0555
2025-05-19 23:21:15,263 - INFO - [src.data_preparation] -   ma14_t: 0.0527
2025-05-19 23:21:15,263 - INFO - [src.data_preparation] -   ma21_t: 0.0492
2025-05-19 23:21:15,265 - INFO - [src.data_preparation] - Ticker PGS - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'TVV', 'insec_t', 's_d7_t', 'ret', 'SR', 'HL', 'ATR', 'LO', 'ma7_t', 'variation_t', 'ma14_t', 'ma21_t']
2025-05-19 23:21:15,348 - INFO - [src.data_preparation] - Ticker PGS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:15,348 - INFO - [src.data_preparation] - Ticker PGS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:15,349 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PGS
2025-05-19 23:21:15,349 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:15,350 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:21:15,350 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:21:15,352 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:21:15,352 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:21:15,355 - INFO - [src.data_preparation] - Ticker PGS - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:15,355 - INFO - [__main__] - Using best model for PGS: svm (F1: 0.6667)
2025-05-19 23:21:15,355 - INFO - [__main__] - Loading svm model for PGS...
2025-05-19 23:21:15,357 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:15,357 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:21:15,357 - INFO - [__main__] - Making predictions for PGS using svm
2025-05-19 23:21:15,359 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:15,359 - INFO - [__main__] - Successfully got last prediction for PGS
2025-05-19 23:21:15,359 - INFO - [__main__] - 
Processing ticker: PGT
2025-05-19 23:21:15,359 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:15,359 - INFO - [__main__] - Getting last prediction point for ticker: PGT
2025-05-19 23:21:15,359 - INFO - [__main__] - ==================================================
2025-05-19 23:21:15,359 - INFO - [__main__] - Preparing test data for PGT...
2025-05-19 23:21:15,393 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:15,394 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:15,394 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:15,412 - INFO - [src.data_preparation] - Ticker PGT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:15,412 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(272), np.int64(1): np.int64(367)}
2025-05-19 23:21:15,698 - INFO - [src.data_preparation] - Ticker PGT - Selected features:
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   TVV: 0.0815
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   vnipc_t: 0.0781
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   ma21_t: 0.0699
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   insec_t: 0.0691
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   SK: 0.0674
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   ma14_t: 0.0647
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   ma7_t: 0.0642
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   s_d7_t: 0.0624
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   ATR: 0.0536
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   variation_t: 0.0531
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   ret: 0.0516
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:21:15,699 - INFO - [src.data_preparation] -   PM: 0.0502
2025-05-19 23:21:15,700 - INFO - [src.data_preparation] -   HL: 0.0405
2025-05-19 23:21:15,702 - INFO - [src.data_preparation] - Ticker PGT - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'insec_t', 'SK', 'Volatility', 'ma14_t', 'ma7_t', 's_d7_t', 'ATR', 'variation_t', 'ret', 'Median_HL', 'PM', 'HL']
2025-05-19 23:21:15,798 - INFO - [src.data_preparation] - Ticker PGT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:15,798 - INFO - [src.data_preparation] - Ticker PGT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:15,800 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PGT
2025-05-19 23:21:15,800 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:15,800 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:21:15,800 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:21:15,804 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:21:15,805 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:21:15,808 - INFO - [src.data_preparation] - Ticker PGT - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:15,808 - INFO - [__main__] - Using best model for PGT: svm (F1: 0.7778)
2025-05-19 23:21:15,808 - INFO - [__main__] - Loading svm model for PGT...
2025-05-19 23:21:15,810 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:15,810 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:21:15,810 - INFO - [__main__] - Making predictions for PGT using svm
2025-05-19 23:21:15,811 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:15,811 - INFO - [__main__] - Successfully got last prediction for PGT
2025-05-19 23:21:15,812 - INFO - [__main__] - 
Processing ticker: PHC
2025-05-19 23:21:15,812 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:15,812 - INFO - [__main__] - Getting last prediction point for ticker: PHC
2025-05-19 23:21:15,812 - INFO - [__main__] - ==================================================
2025-05-19 23:21:15,812 - INFO - [__main__] - Preparing test data for PHC...
2025-05-19 23:21:15,840 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:15,841 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:15,841 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:15,861 - INFO - [src.data_preparation] - Ticker PHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:15,862 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:21:16,231 - INFO - [src.data_preparation] - Ticker PHC - Selected features:
2025-05-19 23:21:16,231 - INFO - [src.data_preparation] -   insec_t: 0.0760
2025-05-19 23:21:16,231 - INFO - [src.data_preparation] -   SK: 0.0756
2025-05-19 23:21:16,231 - INFO - [src.data_preparation] -   Volatility: 0.0735
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   vnipc_t: 0.0629
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   Median_HL: 0.0595
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   variation_t: 0.0583
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   ma21_t: 0.0554
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   ATR: 0.0550
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   LO: 0.0548
2025-05-19 23:21:16,232 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:21:16,233 - INFO - [src.data_preparation] -   SR: 0.0527
2025-05-19 23:21:16,233 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:21:16,233 - INFO - [src.data_preparation] -   ma14_t: 0.0493
2025-05-19 23:21:16,239 - INFO - [src.data_preparation] - Ticker PHC - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'vnipc_t', 's_d7_t', 'TVV', 'Median_HL', 'variation_t', 'ma21_t', 'ATR', 'LO', 'ret', 'SR', 'PM', 'ma14_t']
2025-05-19 23:21:16,352 - INFO - [src.data_preparation] - Ticker PHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:16,352 - INFO - [src.data_preparation] - Ticker PHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:16,354 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PHC
2025-05-19 23:21:16,354 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:16,354 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:21:16,354 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:21:16,357 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:21:16,357 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:21:16,361 - INFO - [src.data_preparation] - Ticker PHC - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:16,361 - INFO - [__main__] - Using best model for PHC: svm (F1: 0.6032)
2025-05-19 23:21:16,361 - INFO - [__main__] - Loading svm model for PHC...
2025-05-19 23:21:16,362 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:16,363 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:21:16,363 - INFO - [__main__] - Making predictions for PHC using svm
2025-05-19 23:21:16,364 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:16,364 - INFO - [__main__] - Successfully got last prediction for PHC
2025-05-19 23:21:16,364 - INFO - [__main__] - 
Processing ticker: PHH
2025-05-19 23:21:16,364 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:16,364 - INFO - [__main__] - Getting last prediction point for ticker: PHH
2025-05-19 23:21:16,364 - INFO - [__main__] - ==================================================
2025-05-19 23:21:16,365 - INFO - [__main__] - Preparing test data for PHH...
2025-05-19 23:21:16,395 - INFO - [src.data_preparation] - After processing - X shape: (636, 19), y shape: (636,)
2025-05-19 23:21:16,395 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:16,395 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:16,415 - INFO - [src.data_preparation] - Ticker PHH - Original shapes: X=(636, 18), y=(636,)
2025-05-19 23:21:16,416 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(197), np.int64(1): np.int64(439)}
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] - Ticker PHH - Selected features:
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   vnipc_t: 0.0851
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   TVV: 0.0779
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   ma21_t: 0.0686
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   ATR: 0.0606
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   ma14_t: 0.0605
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   Median_HL: 0.0600
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   SK: 0.0593
2025-05-19 23:21:16,704 - INFO - [src.data_preparation] -   HL: 0.0589
2025-05-19 23:21:16,706 - INFO - [src.data_preparation] -   Volatility: 0.0569
2025-05-19 23:21:16,706 - INFO - [src.data_preparation] -   PM: 0.0566
2025-05-19 23:21:16,706 - INFO - [src.data_preparation] -   ma7_t: 0.0534
2025-05-19 23:21:16,706 - INFO - [src.data_preparation] -   insec_t: 0.0517
2025-05-19 23:21:16,706 - INFO - [src.data_preparation] -   ret: 0.0491
2025-05-19 23:21:16,706 - INFO - [src.data_preparation] -   variation_t: 0.0454
2025-05-19 23:21:16,709 - INFO - [src.data_preparation] - Ticker PHH - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 's_d7_t', 'ATR', 'ma14_t', 'Median_HL', 'SK', 'HL', 'Volatility', 'PM', 'ma7_t', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:21:16,806 - INFO - [src.data_preparation] - Ticker PHH - 2D shapes: X_train=(460, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:16,806 - INFO - [src.data_preparation] - Ticker PHH - 3D shapes: X_train=(460, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:16,808 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PHH
2025-05-19 23:21:16,808 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (460, 13, 15), y shape: (460,)
2025-05-19 23:21:16,808 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(293)}
2025-05-19 23:21:16,808 - INFO - [src.data_preparation] - Generating 126 synthetic minority samples
2025-05-19 23:21:16,813 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (586, 13, 15), y shape: (586,)
2025-05-19 23:21:16,813 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(293), np.int64(1): np.int64(293)}
2025-05-19 23:21:16,817 - INFO - [src.data_preparation] - Ticker PHH - Final 3D shapes: X_train=(586, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:16,818 - INFO - [__main__] - Using best model for PHH: svm (F1: 0.9647)
2025-05-19 23:21:16,818 - INFO - [__main__] - Loading svm model for PHH...
2025-05-19 23:21:16,819 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:16,820 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:21:16,820 - INFO - [__main__] - Making predictions for PHH using svm
2025-05-19 23:21:16,820 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:16,821 - INFO - [__main__] - Successfully got last prediction for PHH
2025-05-19 23:21:16,821 - INFO - [__main__] - 
Processing ticker: PHR
2025-05-19 23:21:16,821 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:16,821 - INFO - [__main__] - Getting last prediction point for ticker: PHR
2025-05-19 23:21:16,821 - INFO - [__main__] - ==================================================
2025-05-19 23:21:16,821 - INFO - [__main__] - Preparing test data for PHR...
2025-05-19 23:21:16,851 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:16,851 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:16,851 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:16,878 - INFO - [src.data_preparation] - Ticker PHR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:16,878 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:21:17,340 - INFO - [src.data_preparation] - Ticker PHR - Selected features:
2025-05-19 23:21:17,340 - INFO - [src.data_preparation] -   SK: 0.0718
2025-05-19 23:21:17,340 - INFO - [src.data_preparation] -   vnipc_t: 0.0703
2025-05-19 23:21:17,340 - INFO - [src.data_preparation] -   Volatility: 0.0687
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   TVV: 0.0675
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   insec_t: 0.0647
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   s_d7_t: 0.0624
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   ATR: 0.0611
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   SR: 0.0605
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   ret: 0.0588
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   HL: 0.0581
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   LO: 0.0528
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   variation_t: 0.0497
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   PM: 0.0491
2025-05-19 23:21:17,341 - INFO - [src.data_preparation] -   ma21_t: 0.0488
2025-05-19 23:21:17,345 - INFO - [src.data_preparation] - Ticker PHR - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'TVV', 'insec_t', 's_d7_t', 'ATR', 'SR', 'ret', 'HL', 'Median_HL', 'LO', 'variation_t', 'PM', 'ma21_t']
2025-05-19 23:21:17,478 - INFO - [src.data_preparation] - Ticker PHR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:17,479 - INFO - [src.data_preparation] - Ticker PHR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:17,481 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PHR
2025-05-19 23:21:17,482 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:17,482 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:21:17,482 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:21:17,485 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:21:17,485 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:21:17,489 - INFO - [src.data_preparation] - Ticker PHR - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:17,490 - INFO - [__main__] - Using best model for PHR: lstm (F1: 0.6462)
2025-05-19 23:21:17,490 - INFO - [__main__] - Loading lstm model for PHR...
2025-05-19 23:21:17,499 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:17,501 - INFO - [__main__] - Model size: 0.23 MB
2025-05-19 23:21:17,502 - INFO - [__main__] - Making predictions for PHR using lstm
2025-05-19 23:21:17,505 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:17,507 - INFO - [__main__] - Successfully got last prediction for PHR
2025-05-19 23:21:17,507 - INFO - [__main__] - 
Processing ticker: PHS
2025-05-19 23:21:17,507 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:17,507 - INFO - [__main__] - Getting last prediction point for ticker: PHS
2025-05-19 23:21:17,508 - INFO - [__main__] - ==================================================
2025-05-19 23:21:17,508 - INFO - [__main__] - Preparing test data for PHS...
2025-05-19 23:21:17,565 - INFO - [src.data_preparation] - After processing - X shape: (353, 19), y shape: (353,)
2025-05-19 23:21:17,566 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:17,566 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:17,595 - INFO - [src.data_preparation] - Ticker PHS - Original shapes: X=(353, 18), y=(353,)
2025-05-19 23:21:17,595 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(110), np.int64(1): np.int64(243)}
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] - Ticker PHS - Selected features:
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   vnipc_t: 0.0885
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   TVV: 0.0723
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   ma21_t: 0.0682
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   ma14_t: 0.0658
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   SK: 0.0654
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   ATR: 0.0634
2025-05-19 23:21:17,860 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   insec_t: 0.0623
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   PM: 0.0573
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   ma7_t: 0.0524
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   variation_t: 0.0514
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   ret: 0.0501
2025-05-19 23:21:17,861 - INFO - [src.data_preparation] -   HL: 0.0449
2025-05-19 23:21:17,864 - INFO - [src.data_preparation] - Ticker PHS - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma14_t', 'SK', 'Volatility', 'ATR', 's_d7_t', 'insec_t', 'PM', 'Median_HL', 'ma7_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:21:17,920 - INFO - [src.data_preparation] - Ticker PHS - 2D shapes: X_train=(177, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:17,920 - INFO - [src.data_preparation] - Ticker PHS - 3D shapes: X_train=(177, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:17,921 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PHS
2025-05-19 23:21:17,921 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (177, 13, 15), y shape: (177,)
2025-05-19 23:21:17,921 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(56), np.int64(1): np.int64(121)}
2025-05-19 23:21:17,921 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:21:17,924 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (242, 13, 15), y shape: (242,)
2025-05-19 23:21:17,924 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(121), np.int64(1): np.int64(121)}
2025-05-19 23:21:17,927 - INFO - [src.data_preparation] - Ticker PHS - Final 3D shapes: X_train=(242, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:17,927 - INFO - [__main__] - Using best model for PHS: svm (F1: 0.8571)
2025-05-19 23:21:17,927 - INFO - [__main__] - Loading svm model for PHS...
2025-05-19 23:21:17,928 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:17,929 - INFO - [__main__] - Model size: 0.37 MB
2025-05-19 23:21:17,929 - INFO - [__main__] - Making predictions for PHS using svm
2025-05-19 23:21:17,929 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:17,930 - INFO - [__main__] - Successfully got last prediction for PHS
2025-05-19 23:21:17,930 - INFO - [__main__] - 
Processing ticker: PID
2025-05-19 23:21:17,930 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:17,930 - INFO - [__main__] - Getting last prediction point for ticker: PID
2025-05-19 23:21:17,930 - INFO - [__main__] - ==================================================
2025-05-19 23:21:17,930 - INFO - [__main__] - Preparing test data for PID...
2025-05-19 23:21:17,960 - INFO - [src.data_preparation] - After processing - X shape: (636, 19), y shape: (636,)
2025-05-19 23:21:17,960 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:17,960 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:17,981 - INFO - [src.data_preparation] - Ticker PID - Original shapes: X=(636, 18), y=(636,)
2025-05-19 23:21:17,981 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(83), np.int64(1): np.int64(553)}
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] - Ticker PID - Selected features:
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   vnipc_t: 0.1241
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   SR: 0.1171
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   ATR: 0.0892
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   LO: 0.0696
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   Volatility: 0.0628
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   ma21_t: 0.0579
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:21:18,164 - INFO - [src.data_preparation] -   ma14_t: 0.0539
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   TVV: 0.0518
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   variation_t: 0.0499
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   ret: 0.0465
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   s_d7_t: 0.0451
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   PM: 0.0395
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   Median_HL: 0.0345
2025-05-19 23:21:18,165 - INFO - [src.data_preparation] -   SK: 0.0316
2025-05-19 23:21:18,167 - INFO - [src.data_preparation] - Ticker PID - Using features: ['Date', 'vnipc_t', 'SR', 'ATR', 'LO', 'Volatility', 'ma21_t', 'ma7_t', 'ma14_t', 'TVV', 'variation_t', 'ret', 's_d7_t', 'PM', 'Median_HL', 'SK']
2025-05-19 23:21:18,251 - INFO - [src.data_preparation] - Ticker PID - 2D shapes: X_train=(460, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:18,251 - INFO - [src.data_preparation] - Ticker PID - 3D shapes: X_train=(460, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:18,253 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PID
2025-05-19 23:21:18,253 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (460, 13, 15), y shape: (460,)
2025-05-19 23:21:18,253 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(60), np.int64(1): np.int64(400)}
2025-05-19 23:21:18,253 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:21:18,257 - INFO - [src.data_preparation] - Ticker PID - Final 3D shapes: X_train=(460, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:18,258 - INFO - [__main__] - Using best model for PID: lstm (F1: 0.9885)
2025-05-19 23:21:18,258 - INFO - [__main__] - Loading lstm model for PID...
2025-05-19 23:21:18,261 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:18,262 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:21:18,262 - INFO - [__main__] - Making predictions for PID using lstm
2025-05-19 23:21:18,264 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:18,264 - INFO - [__main__] - Successfully got last prediction for PID
2025-05-19 23:21:18,264 - INFO - [__main__] - 
Processing ticker: PIT
2025-05-19 23:21:18,264 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:18,265 - INFO - [__main__] - Getting last prediction point for ticker: PIT
2025-05-19 23:21:18,265 - INFO - [__main__] - ==================================================
2025-05-19 23:21:18,265 - INFO - [__main__] - Preparing test data for PIT...
2025-05-19 23:21:18,313 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:18,313 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:18,313 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:18,345 - INFO - [src.data_preparation] - Ticker PIT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:18,345 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] - Ticker PIT - Selected features:
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   vnipc_t: 0.0741
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   SK: 0.0712
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   s_d7_t: 0.0710
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   TVV: 0.0678
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   insec_t: 0.0664
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   ATR: 0.0628
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   Volatility: 0.0606
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   ma21_t: 0.0584
2025-05-19 23:21:18,780 - INFO - [src.data_preparation] -   ma14_t: 0.0565
2025-05-19 23:21:18,781 - INFO - [src.data_preparation] -   ret: 0.0542
2025-05-19 23:21:18,781 - INFO - [src.data_preparation] -   SR: 0.0538
2025-05-19 23:21:18,781 - INFO - [src.data_preparation] -   variation_t: 0.0524
2025-05-19 23:21:18,781 - INFO - [src.data_preparation] -   ma7_t: 0.0495
2025-05-19 23:21:18,781 - INFO - [src.data_preparation] -   HL: 0.0491
2025-05-19 23:21:18,781 - INFO - [src.data_preparation] -   PM: 0.0476
2025-05-19 23:21:18,784 - INFO - [src.data_preparation] - Ticker PIT - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'TVV', 'insec_t', 'ATR', 'Volatility', 'ma21_t', 'ma14_t', 'ret', 'SR', 'variation_t', 'ma7_t', 'HL', 'PM']
2025-05-19 23:21:18,874 - INFO - [src.data_preparation] - Ticker PIT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:18,874 - INFO - [src.data_preparation] - Ticker PIT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:18,876 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PIT
2025-05-19 23:21:18,876 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:18,876 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:21:18,876 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:21:18,879 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:21:18,879 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:21:18,882 - INFO - [src.data_preparation] - Ticker PIT - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:18,882 - INFO - [__main__] - Using best model for PIT: svm (F1: 0.6250)
2025-05-19 23:21:18,883 - INFO - [__main__] - Loading svm model for PIT...
2025-05-19 23:21:18,884 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:18,885 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:21:18,885 - INFO - [__main__] - Making predictions for PIT using svm
2025-05-19 23:21:18,885 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:18,887 - INFO - [__main__] - Successfully got last prediction for PIT
2025-05-19 23:21:18,887 - INFO - [__main__] - 
Processing ticker: PIV
2025-05-19 23:21:18,887 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:18,887 - INFO - [__main__] - Getting last prediction point for ticker: PIV
2025-05-19 23:21:18,887 - INFO - [__main__] - ==================================================
2025-05-19 23:21:18,887 - INFO - [__main__] - Preparing test data for PIV...
2025-05-19 23:21:18,916 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:18,916 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:18,916 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:18,941 - INFO - [src.data_preparation] - Ticker PIV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:18,942 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(385)}
2025-05-19 23:21:19,273 - INFO - [src.data_preparation] - Ticker PIV - Selected features:
2025-05-19 23:21:19,273 - INFO - [src.data_preparation] -   insec_t: 0.0777
2025-05-19 23:21:19,273 - INFO - [src.data_preparation] -   vnipc_t: 0.0738
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   ma14_t: 0.0715
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   s_d7_t: 0.0703
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   ma21_t: 0.0698
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   TVV: 0.0681
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   SK: 0.0622
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   ATR: 0.0606
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   ma7_t: 0.0579
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   Volatility: 0.0557
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   Median_HL: 0.0537
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   HL: 0.0445
2025-05-19 23:21:19,274 - INFO - [src.data_preparation] -   LO: 0.0426
2025-05-19 23:21:19,275 - INFO - [src.data_preparation] -   ret: 0.0421
2025-05-19 23:21:19,278 - INFO - [src.data_preparation] - Ticker PIV - Using features: ['Date', 'insec_t', 'vnipc_t', 'ma14_t', 's_d7_t', 'ma21_t', 'TVV', 'SK', 'ATR', 'ma7_t', 'Volatility', 'Median_HL', 'PM', 'HL', 'LO', 'ret']
2025-05-19 23:21:19,381 - INFO - [src.data_preparation] - Ticker PIV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:19,382 - INFO - [src.data_preparation] - Ticker PIV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:19,383 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PIV
2025-05-19 23:21:19,384 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:19,384 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(185), np.int64(1): np.int64(278)}
2025-05-19 23:21:19,384 - INFO - [src.data_preparation] - Generating 93 synthetic minority samples
2025-05-19 23:21:19,390 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (556, 13, 15), y shape: (556,)
2025-05-19 23:21:19,390 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(278), np.int64(1): np.int64(278)}
2025-05-19 23:21:19,396 - INFO - [src.data_preparation] - Ticker PIV - Final 3D shapes: X_train=(556, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:19,396 - INFO - [__main__] - Using best model for PIV: svm (F1: 0.6250)
2025-05-19 23:21:19,396 - INFO - [__main__] - Loading svm model for PIV...
2025-05-19 23:21:19,398 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:19,399 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:21:19,399 - INFO - [__main__] - Making predictions for PIV using svm
2025-05-19 23:21:19,399 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:19,400 - INFO - [__main__] - Successfully got last prediction for PIV
2025-05-19 23:21:19,400 - INFO - [__main__] - 
Processing ticker: PJC
2025-05-19 23:21:19,400 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:19,400 - INFO - [__main__] - Getting last prediction point for ticker: PJC
2025-05-19 23:21:19,400 - INFO - [__main__] - ==================================================
2025-05-19 23:21:19,400 - INFO - [__main__] - Preparing test data for PJC...
2025-05-19 23:21:19,446 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:19,446 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:19,446 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:19,468 - INFO - [src.data_preparation] - Ticker PJC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:19,468 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(170), np.int64(1): np.int64(469)}
2025-05-19 23:21:19,792 - INFO - [src.data_preparation] - Ticker PJC - Selected features:
2025-05-19 23:21:19,792 - INFO - [src.data_preparation] -   vnipc_t: 0.0992
2025-05-19 23:21:19,792 - INFO - [src.data_preparation] -   ma21_t: 0.0768
2025-05-19 23:21:19,792 - INFO - [src.data_preparation] -   s_d7_t: 0.0751
2025-05-19 23:21:19,792 - INFO - [src.data_preparation] -   ma14_t: 0.0745
2025-05-19 23:21:19,792 - INFO - [src.data_preparation] -   SK: 0.0737
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   TVV: 0.0691
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   ma7_t: 0.0650
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   ATR: 0.0647
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   Median_HL: 0.0514
2025-05-19 23:21:19,793 - INFO - [src.data_preparation] -   insec_t: 0.0414
2025-05-19 23:21:19,794 - INFO - [src.data_preparation] -   SR: 0.0404
2025-05-19 23:21:19,794 - INFO - [src.data_preparation] -   variation_t: 0.0391
2025-05-19 23:21:19,794 - INFO - [src.data_preparation] -   HL: 0.0384
2025-05-19 23:21:19,799 - INFO - [src.data_preparation] - Ticker PJC - Using features: ['Date', 'vnipc_t', 'ma21_t', 's_d7_t', 'ma14_t', 'SK', 'TVV', 'ma7_t', 'ATR', 'Volatility', 'PM', 'Median_HL', 'insec_t', 'SR', 'variation_t', 'HL']
2025-05-19 23:21:19,943 - INFO - [src.data_preparation] - Ticker PJC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:19,943 - INFO - [src.data_preparation] - Ticker PJC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:19,947 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PJC
2025-05-19 23:21:19,947 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:19,947 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(115), np.int64(1): np.int64(348)}
2025-05-19 23:21:19,947 - INFO - [src.data_preparation] - Generating 233 synthetic minority samples
2025-05-19 23:21:19,958 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (696, 13, 15), y shape: (696,)
2025-05-19 23:21:19,958 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(348), np.int64(1): np.int64(348)}
2025-05-19 23:21:19,965 - INFO - [src.data_preparation] - Ticker PJC - Final 3D shapes: X_train=(696, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:19,965 - INFO - [__main__] - Using best model for PJC: svm (F1: 0.7429)
2025-05-19 23:21:19,965 - INFO - [__main__] - Loading svm model for PJC...
2025-05-19 23:21:19,968 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:19,969 - INFO - [__main__] - Model size: 1.05 MB
2025-05-19 23:21:19,970 - INFO - [__main__] - Making predictions for PJC using svm
2025-05-19 23:21:19,971 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:19,971 - INFO - [__main__] - Successfully got last prediction for PJC
2025-05-19 23:21:19,971 - INFO - [__main__] - 
Processing ticker: PJS
2025-05-19 23:21:19,972 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:19,973 - INFO - [__main__] - Getting last prediction point for ticker: PJS
2025-05-19 23:21:19,974 - INFO - [__main__] - ==================================================
2025-05-19 23:21:19,974 - INFO - [__main__] - Preparing test data for PJS...
2025-05-19 23:21:20,017 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:20,017 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:20,017 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:20,051 - INFO - [src.data_preparation] - Ticker PJS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:20,052 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(191), np.int64(1): np.int64(448)}
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] - Ticker PJS - Selected features:
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   vnipc_t: 0.0738
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   ma14_t: 0.0705
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   ma7_t: 0.0697
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   PM: 0.0681
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   Volatility: 0.0668
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   Median_HL: 0.0666
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   TVV: 0.0648
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   ma21_t: 0.0622
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   ATR: 0.0588
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   s_d7_t: 0.0578
2025-05-19 23:21:20,365 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:21:20,366 - INFO - [src.data_preparation] -   variation_t: 0.0487
2025-05-19 23:21:20,366 - INFO - [src.data_preparation] -   HL: 0.0480
2025-05-19 23:21:20,366 - INFO - [src.data_preparation] -   insec_t: 0.0424
2025-05-19 23:21:20,368 - INFO - [src.data_preparation] - Ticker PJS - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma7_t', 'PM', 'Volatility', 'Median_HL', 'TVV', 'SK', 'ma21_t', 'ATR', 's_d7_t', 'ret', 'variation_t', 'HL', 'insec_t']
2025-05-19 23:21:20,451 - INFO - [src.data_preparation] - Ticker PJS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:20,451 - INFO - [src.data_preparation] - Ticker PJS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:20,453 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PJS
2025-05-19 23:21:20,453 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:20,453 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(146), np.int64(1): np.int64(317)}
2025-05-19 23:21:20,453 - INFO - [src.data_preparation] - Generating 171 synthetic minority samples
2025-05-19 23:21:20,460 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (634, 13, 15), y shape: (634,)
2025-05-19 23:21:20,460 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(317), np.int64(1): np.int64(317)}
2025-05-19 23:21:20,464 - INFO - [src.data_preparation] - Ticker PJS - Final 3D shapes: X_train=(634, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:20,465 - INFO - [__main__] - Using best model for PJS: svm (F1: 0.9000)
2025-05-19 23:21:20,465 - INFO - [__main__] - Loading svm model for PJS...
2025-05-19 23:21:20,465 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:20,467 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:21:20,467 - INFO - [__main__] - Making predictions for PJS using svm
2025-05-19 23:21:20,468 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:20,468 - INFO - [__main__] - Successfully got last prediction for PJS
2025-05-19 23:21:20,468 - INFO - [__main__] - 
Processing ticker: PJT
2025-05-19 23:21:20,468 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:20,468 - INFO - [__main__] - Getting last prediction point for ticker: PJT
2025-05-19 23:21:20,468 - INFO - [__main__] - ==================================================
2025-05-19 23:21:20,468 - INFO - [__main__] - Preparing test data for PJT...
2025-05-19 23:21:20,498 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:20,498 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:20,498 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:20,518 - INFO - [src.data_preparation] - Ticker PJT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:20,519 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(259), np.int64(1): np.int64(380)}
2025-05-19 23:21:20,881 - INFO - [src.data_preparation] - Ticker PJT - Selected features:
2025-05-19 23:21:20,881 - INFO - [src.data_preparation] -   SK: 0.0740
2025-05-19 23:21:20,881 - INFO - [src.data_preparation] -   vnipc_t: 0.0732
2025-05-19 23:21:20,881 - INFO - [src.data_preparation] -   Volatility: 0.0677
2025-05-19 23:21:20,881 - INFO - [src.data_preparation] -   insec_t: 0.0673
2025-05-19 23:21:20,881 - INFO - [src.data_preparation] -   HL: 0.0667
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   ATR: 0.0628
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   ret: 0.0621
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   SR: 0.0619
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   LO: 0.0598
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   TVV: 0.0583
2025-05-19 23:21:20,882 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:21:20,883 - INFO - [src.data_preparation] -   ma21_t: 0.0483
2025-05-19 23:21:20,883 - INFO - [src.data_preparation] -   ma14_t: 0.0477
2025-05-19 23:21:20,883 - INFO - [src.data_preparation] -   Median_HL: 0.0461
2025-05-19 23:21:20,887 - INFO - [src.data_preparation] - Ticker PJT - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'insec_t', 'HL', 'ATR', 's_d7_t', 'ret', 'SR', 'LO', 'TVV', 'variation_t', 'ma21_t', 'ma14_t', 'Median_HL']
2025-05-19 23:21:21,002 - INFO - [src.data_preparation] - Ticker PJT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:21,003 - INFO - [src.data_preparation] - Ticker PJT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:21,005 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PJT
2025-05-19 23:21:21,006 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:21,006 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(187), np.int64(1): np.int64(276)}
2025-05-19 23:21:21,006 - INFO - [src.data_preparation] - Generating 89 synthetic minority samples
2025-05-19 23:21:21,015 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (552, 13, 15), y shape: (552,)
2025-05-19 23:21:21,016 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(276), np.int64(1): np.int64(276)}
2025-05-19 23:21:21,021 - INFO - [src.data_preparation] - Ticker PJT - Final 3D shapes: X_train=(552, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:21,022 - INFO - [__main__] - Using best model for PJT: svm (F1: 0.7246)
2025-05-19 23:21:21,022 - INFO - [__main__] - Loading svm model for PJT...
2025-05-19 23:21:21,024 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:21,026 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:21:21,026 - INFO - [__main__] - Making predictions for PJT using svm
2025-05-19 23:21:21,027 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:21,027 - INFO - [__main__] - Successfully got last prediction for PJT
2025-05-19 23:21:21,027 - INFO - [__main__] - 
Processing ticker: PLC
2025-05-19 23:21:21,027 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:21,027 - INFO - [__main__] - Getting last prediction point for ticker: PLC
2025-05-19 23:21:21,027 - INFO - [__main__] - ==================================================
2025-05-19 23:21:21,028 - INFO - [__main__] - Preparing test data for PLC...
2025-05-19 23:21:21,078 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:21,078 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:21,078 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:21,099 - INFO - [src.data_preparation] - Ticker PLC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:21,099 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] - Ticker PLC - Selected features:
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   vnipc_t: 0.0734
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   insec_t: 0.0698
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   SR: 0.0682
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   TVV: 0.0637
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:21:21,503 - INFO - [src.data_preparation] -   Volatility: 0.0623
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   HL: 0.0581
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   ret: 0.0573
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   ATR: 0.0559
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   LO: 0.0552
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   ma21_t: 0.0542
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   variation_t: 0.0540
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:21:21,504 - INFO - [src.data_preparation] -   ma7_t: 0.0517
2025-05-19 23:21:21,507 - INFO - [src.data_preparation] - Ticker PLC - Using features: ['Date', 'vnipc_t', 'insec_t', 'SR', 'SK', 'TVV', 's_d7_t', 'Volatility', 'HL', 'ret', 'ATR', 'LO', 'ma21_t', 'variation_t', 'PM', 'ma7_t']
2025-05-19 23:21:21,609 - INFO - [src.data_preparation] - Ticker PLC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:21,609 - INFO - [src.data_preparation] - Ticker PLC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:21,613 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PLC
2025-05-19 23:21:21,613 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:21,613 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:21:21,614 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:21:21,618 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:21:21,618 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:21:21,622 - INFO - [src.data_preparation] - Ticker PLC - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:21,622 - INFO - [__main__] - Using best model for PLC: svm (F1: 0.6250)
2025-05-19 23:21:21,622 - INFO - [__main__] - Loading svm model for PLC...
2025-05-19 23:21:21,624 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:21,625 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:21:21,625 - INFO - [__main__] - Making predictions for PLC using svm
2025-05-19 23:21:21,626 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:21,626 - INFO - [__main__] - Successfully got last prediction for PLC
2025-05-19 23:21:21,626 - INFO - [__main__] - 
Processing ticker: PMC
2025-05-19 23:21:21,626 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:21,626 - INFO - [__main__] - Getting last prediction point for ticker: PMC
2025-05-19 23:21:21,626 - INFO - [__main__] - ==================================================
2025-05-19 23:21:21,626 - INFO - [__main__] - Preparing test data for PMC...
2025-05-19 23:21:21,665 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:21,665 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:21,665 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:21,685 - INFO - [src.data_preparation] - Ticker PMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:21,685 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(283), np.int64(1): np.int64(356)}
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] - Ticker PMC - Selected features:
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] -   vnipc_t: 0.0714
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] -   insec_t: 0.0704
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] -   LO: 0.0700
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] -   HL: 0.0656
2025-05-19 23:21:22,100 - INFO - [src.data_preparation] -   SR: 0.0646
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   Volatility: 0.0606
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   ret: 0.0595
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   ATR: 0.0593
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   s_d7_t: 0.0582
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   SK: 0.0571
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   Median_HL: 0.0485
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   ma14_t: 0.0482
2025-05-19 23:21:22,101 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:21:22,104 - INFO - [src.data_preparation] - Ticker PMC - Using features: ['Date', 'vnipc_t', 'insec_t', 'LO', 'TVV', 'HL', 'SR', 'Volatility', 'ret', 'ATR', 's_d7_t', 'SK', 'variation_t', 'Median_HL', 'ma14_t', 'PM']
2025-05-19 23:21:22,209 - INFO - [src.data_preparation] - Ticker PMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:22,210 - INFO - [src.data_preparation] - Ticker PMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:22,212 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PMC
2025-05-19 23:21:22,212 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:22,212 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:21:22,212 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:21:22,215 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:21:22,215 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:21:22,220 - INFO - [src.data_preparation] - Ticker PMC - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:22,220 - INFO - [__main__] - Using best model for PMC: lstm (F1: 0.4348)
2025-05-19 23:21:22,220 - INFO - [__main__] - Loading lstm model for PMC...
2025-05-19 23:21:22,224 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:22,225 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:21:22,225 - INFO - [__main__] - Making predictions for PMC using lstm
2025-05-19 23:21:22,228 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:22,228 - INFO - [__main__] - Successfully got last prediction for PMC
2025-05-19 23:21:22,228 - INFO - [__main__] - 
Processing ticker: PMS
2025-05-19 23:21:22,228 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:22,228 - INFO - [__main__] - Getting last prediction point for ticker: PMS
2025-05-19 23:21:22,228 - INFO - [__main__] - ==================================================
2025-05-19 23:21:22,228 - INFO - [__main__] - Preparing test data for PMS...
2025-05-19 23:21:22,266 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:22,266 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:22,266 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:22,300 - INFO - [src.data_preparation] - Ticker PMS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:22,300 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(247), np.int64(1): np.int64(392)}
2025-05-19 23:21:22,743 - INFO - [src.data_preparation] - Ticker PMS - Selected features:
2025-05-19 23:21:22,743 - INFO - [src.data_preparation] -   insec_t: 0.0788
2025-05-19 23:21:22,743 - INFO - [src.data_preparation] -   TVV: 0.0785
2025-05-19 23:21:22,743 - INFO - [src.data_preparation] -   Volatility: 0.0659
2025-05-19 23:21:22,743 - INFO - [src.data_preparation] -   vnipc_t: 0.0657
2025-05-19 23:21:22,743 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   HL: 0.0634
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   ATR: 0.0617
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   ma21_t: 0.0559
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   LO: 0.0541
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   s_d7_t: 0.0540
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   variation_t: 0.0530
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   SR: 0.0530
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:21:22,744 - INFO - [src.data_preparation] -   ma14_t: 0.0505
2025-05-19 23:21:22,748 - INFO - [src.data_preparation] - Ticker PMS - Using features: ['Date', 'insec_t', 'TVV', 'Volatility', 'vnipc_t', 'SK', 'HL', 'ATR', 'ma21_t', 'LO', 's_d7_t', 'variation_t', 'SR', 'ret', 'PM', 'ma14_t']
2025-05-19 23:21:22,861 - INFO - [src.data_preparation] - Ticker PMS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:22,861 - INFO - [src.data_preparation] - Ticker PMS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:22,863 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PMS
2025-05-19 23:21:22,863 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:22,863 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(177), np.int64(1): np.int64(286)}
2025-05-19 23:21:22,863 - INFO - [src.data_preparation] - Generating 109 synthetic minority samples
2025-05-19 23:21:22,870 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (572, 13, 15), y shape: (572,)
2025-05-19 23:21:22,870 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(286), np.int64(1): np.int64(286)}
2025-05-19 23:21:22,874 - INFO - [src.data_preparation] - Ticker PMS - Final 3D shapes: X_train=(572, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:22,875 - INFO - [__main__] - Using best model for PMS: lstm (F1: 0.7429)
2025-05-19 23:21:22,875 - INFO - [__main__] - Loading lstm model for PMS...
2025-05-19 23:21:22,880 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:22,882 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:21:22,882 - INFO - [__main__] - Making predictions for PMS using lstm
2025-05-19 23:21:22,884 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:22,885 - INFO - [__main__] - Successfully got last prediction for PMS
2025-05-19 23:21:22,885 - INFO - [__main__] - 
Processing ticker: PMT
2025-05-19 23:21:22,885 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:22,885 - INFO - [__main__] - Getting last prediction point for ticker: PMT
2025-05-19 23:21:22,885 - INFO - [__main__] - ==================================================
2025-05-19 23:21:22,885 - INFO - [__main__] - Preparing test data for PMT...
2025-05-19 23:21:22,933 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:22,934 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:22,934 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:22,973 - INFO - [src.data_preparation] - Ticker PMT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:22,973 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(185), np.int64(1): np.int64(454)}
2025-05-19 23:21:23,437 - INFO - [src.data_preparation] - Ticker PMT - Selected features:
2025-05-19 23:21:23,437 - INFO - [src.data_preparation] -   vnipc_t: 0.0902
2025-05-19 23:21:23,437 - INFO - [src.data_preparation] -   TVV: 0.0729
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   ma14_t: 0.0710
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   s_d7_t: 0.0709
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   ma21_t: 0.0699
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   ATR: 0.0675
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   Volatility: 0.0654
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   ma7_t: 0.0610
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   SK: 0.0565
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   Median_HL: 0.0556
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   HL: 0.0525
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   insec_t: 0.0492
2025-05-19 23:21:23,438 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:21:23,439 - INFO - [src.data_preparation] -   SR: 0.0472
2025-05-19 23:21:23,444 - INFO - [src.data_preparation] - Ticker PMT - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 's_d7_t', 'ma21_t', 'ATR', 'Volatility', 'ma7_t', 'SK', 'Median_HL', 'PM', 'HL', 'insec_t', 'ret', 'SR']
2025-05-19 23:21:23,573 - INFO - [src.data_preparation] - Ticker PMT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:23,573 - INFO - [src.data_preparation] - Ticker PMT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:23,575 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PMT
2025-05-19 23:21:23,575 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:23,575 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(133), np.int64(1): np.int64(330)}
2025-05-19 23:21:23,577 - INFO - [src.data_preparation] - Generating 197 synthetic minority samples
2025-05-19 23:21:23,585 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (660, 13, 15), y shape: (660,)
2025-05-19 23:21:23,586 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(330), np.int64(1): np.int64(330)}
2025-05-19 23:21:23,590 - INFO - [src.data_preparation] - Ticker PMT - Final 3D shapes: X_train=(660, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:23,591 - INFO - [__main__] - Using best model for PMT: svm (F1: 0.9000)
2025-05-19 23:21:23,591 - INFO - [__main__] - Loading svm model for PMT...
2025-05-19 23:21:23,593 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:23,594 - INFO - [__main__] - Model size: 1.00 MB
2025-05-19 23:21:23,594 - INFO - [__main__] - Making predictions for PMT using svm
2025-05-19 23:21:23,595 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:23,595 - INFO - [__main__] - Successfully got last prediction for PMT
2025-05-19 23:21:23,595 - INFO - [__main__] - 
Processing ticker: PNC
2025-05-19 23:21:23,595 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:23,595 - INFO - [__main__] - Getting last prediction point for ticker: PNC
2025-05-19 23:21:23,595 - INFO - [__main__] - ==================================================
2025-05-19 23:21:23,595 - INFO - [__main__] - Preparing test data for PNC...
2025-05-19 23:21:23,629 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:23,629 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:23,629 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:23,656 - INFO - [src.data_preparation] - Ticker PNC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:23,656 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(269), np.int64(1): np.int64(370)}
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] - Ticker PNC - Selected features:
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] -   ATR: 0.0795
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] -   SK: 0.0754
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] -   vnipc_t: 0.0683
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] -   Volatility: 0.0641
2025-05-19 23:21:23,989 - INFO - [src.data_preparation] -   s_d7_t: 0.0622
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   HL: 0.0588
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   ret: 0.0569
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   ma14_t: 0.0567
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   insec_t: 0.0549
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:21:23,990 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:21:23,992 - INFO - [src.data_preparation] - Ticker PNC - Using features: ['Date', 'ATR', 'SK', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'HL', 'ret', 'ma14_t', 'ma7_t', 'insec_t', 'ma21_t', 'PM', 'Median_HL', 'variation_t']
2025-05-19 23:21:24,078 - INFO - [src.data_preparation] - Ticker PNC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:24,078 - INFO - [src.data_preparation] - Ticker PNC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:24,079 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PNC
2025-05-19 23:21:24,079 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:24,079 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:21:24,079 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:21:24,082 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:21:24,082 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:21:24,085 - INFO - [src.data_preparation] - Ticker PNC - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:24,085 - INFO - [__main__] - Using best model for PNC: svm (F1: 0.6122)
2025-05-19 23:21:24,085 - INFO - [__main__] - Loading svm model for PNC...
2025-05-19 23:21:24,087 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:24,088 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:21:24,088 - INFO - [__main__] - Making predictions for PNC using svm
2025-05-19 23:21:24,089 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:24,089 - INFO - [__main__] - Successfully got last prediction for PNC
2025-05-19 23:21:24,089 - INFO - [__main__] - 
Processing ticker: PNJ
2025-05-19 23:21:24,089 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:24,090 - INFO - [__main__] - Getting last prediction point for ticker: PNJ
2025-05-19 23:21:24,090 - INFO - [__main__] - ==================================================
2025-05-19 23:21:24,090 - INFO - [__main__] - Preparing test data for PNJ...
2025-05-19 23:21:24,118 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:24,119 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:24,119 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:24,140 - INFO - [src.data_preparation] - Ticker PNJ - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:24,140 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(294), np.int64(1): np.int64(345)}
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] - Ticker PNJ - Selected features:
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   insec_t: 0.0732
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   s_d7_t: 0.0712
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   vnipc_t: 0.0708
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   Volatility: 0.0684
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   SK: 0.0681
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   TVV: 0.0643
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   SR: 0.0616
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   HL: 0.0594
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   LO: 0.0553
2025-05-19 23:21:24,453 - INFO - [src.data_preparation] -   ret: 0.0543
2025-05-19 23:21:24,454 - INFO - [src.data_preparation] -   ma14_t: 0.0483
2025-05-19 23:21:24,454 - INFO - [src.data_preparation] -   ma21_t: 0.0468
2025-05-19 23:21:24,454 - INFO - [src.data_preparation] -   Median_HL: 0.0464
2025-05-19 23:21:24,457 - INFO - [src.data_preparation] - Ticker PNJ - Using features: ['Date', 'insec_t', 's_d7_t', 'vnipc_t', 'Volatility', 'SK', 'ATR', 'TVV', 'SR', 'HL', 'variation_t', 'LO', 'ret', 'ma14_t', 'ma21_t', 'Median_HL']
2025-05-19 23:21:24,538 - INFO - [src.data_preparation] - Ticker PNJ - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:24,538 - INFO - [src.data_preparation] - Ticker PNJ - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:24,539 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PNJ
2025-05-19 23:21:24,539 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:24,539 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:21:24,539 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:21:24,542 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:21:24,542 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:21:24,545 - INFO - [src.data_preparation] - Ticker PNJ - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:24,545 - INFO - [__main__] - Using best model for PNJ: svm (F1: 0.4286)
2025-05-19 23:21:24,545 - INFO - [__main__] - Loading svm model for PNJ...
2025-05-19 23:21:24,547 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:24,547 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:21:24,548 - INFO - [__main__] - Making predictions for PNJ using svm
2025-05-19 23:21:24,548 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:24,548 - INFO - [__main__] - Successfully got last prediction for PNJ
2025-05-19 23:21:24,548 - INFO - [__main__] - 
Processing ticker: POM
2025-05-19 23:21:24,548 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:24,548 - INFO - [__main__] - Getting last prediction point for ticker: POM
2025-05-19 23:21:24,548 - INFO - [__main__] - ==================================================
2025-05-19 23:21:24,548 - INFO - [__main__] - Preparing test data for POM...
2025-05-19 23:21:24,579 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:24,579 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:24,579 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:24,598 - INFO - [src.data_preparation] - Ticker POM - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:24,598 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(331), np.int64(1): np.int64(307)}
2025-05-19 23:21:24,897 - INFO - [src.data_preparation] - Ticker POM - Selected features:
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   SK: 0.0779
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   insec_t: 0.0703
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   s_d7_t: 0.0623
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   ATR: 0.0622
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   vnipc_t: 0.0598
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   ma21_t: 0.0593
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   Volatility: 0.0578
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   SR: 0.0569
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   variation_t: 0.0566
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   ma14_t: 0.0562
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:21:24,898 - INFO - [src.data_preparation] -   ma7_t: 0.0513
2025-05-19 23:21:24,899 - INFO - [src.data_preparation] -   HL: 0.0475
2025-05-19 23:21:24,901 - INFO - [src.data_preparation] - Ticker POM - Using features: ['Date', 'SK', 'insec_t', 'TVV', 's_d7_t', 'ATR', 'vnipc_t', 'ma21_t', 'Volatility', 'SR', 'variation_t', 'ma14_t', 'ret', 'PM', 'ma7_t', 'HL']
2025-05-19 23:21:25,074 - INFO - [src.data_preparation] - Ticker POM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:21:25,074 - INFO - [src.data_preparation] - Ticker POM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:21:25,075 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker POM
2025-05-19 23:21:25,075 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:25,076 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(229), np.int64(1): np.int64(234)}
2025-05-19 23:21:25,076 - INFO - [src.data_preparation] - Generating 5 synthetic minority samples
2025-05-19 23:21:25,076 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (468, 13, 15), y shape: (468,)
2025-05-19 23:21:25,077 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(234), np.int64(1): np.int64(234)}
2025-05-19 23:21:25,080 - INFO - [src.data_preparation] - Ticker POM - Final 3D shapes: X_train=(468, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:21:25,080 - INFO - [__main__] - Using best model for POM: logistic_regression (F1: 0.5385)
2025-05-19 23:21:25,080 - INFO - [__main__] - Loading logistic_regression model for POM...
2025-05-19 23:21:25,081 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:25,081 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:25,081 - INFO - [__main__] - Making predictions for POM using logistic_regression
2025-05-19 23:21:25,081 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:25,082 - INFO - [__main__] - Successfully got last prediction for POM
2025-05-19 23:21:25,082 - INFO - [__main__] - 
Processing ticker: POT
2025-05-19 23:21:25,082 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:25,082 - INFO - [__main__] - Getting last prediction point for ticker: POT
2025-05-19 23:21:25,082 - INFO - [__main__] - ==================================================
2025-05-19 23:21:25,082 - INFO - [__main__] - Preparing test data for POT...
2025-05-19 23:21:25,107 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:25,107 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:25,107 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:25,125 - INFO - [src.data_preparation] - Ticker POT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:25,125 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] - Ticker POT - Selected features:
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] -   vnipc_t: 0.0760
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] -   SK: 0.0746
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] -   insec_t: 0.0626
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] -   Volatility: 0.0621
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:21:25,446 - INFO - [src.data_preparation] -   Median_HL: 0.0591
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   SR: 0.0581
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   ma14_t: 0.0579
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   ma21_t: 0.0575
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   ATR: 0.0566
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   TVV: 0.0561
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   variation_t: 0.0557
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:21:25,447 - INFO - [src.data_preparation] -   HL: 0.0521
2025-05-19 23:21:25,450 - INFO - [src.data_preparation] - Ticker POT - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'Volatility', 's_d7_t', 'Median_HL', 'SR', 'ma14_t', 'ma21_t', 'ATR', 'TVV', 'variation_t', 'ret', 'PM', 'HL']
2025-05-19 23:21:25,567 - INFO - [src.data_preparation] - Ticker POT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:25,567 - INFO - [src.data_preparation] - Ticker POT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:25,570 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker POT
2025-05-19 23:21:25,570 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:25,570 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:21:25,571 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:21:25,575 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:21:25,575 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:21:25,578 - INFO - [src.data_preparation] - Ticker POT - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:25,579 - INFO - [__main__] - Using best model for POT: svm (F1: 0.7059)
2025-05-19 23:21:25,579 - INFO - [__main__] - Loading svm model for POT...
2025-05-19 23:21:25,581 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:25,582 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:21:25,583 - INFO - [__main__] - Making predictions for POT using svm
2025-05-19 23:21:25,584 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:25,584 - INFO - [__main__] - Successfully got last prediction for POT
2025-05-19 23:21:25,584 - INFO - [__main__] - 
Processing ticker: POV
2025-05-19 23:21:25,585 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:25,585 - INFO - [__main__] - Getting last prediction point for ticker: POV
2025-05-19 23:21:25,585 - INFO - [__main__] - ==================================================
2025-05-19 23:21:25,585 - INFO - [__main__] - Preparing test data for POV...
2025-05-19 23:21:25,639 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:25,639 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:25,639 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:25,664 - INFO - [src.data_preparation] - Ticker POV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:25,664 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(212), np.int64(1): np.int64(427)}
2025-05-19 23:21:26,015 - INFO - [src.data_preparation] - Ticker POV - Selected features:
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   TVV: 0.0782
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   vnipc_t: 0.0751
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   ma14_t: 0.0723
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   ma21_t: 0.0705
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   ma7_t: 0.0665
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   s_d7_t: 0.0647
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   SK: 0.0639
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   PM: 0.0608
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   ATR: 0.0601
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   Median_HL: 0.0592
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   insec_t: 0.0554
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   Volatility: 0.0547
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   variation_t: 0.0481
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   SR: 0.0469
2025-05-19 23:21:26,016 - INFO - [src.data_preparation] -   ret: 0.0439
2025-05-19 23:21:26,019 - INFO - [src.data_preparation] - Ticker POV - Using features: ['Date', 'TVV', 'vnipc_t', 'ma14_t', 'ma21_t', 'ma7_t', 's_d7_t', 'SK', 'PM', 'ATR', 'Median_HL', 'insec_t', 'Volatility', 'variation_t', 'SR', 'ret']
2025-05-19 23:21:26,121 - INFO - [src.data_preparation] - Ticker POV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:26,121 - INFO - [src.data_preparation] - Ticker POV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:26,123 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker POV
2025-05-19 23:21:26,123 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:26,123 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(136), np.int64(1): np.int64(327)}
2025-05-19 23:21:26,123 - INFO - [src.data_preparation] - Generating 191 synthetic minority samples
2025-05-19 23:21:26,132 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (654, 13, 15), y shape: (654,)
2025-05-19 23:21:26,133 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(327), np.int64(1): np.int64(327)}
2025-05-19 23:21:26,136 - INFO - [src.data_preparation] - Ticker POV - Final 3D shapes: X_train=(654, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:26,137 - INFO - [__main__] - Using best model for POV: svm (F1: 0.7246)
2025-05-19 23:21:26,137 - INFO - [__main__] - Loading svm model for POV...
2025-05-19 23:21:26,139 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:26,140 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:21:26,140 - INFO - [__main__] - Making predictions for POV using svm
2025-05-19 23:21:26,140 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:26,141 - INFO - [__main__] - Successfully got last prediction for POV
2025-05-19 23:21:26,141 - INFO - [__main__] - 
Processing ticker: PPC
2025-05-19 23:21:26,141 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:26,141 - INFO - [__main__] - Getting last prediction point for ticker: PPC
2025-05-19 23:21:26,141 - INFO - [__main__] - ==================================================
2025-05-19 23:21:26,141 - INFO - [__main__] - Preparing test data for PPC...
2025-05-19 23:21:26,178 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:26,178 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:26,178 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:26,198 - INFO - [src.data_preparation] - Ticker PPC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:26,198 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(301), np.int64(1): np.int64(338)}
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] - Ticker PPC - Selected features:
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   vnipc_t: 0.0756
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   SK: 0.0721
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   insec_t: 0.0714
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   s_d7_t: 0.0705
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   TVV: 0.0669
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   Volatility: 0.0632
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   HL: 0.0599
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   ATR: 0.0578
2025-05-19 23:21:26,534 - INFO - [src.data_preparation] -   ret: 0.0577
2025-05-19 23:21:26,535 - INFO - [src.data_preparation] -   variation_t: 0.0551
2025-05-19 23:21:26,535 - INFO - [src.data_preparation] -   LO: 0.0546
2025-05-19 23:21:26,535 - INFO - [src.data_preparation] -   SR: 0.0539
2025-05-19 23:21:26,535 - INFO - [src.data_preparation] -   ma14_t: 0.0504
2025-05-19 23:21:26,535 - INFO - [src.data_preparation] -   ma21_t: 0.0502
2025-05-19 23:21:26,535 - INFO - [src.data_preparation] -   Median_HL: 0.0488
2025-05-19 23:21:26,539 - INFO - [src.data_preparation] - Ticker PPC - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 's_d7_t', 'TVV', 'Volatility', 'HL', 'ATR', 'ret', 'variation_t', 'LO', 'SR', 'ma14_t', 'ma21_t', 'Median_HL']
2025-05-19 23:21:26,624 - INFO - [src.data_preparation] - Ticker PPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:26,624 - INFO - [src.data_preparation] - Ticker PPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:26,624 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PPC
2025-05-19 23:21:26,624 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:26,624 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:21:26,624 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:21:26,628 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:21:26,628 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:21:26,631 - INFO - [src.data_preparation] - Ticker PPC - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:26,631 - INFO - [__main__] - Using best model for PPC: svm (F1: 0.5957)
2025-05-19 23:21:26,632 - INFO - [__main__] - Loading svm model for PPC...
2025-05-19 23:21:26,633 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:26,633 - INFO - [__main__] - Model size: 0.64 MB
2025-05-19 23:21:26,633 - INFO - [__main__] - Making predictions for PPC using svm
2025-05-19 23:21:26,634 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:26,634 - INFO - [__main__] - Successfully got last prediction for PPC
2025-05-19 23:21:26,634 - INFO - [__main__] - 
Processing ticker: PPE
2025-05-19 23:21:26,634 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:26,634 - INFO - [__main__] - Getting last prediction point for ticker: PPE
2025-05-19 23:21:26,634 - INFO - [__main__] - ==================================================
2025-05-19 23:21:26,635 - INFO - [__main__] - Preparing test data for PPE...
2025-05-19 23:21:26,661 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:26,661 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:26,661 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:26,680 - INFO - [src.data_preparation] - Ticker PPE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:26,680 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(193), np.int64(1): np.int64(446)}
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] - Ticker PPE - Selected features:
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   vnipc_t: 0.0843
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   ma21_t: 0.0783
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   ATR: 0.0746
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   Volatility: 0.0733
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   ma14_t: 0.0708
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   ma7_t: 0.0674
2025-05-19 23:21:26,939 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   TVV: 0.0608
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   insec_t: 0.0535
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   PM: 0.0532
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   SK: 0.0529
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   Median_HL: 0.0529
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   ret: 0.0515
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   variation_t: 0.0428
2025-05-19 23:21:26,940 - INFO - [src.data_preparation] -   HL: 0.0396
2025-05-19 23:21:26,944 - INFO - [src.data_preparation] - Ticker PPE - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ATR', 'Volatility', 'ma14_t', 'ma7_t', 's_d7_t', 'TVV', 'insec_t', 'PM', 'SK', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:27,028 - INFO - [src.data_preparation] - Ticker PPE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:27,029 - INFO - [src.data_preparation] - Ticker PPE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:27,030 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PPE
2025-05-19 23:21:27,030 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:27,030 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(145), np.int64(1): np.int64(318)}
2025-05-19 23:21:27,030 - INFO - [src.data_preparation] - Generating 173 synthetic minority samples
2025-05-19 23:21:27,038 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (636, 13, 15), y shape: (636,)
2025-05-19 23:21:27,038 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(318), np.int64(1): np.int64(318)}
2025-05-19 23:21:27,042 - INFO - [src.data_preparation] - Ticker PPE - Final 3D shapes: X_train=(636, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:27,043 - INFO - [__main__] - Using best model for PPE: logistic_regression (F1: 0.7576)
2025-05-19 23:21:27,043 - INFO - [__main__] - Loading logistic_regression model for PPE...
2025-05-19 23:21:27,043 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:27,044 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:27,044 - INFO - [__main__] - Making predictions for PPE using logistic_regression
2025-05-19 23:21:27,044 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:27,044 - INFO - [__main__] - Successfully got last prediction for PPE
2025-05-19 23:21:27,044 - INFO - [__main__] - 
Processing ticker: PPI
2025-05-19 23:21:27,044 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:27,045 - INFO - [__main__] - Getting last prediction point for ticker: PPI
2025-05-19 23:21:27,045 - INFO - [__main__] - ==================================================
2025-05-19 23:21:27,045 - INFO - [__main__] - Preparing test data for PPI...
2025-05-19 23:21:27,073 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:27,073 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:27,073 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:27,092 - INFO - [src.data_preparation] - Ticker PPI - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:27,092 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(386)}
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] - Ticker PPI - Selected features:
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   TVV: 0.0807
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   ma14_t: 0.0752
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   ma21_t: 0.0722
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   insec_t: 0.0694
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   ma7_t: 0.0689
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   Median_HL: 0.0634
2025-05-19 23:21:27,342 - INFO - [src.data_preparation] -   PM: 0.0613
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   s_d7_t: 0.0596
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   SK: 0.0569
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   Volatility: 0.0551
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   ATR: 0.0486
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   variation_t: 0.0429
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   ret: 0.0421
2025-05-19 23:21:27,343 - INFO - [src.data_preparation] -   HL: 0.0413
2025-05-19 23:21:27,346 - INFO - [src.data_preparation] - Ticker PPI - Using features: ['Date', 'TVV', 'vnipc_t', 'ma14_t', 'ma21_t', 'insec_t', 'ma7_t', 'Median_HL', 'PM', 's_d7_t', 'SK', 'Volatility', 'ATR', 'variation_t', 'ret', 'HL']
2025-05-19 23:21:27,427 - INFO - [src.data_preparation] - Ticker PPI - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:27,427 - INFO - [src.data_preparation] - Ticker PPI - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:27,429 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PPI
2025-05-19 23:21:27,429 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:27,429 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(257)}
2025-05-19 23:21:27,429 - INFO - [src.data_preparation] - Generating 52 synthetic minority samples
2025-05-19 23:21:27,432 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:21:27,432 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:21:27,435 - INFO - [src.data_preparation] - Ticker PPI - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:27,435 - INFO - [__main__] - Using best model for PPI: svm (F1: 0.9885)
2025-05-19 23:21:27,435 - INFO - [__main__] - Loading svm model for PPI...
2025-05-19 23:21:27,437 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:27,437 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:21:27,437 - INFO - [__main__] - Making predictions for PPI using svm
2025-05-19 23:21:27,438 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:27,438 - INFO - [__main__] - Successfully got last prediction for PPI
2025-05-19 23:21:27,438 - INFO - [__main__] - 
Processing ticker: PPP
2025-05-19 23:21:27,438 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:27,438 - INFO - [__main__] - Getting last prediction point for ticker: PPP
2025-05-19 23:21:27,438 - INFO - [__main__] - ==================================================
2025-05-19 23:21:27,438 - INFO - [__main__] - Preparing test data for PPP...
2025-05-19 23:21:27,465 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:27,465 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:27,467 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:27,485 - INFO - [src.data_preparation] - Ticker PPP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:27,485 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(217), np.int64(1): np.int64(422)}
2025-05-19 23:21:27,762 - INFO - [src.data_preparation] - Ticker PPP - Selected features:
2025-05-19 23:21:27,762 - INFO - [src.data_preparation] -   ATR: 0.0762
2025-05-19 23:21:27,762 - INFO - [src.data_preparation] -   vnipc_t: 0.0756
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   TVV: 0.0715
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   SK: 0.0651
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   ma14_t: 0.0638
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   ma21_t: 0.0619
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   PM: 0.0597
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   Median_HL: 0.0579
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   ma7_t: 0.0571
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   insec_t: 0.0549
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   HL: 0.0488
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   variation_t: 0.0442
2025-05-19 23:21:27,763 - INFO - [src.data_preparation] -   SR: 0.0425
2025-05-19 23:21:27,765 - INFO - [src.data_preparation] - Ticker PPP - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'SK', 'ma14_t', 'ma21_t', 'PM', 'Median_HL', 'ma7_t', 'insec_t', 'HL', 'variation_t', 'SR']
2025-05-19 23:21:27,867 - INFO - [src.data_preparation] - Ticker PPP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:27,869 - INFO - [src.data_preparation] - Ticker PPP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:27,870 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PPP
2025-05-19 23:21:27,870 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:27,871 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(145), np.int64(1): np.int64(318)}
2025-05-19 23:21:27,871 - INFO - [src.data_preparation] - Generating 173 synthetic minority samples
2025-05-19 23:21:27,879 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (636, 13, 15), y shape: (636,)
2025-05-19 23:21:27,880 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(318), np.int64(1): np.int64(318)}
2025-05-19 23:21:27,885 - INFO - [src.data_preparation] - Ticker PPP - Final 3D shapes: X_train=(636, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:27,885 - INFO - [__main__] - Using best model for PPP: svm (F1: 0.7246)
2025-05-19 23:21:27,886 - INFO - [__main__] - Loading svm model for PPP...
2025-05-19 23:21:27,887 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:27,888 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:21:27,889 - INFO - [__main__] - Making predictions for PPP using svm
2025-05-19 23:21:27,890 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:27,890 - INFO - [__main__] - Successfully got last prediction for PPP
2025-05-19 23:21:27,891 - INFO - [__main__] - 
Processing ticker: PPS
2025-05-19 23:21:27,891 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:27,891 - INFO - [__main__] - Getting last prediction point for ticker: PPS
2025-05-19 23:21:27,891 - INFO - [__main__] - ==================================================
2025-05-19 23:21:27,891 - INFO - [__main__] - Preparing test data for PPS...
2025-05-19 23:21:27,925 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:27,926 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:27,926 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:27,946 - INFO - [src.data_preparation] - Ticker PPS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:27,946 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(253), np.int64(1): np.int64(386)}
2025-05-19 23:21:28,266 - INFO - [src.data_preparation] - Ticker PPS - Selected features:
2025-05-19 23:21:28,266 - INFO - [src.data_preparation] -   TVV: 0.0770
2025-05-19 23:21:28,266 - INFO - [src.data_preparation] -   SK: 0.0744
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   vnipc_t: 0.0741
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   insec_t: 0.0736
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   SR: 0.0572
2025-05-19 23:21:28,267 - INFO - [src.data_preparation] -   ret: 0.0542
2025-05-19 23:21:28,268 - INFO - [src.data_preparation] -   variation_t: 0.0540
2025-05-19 23:21:28,268 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:21:28,268 - INFO - [src.data_preparation] -   HL: 0.0525
2025-05-19 23:21:28,268 - INFO - [src.data_preparation] -   ma7_t: 0.0515
2025-05-19 23:21:28,268 - INFO - [src.data_preparation] -   ma21_t: 0.0514
2025-05-19 23:21:28,268 - INFO - [src.data_preparation] -   LO: 0.0495
2025-05-19 23:21:28,271 - INFO - [src.data_preparation] - Ticker PPS - Using features: ['Date', 'TVV', 'SK', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'ATR', 'SR', 'ret', 'variation_t', 'ma14_t', 'HL', 'ma7_t', 'ma21_t', 'LO']
2025-05-19 23:21:28,362 - INFO - [src.data_preparation] - Ticker PPS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:28,362 - INFO - [src.data_preparation] - Ticker PPS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:28,364 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PPS
2025-05-19 23:21:28,364 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:28,364 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(176), np.int64(1): np.int64(287)}
2025-05-19 23:21:28,365 - INFO - [src.data_preparation] - Generating 111 synthetic minority samples
2025-05-19 23:21:28,371 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (574, 13, 15), y shape: (574,)
2025-05-19 23:21:28,371 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(287), np.int64(1): np.int64(287)}
2025-05-19 23:21:28,374 - INFO - [src.data_preparation] - Ticker PPS - Final 3D shapes: X_train=(574, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:28,374 - INFO - [__main__] - Using best model for PPS: lstm (F1: 0.7246)
2025-05-19 23:21:28,374 - INFO - [__main__] - Loading lstm model for PPS...
2025-05-19 23:21:28,379 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:28,380 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:21:28,380 - INFO - [__main__] - Making predictions for PPS using lstm
2025-05-19 23:21:28,382 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:28,382 - INFO - [__main__] - Successfully got last prediction for PPS
2025-05-19 23:21:28,382 - INFO - [__main__] - 
Processing ticker: PRC
2025-05-19 23:21:28,382 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:28,382 - INFO - [__main__] - Getting last prediction point for ticker: PRC
2025-05-19 23:21:28,382 - INFO - [__main__] - ==================================================
2025-05-19 23:21:28,382 - INFO - [__main__] - Preparing test data for PRC...
2025-05-19 23:21:28,415 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:28,416 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:28,416 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:28,436 - INFO - [src.data_preparation] - Ticker PRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:28,436 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(140), np.int64(1): np.int64(499)}
2025-05-19 23:21:28,702 - INFO - [src.data_preparation] - Ticker PRC - Selected features:
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   ma21_t: 0.1046
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   ma14_t: 0.0904
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   vnipc_t: 0.0890
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   TVV: 0.0763
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   Median_HL: 0.0742
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   ma7_t: 0.0720
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   PM: 0.0714
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   s_d7_t: 0.0624
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   Volatility: 0.0567
2025-05-19 23:21:28,703 - INFO - [src.data_preparation] -   ATR: 0.0548
2025-05-19 23:21:28,704 - INFO - [src.data_preparation] -   insec_t: 0.0541
2025-05-19 23:21:28,704 - INFO - [src.data_preparation] -   SK: 0.0467
2025-05-19 23:21:28,704 - INFO - [src.data_preparation] -   HL: 0.0418
2025-05-19 23:21:28,704 - INFO - [src.data_preparation] -   ret: 0.0295
2025-05-19 23:21:28,704 - INFO - [src.data_preparation] -   variation_t: 0.0289
2025-05-19 23:21:28,709 - INFO - [src.data_preparation] - Ticker PRC - Using features: ['Date', 'ma21_t', 'ma14_t', 'vnipc_t', 'TVV', 'Median_HL', 'ma7_t', 'PM', 's_d7_t', 'Volatility', 'ATR', 'insec_t', 'SK', 'HL', 'ret', 'variation_t']
2025-05-19 23:21:28,798 - INFO - [src.data_preparation] - Ticker PRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:28,798 - INFO - [src.data_preparation] - Ticker PRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:28,799 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PRC
2025-05-19 23:21:28,801 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:28,801 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(71), np.int64(1): np.int64(392)}
2025-05-19 23:21:28,801 - INFO - [src.data_preparation] - Generating 321 synthetic minority samples
2025-05-19 23:21:28,814 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (784, 13, 15), y shape: (784,)
2025-05-19 23:21:28,814 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(392), np.int64(1): np.int64(392)}
2025-05-19 23:21:28,824 - INFO - [src.data_preparation] - Ticker PRC - Final 3D shapes: X_train=(784, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:28,826 - INFO - [__main__] - Using best model for PRC: svm (F1: 0.6866)
2025-05-19 23:21:28,826 - INFO - [__main__] - Loading svm model for PRC...
2025-05-19 23:21:28,829 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:28,830 - INFO - [__main__] - Model size: 0.53 MB
2025-05-19 23:21:28,830 - INFO - [__main__] - Making predictions for PRC using svm
2025-05-19 23:21:28,831 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:28,832 - INFO - [__main__] - Successfully got last prediction for PRC
2025-05-19 23:21:28,832 - INFO - [__main__] - 
Processing ticker: PSB
2025-05-19 23:21:28,832 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:28,832 - INFO - [__main__] - Getting last prediction point for ticker: PSB
2025-05-19 23:21:28,832 - INFO - [__main__] - ==================================================
2025-05-19 23:21:28,832 - INFO - [__main__] - Preparing test data for PSB...
2025-05-19 23:21:28,870 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:28,870 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:28,870 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:28,890 - INFO - [src.data_preparation] - Ticker PSB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:28,890 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:21:29,163 - INFO - [src.data_preparation] - Ticker PSB - Selected features:
2025-05-19 23:21:29,163 - INFO - [src.data_preparation] -   TVV: 0.0760
2025-05-19 23:21:29,163 - INFO - [src.data_preparation] -   vnipc_t: 0.0748
2025-05-19 23:21:29,163 - INFO - [src.data_preparation] -   Volatility: 0.0719
2025-05-19 23:21:29,163 - INFO - [src.data_preparation] -   SK: 0.0708
2025-05-19 23:21:29,163 - INFO - [src.data_preparation] -   insec_t: 0.0692
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   ma14_t: 0.0663
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   ma21_t: 0.0661
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   s_d7_t: 0.0650
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   ATR: 0.0566
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   Median_HL: 0.0537
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   variation_t: 0.0509
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   ret: 0.0496
2025-05-19 23:21:29,164 - INFO - [src.data_preparation] -   HL: 0.0405
2025-05-19 23:21:29,167 - INFO - [src.data_preparation] - Ticker PSB - Using features: ['Date', 'TVV', 'vnipc_t', 'Volatility', 'SK', 'insec_t', 'ma14_t', 'ma21_t', 's_d7_t', 'ATR', 'PM', 'ma7_t', 'Median_HL', 'variation_t', 'ret', 'HL']
2025-05-19 23:21:29,249 - INFO - [src.data_preparation] - Ticker PSB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:29,249 - INFO - [src.data_preparation] - Ticker PSB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:29,258 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PSB
2025-05-19 23:21:29,259 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:29,259 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:21:29,259 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:21:29,262 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:21:29,262 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:21:29,265 - INFO - [src.data_preparation] - Ticker PSB - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:29,265 - INFO - [__main__] - Using best model for PSB: svm (F1: 0.2609)
2025-05-19 23:21:29,265 - INFO - [__main__] - Loading svm model for PSB...
2025-05-19 23:21:29,267 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:29,267 - INFO - [__main__] - Model size: 0.57 MB
2025-05-19 23:21:29,267 - INFO - [__main__] - Making predictions for PSB using svm
2025-05-19 23:21:29,268 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:29,268 - INFO - [__main__] - Successfully got last prediction for PSB
2025-05-19 23:21:29,268 - INFO - [__main__] - 
Processing ticker: PSC
2025-05-19 23:21:29,268 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:29,268 - INFO - [__main__] - Getting last prediction point for ticker: PSC
2025-05-19 23:21:29,268 - INFO - [__main__] - ==================================================
2025-05-19 23:21:29,268 - INFO - [__main__] - Preparing test data for PSC...
2025-05-19 23:21:29,298 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:29,298 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:29,298 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:29,317 - INFO - [src.data_preparation] - Ticker PSC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:29,317 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(193), np.int64(1): np.int64(446)}
2025-05-19 23:21:29,600 - INFO - [src.data_preparation] - Ticker PSC - Selected features:
2025-05-19 23:21:29,600 - INFO - [src.data_preparation] -   vnipc_t: 0.0913
2025-05-19 23:21:29,600 - INFO - [src.data_preparation] -   ATR: 0.0750
2025-05-19 23:21:29,600 - INFO - [src.data_preparation] -   s_d7_t: 0.0748
2025-05-19 23:21:29,600 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:21:29,600 - INFO - [src.data_preparation] -   Volatility: 0.0646
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   ma21_t: 0.0638
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   ma7_t: 0.0622
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   ma14_t: 0.0593
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   SK: 0.0586
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   Median_HL: 0.0565
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   insec_t: 0.0512
2025-05-19 23:21:29,601 - INFO - [src.data_preparation] -   HL: 0.0480
2025-05-19 23:21:29,602 - INFO - [src.data_preparation] -   variation_t: 0.0474
2025-05-19 23:21:29,602 - INFO - [src.data_preparation] -   SR: 0.0470
2025-05-19 23:21:29,606 - INFO - [src.data_preparation] - Ticker PSC - Using features: ['Date', 'vnipc_t', 'ATR', 's_d7_t', 'TVV', 'Volatility', 'ma21_t', 'ma7_t', 'ma14_t', 'SK', 'Median_HL', 'PM', 'insec_t', 'HL', 'variation_t', 'SR']
2025-05-19 23:21:29,698 - INFO - [src.data_preparation] - Ticker PSC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:29,699 - INFO - [src.data_preparation] - Ticker PSC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:29,700 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PSC
2025-05-19 23:21:29,700 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:29,700 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(135), np.int64(1): np.int64(328)}
2025-05-19 23:21:29,700 - INFO - [src.data_preparation] - Generating 193 synthetic minority samples
2025-05-19 23:21:29,710 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (656, 13, 15), y shape: (656,)
2025-05-19 23:21:29,710 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(328), np.int64(1): np.int64(328)}
2025-05-19 23:21:29,714 - INFO - [src.data_preparation] - Ticker PSC - Final 3D shapes: X_train=(656, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:29,714 - INFO - [__main__] - Using best model for PSC: svm (F1: 0.7606)
2025-05-19 23:21:29,714 - INFO - [__main__] - Loading svm model for PSC...
2025-05-19 23:21:29,715 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:29,717 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:21:29,717 - INFO - [__main__] - Making predictions for PSC using svm
2025-05-19 23:21:29,718 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:29,718 - INFO - [__main__] - Successfully got last prediction for PSC
2025-05-19 23:21:29,718 - INFO - [__main__] - 
Processing ticker: PSG
2025-05-19 23:21:29,718 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:29,718 - INFO - [__main__] - Getting last prediction point for ticker: PSG
2025-05-19 23:21:29,718 - INFO - [__main__] - ==================================================
2025-05-19 23:21:29,718 - INFO - [__main__] - Preparing test data for PSG...
2025-05-19 23:21:29,746 - INFO - [src.data_preparation] - After processing - X shape: (574, 19), y shape: (574,)
2025-05-19 23:21:29,747 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:29,747 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:29,766 - INFO - [src.data_preparation] - Ticker PSG - Original shapes: X=(574, 18), y=(574,)
2025-05-19 23:21:29,766 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(162), np.int64(1): np.int64(412)}
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] - Ticker PSG - Selected features:
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   vnipc_t: 0.1086
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   insec_t: 0.0843
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   TVV: 0.0802
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   ma21_t: 0.0785
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   ma14_t: 0.0769
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   ma7_t: 0.0691
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   s_d7_t: 0.0674
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   SK: 0.0590
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   Median_HL: 0.0461
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   PM: 0.0457
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   ret: 0.0374
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   variation_t: 0.0361
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] -   HL: 0.0331
2025-05-19 23:21:29,979 - INFO - [src.data_preparation] - Ticker PSG - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'Volatility', 'SK', 'ATR', 'Median_HL', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:30,060 - INFO - [src.data_preparation] - Ticker PSG - 2D shapes: X_train=(398, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:30,061 - INFO - [src.data_preparation] - Ticker PSG - 3D shapes: X_train=(398, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:30,062 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PSG
2025-05-19 23:21:30,062 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (398, 13, 15), y shape: (398,)
2025-05-19 23:21:30,062 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(102), np.int64(1): np.int64(296)}
2025-05-19 23:21:30,062 - INFO - [src.data_preparation] - Generating 194 synthetic minority samples
2025-05-19 23:21:30,070 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:21:30,070 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:21:30,073 - INFO - [src.data_preparation] - Ticker PSG - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:30,073 - INFO - [__main__] - Using best model for PSG: lstm (F1: 0.9885)
2025-05-19 23:21:30,073 - INFO - [__main__] - Loading lstm model for PSG...
2025-05-19 23:21:30,077 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:30,078 - INFO - [__main__] - Model size: 0.39 MB
2025-05-19 23:21:30,079 - INFO - [__main__] - Making predictions for PSG using lstm
2025-05-19 23:21:30,083 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:30,083 - INFO - [__main__] - Successfully got last prediction for PSG
2025-05-19 23:21:30,084 - INFO - [__main__] - 
Processing ticker: PSI
2025-05-19 23:21:30,084 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:30,084 - INFO - [__main__] - Getting last prediction point for ticker: PSI
2025-05-19 23:21:30,084 - INFO - [__main__] - ==================================================
2025-05-19 23:21:30,084 - INFO - [__main__] - Preparing test data for PSI...
2025-05-19 23:21:30,121 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:30,121 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:30,121 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:30,145 - INFO - [src.data_preparation] - Ticker PSI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:30,145 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] - Ticker PSI - Selected features:
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] -   vnipc_t: 0.0737
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] -   Volatility: 0.0710
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] -   insec_t: 0.0709
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] -   TVV: 0.0677
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] -   ma14_t: 0.0653
2025-05-19 23:21:30,506 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:21:30,507 - INFO - [src.data_preparation] -   s_d7_t: 0.0617
2025-05-19 23:21:30,507 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:21:30,507 - INFO - [src.data_preparation] -   Median_HL: 0.0582
2025-05-19 23:21:30,507 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:21:30,507 - INFO - [src.data_preparation] -   ATR: 0.0568
2025-05-19 23:21:30,508 - INFO - [src.data_preparation] -   variation_t: 0.0551
2025-05-19 23:21:30,508 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:21:30,508 - INFO - [src.data_preparation] -   ma7_t: 0.0518
2025-05-19 23:21:30,508 - INFO - [src.data_preparation] -   SR: 0.0460
2025-05-19 23:21:30,512 - INFO - [src.data_preparation] - Ticker PSI - Using features: ['Date', 'vnipc_t', 'Volatility', 'insec_t', 'TVV', 'ma14_t', 'SK', 's_d7_t', 'ma21_t', 'Median_HL', 'PM', 'ATR', 'variation_t', 'ret', 'ma7_t', 'SR']
2025-05-19 23:21:30,597 - INFO - [src.data_preparation] - Ticker PSI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:30,597 - INFO - [src.data_preparation] - Ticker PSI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:30,599 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PSI
2025-05-19 23:21:30,599 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:30,599 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(181), np.int64(1): np.int64(282)}
2025-05-19 23:21:30,599 - INFO - [src.data_preparation] - Generating 101 synthetic minority samples
2025-05-19 23:21:30,604 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:21:30,604 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:21:30,607 - INFO - [src.data_preparation] - Ticker PSI - Final 3D shapes: X_train=(564, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:30,607 - INFO - [__main__] - Using best model for PSI: svm (F1: 0.7246)
2025-05-19 23:21:30,607 - INFO - [__main__] - Loading svm model for PSI...
2025-05-19 23:21:30,608 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:30,609 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:21:30,609 - INFO - [__main__] - Making predictions for PSI using svm
2025-05-19 23:21:30,610 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:30,610 - INFO - [__main__] - Successfully got last prediction for PSI
2025-05-19 23:21:30,610 - INFO - [__main__] - 
Processing ticker: PSL
2025-05-19 23:21:30,610 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:30,610 - INFO - [__main__] - Getting last prediction point for ticker: PSL
2025-05-19 23:21:30,610 - INFO - [__main__] - ==================================================
2025-05-19 23:21:30,610 - INFO - [__main__] - Preparing test data for PSL...
2025-05-19 23:21:30,650 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:30,650 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:30,650 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:30,669 - INFO - [src.data_preparation] - Ticker PSL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:30,670 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(238), np.int64(1): np.int64(401)}
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] - Ticker PSL - Selected features:
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   vnipc_t: 0.0704
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   TVV: 0.0683
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   ma14_t: 0.0679
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   Volatility: 0.0664
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   Median_HL: 0.0655
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   PM: 0.0641
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   ma21_t: 0.0639
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   ATR: 0.0638
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   ma7_t: 0.0630
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   s_d7_t: 0.0616
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   insec_t: 0.0577
2025-05-19 23:21:30,953 - INFO - [src.data_preparation] -   SK: 0.0575
2025-05-19 23:21:30,954 - INFO - [src.data_preparation] -   ret: 0.0505
2025-05-19 23:21:30,954 - INFO - [src.data_preparation] -   HL: 0.0488
2025-05-19 23:21:30,954 - INFO - [src.data_preparation] -   variation_t: 0.0482
2025-05-19 23:21:30,956 - INFO - [src.data_preparation] - Ticker PSL - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 'Volatility', 'Median_HL', 'PM', 'ma21_t', 'ATR', 'ma7_t', 's_d7_t', 'insec_t', 'SK', 'ret', 'HL', 'variation_t']
2025-05-19 23:21:31,044 - INFO - [src.data_preparation] - Ticker PSL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:31,044 - INFO - [src.data_preparation] - Ticker PSL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:31,046 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PSL
2025-05-19 23:21:31,046 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:31,046 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(156), np.int64(1): np.int64(307)}
2025-05-19 23:21:31,046 - INFO - [src.data_preparation] - Generating 151 synthetic minority samples
2025-05-19 23:21:31,053 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (614, 13, 15), y shape: (614,)
2025-05-19 23:21:31,053 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(307), np.int64(1): np.int64(307)}
2025-05-19 23:21:31,056 - INFO - [src.data_preparation] - Ticker PSL - Final 3D shapes: X_train=(614, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:31,056 - INFO - [__main__] - Using best model for PSL: logistic_regression (F1: 0.5128)
2025-05-19 23:21:31,057 - INFO - [__main__] - Loading logistic_regression model for PSL...
2025-05-19 23:21:31,057 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:31,058 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:31,058 - INFO - [__main__] - Making predictions for PSL using logistic_regression
2025-05-19 23:21:31,058 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:31,058 - INFO - [__main__] - Successfully got last prediction for PSL
2025-05-19 23:21:31,058 - INFO - [__main__] - 
Processing ticker: PSP
2025-05-19 23:21:31,058 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:31,058 - INFO - [__main__] - Getting last prediction point for ticker: PSP
2025-05-19 23:21:31,059 - INFO - [__main__] - ==================================================
2025-05-19 23:21:31,059 - INFO - [__main__] - Preparing test data for PSP...
2025-05-19 23:21:31,087 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:31,087 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:31,087 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:31,105 - INFO - [src.data_preparation] - Ticker PSP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:31,105 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(263), np.int64(1): np.int64(376)}
2025-05-19 23:21:31,496 - INFO - [src.data_preparation] - Ticker PSP - Selected features:
2025-05-19 23:21:31,496 - INFO - [src.data_preparation] -   SK: 0.0764
2025-05-19 23:21:31,496 - INFO - [src.data_preparation] -   vnipc_t: 0.0685
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   s_d7_t: 0.0677
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   TVV: 0.0662
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   ATR: 0.0646
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   ma21_t: 0.0586
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   ma14_t: 0.0580
2025-05-19 23:21:31,497 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:21:31,498 - INFO - [src.data_preparation] -   variation_t: 0.0547
2025-05-19 23:21:31,498 - INFO - [src.data_preparation] -   SR: 0.0542
2025-05-19 23:21:31,498 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:21:31,498 - INFO - [src.data_preparation] -   Median_HL: 0.0518
2025-05-19 23:21:31,498 - INFO - [src.data_preparation] -   ret: 0.0514
2025-05-19 23:21:31,498 - INFO - [src.data_preparation] - Ticker PSP - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'TVV', 'ATR', 'Volatility', 'insec_t', 'ma21_t', 'ma14_t', 'ma7_t', 'variation_t', 'SR', 'PM', 'Median_HL', 'ret']
2025-05-19 23:21:31,593 - INFO - [src.data_preparation] - Ticker PSP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:31,593 - INFO - [src.data_preparation] - Ticker PSP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:31,595 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PSP
2025-05-19 23:21:31,595 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:31,595 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:21:31,595 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:21:31,601 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:21:31,601 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:21:31,605 - INFO - [src.data_preparation] - Ticker PSP - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:31,605 - INFO - [__main__] - Using best model for PSP: svm (F1: 0.7606)
2025-05-19 23:21:31,605 - INFO - [__main__] - Loading svm model for PSP...
2025-05-19 23:21:31,607 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:31,608 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:21:31,608 - INFO - [__main__] - Making predictions for PSP using svm
2025-05-19 23:21:31,609 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:31,609 - INFO - [__main__] - Successfully got last prediction for PSP
2025-05-19 23:21:31,609 - INFO - [__main__] - 
Processing ticker: PTB
2025-05-19 23:21:31,609 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:31,609 - INFO - [__main__] - Getting last prediction point for ticker: PTB
2025-05-19 23:21:31,609 - INFO - [__main__] - ==================================================
2025-05-19 23:21:31,609 - INFO - [__main__] - Preparing test data for PTB...
2025-05-19 23:21:31,655 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:31,656 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:31,656 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:31,674 - INFO - [src.data_preparation] - Ticker PTB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:31,674 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(294), np.int64(1): np.int64(345)}
2025-05-19 23:21:32,039 - INFO - [src.data_preparation] - Ticker PTB - Selected features:
2025-05-19 23:21:32,039 - INFO - [src.data_preparation] -   insec_t: 0.0752
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   vnipc_t: 0.0689
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   Volatility: 0.0659
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   SK: 0.0620
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   TVV: 0.0589
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   Median_HL: 0.0577
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   ret: 0.0558
2025-05-19 23:21:32,040 - INFO - [src.data_preparation] -   ATR: 0.0556
2025-05-19 23:21:32,041 - INFO - [src.data_preparation] -   ma21_t: 0.0556
2025-05-19 23:21:32,041 - INFO - [src.data_preparation] -   s_d7_t: 0.0555
2025-05-19 23:21:32,041 - INFO - [src.data_preparation] -   PM: 0.0552
2025-05-19 23:21:32,041 - INFO - [src.data_preparation] -   SR: 0.0534
2025-05-19 23:21:32,041 - INFO - [src.data_preparation] -   variation_t: 0.0533
2025-05-19 23:21:32,041 - INFO - [src.data_preparation] -   LO: 0.0529
2025-05-19 23:21:32,044 - INFO - [src.data_preparation] - Ticker PTB - Using features: ['Date', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 'HL', 'TVV', 'Median_HL', 'ret', 'ATR', 'ma21_t', 's_d7_t', 'PM', 'SR', 'variation_t', 'LO']
2025-05-19 23:21:32,138 - INFO - [src.data_preparation] - Ticker PTB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:32,138 - INFO - [src.data_preparation] - Ticker PTB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:32,141 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTB
2025-05-19 23:21:32,142 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:32,142 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:21:32,142 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:21:32,145 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:21:32,145 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:21:32,150 - INFO - [src.data_preparation] - Ticker PTB - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:32,150 - INFO - [__main__] - Using best model for PTB: svm (F1: 0.5333)
2025-05-19 23:21:32,150 - INFO - [__main__] - Loading svm model for PTB...
2025-05-19 23:21:32,152 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:32,152 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:21:32,152 - INFO - [__main__] - Making predictions for PTB using svm
2025-05-19 23:21:32,153 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:32,153 - INFO - [__main__] - Successfully got last prediction for PTB
2025-05-19 23:21:32,153 - INFO - [__main__] - 
Processing ticker: PTC
2025-05-19 23:21:32,154 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:32,154 - INFO - [__main__] - Getting last prediction point for ticker: PTC
2025-05-19 23:21:32,154 - INFO - [__main__] - ==================================================
2025-05-19 23:21:32,154 - INFO - [__main__] - Preparing test data for PTC...
2025-05-19 23:21:32,183 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:32,183 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:32,183 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:32,207 - INFO - [src.data_preparation] - Ticker PTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:32,207 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(300), np.int64(1): np.int64(339)}
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] - Ticker PTC - Selected features:
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   SK: 0.0798
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   TVV: 0.0755
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   vnipc_t: 0.0737
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   Volatility: 0.0731
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   insec_t: 0.0624
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   ma14_t: 0.0597
2025-05-19 23:21:32,563 - INFO - [src.data_preparation] -   ma21_t: 0.0566
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   ATR: 0.0558
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   SR: 0.0556
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   variation_t: 0.0517
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   ma7_t: 0.0508
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   PM: 0.0499
2025-05-19 23:21:32,564 - INFO - [src.data_preparation] -   HL: 0.0497
2025-05-19 23:21:32,567 - INFO - [src.data_preparation] - Ticker PTC - Using features: ['Date', 'SK', 'TVV', 'vnipc_t', 'Volatility', 's_d7_t', 'insec_t', 'ma14_t', 'ma21_t', 'ATR', 'SR', 'ret', 'variation_t', 'ma7_t', 'PM', 'HL']
2025-05-19 23:21:32,669 - INFO - [src.data_preparation] - Ticker PTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:32,669 - INFO - [src.data_preparation] - Ticker PTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:32,669 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTC
2025-05-19 23:21:32,669 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:32,669 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:21:32,677 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:21:32,678 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:21:32,678 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:21:32,684 - INFO - [src.data_preparation] - Ticker PTC - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:32,685 - INFO - [__main__] - Using best model for PTC: transformer (F1: 0.5957)
2025-05-19 23:21:32,685 - INFO - [__main__] - Loading transformer model for PTC...
2025-05-19 23:21:32,709 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:32,718 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:21:32,718 - INFO - [__main__] - Making predictions for PTC using transformer
2025-05-19 23:21:32,723 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:32,724 - INFO - [__main__] - Successfully got last prediction for PTC
2025-05-19 23:21:32,724 - INFO - [__main__] - 
Processing ticker: PTD
2025-05-19 23:21:32,724 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:32,724 - INFO - [__main__] - Getting last prediction point for ticker: PTD
2025-05-19 23:21:32,724 - INFO - [__main__] - ==================================================
2025-05-19 23:21:32,725 - INFO - [__main__] - Preparing test data for PTD...
2025-05-19 23:21:32,792 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:32,792 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:32,792 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:32,835 - INFO - [src.data_preparation] - Ticker PTD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:32,836 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(135), np.int64(1): np.int64(504)}
2025-05-19 23:21:33,166 - INFO - [src.data_preparation] - Ticker PTD - Selected features:
2025-05-19 23:21:33,166 - INFO - [src.data_preparation] -   ATR: 0.0998
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   vnipc_t: 0.0857
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   ma21_t: 0.0789
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   s_d7_t: 0.0744
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   ma14_t: 0.0730
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   Volatility: 0.0681
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   SK: 0.0635
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   ma7_t: 0.0601
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   HL: 0.0489
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   PM: 0.0438
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   ret: 0.0378
2025-05-19 23:21:33,167 - INFO - [src.data_preparation] -   insec_t: 0.0375
2025-05-19 23:21:33,168 - INFO - [src.data_preparation] -   variation_t: 0.0371
2025-05-19 23:21:33,170 - INFO - [src.data_preparation] - Ticker PTD - Using features: ['Date', 'ATR', 'vnipc_t', 'ma21_t', 's_d7_t', 'ma14_t', 'TVV', 'Volatility', 'SK', 'ma7_t', 'Median_HL', 'HL', 'PM', 'ret', 'insec_t', 'variation_t']
2025-05-19 23:21:33,262 - INFO - [src.data_preparation] - Ticker PTD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:33,262 - INFO - [src.data_preparation] - Ticker PTD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:33,263 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTD
2025-05-19 23:21:33,264 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:33,264 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(78), np.int64(1): np.int64(385)}
2025-05-19 23:21:33,264 - INFO - [src.data_preparation] - Generating 307 synthetic minority samples
2025-05-19 23:21:33,273 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (770, 13, 15), y shape: (770,)
2025-05-19 23:21:33,273 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(385), np.int64(1): np.int64(385)}
2025-05-19 23:21:33,278 - INFO - [src.data_preparation] - Ticker PTD - Final 3D shapes: X_train=(770, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:33,278 - INFO - [__main__] - Using best model for PTD: svm (F1: 0.7188)
2025-05-19 23:21:33,279 - INFO - [__main__] - Loading svm model for PTD...
2025-05-19 23:21:33,279 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:33,279 - INFO - [__main__] - Model size: 0.53 MB
2025-05-19 23:21:33,279 - INFO - [__main__] - Making predictions for PTD using svm
2025-05-19 23:21:33,279 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:33,279 - INFO - [__main__] - Successfully got last prediction for PTD
2025-05-19 23:21:33,279 - INFO - [__main__] - 
Processing ticker: PTG
2025-05-19 23:21:33,279 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:33,279 - INFO - [__main__] - Getting last prediction point for ticker: PTG
2025-05-19 23:21:33,279 - INFO - [__main__] - ==================================================
2025-05-19 23:21:33,279 - INFO - [__main__] - Preparing test data for PTG...
2025-05-19 23:21:33,309 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:33,309 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:33,309 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:33,328 - INFO - [src.data_preparation] - Ticker PTG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:33,328 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(20), np.int64(1): np.int64(619)}
2025-05-19 23:21:33,482 - INFO - [src.data_preparation] - Ticker PTG - Selected features:
2025-05-19 23:21:33,482 - INFO - [src.data_preparation] -   vnipc_t: 0.3228
2025-05-19 23:21:33,482 - INFO - [src.data_preparation] -   ma21_t: 0.1790
2025-05-19 23:21:33,482 - INFO - [src.data_preparation] -   ma14_t: 0.1132
2025-05-19 23:21:33,482 - INFO - [src.data_preparation] -   ma7_t: 0.0590
2025-05-19 23:21:33,482 - INFO - [src.data_preparation] -   Median_HL: 0.0497
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   PM: 0.0491
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   LO: 0.0404
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   variation_t: 0.0320
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   ret: 0.0304
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   ATR: 0.0292
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   SR: 0.0242
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   Volatility: 0.0189
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   TVV: 0.0188
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   s_d7_t: 0.0168
2025-05-19 23:21:33,483 - INFO - [src.data_preparation] -   MDD: 0.0080
2025-05-19 23:21:33,486 - INFO - [src.data_preparation] - Ticker PTG - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 'LO', 'variation_t', 'ret', 'ATR', 'SR', 'Volatility', 'TVV', 's_d7_t', 'MDD']
2025-05-19 23:21:33,565 - INFO - [src.data_preparation] - Ticker PTG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:33,565 - INFO - [src.data_preparation] - Ticker PTG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:33,566 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTG
2025-05-19 23:21:33,566 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:33,566 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(12), np.int64(1): np.int64(451)}
2025-05-19 23:21:33,566 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:21:33,569 - INFO - [src.data_preparation] - Ticker PTG - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:33,569 - INFO - [__main__] - Using best model for PTG: lstm (F1: 0.9885)
2025-05-19 23:21:33,569 - INFO - [__main__] - Loading lstm model for PTG...
2025-05-19 23:21:33,574 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:33,576 - INFO - [__main__] - Model size: 0.33 MB
2025-05-19 23:21:33,576 - INFO - [__main__] - Making predictions for PTG using lstm
2025-05-19 23:21:33,579 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:33,579 - INFO - [__main__] - Successfully got last prediction for PTG
2025-05-19 23:21:33,579 - INFO - [__main__] - 
Processing ticker: PTH
2025-05-19 23:21:33,579 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:33,579 - INFO - [__main__] - Getting last prediction point for ticker: PTH
2025-05-19 23:21:33,579 - INFO - [__main__] - ==================================================
2025-05-19 23:21:33,580 - INFO - [__main__] - Preparing test data for PTH...
2025-05-19 23:21:33,617 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:33,617 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:33,617 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:33,642 - INFO - [src.data_preparation] - Ticker PTH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:33,642 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(65), np.int64(1): np.int64(574)}
2025-05-19 23:21:33,886 - INFO - [src.data_preparation] - Ticker PTH - Selected features:
2025-05-19 23:21:33,886 - INFO - [src.data_preparation] -   vnipc_t: 0.1207
2025-05-19 23:21:33,886 - INFO - [src.data_preparation] -   ma21_t: 0.0996
2025-05-19 23:21:33,886 - INFO - [src.data_preparation] -   ma14_t: 0.0990
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   ma7_t: 0.0855
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   ATR: 0.0697
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   Median_HL: 0.0581
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   PM: 0.0569
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   Volatility: 0.0498
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   SK: 0.0434
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   SR: 0.0431
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   insec_t: 0.0357
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   LO: 0.0330
2025-05-19 23:21:33,887 - INFO - [src.data_preparation] -   variation_t: 0.0290
2025-05-19 23:21:33,890 - INFO - [src.data_preparation] - Ticker PTH - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'ATR', 'TVV', 's_d7_t', 'Median_HL', 'PM', 'Volatility', 'SK', 'SR', 'insec_t', 'LO', 'variation_t']
2025-05-19 23:21:33,973 - INFO - [src.data_preparation] - Ticker PTH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:33,973 - INFO - [src.data_preparation] - Ticker PTH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:33,974 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTH
2025-05-19 23:21:33,974 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:33,975 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(49), np.int64(1): np.int64(414)}
2025-05-19 23:21:33,975 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:21:33,978 - INFO - [src.data_preparation] - Ticker PTH - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:33,978 - INFO - [__main__] - Using best model for PTH: lstm (F1: 0.9647)
2025-05-19 23:21:33,978 - INFO - [__main__] - Loading lstm model for PTH...
2025-05-19 23:21:33,982 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:33,984 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:21:33,984 - INFO - [__main__] - Making predictions for PTH using lstm
2025-05-19 23:21:33,987 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:33,987 - INFO - [__main__] - Successfully got last prediction for PTH
2025-05-19 23:21:33,987 - INFO - [__main__] - 
Processing ticker: PTI
2025-05-19 23:21:33,987 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:33,987 - INFO - [__main__] - Getting last prediction point for ticker: PTI
2025-05-19 23:21:33,988 - INFO - [__main__] - ==================================================
2025-05-19 23:21:33,988 - INFO - [__main__] - Preparing test data for PTI...
2025-05-19 23:21:34,028 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:34,029 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:34,029 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:34,052 - INFO - [src.data_preparation] - Ticker PTI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:34,052 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(270), np.int64(1): np.int64(369)}
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] - Ticker PTI - Selected features:
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   vnipc_t: 0.0708
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   SK: 0.0674
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   insec_t: 0.0674
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   ATR: 0.0658
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   TVV: 0.0614
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   Volatility: 0.0613
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   HL: 0.0609
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   ret: 0.0586
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   s_d7_t: 0.0576
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:21:34,368 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:21:34,369 - INFO - [src.data_preparation] -   SR: 0.0536
2025-05-19 23:21:34,369 - INFO - [src.data_preparation] -   ma14_t: 0.0517
2025-05-19 23:21:34,369 - INFO - [src.data_preparation] -   ma21_t: 0.0500
2025-05-19 23:21:34,369 - INFO - [src.data_preparation] -   LO: 0.0500
2025-05-19 23:21:34,372 - INFO - [src.data_preparation] - Ticker PTI - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'ATR', 'TVV', 'Volatility', 'HL', 'ret', 's_d7_t', 'PM', 'variation_t', 'SR', 'ma14_t', 'ma21_t', 'LO']
2025-05-19 23:21:34,460 - INFO - [src.data_preparation] - Ticker PTI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:34,460 - INFO - [src.data_preparation] - Ticker PTI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:34,462 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTI
2025-05-19 23:21:34,462 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:34,462 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:21:34,462 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:21:34,465 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:21:34,465 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:21:34,468 - INFO - [src.data_preparation] - Ticker PTI - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:34,469 - INFO - [__main__] - Using best model for PTI: lstm (F1: 0.7246)
2025-05-19 23:21:34,470 - INFO - [__main__] - Loading lstm model for PTI...
2025-05-19 23:21:34,473 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:34,475 - INFO - [__main__] - Model size: 0.29 MB
2025-05-19 23:21:34,475 - INFO - [__main__] - Making predictions for PTI using lstm
2025-05-19 23:21:34,477 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:34,477 - INFO - [__main__] - Successfully got last prediction for PTI
2025-05-19 23:21:34,477 - INFO - [__main__] - 
Processing ticker: PTL
2025-05-19 23:21:34,478 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:34,478 - INFO - [__main__] - Getting last prediction point for ticker: PTL
2025-05-19 23:21:34,478 - INFO - [__main__] - ==================================================
2025-05-19 23:21:34,478 - INFO - [__main__] - Preparing test data for PTL...
2025-05-19 23:21:34,507 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:34,507 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:34,507 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:34,525 - INFO - [src.data_preparation] - Ticker PTL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:34,527 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(320), np.int64(1): np.int64(319)}
2025-05-19 23:21:34,870 - INFO - [src.data_preparation] - Ticker PTL - Selected features:
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   vnipc_t: 0.0770
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   SK: 0.0711
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   Volatility: 0.0689
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   TVV: 0.0685
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   insec_t: 0.0673
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   s_d7_t: 0.0629
2025-05-19 23:21:34,871 - INFO - [src.data_preparation] -   ma21_t: 0.0598
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   ret: 0.0590
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   variation_t: 0.0531
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   SR: 0.0512
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   ma14_t: 0.0503
2025-05-19 23:21:34,872 - INFO - [src.data_preparation] -   ATR: 0.0496
2025-05-19 23:21:34,877 - INFO - [src.data_preparation] - Ticker PTL - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'TVV', 'insec_t', 's_d7_t', 'ma21_t', 'ret', 'ma7_t', 'variation_t', 'Median_HL', 'SR', 'PM', 'ma14_t', 'ATR']
2025-05-19 23:21:34,985 - INFO - [src.data_preparation] - Ticker PTL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:34,987 - INFO - [src.data_preparation] - Ticker PTL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:34,990 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTL
2025-05-19 23:21:34,990 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:34,990 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:21:34,991 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:21:34,992 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:21:34,993 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:21:34,997 - INFO - [src.data_preparation] - Ticker PTL - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:34,998 - INFO - [__main__] - Using best model for PTL: transformer (F1: 0.5806)
2025-05-19 23:21:34,999 - INFO - [__main__] - Loading transformer model for PTL...
2025-05-19 23:21:35,022 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:35,030 - INFO - [__main__] - Model size: 0.42 MB
2025-05-19 23:21:35,030 - INFO - [__main__] - Making predictions for PTL using transformer
2025-05-19 23:21:35,032 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:35,033 - INFO - [__main__] - Successfully got last prediction for PTL
2025-05-19 23:21:35,033 - INFO - [__main__] - 
Processing ticker: PTP
2025-05-19 23:21:35,033 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:35,033 - INFO - [__main__] - Getting last prediction point for ticker: PTP
2025-05-19 23:21:35,033 - INFO - [__main__] - ==================================================
2025-05-19 23:21:35,034 - INFO - [__main__] - Preparing test data for PTP...
2025-05-19 23:21:35,101 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:35,101 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:35,101 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:35,139 - INFO - [src.data_preparation] - Ticker PTP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:35,140 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(113), np.int64(1): np.int64(526)}
2025-05-19 23:21:35,457 - INFO - [src.data_preparation] - Ticker PTP - Selected features:
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   vnipc_t: 0.1251
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   TVV: 0.0904
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   ma7_t: 0.0725
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   s_d7_t: 0.0709
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   Volatility: 0.0709
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   ma21_t: 0.0702
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   ma14_t: 0.0677
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   ATR: 0.0640
2025-05-19 23:21:35,458 - INFO - [src.data_preparation] -   SK: 0.0566
2025-05-19 23:21:35,459 - INFO - [src.data_preparation] -   Median_HL: 0.0522
2025-05-19 23:21:35,459 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:21:35,459 - INFO - [src.data_preparation] -   ret: 0.0391
2025-05-19 23:21:35,459 - INFO - [src.data_preparation] -   insec_t: 0.0363
2025-05-19 23:21:35,459 - INFO - [src.data_preparation] -   variation_t: 0.0361
2025-05-19 23:21:35,459 - INFO - [src.data_preparation] -   HL: 0.0329
2025-05-19 23:21:35,462 - INFO - [src.data_preparation] - Ticker PTP - Using features: ['Date', 'vnipc_t', 'TVV', 'ma7_t', 's_d7_t', 'Volatility', 'ma21_t', 'ma14_t', 'ATR', 'SK', 'Median_HL', 'PM', 'ret', 'insec_t', 'variation_t', 'HL']
2025-05-19 23:21:35,566 - INFO - [src.data_preparation] - Ticker PTP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:35,566 - INFO - [src.data_preparation] - Ticker PTP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:35,569 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTP
2025-05-19 23:21:35,569 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:35,569 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(77), np.int64(1): np.int64(386)}
2025-05-19 23:21:35,569 - INFO - [src.data_preparation] - Generating 309 synthetic minority samples
2025-05-19 23:21:35,581 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (772, 13, 15), y shape: (772,)
2025-05-19 23:21:35,582 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(386), np.int64(1): np.int64(386)}
2025-05-19 23:21:35,586 - INFO - [src.data_preparation] - Ticker PTP - Final 3D shapes: X_train=(772, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:35,587 - INFO - [__main__] - Using best model for PTP: svm (F1: 0.6441)
2025-05-19 23:21:35,587 - INFO - [__main__] - Loading svm model for PTP...
2025-05-19 23:21:35,589 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:35,589 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:21:35,589 - INFO - [__main__] - Making predictions for PTP using svm
2025-05-19 23:21:35,589 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:35,590 - INFO - [__main__] - Successfully got last prediction for PTP
2025-05-19 23:21:35,590 - INFO - [__main__] - 
Processing ticker: PTS
2025-05-19 23:21:35,590 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:35,590 - INFO - [__main__] - Getting last prediction point for ticker: PTS
2025-05-19 23:21:35,590 - INFO - [__main__] - ==================================================
2025-05-19 23:21:35,590 - INFO - [__main__] - Preparing test data for PTS...
2025-05-19 23:21:35,616 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:35,616 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:35,616 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:35,635 - INFO - [src.data_preparation] - Ticker PTS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:35,635 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(245), np.int64(1): np.int64(394)}
2025-05-19 23:21:35,943 - INFO - [src.data_preparation] - Ticker PTS - Selected features:
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   ATR: 0.0738
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   TVV: 0.0737
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   vnipc_t: 0.0717
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   insec_t: 0.0700
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   Volatility: 0.0697
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   s_d7_t: 0.0678
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   SK: 0.0629
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   HL: 0.0558
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   ma21_t: 0.0553
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   SR: 0.0513
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   variation_t: 0.0507
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   LO: 0.0505
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   ret: 0.0502
2025-05-19 23:21:35,944 - INFO - [src.data_preparation] -   ma14_t: 0.0500
2025-05-19 23:21:35,945 - INFO - [src.data_preparation] -   PM: 0.0489
2025-05-19 23:21:35,948 - INFO - [src.data_preparation] - Ticker PTS - Using features: ['Date', 'ATR', 'TVV', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'SK', 'HL', 'ma21_t', 'SR', 'variation_t', 'LO', 'ret', 'ma14_t', 'PM']
2025-05-19 23:21:36,029 - INFO - [src.data_preparation] - Ticker PTS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:36,029 - INFO - [src.data_preparation] - Ticker PTS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:36,030 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTS
2025-05-19 23:21:36,031 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:36,031 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:21:36,031 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:21:36,036 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:21:36,036 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:21:36,039 - INFO - [src.data_preparation] - Ticker PTS - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:36,039 - INFO - [__main__] - Using best model for PTS: transformer (F1: 0.7536)
2025-05-19 23:21:36,040 - INFO - [__main__] - Loading transformer model for PTS...
2025-05-19 23:21:36,051 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:36,055 - INFO - [__main__] - Model size: 0.34 MB
2025-05-19 23:21:36,055 - INFO - [__main__] - Making predictions for PTS using transformer
2025-05-19 23:21:36,058 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:36,059 - INFO - [__main__] - Successfully got last prediction for PTS
2025-05-19 23:21:36,059 - INFO - [__main__] - 
Processing ticker: PTT
2025-05-19 23:21:36,059 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:36,060 - INFO - [__main__] - Getting last prediction point for ticker: PTT
2025-05-19 23:21:36,060 - INFO - [__main__] - ==================================================
2025-05-19 23:21:36,060 - INFO - [__main__] - Preparing test data for PTT...
2025-05-19 23:21:36,103 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:36,103 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:36,103 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:36,122 - INFO - [src.data_preparation] - Ticker PTT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:36,122 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(180), np.int64(1): np.int64(459)}
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] - Ticker PTT - Selected features:
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   vnipc_t: 0.0896
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   ma21_t: 0.0733
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   ma14_t: 0.0708
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   Volatility: 0.0700
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   ATR: 0.0691
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   ma7_t: 0.0659
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   s_d7_t: 0.0653
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   PM: 0.0543
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   insec_t: 0.0523
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   HL: 0.0477
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   variation_t: 0.0438
2025-05-19 23:21:36,423 - INFO - [src.data_preparation] -   ret: 0.0432
2025-05-19 23:21:36,427 - INFO - [src.data_preparation] - Ticker PTT - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'Volatility', 'ATR', 'ma7_t', 's_d7_t', 'SK', 'TVV', 'PM', 'insec_t', 'Median_HL', 'HL', 'variation_t', 'ret']
2025-05-19 23:21:36,511 - INFO - [src.data_preparation] - Ticker PTT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:36,511 - INFO - [src.data_preparation] - Ticker PTT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:36,513 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PTT
2025-05-19 23:21:36,513 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:36,513 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(124), np.int64(1): np.int64(339)}
2025-05-19 23:21:36,513 - INFO - [src.data_preparation] - Generating 215 synthetic minority samples
2025-05-19 23:21:36,522 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (678, 13, 15), y shape: (678,)
2025-05-19 23:21:36,522 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(339), np.int64(1): np.int64(339)}
2025-05-19 23:21:36,526 - INFO - [src.data_preparation] - Ticker PTT - Final 3D shapes: X_train=(678, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:36,526 - INFO - [__main__] - Using best model for PTT: svm (F1: 0.8108)
2025-05-19 23:21:36,526 - INFO - [__main__] - Loading svm model for PTT...
2025-05-19 23:21:36,528 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:36,529 - INFO - [__main__] - Model size: 1.02 MB
2025-05-19 23:21:36,529 - INFO - [__main__] - Making predictions for PTT using svm
2025-05-19 23:21:36,529 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:36,529 - INFO - [__main__] - Successfully got last prediction for PTT
2025-05-19 23:21:36,529 - INFO - [__main__] - 
Processing ticker: PV2
2025-05-19 23:21:36,530 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:36,530 - INFO - [__main__] - Getting last prediction point for ticker: PV2
2025-05-19 23:21:36,530 - INFO - [__main__] - ==================================================
2025-05-19 23:21:36,530 - INFO - [__main__] - Preparing test data for PV2...
2025-05-19 23:21:36,562 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:36,562 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:36,562 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:36,585 - INFO - [src.data_preparation] - Ticker PV2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:36,585 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(224), np.int64(1): np.int64(415)}
2025-05-19 23:21:36,846 - INFO - [src.data_preparation] - Ticker PV2 - Selected features:
2025-05-19 23:21:36,846 - INFO - [src.data_preparation] -   vnipc_t: 0.0864
2025-05-19 23:21:36,846 - INFO - [src.data_preparation] -   insec_t: 0.0766
2025-05-19 23:21:36,846 - INFO - [src.data_preparation] -   s_d7_t: 0.0713
2025-05-19 23:21:36,846 - INFO - [src.data_preparation] -   TVV: 0.0713
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   ma14_t: 0.0683
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   Volatility: 0.0680
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   ma21_t: 0.0665
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   SK: 0.0628
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   Median_HL: 0.0617
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   ma7_t: 0.0613
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   ATR: 0.0547
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   ret: 0.0516
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   variation_t: 0.0467
2025-05-19 23:21:36,847 - INFO - [src.data_preparation] -   HL: 0.0309
2025-05-19 23:21:36,850 - INFO - [src.data_preparation] - Ticker PV2 - Using features: ['Date', 'vnipc_t', 'insec_t', 's_d7_t', 'TVV', 'ma14_t', 'Volatility', 'ma21_t', 'SK', 'Median_HL', 'ma7_t', 'ATR', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:36,935 - INFO - [src.data_preparation] - Ticker PV2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:36,935 - INFO - [src.data_preparation] - Ticker PV2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:36,937 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PV2
2025-05-19 23:21:36,937 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:36,937 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(157), np.int64(1): np.int64(306)}
2025-05-19 23:21:36,937 - INFO - [src.data_preparation] - Generating 149 synthetic minority samples
2025-05-19 23:21:36,942 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (612, 13, 15), y shape: (612,)
2025-05-19 23:21:36,942 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(306), np.int64(1): np.int64(306)}
2025-05-19 23:21:36,945 - INFO - [src.data_preparation] - Ticker PV2 - Final 3D shapes: X_train=(612, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:36,945 - INFO - [__main__] - Using best model for PV2: svm (F1: 0.8108)
2025-05-19 23:21:36,945 - INFO - [__main__] - Loading svm model for PV2...
2025-05-19 23:21:36,948 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:36,948 - INFO - [__main__] - Model size: 0.92 MB
2025-05-19 23:21:36,949 - INFO - [__main__] - Making predictions for PV2 using svm
2025-05-19 23:21:36,949 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:36,949 - INFO - [__main__] - Successfully got last prediction for PV2
2025-05-19 23:21:36,949 - INFO - [__main__] - 
Processing ticker: PVA
2025-05-19 23:21:36,949 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:36,949 - INFO - [__main__] - Getting last prediction point for ticker: PVA
2025-05-19 23:21:36,949 - INFO - [__main__] - ==================================================
2025-05-19 23:21:36,949 - INFO - [__main__] - Preparing test data for PVA...
2025-05-19 23:21:36,985 - INFO - [src.data_preparation] - After processing - X shape: (623, 19), y shape: (623,)
2025-05-19 23:21:36,985 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:36,985 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:37,003 - INFO - [src.data_preparation] - Ticker PVA - Original shapes: X=(623, 18), y=(623,)
2025-05-19 23:21:37,003 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(203), np.int64(1): np.int64(420)}
2025-05-19 23:21:37,221 - INFO - [src.data_preparation] - Ticker PVA - Selected features:
2025-05-19 23:21:37,221 - INFO - [src.data_preparation] -   vnipc_t: 0.1032
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   insec_t: 0.0831
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   TVV: 0.0812
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   ma14_t: 0.0775
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   Volatility: 0.0730
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   ma21_t: 0.0728
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   ma7_t: 0.0676
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   s_d7_t: 0.0633
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   ATR: 0.0576
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   SK: 0.0554
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   ret: 0.0406
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   variation_t: 0.0398
2025-05-19 23:21:37,222 - INFO - [src.data_preparation] -   SR: 0.0271
2025-05-19 23:21:37,225 - INFO - [src.data_preparation] - Ticker PVA - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'ma14_t', 'Volatility', 'ma21_t', 'ma7_t', 's_d7_t', 'ATR', 'SK', 'Median_HL', 'PM', 'ret', 'variation_t', 'SR']
2025-05-19 23:21:37,306 - INFO - [src.data_preparation] - Ticker PVA - 2D shapes: X_train=(447, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:37,306 - INFO - [src.data_preparation] - Ticker PVA - 3D shapes: X_train=(447, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:37,308 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVA
2025-05-19 23:21:37,308 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (447, 13, 15), y shape: (447,)
2025-05-19 23:21:37,308 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(151), np.int64(1): np.int64(296)}
2025-05-19 23:21:37,309 - INFO - [src.data_preparation] - Generating 145 synthetic minority samples
2025-05-19 23:21:37,316 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:21:37,316 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:21:37,320 - INFO - [src.data_preparation] - Ticker PVA - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:37,321 - INFO - [__main__] - Using best model for PVA: svm (F1: 0.9885)
2025-05-19 23:21:37,321 - INFO - [__main__] - Loading svm model for PVA...
2025-05-19 23:21:37,322 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:37,323 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:21:37,323 - INFO - [__main__] - Making predictions for PVA using svm
2025-05-19 23:21:37,324 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:37,324 - INFO - [__main__] - Successfully got last prediction for PVA
2025-05-19 23:21:37,324 - INFO - [__main__] - 
Processing ticker: PVC
2025-05-19 23:21:37,324 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:37,324 - INFO - [__main__] - Getting last prediction point for ticker: PVC
2025-05-19 23:21:37,324 - INFO - [__main__] - ==================================================
2025-05-19 23:21:37,324 - INFO - [__main__] - Preparing test data for PVC...
2025-05-19 23:21:37,353 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:37,353 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:37,353 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:37,387 - INFO - [src.data_preparation] - Ticker PVC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:37,387 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(301), np.int64(1): np.int64(338)}
2025-05-19 23:21:37,734 - INFO - [src.data_preparation] - Ticker PVC - Selected features:
2025-05-19 23:21:37,734 - INFO - [src.data_preparation] -   SK: 0.0785
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   Volatility: 0.0756
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   vnipc_t: 0.0676
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   insec_t: 0.0664
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   ma21_t: 0.0616
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   s_d7_t: 0.0577
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   Median_HL: 0.0573
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   TVV: 0.0563
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   LO: 0.0545
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   HL: 0.0545
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   ma14_t: 0.0535
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   PM: 0.0527
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   ret: 0.0502
2025-05-19 23:21:37,735 - INFO - [src.data_preparation] -   variation_t: 0.0499
2025-05-19 23:21:37,739 - INFO - [src.data_preparation] - Ticker PVC - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'insec_t', 'ma21_t', 'ATR', 's_d7_t', 'Median_HL', 'TVV', 'LO', 'HL', 'ma14_t', 'PM', 'ret', 'variation_t']
2025-05-19 23:21:37,824 - INFO - [src.data_preparation] - Ticker PVC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:37,824 - INFO - [src.data_preparation] - Ticker PVC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:37,826 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVC
2025-05-19 23:21:37,826 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:37,826 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:21:37,826 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:21:37,827 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:21:37,828 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:21:37,831 - INFO - [src.data_preparation] - Ticker PVC - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:37,831 - INFO - [__main__] - Using best model for PVC: logistic_regression (F1: 0.6182)
2025-05-19 23:21:37,831 - INFO - [__main__] - Loading logistic_regression model for PVC...
2025-05-19 23:21:37,832 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:37,832 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:37,832 - INFO - [__main__] - Making predictions for PVC using logistic_regression
2025-05-19 23:21:37,832 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:37,833 - INFO - [__main__] - Successfully got last prediction for PVC
2025-05-19 23:21:37,833 - INFO - [__main__] - 
Processing ticker: PVD
2025-05-19 23:21:37,833 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:37,833 - INFO - [__main__] - Getting last prediction point for ticker: PVD
2025-05-19 23:21:37,833 - INFO - [__main__] - ==================================================
2025-05-19 23:21:37,833 - INFO - [__main__] - Preparing test data for PVD...
2025-05-19 23:21:37,864 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:37,864 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:37,864 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:37,883 - INFO - [src.data_preparation] - Ticker PVD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:37,883 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(337)}
2025-05-19 23:21:38,200 - INFO - [src.data_preparation] - Ticker PVD - Selected features:
2025-05-19 23:21:38,200 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:21:38,200 - INFO - [src.data_preparation] -   insec_t: 0.0639
2025-05-19 23:21:38,200 - INFO - [src.data_preparation] -   s_d7_t: 0.0630
2025-05-19 23:21:38,200 - INFO - [src.data_preparation] -   vnipc_t: 0.0625
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   Volatility: 0.0619
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   SK: 0.0610
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   ATR: 0.0597
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   LO: 0.0587
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   ma21_t: 0.0586
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   HL: 0.0584
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   ma14_t: 0.0557
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   ret: 0.0556
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   SR: 0.0549
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   PM: 0.0517
2025-05-19 23:21:38,201 - INFO - [src.data_preparation] -   variation_t: 0.0516
2025-05-19 23:21:38,204 - INFO - [src.data_preparation] - Ticker PVD - Using features: ['Date', 'TVV', 'insec_t', 's_d7_t', 'vnipc_t', 'Volatility', 'SK', 'ATR', 'LO', 'ma21_t', 'HL', 'ma14_t', 'ret', 'SR', 'PM', 'variation_t']
2025-05-19 23:21:38,289 - INFO - [src.data_preparation] - Ticker PVD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:38,289 - INFO - [src.data_preparation] - Ticker PVD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:38,291 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVD
2025-05-19 23:21:38,291 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:38,291 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(218), np.int64(1): np.int64(245)}
2025-05-19 23:21:38,291 - INFO - [src.data_preparation] - Generating 27 synthetic minority samples
2025-05-19 23:21:38,293 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (490, 13, 15), y shape: (490,)
2025-05-19 23:21:38,293 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(245), np.int64(1): np.int64(245)}
2025-05-19 23:21:38,296 - INFO - [src.data_preparation] - Ticker PVD - Final 3D shapes: X_train=(490, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:38,296 - INFO - [__main__] - Using best model for PVD: transformer (F1: 0.6296)
2025-05-19 23:21:38,296 - INFO - [__main__] - Loading transformer model for PVD...
2025-05-19 23:21:38,312 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:38,317 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:21:38,317 - INFO - [__main__] - Making predictions for PVD using transformer
2025-05-19 23:21:38,320 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:38,321 - INFO - [__main__] - Successfully got last prediction for PVD
2025-05-19 23:21:38,321 - INFO - [__main__] - 
Processing ticker: PVE
2025-05-19 23:21:38,321 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:38,321 - INFO - [__main__] - Getting last prediction point for ticker: PVE
2025-05-19 23:21:38,321 - INFO - [__main__] - ==================================================
2025-05-19 23:21:38,321 - INFO - [__main__] - Preparing test data for PVE...
2025-05-19 23:21:38,359 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:38,360 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:38,360 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:38,383 - INFO - [src.data_preparation] - Ticker PVE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:38,383 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(269), np.int64(1): np.int64(370)}
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] - Ticker PVE - Selected features:
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   vnipc_t: 0.0786
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   SK: 0.0724
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   TVV: 0.0710
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   Volatility: 0.0701
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   s_d7_t: 0.0665
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   insec_t: 0.0623
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   ma14_t: 0.0616
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   ma21_t: 0.0591
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   variation_t: 0.0569
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   ATR: 0.0562
2025-05-19 23:21:38,694 - INFO - [src.data_preparation] -   HL: 0.0555
2025-05-19 23:21:38,695 - INFO - [src.data_preparation] -   ma7_t: 0.0529
2025-05-19 23:21:38,695 - INFO - [src.data_preparation] -   ret: 0.0510
2025-05-19 23:21:38,695 - INFO - [src.data_preparation] -   PM: 0.0506
2025-05-19 23:21:38,695 - INFO - [src.data_preparation] -   Median_HL: 0.0502
2025-05-19 23:21:38,698 - INFO - [src.data_preparation] - Ticker PVE - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'Volatility', 's_d7_t', 'insec_t', 'ma14_t', 'ma21_t', 'variation_t', 'ATR', 'HL', 'ma7_t', 'ret', 'PM', 'Median_HL']
2025-05-19 23:21:38,787 - INFO - [src.data_preparation] - Ticker PVE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:38,787 - INFO - [src.data_preparation] - Ticker PVE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:38,788 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVE
2025-05-19 23:21:38,788 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:38,788 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(191), np.int64(1): np.int64(272)}
2025-05-19 23:21:38,789 - INFO - [src.data_preparation] - Generating 81 synthetic minority samples
2025-05-19 23:21:38,792 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (544, 13, 15), y shape: (544,)
2025-05-19 23:21:38,792 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(272), np.int64(1): np.int64(272)}
2025-05-19 23:21:38,795 - INFO - [src.data_preparation] - Ticker PVE - Final 3D shapes: X_train=(544, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:38,795 - INFO - [__main__] - Using best model for PVE: lstm (F1: 0.7606)
2025-05-19 23:21:38,795 - INFO - [__main__] - Loading lstm model for PVE...
2025-05-19 23:21:38,801 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:38,802 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:21:38,802 - INFO - [__main__] - Making predictions for PVE using lstm
2025-05-19 23:21:38,803 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:38,804 - INFO - [__main__] - Successfully got last prediction for PVE
2025-05-19 23:21:38,804 - INFO - [__main__] - 
Processing ticker: PVG
2025-05-19 23:21:38,805 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:38,805 - INFO - [__main__] - Getting last prediction point for ticker: PVG
2025-05-19 23:21:38,805 - INFO - [__main__] - ==================================================
2025-05-19 23:21:38,805 - INFO - [__main__] - Preparing test data for PVG...
2025-05-19 23:21:38,874 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:38,874 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:38,874 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:38,897 - INFO - [src.data_preparation] - Ticker PVG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:38,897 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(355)}
2025-05-19 23:21:39,305 - INFO - [src.data_preparation] - Ticker PVG - Selected features:
2025-05-19 23:21:39,305 - INFO - [src.data_preparation] -   insec_t: 0.0720
2025-05-19 23:21:39,306 - INFO - [src.data_preparation] -   vnipc_t: 0.0647
2025-05-19 23:21:39,306 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:21:39,306 - INFO - [src.data_preparation] -   TVV: 0.0636
2025-05-19 23:21:39,306 - INFO - [src.data_preparation] -   SK: 0.0608
2025-05-19 23:21:39,306 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:21:39,306 - INFO - [src.data_preparation] -   LO: 0.0599
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   PM: 0.0598
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   ma21_t: 0.0597
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   HL: 0.0582
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   ma14_t: 0.0580
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   Median_HL: 0.0560
2025-05-19 23:21:39,307 - INFO - [src.data_preparation] -   SR: 0.0505
2025-05-19 23:21:39,312 - INFO - [src.data_preparation] - Ticker PVG - Using features: ['Date', 'insec_t', 'vnipc_t', 'Volatility', 'TVV', 'SK', 'ATR', 'LO', 'PM', 'ma21_t', 's_d7_t', 'HL', 'ma14_t', 'ma7_t', 'Median_HL', 'SR']
2025-05-19 23:21:39,430 - INFO - [src.data_preparation] - Ticker PVG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:39,430 - INFO - [src.data_preparation] - Ticker PVG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:39,432 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVG
2025-05-19 23:21:39,432 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:39,432 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(258)}
2025-05-19 23:21:39,433 - INFO - [src.data_preparation] - Generating 53 synthetic minority samples
2025-05-19 23:21:39,439 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:21:39,439 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:21:39,445 - INFO - [src.data_preparation] - Ticker PVG - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:39,445 - INFO - [__main__] - Using best model for PVG: logistic_regression (F1: 0.5833)
2025-05-19 23:21:39,446 - INFO - [__main__] - Loading logistic_regression model for PVG...
2025-05-19 23:21:39,447 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:39,447 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:39,448 - INFO - [__main__] - Making predictions for PVG using logistic_regression
2025-05-19 23:21:39,448 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:39,449 - INFO - [__main__] - Successfully got last prediction for PVG
2025-05-19 23:21:39,449 - INFO - [__main__] - 
Processing ticker: PVI
2025-05-19 23:21:39,449 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:39,449 - INFO - [__main__] - Getting last prediction point for ticker: PVI
2025-05-19 23:21:39,449 - INFO - [__main__] - ==================================================
2025-05-19 23:21:39,449 - INFO - [__main__] - Preparing test data for PVI...
2025-05-19 23:21:39,481 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:39,481 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:39,481 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:39,503 - INFO - [src.data_preparation] - Ticker PVI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:39,503 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(292), np.int64(1): np.int64(347)}
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] - Ticker PVI - Selected features:
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   SK: 0.0774
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   Volatility: 0.0681
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   vnipc_t: 0.0670
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   SR: 0.0643
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   ATR: 0.0643
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   TVV: 0.0622
2025-05-19 23:21:39,945 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:21:39,947 - INFO - [src.data_preparation] -   HL: 0.0609
2025-05-19 23:21:39,947 - INFO - [src.data_preparation] -   LO: 0.0602
2025-05-19 23:21:39,947 - INFO - [src.data_preparation] -   insec_t: 0.0590
2025-05-19 23:21:39,947 - INFO - [src.data_preparation] -   ret: 0.0588
2025-05-19 23:21:39,947 - INFO - [src.data_preparation] -   variation_t: 0.0582
2025-05-19 23:21:39,947 - INFO - [src.data_preparation] -   ma14_t: 0.0501
2025-05-19 23:21:39,948 - INFO - [src.data_preparation] -   Median_HL: 0.0479
2025-05-19 23:21:39,948 - INFO - [src.data_preparation] -   ma7_t: 0.0470
2025-05-19 23:21:39,952 - INFO - [src.data_preparation] - Ticker PVI - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'SR', 'ATR', 'TVV', 's_d7_t', 'HL', 'LO', 'insec_t', 'ret', 'variation_t', 'ma14_t', 'Median_HL', 'ma7_t']
2025-05-19 23:21:40,048 - INFO - [src.data_preparation] - Ticker PVI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:40,048 - INFO - [src.data_preparation] - Ticker PVI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:40,050 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVI
2025-05-19 23:21:40,050 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:40,050 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:21:40,050 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:21:40,053 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:21:40,053 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:21:40,057 - INFO - [src.data_preparation] - Ticker PVI - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:40,057 - INFO - [__main__] - Using best model for PVI: svm (F1: 0.6522)
2025-05-19 23:21:40,058 - INFO - [__main__] - Loading svm model for PVI...
2025-05-19 23:21:40,058 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:40,059 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:21:40,059 - INFO - [__main__] - Making predictions for PVI using svm
2025-05-19 23:21:40,059 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:40,060 - INFO - [__main__] - Successfully got last prediction for PVI
2025-05-19 23:21:40,060 - INFO - [__main__] - 
Processing ticker: PVL
2025-05-19 23:21:40,060 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:40,060 - INFO - [__main__] - Getting last prediction point for ticker: PVL
2025-05-19 23:21:40,060 - INFO - [__main__] - ==================================================
2025-05-19 23:21:40,060 - INFO - [__main__] - Preparing test data for PVL...
2025-05-19 23:21:40,089 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:40,089 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:40,089 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:40,108 - INFO - [src.data_preparation] - Ticker PVL - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:40,108 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(248), np.int64(1): np.int64(390)}
2025-05-19 23:21:40,359 - INFO - [src.data_preparation] - Ticker PVL - Selected features:
2025-05-19 23:21:40,359 - INFO - [src.data_preparation] -   vnipc_t: 0.0798
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   Volatility: 0.0759
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   insec_t: 0.0753
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   s_d7_t: 0.0702
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   SK: 0.0701
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   ma21_t: 0.0672
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   TVV: 0.0631
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   ma14_t: 0.0603
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   ma7_t: 0.0600
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   ret: 0.0547
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   ATR: 0.0524
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   variation_t: 0.0470
2025-05-19 23:21:40,360 - INFO - [src.data_preparation] -   HL: 0.0381
2025-05-19 23:21:40,363 - INFO - [src.data_preparation] - Ticker PVL - Using features: ['Date', 'vnipc_t', 'Volatility', 'insec_t', 's_d7_t', 'SK', 'ma21_t', 'TVV', 'ma14_t', 'ma7_t', 'ret', 'Median_HL', 'PM', 'ATR', 'variation_t', 'HL']
2025-05-19 23:21:40,470 - INFO - [src.data_preparation] - Ticker PVL - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:21:40,471 - INFO - [src.data_preparation] - Ticker PVL - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:40,474 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVL
2025-05-19 23:21:40,474 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:40,474 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(175), np.int64(1): np.int64(288)}
2025-05-19 23:21:40,475 - INFO - [src.data_preparation] - Generating 113 synthetic minority samples
2025-05-19 23:21:40,481 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (576, 13, 15), y shape: (576,)
2025-05-19 23:21:40,481 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(288), np.int64(1): np.int64(288)}
2025-05-19 23:21:40,485 - INFO - [src.data_preparation] - Ticker PVL - Final 3D shapes: X_train=(576, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:40,487 - INFO - [__main__] - Using best model for PVL: svm (F1: 0.8108)
2025-05-19 23:21:40,487 - INFO - [__main__] - Loading svm model for PVL...
2025-05-19 23:21:40,489 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:40,490 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:21:40,491 - INFO - [__main__] - Making predictions for PVL using svm
2025-05-19 23:21:40,491 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:40,492 - INFO - [__main__] - Successfully got last prediction for PVL
2025-05-19 23:21:40,492 - INFO - [__main__] - 
Processing ticker: PVR
2025-05-19 23:21:40,492 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:40,492 - INFO - [__main__] - Getting last prediction point for ticker: PVR
2025-05-19 23:21:40,492 - INFO - [__main__] - ==================================================
2025-05-19 23:21:40,492 - INFO - [__main__] - Preparing test data for PVR...
2025-05-19 23:21:40,522 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:40,522 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:40,523 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:40,545 - INFO - [src.data_preparation] - Ticker PVR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:40,545 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(219), np.int64(1): np.int64(420)}
2025-05-19 23:21:40,824 - INFO - [src.data_preparation] - Ticker PVR - Selected features:
2025-05-19 23:21:40,824 - INFO - [src.data_preparation] -   vnipc_t: 0.0831
2025-05-19 23:21:40,824 - INFO - [src.data_preparation] -   s_d7_t: 0.0763
2025-05-19 23:21:40,824 - INFO - [src.data_preparation] -   TVV: 0.0734
2025-05-19 23:21:40,824 - INFO - [src.data_preparation] -   Volatility: 0.0729
2025-05-19 23:21:40,824 - INFO - [src.data_preparation] -   SK: 0.0725
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   ma14_t: 0.0713
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   insec_t: 0.0706
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   ma21_t: 0.0642
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   ma7_t: 0.0639
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   ATR: 0.0582
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   Median_HL: 0.0484
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   ret: 0.0445
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   variation_t: 0.0442
2025-05-19 23:21:40,825 - INFO - [src.data_preparation] -   HL: 0.0394
2025-05-19 23:21:40,828 - INFO - [src.data_preparation] - Ticker PVR - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'Volatility', 'SK', 'ma14_t', 'insec_t', 'ma21_t', 'ma7_t', 'ATR', 'PM', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:40,921 - INFO - [src.data_preparation] - Ticker PVR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:40,921 - INFO - [src.data_preparation] - Ticker PVR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:40,923 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVR
2025-05-19 23:21:40,923 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:40,924 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(156), np.int64(1): np.int64(307)}
2025-05-19 23:21:40,924 - INFO - [src.data_preparation] - Generating 151 synthetic minority samples
2025-05-19 23:21:40,932 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (614, 13, 15), y shape: (614,)
2025-05-19 23:21:40,933 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(307), np.int64(1): np.int64(307)}
2025-05-19 23:21:40,938 - INFO - [src.data_preparation] - Ticker PVR - Final 3D shapes: X_train=(614, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:40,939 - INFO - [__main__] - Using best model for PVR: lstm (F1: 0.8861)
2025-05-19 23:21:40,939 - INFO - [__main__] - Loading lstm model for PVR...
2025-05-19 23:21:40,944 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:40,946 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:21:40,946 - INFO - [__main__] - Making predictions for PVR using lstm
2025-05-19 23:21:40,948 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:40,948 - INFO - [__main__] - Successfully got last prediction for PVR
2025-05-19 23:21:40,949 - INFO - [__main__] - 
Processing ticker: PVS
2025-05-19 23:21:40,949 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:40,949 - INFO - [__main__] - Getting last prediction point for ticker: PVS
2025-05-19 23:21:40,949 - INFO - [__main__] - ==================================================
2025-05-19 23:21:40,949 - INFO - [__main__] - Preparing test data for PVS...
2025-05-19 23:21:40,987 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:40,988 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:40,989 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:41,015 - INFO - [src.data_preparation] - Ticker PVS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:41,015 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(281), np.int64(1): np.int64(358)}
2025-05-19 23:21:41,378 - INFO - [src.data_preparation] - Ticker PVS - Selected features:
2025-05-19 23:21:41,378 - INFO - [src.data_preparation] -   insec_t: 0.0777
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   Volatility: 0.0693
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   LO: 0.0639
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   ma21_t: 0.0604
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   TVV: 0.0578
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   ATR: 0.0577
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   SR: 0.0577
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   ma14_t: 0.0572
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   vnipc_t: 0.0572
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   ret: 0.0563
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   HL: 0.0548
2025-05-19 23:21:41,379 - INFO - [src.data_preparation] -   ma7_t: 0.0546
2025-05-19 23:21:41,380 - INFO - [src.data_preparation] -   s_d7_t: 0.0544
2025-05-19 23:21:41,380 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:21:41,382 - INFO - [src.data_preparation] - Ticker PVS - Using features: ['Date', 'insec_t', 'Volatility', 'SK', 'LO', 'ma21_t', 'TVV', 'ATR', 'SR', 'ma14_t', 'vnipc_t', 'ret', 'HL', 'ma7_t', 's_d7_t', 'Median_HL']
2025-05-19 23:21:41,479 - INFO - [src.data_preparation] - Ticker PVS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:41,479 - INFO - [src.data_preparation] - Ticker PVS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:41,481 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVS
2025-05-19 23:21:41,481 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:41,481 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:21:41,482 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:21:41,485 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:21:41,485 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:21:41,488 - INFO - [src.data_preparation] - Ticker PVS - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:41,489 - INFO - [__main__] - Using best model for PVS: svm (F1: 0.6250)
2025-05-19 23:21:41,489 - INFO - [__main__] - Loading svm model for PVS...
2025-05-19 23:21:41,492 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:41,493 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:21:41,494 - INFO - [__main__] - Making predictions for PVS using svm
2025-05-19 23:21:41,495 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:41,495 - INFO - [__main__] - Successfully got last prediction for PVS
2025-05-19 23:21:41,495 - INFO - [__main__] - 
Processing ticker: PVT
2025-05-19 23:21:41,495 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:41,495 - INFO - [__main__] - Getting last prediction point for ticker: PVT
2025-05-19 23:21:41,495 - INFO - [__main__] - ==================================================
2025-05-19 23:21:41,495 - INFO - [__main__] - Preparing test data for PVT...
2025-05-19 23:21:41,523 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:41,524 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:41,524 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:41,554 - INFO - [src.data_preparation] - Ticker PVT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:41,554 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] - Ticker PVT - Selected features:
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   SK: 0.0701
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   s_d7_t: 0.0700
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   insec_t: 0.0652
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   LO: 0.0651
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   vnipc_t: 0.0619
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   ma14_t: 0.0572
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   ATR: 0.0568
2025-05-19 23:21:41,875 - INFO - [src.data_preparation] -   ma21_t: 0.0565
2025-05-19 23:21:41,877 - INFO - [src.data_preparation] -   HL: 0.0557
2025-05-19 23:21:41,877 - INFO - [src.data_preparation] -   SR: 0.0556
2025-05-19 23:21:41,877 - INFO - [src.data_preparation] -   Median_HL: 0.0541
2025-05-19 23:21:41,877 - INFO - [src.data_preparation] -   PM: 0.0537
2025-05-19 23:21:41,877 - INFO - [src.data_preparation] -   ma7_t: 0.0525
2025-05-19 23:21:41,879 - INFO - [src.data_preparation] - Ticker PVT - Using features: ['Date', 'SK', 's_d7_t', 'Volatility', 'insec_t', 'LO', 'vnipc_t', 'TVV', 'ma14_t', 'ATR', 'ma21_t', 'HL', 'SR', 'Median_HL', 'PM', 'ma7_t']
2025-05-19 23:21:41,982 - INFO - [src.data_preparation] - Ticker PVT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:41,982 - INFO - [src.data_preparation] - Ticker PVT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:41,984 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVT
2025-05-19 23:21:41,984 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:41,984 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:21:41,984 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:21:41,988 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:21:41,989 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:21:41,992 - INFO - [src.data_preparation] - Ticker PVT - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:41,993 - INFO - [__main__] - Using best model for PVT: transformer (F1: 0.3200)
2025-05-19 23:21:41,993 - INFO - [__main__] - Loading transformer model for PVT...
2025-05-19 23:21:42,014 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:42,022 - INFO - [__main__] - Model size: 0.60 MB
2025-05-19 23:21:42,022 - INFO - [__main__] - Making predictions for PVT using transformer
2025-05-19 23:21:42,027 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:42,027 - INFO - [__main__] - Successfully got last prediction for PVT
2025-05-19 23:21:42,027 - INFO - [__main__] - 
Processing ticker: PVV
2025-05-19 23:21:42,028 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:42,028 - INFO - [__main__] - Getting last prediction point for ticker: PVV
2025-05-19 23:21:42,028 - INFO - [__main__] - ==================================================
2025-05-19 23:21:42,028 - INFO - [__main__] - Preparing test data for PVV...
2025-05-19 23:21:42,094 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:42,094 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:42,094 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:42,132 - INFO - [src.data_preparation] - Ticker PVV - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:42,132 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(234), np.int64(1): np.int64(404)}
2025-05-19 23:21:42,523 - INFO - [src.data_preparation] - Ticker PVV - Selected features:
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   vnipc_t: 0.0856
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   insec_t: 0.0822
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   s_d7_t: 0.0766
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   TVV: 0.0746
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   Volatility: 0.0703
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   ma21_t: 0.0687
2025-05-19 23:21:42,524 - INFO - [src.data_preparation] -   ma14_t: 0.0657
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   ma7_t: 0.0643
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   ATR: 0.0572
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   PM: 0.0566
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   SK: 0.0560
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   Median_HL: 0.0511
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   variation_t: 0.0486
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   ret: 0.0476
2025-05-19 23:21:42,525 - INFO - [src.data_preparation] -   SR: 0.0321
2025-05-19 23:21:42,530 - INFO - [src.data_preparation] - Ticker PVV - Using features: ['Date', 'vnipc_t', 'insec_t', 's_d7_t', 'TVV', 'Volatility', 'ma21_t', 'ma14_t', 'ma7_t', 'ATR', 'PM', 'SK', 'Median_HL', 'variation_t', 'ret', 'SR']
2025-05-19 23:21:42,644 - INFO - [src.data_preparation] - Ticker PVV - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:42,645 - INFO - [src.data_preparation] - Ticker PVV - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:42,648 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVV
2025-05-19 23:21:42,649 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:42,649 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(158), np.int64(1): np.int64(304)}
2025-05-19 23:21:42,649 - INFO - [src.data_preparation] - Generating 146 synthetic minority samples
2025-05-19 23:21:42,654 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (608, 13, 15), y shape: (608,)
2025-05-19 23:21:42,655 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(304), np.int64(1): np.int64(304)}
2025-05-19 23:21:42,658 - INFO - [src.data_preparation] - Ticker PVV - Final 3D shapes: X_train=(608, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:42,659 - INFO - [__main__] - Using best model for PVV: lstm (F1: 0.8000)
2025-05-19 23:21:42,659 - INFO - [__main__] - Loading lstm model for PVV...
2025-05-19 23:21:42,664 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:42,665 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:21:42,665 - INFO - [__main__] - Making predictions for PVV using lstm
2025-05-19 23:21:42,668 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:42,668 - INFO - [__main__] - Successfully got last prediction for PVV
2025-05-19 23:21:42,668 - INFO - [__main__] - 
Processing ticker: PVX
2025-05-19 23:21:42,668 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:42,669 - INFO - [__main__] - Getting last prediction point for ticker: PVX
2025-05-19 23:21:42,669 - INFO - [__main__] - ==================================================
2025-05-19 23:21:42,669 - INFO - [__main__] - Preparing test data for PVX...
2025-05-19 23:21:42,715 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:42,715 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:42,715 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:42,742 - INFO - [src.data_preparation] - Ticker PVX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:42,742 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] - Ticker PVX - Selected features:
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   Volatility: 0.0802
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   insec_t: 0.0794
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   TVV: 0.0725
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   SK: 0.0713
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   ma21_t: 0.0677
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   s_d7_t: 0.0677
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   ma14_t: 0.0646
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   Median_HL: 0.0574
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   ma7_t: 0.0573
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   PM: 0.0560
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   variation_t: 0.0480
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   ATR: 0.0397
2025-05-19 23:21:43,065 - INFO - [src.data_preparation] -   HL: 0.0379
2025-05-19 23:21:43,069 - INFO - [src.data_preparation] - Ticker PVX - Using features: ['Date', 'Volatility', 'insec_t', 'vnipc_t', 'TVV', 'SK', 'ma21_t', 's_d7_t', 'ma14_t', 'Median_HL', 'ma7_t', 'PM', 'ret', 'variation_t', 'ATR', 'HL']
2025-05-19 23:21:43,178 - INFO - [src.data_preparation] - Ticker PVX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:43,178 - INFO - [src.data_preparation] - Ticker PVX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:43,181 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PVX
2025-05-19 23:21:43,181 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:43,182 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(178), np.int64(1): np.int64(285)}
2025-05-19 23:21:43,182 - INFO - [src.data_preparation] - Generating 107 synthetic minority samples
2025-05-19 23:21:43,190 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (570, 13, 15), y shape: (570,)
2025-05-19 23:21:43,190 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(285), np.int64(1): np.int64(285)}
2025-05-19 23:21:43,194 - INFO - [src.data_preparation] - Ticker PVX - Final 3D shapes: X_train=(570, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:43,195 - INFO - [__main__] - Using best model for PVX: lstm (F1: 0.7778)
2025-05-19 23:21:43,195 - INFO - [__main__] - Loading lstm model for PVX...
2025-05-19 23:21:43,200 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:43,202 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:21:43,202 - INFO - [__main__] - Making predictions for PVX using lstm
2025-05-19 23:21:43,203 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:43,204 - INFO - [__main__] - Successfully got last prediction for PVX
2025-05-19 23:21:43,204 - INFO - [__main__] - 
Processing ticker: PX1
2025-05-19 23:21:43,204 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:43,204 - INFO - [__main__] - Getting last prediction point for ticker: PX1
2025-05-19 23:21:43,204 - INFO - [__main__] - ==================================================
2025-05-19 23:21:43,204 - INFO - [__main__] - Preparing test data for PX1...
2025-05-19 23:21:43,259 - INFO - [src.data_preparation] - After processing - X shape: (588, 19), y shape: (588,)
2025-05-19 23:21:43,259 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:43,259 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:43,295 - INFO - [src.data_preparation] - Ticker PX1 - Original shapes: X=(588, 18), y=(588,)
2025-05-19 23:21:43,295 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(6), np.int64(1): np.int64(582)}
2025-05-19 23:21:43,504 - INFO - [src.data_preparation] - Ticker PX1 - Selected features:
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   vnipc_t: 0.9126
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   ma21_t: 0.0440
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   MDD: 0.0212
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   ma14_t: 0.0125
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   ma7_t: 0.0034
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   Median_HL: 0.0028
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   PM: 0.0027
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   s_d7_t: 0.0003
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   ATR: 0.0002
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   Volatility: 0.0002
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   TVV: 0.0001
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   SK: 0.0000
2025-05-19 23:21:43,505 - INFO - [src.data_preparation] -   ret: 0.0000
2025-05-19 23:21:43,506 - INFO - [src.data_preparation] -   variation_t: 0.0000
2025-05-19 23:21:43,506 - INFO - [src.data_preparation] -   HL: 0.0000
2025-05-19 23:21:43,508 - INFO - [src.data_preparation] - Ticker PX1 - Using features: ['Date', 'vnipc_t', 'ma21_t', 'MDD', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 's_d7_t', 'ATR', 'Volatility', 'TVV', 'SK', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:43,589 - INFO - [src.data_preparation] - Ticker PX1 - 2D shapes: X_train=(412, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:43,589 - INFO - [src.data_preparation] - Ticker PX1 - 3D shapes: X_train=(412, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:43,591 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE for ticker PX1 - insufficient samples per class or only one class
2025-05-19 23:21:43,594 - INFO - [src.data_preparation] - Ticker PX1 - Final 3D shapes: X_train=(412, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:43,594 - INFO - [__main__] - Using best model for PX1: lstm (F1: 0.9885)
2025-05-19 23:21:43,594 - INFO - [__main__] - Loading lstm model for PX1...
2025-05-19 23:21:43,598 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:43,598 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:21:43,598 - INFO - [__main__] - Making predictions for PX1 using lstm
2025-05-19 23:21:43,598 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:43,598 - INFO - [__main__] - Successfully got last prediction for PX1
2025-05-19 23:21:43,598 - INFO - [__main__] - 
Processing ticker: PXA
2025-05-19 23:21:43,598 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:43,598 - INFO - [__main__] - Getting last prediction point for ticker: PXA
2025-05-19 23:21:43,598 - INFO - [__main__] - ==================================================
2025-05-19 23:21:43,598 - INFO - [__main__] - Preparing test data for PXA...
2025-05-19 23:21:43,647 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:43,648 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:43,648 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:43,675 - INFO - [src.data_preparation] - Ticker PXA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:43,676 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(233), np.int64(1): np.int64(406)}
2025-05-19 23:21:44,035 - INFO - [src.data_preparation] - Ticker PXA - Selected features:
2025-05-19 23:21:44,035 - INFO - [src.data_preparation] -   vnipc_t: 0.0892
2025-05-19 23:21:44,035 - INFO - [src.data_preparation] -   TVV: 0.0767
2025-05-19 23:21:44,035 - INFO - [src.data_preparation] -   ma7_t: 0.0701
2025-05-19 23:21:44,035 - INFO - [src.data_preparation] -   ma21_t: 0.0695
2025-05-19 23:21:44,036 - INFO - [src.data_preparation] -   Volatility: 0.0673
2025-05-19 23:21:44,036 - INFO - [src.data_preparation] -   ma14_t: 0.0654
2025-05-19 23:21:44,036 - INFO - [src.data_preparation] -   insec_t: 0.0654
2025-05-19 23:21:44,036 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:21:44,036 - INFO - [src.data_preparation] -   SK: 0.0623
2025-05-19 23:21:44,037 - INFO - [src.data_preparation] -   PM: 0.0559
2025-05-19 23:21:44,037 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:21:44,037 - INFO - [src.data_preparation] -   ATR: 0.0499
2025-05-19 23:21:44,037 - INFO - [src.data_preparation] -   ret: 0.0479
2025-05-19 23:21:44,037 - INFO - [src.data_preparation] -   variation_t: 0.0467
2025-05-19 23:21:44,038 - INFO - [src.data_preparation] -   HL: 0.0456
2025-05-19 23:21:44,041 - INFO - [src.data_preparation] - Ticker PXA - Using features: ['Date', 'vnipc_t', 'TVV', 'ma7_t', 'ma21_t', 'Volatility', 'ma14_t', 'insec_t', 's_d7_t', 'SK', 'PM', 'Median_HL', 'ATR', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:44,135 - INFO - [src.data_preparation] - Ticker PXA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:44,136 - INFO - [src.data_preparation] - Ticker PXA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:44,137 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PXA
2025-05-19 23:21:44,137 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:44,137 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:21:44,137 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:21:44,146 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:21:44,147 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:21:44,152 - INFO - [src.data_preparation] - Ticker PXA - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:44,153 - INFO - [__main__] - Using best model for PXA: lstm (F1: 0.7945)
2025-05-19 23:21:44,153 - INFO - [__main__] - Loading lstm model for PXA...
2025-05-19 23:21:44,156 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:44,158 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:21:44,158 - INFO - [__main__] - Making predictions for PXA using lstm
2025-05-19 23:21:44,162 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:44,162 - INFO - [__main__] - Successfully got last prediction for PXA
2025-05-19 23:21:44,163 - INFO - [__main__] - 
Processing ticker: PXI
2025-05-19 23:21:44,163 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:44,163 - INFO - [__main__] - Getting last prediction point for ticker: PXI
2025-05-19 23:21:44,163 - INFO - [__main__] - ==================================================
2025-05-19 23:21:44,163 - INFO - [__main__] - Preparing test data for PXI...
2025-05-19 23:21:44,221 - INFO - [src.data_preparation] - After processing - X shape: (629, 19), y shape: (629,)
2025-05-19 23:21:44,222 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:44,222 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:44,253 - INFO - [src.data_preparation] - Ticker PXI - Original shapes: X=(629, 18), y=(629,)
2025-05-19 23:21:44,253 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(327)}
2025-05-19 23:21:44,643 - INFO - [src.data_preparation] - Ticker PXI - Selected features:
2025-05-19 23:21:44,643 - INFO - [src.data_preparation] -   vnipc_t: 0.0768
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   SK: 0.0661
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   ma7_t: 0.0623
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   ret: 0.0593
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   ma14_t: 0.0572
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   variation_t: 0.0568
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   ma21_t: 0.0567
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   PM: 0.0552
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   ATR: 0.0512
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:21:44,644 - INFO - [src.data_preparation] -   SR: 0.0479
2025-05-19 23:21:44,647 - INFO - [src.data_preparation] - Ticker PXI - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'Volatility', 's_d7_t', 'ma7_t', 'insec_t', 'ret', 'ma14_t', 'variation_t', 'ma21_t', 'PM', 'ATR', 'Median_HL', 'SR']
2025-05-19 23:21:44,734 - INFO - [src.data_preparation] - Ticker PXI - 2D shapes: X_train=(463, 195), X_valid=(80, 195), X_test=(45, 195)
2025-05-19 23:21:44,734 - INFO - [src.data_preparation] - Ticker PXI - 3D shapes: X_train=(463, 13, 15), X_valid=(80, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:44,736 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PXI
2025-05-19 23:21:44,736 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:44,736 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:21:44,736 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:21:44,738 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:21:44,738 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:21:44,741 - INFO - [src.data_preparation] - Ticker PXI - Final 3D shapes: X_train=(470, 13, 15), X_valid=(80, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:44,741 - INFO - [__main__] - Using best model for PXI: logistic_regression (F1: 0.7164)
2025-05-19 23:21:44,741 - INFO - [__main__] - Loading logistic_regression model for PXI...
2025-05-19 23:21:44,743 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:44,743 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:44,744 - INFO - [__main__] - Making predictions for PXI using logistic_regression
2025-05-19 23:21:44,744 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:44,744 - INFO - [__main__] - Successfully got last prediction for PXI
2025-05-19 23:21:44,744 - INFO - [__main__] - 
Processing ticker: PXL
2025-05-19 23:21:44,744 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:44,745 - INFO - [__main__] - Getting last prediction point for ticker: PXL
2025-05-19 23:21:44,745 - INFO - [__main__] - ==================================================
2025-05-19 23:21:44,745 - INFO - [__main__] - Preparing test data for PXL...
2025-05-19 23:21:44,784 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:44,784 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:44,784 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:44,823 - INFO - [src.data_preparation] - Ticker PXL - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:44,823 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(348)}
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] - Ticker PXL - Selected features:
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   TVV: 0.0770
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   insec_t: 0.0755
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   vnipc_t: 0.0752
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   SK: 0.0724
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   ATR: 0.0694
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   s_d7_t: 0.0622
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   ma14_t: 0.0606
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   ma7_t: 0.0582
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   PM: 0.0542
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   ret: 0.0540
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   Median_HL: 0.0519
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   variation_t: 0.0513
2025-05-19 23:21:45,238 - INFO - [src.data_preparation] -   HL: 0.0390
2025-05-19 23:21:45,245 - INFO - [src.data_preparation] - Ticker PXL - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 'SK', 'ATR', 'Volatility', 's_d7_t', 'ma14_t', 'ma21_t', 'ma7_t', 'PM', 'ret', 'Median_HL', 'variation_t', 'HL']
2025-05-19 23:21:45,357 - INFO - [src.data_preparation] - Ticker PXL - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:45,357 - INFO - [src.data_preparation] - Ticker PXL - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:45,360 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PXL
2025-05-19 23:21:45,360 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:45,360 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(261)}
2025-05-19 23:21:45,360 - INFO - [src.data_preparation] - Generating 60 synthetic minority samples
2025-05-19 23:21:45,365 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:21:45,365 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:21:45,369 - INFO - [src.data_preparation] - Ticker PXL - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:45,369 - INFO - [__main__] - Using best model for PXL: svm (F1: 0.6250)
2025-05-19 23:21:45,369 - INFO - [__main__] - Loading svm model for PXL...
2025-05-19 23:21:45,370 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:45,370 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:21:45,370 - INFO - [__main__] - Making predictions for PXL using svm
2025-05-19 23:21:45,370 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:45,370 - INFO - [__main__] - Successfully got last prediction for PXL
2025-05-19 23:21:45,370 - INFO - [__main__] - 
Processing ticker: PXM
2025-05-19 23:21:45,370 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:45,370 - INFO - [__main__] - Getting last prediction point for ticker: PXM
2025-05-19 23:21:45,370 - INFO - [__main__] - ==================================================
2025-05-19 23:21:45,370 - INFO - [__main__] - Preparing test data for PXM...
2025-05-19 23:21:45,440 - INFO - [src.data_preparation] - After processing - X shape: (633, 19), y shape: (633,)
2025-05-19 23:21:45,441 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:45,441 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:45,469 - INFO - [src.data_preparation] - Ticker PXM - Original shapes: X=(633, 18), y=(633,)
2025-05-19 23:21:45,469 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(181), np.int64(1): np.int64(452)}
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] - Ticker PXM - Selected features:
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   vnipc_t: 0.0966
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   TVV: 0.0894
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   insec_t: 0.0893
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   ma21_t: 0.0795
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   ma14_t: 0.0766
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   Volatility: 0.0678
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   ma7_t: 0.0647
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   s_d7_t: 0.0581
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   ATR: 0.0567
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   SK: 0.0545
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   Median_HL: 0.0533
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   ret: 0.0386
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   variation_t: 0.0374
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] -   HL: 0.0287
2025-05-19 23:21:45,768 - INFO - [src.data_preparation] - Ticker PXM - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ma21_t', 'ma14_t', 'Volatility', 'ma7_t', 's_d7_t', 'ATR', 'SK', 'Median_HL', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:21:45,878 - INFO - [src.data_preparation] - Ticker PXM - 2D shapes: X_train=(457, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:45,878 - INFO - [src.data_preparation] - Ticker PXM - 3D shapes: X_train=(457, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:45,888 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PXM
2025-05-19 23:21:45,888 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (457, 13, 15), y shape: (457,)
2025-05-19 23:21:45,888 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(122), np.int64(1): np.int64(335)}
2025-05-19 23:21:45,888 - INFO - [src.data_preparation] - Generating 213 synthetic minority samples
2025-05-19 23:21:45,898 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (670, 13, 15), y shape: (670,)
2025-05-19 23:21:45,898 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(335), np.int64(1): np.int64(335)}
2025-05-19 23:21:45,902 - INFO - [src.data_preparation] - Ticker PXM - Final 3D shapes: X_train=(670, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:45,902 - INFO - [__main__] - Using best model for PXM: lstm (F1: 0.8571)
2025-05-19 23:21:45,902 - INFO - [__main__] - Loading lstm model for PXM...
2025-05-19 23:21:45,907 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:45,908 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:21:45,908 - INFO - [__main__] - Making predictions for PXM using lstm
2025-05-19 23:21:45,910 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:45,910 - INFO - [__main__] - Successfully got last prediction for PXM
2025-05-19 23:21:45,910 - INFO - [__main__] - 
Processing ticker: PXS
2025-05-19 23:21:45,910 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:45,910 - INFO - [__main__] - Getting last prediction point for ticker: PXS
2025-05-19 23:21:45,911 - INFO - [__main__] - ==================================================
2025-05-19 23:21:45,911 - INFO - [__main__] - Preparing test data for PXS...
2025-05-19 23:21:45,981 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:45,981 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:45,981 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:46,010 - INFO - [src.data_preparation] - Ticker PXS - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:46,010 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] - Ticker PXS - Selected features:
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   SK: 0.0721
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   insec_t: 0.0687
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   s_d7_t: 0.0678
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   TVV: 0.0645
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   Volatility: 0.0644
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   ma21_t: 0.0608
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   vnipc_t: 0.0592
2025-05-19 23:21:46,379 - INFO - [src.data_preparation] -   ma14_t: 0.0592
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   ret: 0.0565
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   HL: 0.0561
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   ma7_t: 0.0557
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   ATR: 0.0534
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   variation_t: 0.0517
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   PM: 0.0500
2025-05-19 23:21:46,380 - INFO - [src.data_preparation] -   SR: 0.0492
2025-05-19 23:21:46,383 - INFO - [src.data_preparation] - Ticker PXS - Using features: ['Date', 'SK', 'insec_t', 's_d7_t', 'TVV', 'Volatility', 'ma21_t', 'vnipc_t', 'ma14_t', 'ret', 'HL', 'ma7_t', 'ATR', 'variation_t', 'PM', 'SR']
2025-05-19 23:21:46,484 - INFO - [src.data_preparation] - Ticker PXS - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:21:46,485 - INFO - [src.data_preparation] - Ticker PXS - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:46,487 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PXS
2025-05-19 23:21:46,487 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:46,487 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(226)}
2025-05-19 23:21:46,487 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:21:46,488 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:21:46,488 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:21:46,491 - INFO - [src.data_preparation] - Ticker PXS - Final 3D shapes: X_train=(474, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:46,492 - INFO - [__main__] - Using best model for PXS: transformer (F1: 0.4651)
2025-05-19 23:21:46,492 - INFO - [__main__] - Loading transformer model for PXS...
2025-05-19 23:21:46,503 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:46,507 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:21:46,507 - INFO - [__main__] - Making predictions for PXS using transformer
2025-05-19 23:21:46,509 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:46,509 - INFO - [__main__] - Successfully got last prediction for PXS
2025-05-19 23:21:46,510 - INFO - [__main__] - 
Processing ticker: PXT
2025-05-19 23:21:46,510 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:46,510 - INFO - [__main__] - Getting last prediction point for ticker: PXT
2025-05-19 23:21:46,510 - INFO - [__main__] - ==================================================
2025-05-19 23:21:46,510 - INFO - [__main__] - Preparing test data for PXT...
2025-05-19 23:21:46,568 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:46,569 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:46,569 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:46,605 - INFO - [src.data_preparation] - Ticker PXT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:46,605 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(312), np.int64(1): np.int64(326)}
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] - Ticker PXT - Selected features:
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   vnipc_t: 0.0796
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   Volatility: 0.0678
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   ma21_t: 0.0662
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   TVV: 0.0648
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   ma14_t: 0.0640
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   SK: 0.0614
2025-05-19 23:21:47,030 - INFO - [src.data_preparation] -   ret: 0.0595
2025-05-19 23:21:47,031 - INFO - [src.data_preparation] -   ma7_t: 0.0548
2025-05-19 23:21:47,031 - INFO - [src.data_preparation] -   variation_t: 0.0542
2025-05-19 23:21:47,031 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:21:47,031 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:21:47,032 - INFO - [src.data_preparation] -   SR: 0.0485
2025-05-19 23:21:47,032 - INFO - [src.data_preparation] -   ATR: 0.0484
2025-05-19 23:21:47,036 - INFO - [src.data_preparation] - Ticker PXT - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'ma21_t', 'TVV', 'ma14_t', 's_d7_t', 'SK', 'ret', 'ma7_t', 'variation_t', 'PM', 'Median_HL', 'SR', 'ATR']
2025-05-19 23:21:47,132 - INFO - [src.data_preparation] - Ticker PXT - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:47,132 - INFO - [src.data_preparation] - Ticker PXT - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:47,135 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker PXT
2025-05-19 23:21:47,135 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:47,135 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(234)}
2025-05-19 23:21:47,135 - INFO - [src.data_preparation] - Generating 6 synthetic minority samples
2025-05-19 23:21:47,136 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (468, 13, 15), y shape: (468,)
2025-05-19 23:21:47,136 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(234), np.int64(1): np.int64(234)}
2025-05-19 23:21:47,140 - INFO - [src.data_preparation] - Ticker PXT - Final 3D shapes: X_train=(468, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:47,140 - INFO - [__main__] - Using best model for PXT: transformer (F1: 0.4762)
2025-05-19 23:21:47,140 - INFO - [__main__] - Loading transformer model for PXT...
2025-05-19 23:21:47,156 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:47,161 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:21:47,162 - INFO - [__main__] - Making predictions for PXT using transformer
2025-05-19 23:21:47,165 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:47,166 - INFO - [__main__] - Successfully got last prediction for PXT
2025-05-19 23:21:47,166 - INFO - [__main__] - 
Processing ticker: QCC
2025-05-19 23:21:47,166 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:47,166 - INFO - [__main__] - Getting last prediction point for ticker: QCC
2025-05-19 23:21:47,166 - INFO - [__main__] - ==================================================
2025-05-19 23:21:47,166 - INFO - [__main__] - Preparing test data for QCC...
2025-05-19 23:21:47,216 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:47,217 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:47,217 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:47,252 - INFO - [src.data_preparation] - Ticker QCC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:47,252 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(182), np.int64(1): np.int64(456)}
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] - Ticker QCC - Selected features:
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   ma21_t: 0.0713
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   vnipc_t: 0.0708
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   ma14_t: 0.0687
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   s_d7_t: 0.0664
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   TVV: 0.0653
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   SK: 0.0626
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   ATR: 0.0616
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   ma7_t: 0.0601
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   Median_HL: 0.0584
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   PM: 0.0553
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   insec_t: 0.0539
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   ret: 0.0499
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   HL: 0.0483
2025-05-19 23:21:47,605 - INFO - [src.data_preparation] -   variation_t: 0.0450
2025-05-19 23:21:47,608 - INFO - [src.data_preparation] - Ticker QCC - Using features: ['Date', 'ma21_t', 'vnipc_t', 'Volatility', 'ma14_t', 's_d7_t', 'TVV', 'SK', 'ATR', 'ma7_t', 'Median_HL', 'PM', 'insec_t', 'ret', 'HL', 'variation_t']
2025-05-19 23:21:47,699 - INFO - [src.data_preparation] - Ticker QCC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:47,699 - INFO - [src.data_preparation] - Ticker QCC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:47,700 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker QCC
2025-05-19 23:21:47,700 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:47,701 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(143), np.int64(1): np.int64(319)}
2025-05-19 23:21:47,701 - INFO - [src.data_preparation] - Generating 176 synthetic minority samples
2025-05-19 23:21:47,709 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (638, 13, 15), y shape: (638,)
2025-05-19 23:21:47,709 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:21:47,713 - INFO - [src.data_preparation] - Ticker QCC - Final 3D shapes: X_train=(638, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:47,714 - INFO - [__main__] - Using best model for QCC: svm (F1: 0.8861)
2025-05-19 23:21:47,714 - INFO - [__main__] - Loading svm model for QCC...
2025-05-19 23:21:47,715 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:47,716 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:21:47,716 - INFO - [__main__] - Making predictions for QCC using svm
2025-05-19 23:21:47,717 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:47,717 - INFO - [__main__] - Successfully got last prediction for QCC
2025-05-19 23:21:47,717 - INFO - [__main__] - 
Processing ticker: QCG
2025-05-19 23:21:47,717 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:47,717 - INFO - [__main__] - Getting last prediction point for ticker: QCG
2025-05-19 23:21:47,717 - INFO - [__main__] - ==================================================
2025-05-19 23:21:47,717 - INFO - [__main__] - Preparing test data for QCG...
2025-05-19 23:21:47,746 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:47,746 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:47,746 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:47,765 - INFO - [src.data_preparation] - Ticker QCG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:47,765 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(337), np.int64(1): np.int64(302)}
2025-05-19 23:21:48,091 - INFO - [src.data_preparation] - Ticker QCG - Selected features:
2025-05-19 23:21:48,091 - INFO - [src.data_preparation] -   vnipc_t: 0.0716
2025-05-19 23:21:48,091 - INFO - [src.data_preparation] -   TVV: 0.0710
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   Volatility: 0.0633
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   SK: 0.0617
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   ma21_t: 0.0608
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   ATR: 0.0599
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   insec_t: 0.0591
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   ret: 0.0582
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   ma14_t: 0.0571
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   variation_t: 0.0561
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   ma7_t: 0.0561
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   PM: 0.0533
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:21:48,092 - INFO - [src.data_preparation] -   HL: 0.0502
2025-05-19 23:21:48,096 - INFO - [src.data_preparation] - Ticker QCG - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'SK', 's_d7_t', 'ma21_t', 'ATR', 'insec_t', 'ret', 'ma14_t', 'variation_t', 'ma7_t', 'PM', 'Median_HL', 'HL']
2025-05-19 23:21:48,187 - INFO - [src.data_preparation] - Ticker QCG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:48,187 - INFO - [src.data_preparation] - Ticker QCG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:48,189 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker QCG
2025-05-19 23:21:48,189 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:48,190 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(221)}
2025-05-19 23:21:48,190 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:21:48,191 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:21:48,191 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:21:48,194 - INFO - [src.data_preparation] - Ticker QCG - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:48,194 - INFO - [__main__] - Using best model for QCG: lstm (F1: 0.6667)
2025-05-19 23:21:48,194 - INFO - [__main__] - Loading lstm model for QCG...
2025-05-19 23:21:48,199 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:48,201 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:21:48,201 - INFO - [__main__] - Making predictions for QCG using lstm
2025-05-19 23:21:48,203 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:48,203 - INFO - [__main__] - Successfully got last prediction for QCG
2025-05-19 23:21:48,203 - INFO - [__main__] - 
Processing ticker: QNC
2025-05-19 23:21:48,203 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:48,203 - INFO - [__main__] - Getting last prediction point for ticker: QNC
2025-05-19 23:21:48,203 - INFO - [__main__] - ==================================================
2025-05-19 23:21:48,203 - INFO - [__main__] - Preparing test data for QNC...
2025-05-19 23:21:48,242 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:48,242 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:48,242 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:48,272 - INFO - [src.data_preparation] - Ticker QNC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:48,273 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:21:48,629 - INFO - [src.data_preparation] - Ticker QNC - Selected features:
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   TVV: 0.0725
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   ma21_t: 0.0725
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   SK: 0.0642
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   ma7_t: 0.0636
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   Volatility: 0.0622
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   ma14_t: 0.0621
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   s_d7_t: 0.0601
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   insec_t: 0.0568
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   ATR: 0.0535
2025-05-19 23:21:48,630 - INFO - [src.data_preparation] -   HL: 0.0509
2025-05-19 23:21:48,631 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:21:48,631 - INFO - [src.data_preparation] -   PM: 0.0501
2025-05-19 23:21:48,631 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:21:48,631 - INFO - [src.data_preparation] -   ret: 0.0496
2025-05-19 23:21:48,634 - INFO - [src.data_preparation] - Ticker QNC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'SK', 'ma7_t', 'Volatility', 'ma14_t', 's_d7_t', 'insec_t', 'ATR', 'HL', 'variation_t', 'PM', 'Median_HL', 'ret']
2025-05-19 23:21:48,734 - INFO - [src.data_preparation] - Ticker QNC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:48,734 - INFO - [src.data_preparation] - Ticker QNC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:48,735 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker QNC
2025-05-19 23:21:48,735 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:48,735 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(173), np.int64(1): np.int64(290)}
2025-05-19 23:21:48,735 - INFO - [src.data_preparation] - Generating 117 synthetic minority samples
2025-05-19 23:21:48,741 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (580, 13, 15), y shape: (580,)
2025-05-19 23:21:48,741 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(290), np.int64(1): np.int64(290)}
2025-05-19 23:21:48,744 - INFO - [src.data_preparation] - Ticker QNC - Final 3D shapes: X_train=(580, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:48,745 - INFO - [__main__] - Using best model for QNC: svm (F1: 0.6866)
2025-05-19 23:21:48,745 - INFO - [__main__] - Loading svm model for QNC...
2025-05-19 23:21:48,747 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:48,748 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:21:48,748 - INFO - [__main__] - Making predictions for QNC using svm
2025-05-19 23:21:48,749 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:48,749 - INFO - [__main__] - Successfully got last prediction for QNC
2025-05-19 23:21:48,749 - INFO - [__main__] - 
Processing ticker: QST
2025-05-19 23:21:48,749 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:48,749 - INFO - [__main__] - Getting last prediction point for ticker: QST
2025-05-19 23:21:48,750 - INFO - [__main__] - ==================================================
2025-05-19 23:21:48,750 - INFO - [__main__] - Preparing test data for QST...
2025-05-19 23:21:48,781 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:48,781 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:48,781 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:48,804 - INFO - [src.data_preparation] - Ticker QST - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:48,805 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(57), np.int64(1): np.int64(582)}
2025-05-19 23:21:49,071 - INFO - [src.data_preparation] - Ticker QST - Selected features:
2025-05-19 23:21:49,071 - INFO - [src.data_preparation] -   ma21_t: 0.1281
2025-05-19 23:21:49,071 - INFO - [src.data_preparation] -   vnipc_t: 0.1205
2025-05-19 23:21:49,071 - INFO - [src.data_preparation] -   ma14_t: 0.1085
2025-05-19 23:21:49,071 - INFO - [src.data_preparation] -   ma7_t: 0.0785
2025-05-19 23:21:49,071 - INFO - [src.data_preparation] -   PM: 0.0730
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   Median_HL: 0.0697
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   TVV: 0.0580
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   ATR: 0.0550
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   SK: 0.0457
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   insec_t: 0.0353
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   ret: 0.0244
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   SR: 0.0235
2025-05-19 23:21:49,072 - INFO - [src.data_preparation] -   variation_t: 0.0210
2025-05-19 23:21:49,075 - INFO - [src.data_preparation] - Ticker QST - Using features: ['Date', 'ma21_t', 'vnipc_t', 'ma14_t', 'ma7_t', 'PM', 'Median_HL', 's_d7_t', 'Volatility', 'TVV', 'ATR', 'SK', 'insec_t', 'ret', 'SR', 'variation_t']
2025-05-19 23:21:49,186 - INFO - [src.data_preparation] - Ticker QST - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:49,186 - INFO - [src.data_preparation] - Ticker QST - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:49,188 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker QST
2025-05-19 23:21:49,188 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:49,188 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(41), np.int64(1): np.int64(422)}
2025-05-19 23:21:49,188 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:21:49,192 - INFO - [src.data_preparation] - Ticker QST - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:49,193 - INFO - [__main__] - Using best model for QST: transformer (F1: 0.9383)
2025-05-19 23:21:49,193 - INFO - [__main__] - Loading transformer model for QST...
2025-05-19 23:21:49,205 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:49,211 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:21:49,211 - INFO - [__main__] - Making predictions for QST using transformer
2025-05-19 23:21:49,215 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:49,216 - INFO - [__main__] - Successfully got last prediction for QST
2025-05-19 23:21:49,216 - INFO - [__main__] - 
Processing ticker: QTC
2025-05-19 23:21:49,216 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:49,216 - INFO - [__main__] - Getting last prediction point for ticker: QTC
2025-05-19 23:21:49,217 - INFO - [__main__] - ==================================================
2025-05-19 23:21:49,217 - INFO - [__main__] - Preparing test data for QTC...
2025-05-19 23:21:49,274 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:49,274 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:49,274 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:49,309 - INFO - [src.data_preparation] - Ticker QTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:49,309 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(235), np.int64(1): np.int64(404)}
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] - Ticker QTC - Selected features:
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] -   ATR: 0.0718
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] -   vnipc_t: 0.0715
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] -   TVV: 0.0679
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] -   s_d7_t: 0.0673
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] -   Volatility: 0.0654
2025-05-19 23:21:49,679 - INFO - [src.data_preparation] -   SK: 0.0653
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   insec_t: 0.0642
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   ma14_t: 0.0607
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   Median_HL: 0.0595
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   ma7_t: 0.0588
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   ma21_t: 0.0587
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   PM: 0.0567
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   ret: 0.0502
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   HL: 0.0476
2025-05-19 23:21:49,680 - INFO - [src.data_preparation] -   variation_t: 0.0475
2025-05-19 23:21:49,683 - INFO - [src.data_preparation] - Ticker QTC - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'Volatility', 'SK', 'insec_t', 'ma14_t', 'Median_HL', 'ma7_t', 'ma21_t', 'PM', 'ret', 'HL', 'variation_t']
2025-05-19 23:21:49,769 - INFO - [src.data_preparation] - Ticker QTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:49,769 - INFO - [src.data_preparation] - Ticker QTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:49,771 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker QTC
2025-05-19 23:21:49,771 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:49,771 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(174), np.int64(1): np.int64(289)}
2025-05-19 23:21:49,771 - INFO - [src.data_preparation] - Generating 115 synthetic minority samples
2025-05-19 23:21:49,776 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (578, 13, 15), y shape: (578,)
2025-05-19 23:21:49,776 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(289), np.int64(1): np.int64(289)}
2025-05-19 23:21:49,780 - INFO - [src.data_preparation] - Ticker QTC - Final 3D shapes: X_train=(578, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:49,780 - INFO - [__main__] - Using best model for QTC: svm (F1: 0.8421)
2025-05-19 23:21:49,781 - INFO - [__main__] - Loading svm model for QTC...
2025-05-19 23:21:49,783 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:49,783 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:21:49,784 - INFO - [__main__] - Making predictions for QTC using svm
2025-05-19 23:21:49,784 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:49,784 - INFO - [__main__] - Successfully got last prediction for QTC
2025-05-19 23:21:49,785 - INFO - [__main__] - 
Processing ticker: RAL
2025-05-19 23:21:49,785 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:49,785 - INFO - [__main__] - Getting last prediction point for ticker: RAL
2025-05-19 23:21:49,785 - INFO - [__main__] - ==================================================
2025-05-19 23:21:49,785 - INFO - [__main__] - Preparing test data for RAL...
2025-05-19 23:21:49,824 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:49,824 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:49,824 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:49,849 - INFO - [src.data_preparation] - Ticker RAL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:49,849 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(293), np.int64(1): np.int64(346)}
2025-05-19 23:21:50,193 - INFO - [src.data_preparation] - Ticker RAL - Selected features:
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   insec_t: 0.0742
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   HL: 0.0728
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   LO: 0.0678
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   ATR: 0.0642
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   SK: 0.0634
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   Volatility: 0.0622
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   TVV: 0.0597
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   SR: 0.0572
2025-05-19 23:21:50,194 - INFO - [src.data_preparation] -   ret: 0.0532
2025-05-19 23:21:50,195 - INFO - [src.data_preparation] -   variation_t: 0.0495
2025-05-19 23:21:50,195 - INFO - [src.data_preparation] -   Median_HL: 0.0491
2025-05-19 23:21:50,195 - INFO - [src.data_preparation] -   PM: 0.0490
2025-05-19 23:21:50,195 - INFO - [src.data_preparation] -   ma21_t: 0.0478
2025-05-19 23:21:50,198 - INFO - [src.data_preparation] - Ticker RAL - Using features: ['Date', 'insec_t', 'HL', 'vnipc_t', 'LO', 's_d7_t', 'ATR', 'SK', 'Volatility', 'TVV', 'SR', 'ret', 'variation_t', 'Median_HL', 'PM', 'ma21_t']
2025-05-19 23:21:50,298 - INFO - [src.data_preparation] - Ticker RAL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:50,298 - INFO - [src.data_preparation] - Ticker RAL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:50,300 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker RAL
2025-05-19 23:21:50,300 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:50,300 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:21:50,300 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:21:50,303 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:21:50,303 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:21:50,307 - INFO - [src.data_preparation] - Ticker RAL - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:50,307 - INFO - [__main__] - Using best model for RAL: logistic_regression (F1: 0.6207)
2025-05-19 23:21:50,307 - INFO - [__main__] - Loading logistic_regression model for RAL...
2025-05-19 23:21:50,307 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:50,309 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:50,309 - INFO - [__main__] - Making predictions for RAL using logistic_regression
2025-05-19 23:21:50,309 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:50,309 - INFO - [__main__] - Successfully got last prediction for RAL
2025-05-19 23:21:50,309 - INFO - [__main__] - 
Processing ticker: RCL
2025-05-19 23:21:50,310 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:50,310 - INFO - [__main__] - Getting last prediction point for ticker: RCL
2025-05-19 23:21:50,310 - INFO - [__main__] - ==================================================
2025-05-19 23:21:50,310 - INFO - [__main__] - Preparing test data for RCL...
2025-05-19 23:21:50,343 - INFO - [src.data_preparation] - After processing - X shape: (587, 19), y shape: (587,)
2025-05-19 23:21:50,343 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:50,343 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:50,364 - INFO - [src.data_preparation] - Ticker RCL - Original shapes: X=(587, 18), y=(587,)
2025-05-19 23:21:50,364 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(250), np.int64(1): np.int64(337)}
2025-05-19 23:21:50,690 - INFO - [src.data_preparation] - Ticker RCL - Selected features:
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   SK: 0.0776
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   vnipc_t: 0.0724
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   TVV: 0.0638
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   ATR: 0.0637
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   Volatility: 0.0635
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   Median_HL: 0.0615
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   insec_t: 0.0615
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   HL: 0.0583
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   s_d7_t: 0.0579
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   PM: 0.0569
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   ma14_t: 0.0550
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   SR: 0.0540
2025-05-19 23:21:50,691 - INFO - [src.data_preparation] -   ma7_t: 0.0524
2025-05-19 23:21:50,692 - INFO - [src.data_preparation] -   variation_t: 0.0513
2025-05-19 23:21:50,692 - INFO - [src.data_preparation] -   ma21_t: 0.0511
2025-05-19 23:21:50,694 - INFO - [src.data_preparation] - Ticker RCL - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'ATR', 'Volatility', 'Median_HL', 'insec_t', 'HL', 's_d7_t', 'PM', 'ma14_t', 'SR', 'ma7_t', 'variation_t', 'ma21_t']
2025-05-19 23:21:50,795 - INFO - [src.data_preparation] - Ticker RCL - 2D shapes: X_train=(411, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:50,795 - INFO - [src.data_preparation] - Ticker RCL - 3D shapes: X_train=(411, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:50,797 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker RCL
2025-05-19 23:21:50,797 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (411, 13, 15), y shape: (411,)
2025-05-19 23:21:50,797 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(172), np.int64(1): np.int64(239)}
2025-05-19 23:21:50,797 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:21:50,801 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:21:50,801 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:21:50,801 - INFO - [src.data_preparation] - Ticker RCL - Final 3D shapes: X_train=(478, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:50,801 - INFO - [__main__] - Using best model for RCL: transformer (F1: 0.7761)
2025-05-19 23:21:50,801 - INFO - [__main__] - Loading transformer model for RCL...
2025-05-19 23:21:50,823 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:21:50,827 - INFO - [__main__] - Model size: 0.48 MB
2025-05-19 23:21:50,827 - INFO - [__main__] - Making predictions for RCL using transformer
2025-05-19 23:21:50,829 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:50,830 - INFO - [__main__] - Successfully got last prediction for RCL
2025-05-19 23:21:50,830 - INFO - [__main__] - 
Processing ticker: REE
2025-05-19 23:21:50,830 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:50,830 - INFO - [__main__] - Getting last prediction point for ticker: REE
2025-05-19 23:21:50,830 - INFO - [__main__] - ==================================================
2025-05-19 23:21:50,831 - INFO - [__main__] - Preparing test data for REE...
2025-05-19 23:21:50,885 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:50,887 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:50,887 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:50,915 - INFO - [src.data_preparation] - Ticker REE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:50,916 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(279), np.int64(1): np.int64(360)}
2025-05-19 23:21:51,333 - INFO - [src.data_preparation] - Ticker REE - Selected features:
2025-05-19 23:21:51,333 - INFO - [src.data_preparation] -   insec_t: 0.0743
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   SK: 0.0701
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   TVV: 0.0681
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   vnipc_t: 0.0654
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   LO: 0.0652
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   s_d7_t: 0.0603
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   SR: 0.0592
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   ret: 0.0555
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   HL: 0.0539
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   PM: 0.0508
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   ma21_t: 0.0502
2025-05-19 23:21:51,334 - INFO - [src.data_preparation] -   ma14_t: 0.0499
2025-05-19 23:21:51,338 - INFO - [src.data_preparation] - Ticker REE - Using features: ['Date', 'insec_t', 'SK', 'TVV', 'Volatility', 'vnipc_t', 'LO', 's_d7_t', 'SR', 'ATR', 'ret', 'HL', 'variation_t', 'PM', 'ma21_t', 'ma14_t']
2025-05-19 23:21:51,439 - INFO - [src.data_preparation] - Ticker REE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:51,439 - INFO - [src.data_preparation] - Ticker REE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:51,441 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker REE
2025-05-19 23:21:51,442 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:51,442 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:21:51,442 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:21:51,446 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:21:51,446 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:21:51,453 - INFO - [src.data_preparation] - Ticker REE - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:51,454 - INFO - [__main__] - Using best model for REE: svm (F1: 0.5106)
2025-05-19 23:21:51,454 - INFO - [__main__] - Loading svm model for REE...
2025-05-19 23:21:51,456 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:51,456 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:21:51,456 - INFO - [__main__] - Making predictions for REE using svm
2025-05-19 23:21:51,457 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:51,457 - INFO - [__main__] - Successfully got last prediction for REE
2025-05-19 23:21:51,457 - INFO - [__main__] - 
Processing ticker: RIC
2025-05-19 23:21:51,457 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:51,457 - INFO - [__main__] - Getting last prediction point for ticker: RIC
2025-05-19 23:21:51,458 - INFO - [__main__] - ==================================================
2025-05-19 23:21:51,458 - INFO - [__main__] - Preparing test data for RIC...
2025-05-19 23:21:51,517 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:51,517 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:51,517 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:51,543 - INFO - [src.data_preparation] - Ticker RIC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:51,544 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:21:51,921 - INFO - [src.data_preparation] - Ticker RIC - Selected features:
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   vnipc_t: 0.0766
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   TVV: 0.0690
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   insec_t: 0.0687
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   Volatility: 0.0682
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   SK: 0.0678
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   ATR: 0.0646
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   ret: 0.0561
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   Median_HL: 0.0561
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   s_d7_t: 0.0556
2025-05-19 23:21:51,922 - INFO - [src.data_preparation] -   ma21_t: 0.0554
2025-05-19 23:21:51,923 - INFO - [src.data_preparation] -   SR: 0.0545
2025-05-19 23:21:51,923 - INFO - [src.data_preparation] -   PM: 0.0531
2025-05-19 23:21:51,923 - INFO - [src.data_preparation] -   ma14_t: 0.0529
2025-05-19 23:21:51,923 - INFO - [src.data_preparation] -   ma7_t: 0.0524
2025-05-19 23:21:51,923 - INFO - [src.data_preparation] -   variation_t: 0.0506
2025-05-19 23:21:51,925 - INFO - [src.data_preparation] - Ticker RIC - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 'SK', 'ATR', 'ret', 'Median_HL', 's_d7_t', 'ma21_t', 'SR', 'PM', 'ma14_t', 'ma7_t', 'variation_t']
2025-05-19 23:21:52,021 - INFO - [src.data_preparation] - Ticker RIC - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:21:52,021 - INFO - [src.data_preparation] - Ticker RIC - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:52,023 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker RIC
2025-05-19 23:21:52,023 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:52,023 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(224)}
2025-05-19 23:21:52,023 - INFO - [src.data_preparation] - Generating 15 synthetic minority samples
2025-05-19 23:21:52,024 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:21:52,025 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:21:52,028 - INFO - [src.data_preparation] - Ticker RIC - Final 3D shapes: X_train=(478, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:52,028 - INFO - [__main__] - Using best model for RIC: lstm (F1: 0.7945)
2025-05-19 23:21:52,028 - INFO - [__main__] - Loading lstm model for RIC...
2025-05-19 23:21:52,032 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:52,034 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:21:52,034 - INFO - [__main__] - Making predictions for RIC using lstm
2025-05-19 23:21:52,035 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:52,036 - INFO - [__main__] - Successfully got last prediction for RIC
2025-05-19 23:21:52,036 - INFO - [__main__] - 
Processing ticker: S12
2025-05-19 23:21:52,036 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:52,036 - INFO - [__main__] - Getting last prediction point for ticker: S12
2025-05-19 23:21:52,036 - INFO - [__main__] - ==================================================
2025-05-19 23:21:52,036 - INFO - [__main__] - Preparing test data for S12...
2025-05-19 23:21:52,081 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:52,081 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:52,081 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:52,109 - INFO - [src.data_preparation] - Ticker S12 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:52,109 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(181), np.int64(1): np.int64(458)}
2025-05-19 23:21:52,402 - INFO - [src.data_preparation] - Ticker S12 - Selected features:
2025-05-19 23:21:52,403 - INFO - [src.data_preparation] -   vnipc_t: 0.0880
2025-05-19 23:21:52,403 - INFO - [src.data_preparation] -   ma21_t: 0.0802
2025-05-19 23:21:52,403 - INFO - [src.data_preparation] -   ATR: 0.0761
2025-05-19 23:21:52,403 - INFO - [src.data_preparation] -   Volatility: 0.0735
2025-05-19 23:21:52,403 - INFO - [src.data_preparation] -   ma14_t: 0.0710
2025-05-19 23:21:52,403 - INFO - [src.data_preparation] -   TVV: 0.0702
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   PM: 0.0670
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   s_d7_t: 0.0666
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   ma7_t: 0.0635
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   Median_HL: 0.0624
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   SK: 0.0551
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   insec_t: 0.0496
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   variation_t: 0.0414
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   ret: 0.0391
2025-05-19 23:21:52,404 - INFO - [src.data_preparation] -   HL: 0.0371
2025-05-19 23:21:52,407 - INFO - [src.data_preparation] - Ticker S12 - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ATR', 'Volatility', 'ma14_t', 'TVV', 'PM', 's_d7_t', 'ma7_t', 'Median_HL', 'SK', 'insec_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:21:52,512 - INFO - [src.data_preparation] - Ticker S12 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:52,513 - INFO - [src.data_preparation] - Ticker S12 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:52,514 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker S12
2025-05-19 23:21:52,514 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:52,514 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(137), np.int64(1): np.int64(326)}
2025-05-19 23:21:52,514 - INFO - [src.data_preparation] - Generating 189 synthetic minority samples
2025-05-19 23:21:52,522 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (652, 13, 15), y shape: (652,)
2025-05-19 23:21:52,522 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(326), np.int64(1): np.int64(326)}
2025-05-19 23:21:52,526 - INFO - [src.data_preparation] - Ticker S12 - Final 3D shapes: X_train=(652, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:52,526 - INFO - [__main__] - Using best model for S12: svm (F1: 0.9268)
2025-05-19 23:21:52,526 - INFO - [__main__] - Loading svm model for S12...
2025-05-19 23:21:52,529 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:52,530 - INFO - [__main__] - Model size: 0.98 MB
2025-05-19 23:21:52,530 - INFO - [__main__] - Making predictions for S12 using svm
2025-05-19 23:21:52,530 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:52,531 - INFO - [__main__] - Successfully got last prediction for S12
2025-05-19 23:21:52,531 - INFO - [__main__] - 
Processing ticker: S27
2025-05-19 23:21:52,531 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:52,531 - INFO - [__main__] - Getting last prediction point for ticker: S27
2025-05-19 23:21:52,531 - INFO - [__main__] - ==================================================
2025-05-19 23:21:52,531 - INFO - [__main__] - Preparing test data for S27...
2025-05-19 23:21:52,559 - INFO - [src.data_preparation] - After processing - X shape: (560, 19), y shape: (560,)
2025-05-19 23:21:52,559 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:52,559 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:52,577 - INFO - [src.data_preparation] - Ticker S27 - Original shapes: X=(560, 18), y=(560,)
2025-05-19 23:21:52,578 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(94), np.int64(1): np.int64(466)}
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] - Ticker S27 - Selected features:
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   vnipc_t: 0.1081
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   TVV: 0.1028
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   ma21_t: 0.0748
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   s_d7_t: 0.0722
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   Volatility: 0.0717
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   ma7_t: 0.0673
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   ma14_t: 0.0666
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   ATR: 0.0644
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   SK: 0.0619
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   Median_HL: 0.0551
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   PM: 0.0539
2025-05-19 23:21:52,768 - INFO - [src.data_preparation] -   ret: 0.0451
2025-05-19 23:21:52,769 - INFO - [src.data_preparation] -   variation_t: 0.0391
2025-05-19 23:21:52,769 - INFO - [src.data_preparation] -   insec_t: 0.0320
2025-05-19 23:21:52,769 - INFO - [src.data_preparation] -   MDD: 0.0307
2025-05-19 23:21:52,771 - INFO - [src.data_preparation] - Ticker S27 - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 's_d7_t', 'Volatility', 'ma7_t', 'ma14_t', 'ATR', 'SK', 'Median_HL', 'PM', 'ret', 'variation_t', 'insec_t', 'MDD']
2025-05-19 23:21:52,862 - INFO - [src.data_preparation] - Ticker S27 - 2D shapes: X_train=(384, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:52,862 - INFO - [src.data_preparation] - Ticker S27 - 3D shapes: X_train=(384, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:52,864 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker S27
2025-05-19 23:21:52,865 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (384, 13, 15), y shape: (384,)
2025-05-19 23:21:52,866 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(52), np.int64(1): np.int64(332)}
2025-05-19 23:21:52,866 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:21:52,869 - INFO - [src.data_preparation] - Ticker S27 - Final 3D shapes: X_train=(384, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:52,869 - INFO - [__main__] - Using best model for S27: lstm (F1: 0.9885)
2025-05-19 23:21:52,869 - INFO - [__main__] - Loading lstm model for S27...
2025-05-19 23:21:52,869 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:52,875 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:21:52,875 - INFO - [__main__] - Making predictions for S27 using lstm
2025-05-19 23:21:52,877 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:52,878 - INFO - [__main__] - Successfully got last prediction for S27
2025-05-19 23:21:52,878 - INFO - [__main__] - 
Processing ticker: S55
2025-05-19 23:21:52,878 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:52,878 - INFO - [__main__] - Getting last prediction point for ticker: S55
2025-05-19 23:21:52,878 - INFO - [__main__] - ==================================================
2025-05-19 23:21:52,878 - INFO - [__main__] - Preparing test data for S55...
2025-05-19 23:21:52,939 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:52,939 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:52,939 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:52,968 - INFO - [src.data_preparation] - Ticker S55 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:52,968 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(371)}
2025-05-19 23:21:53,344 - INFO - [src.data_preparation] - Ticker S55 - Selected features:
2025-05-19 23:21:53,344 - INFO - [src.data_preparation] -   SK: 0.0758
2025-05-19 23:21:53,344 - INFO - [src.data_preparation] -   TVV: 0.0750
2025-05-19 23:21:53,344 - INFO - [src.data_preparation] -   vnipc_t: 0.0707
2025-05-19 23:21:53,344 - INFO - [src.data_preparation] -   ATR: 0.0641
2025-05-19 23:21:53,344 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   s_d7_t: 0.0609
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   HL: 0.0587
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   insec_t: 0.0570
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   SR: 0.0558
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   ma14_t: 0.0532
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   LO: 0.0530
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:21:53,345 - INFO - [src.data_preparation] -   ma7_t: 0.0514
2025-05-19 23:21:53,348 - INFO - [src.data_preparation] - Ticker S55 - Using features: ['Date', 'SK', 'TVV', 'vnipc_t', 'ATR', 'Volatility', 's_d7_t', 'ma21_t', 'HL', 'insec_t', 'SR', 'variation_t', 'ma14_t', 'LO', 'ret', 'ma7_t']
2025-05-19 23:21:53,439 - INFO - [src.data_preparation] - Ticker S55 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:53,439 - INFO - [src.data_preparation] - Ticker S55 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:53,441 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker S55
2025-05-19 23:21:53,441 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:53,441 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(258)}
2025-05-19 23:21:53,441 - INFO - [src.data_preparation] - Generating 53 synthetic minority samples
2025-05-19 23:21:53,443 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:21:53,443 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:21:53,447 - INFO - [src.data_preparation] - Ticker S55 - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:53,447 - INFO - [__main__] - Using best model for S55: svm (F1: 0.9268)
2025-05-19 23:21:53,447 - INFO - [__main__] - Loading svm model for S55...
2025-05-19 23:21:53,448 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:53,449 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:21:53,450 - INFO - [__main__] - Making predictions for S55 using svm
2025-05-19 23:21:53,452 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:53,452 - INFO - [__main__] - Successfully got last prediction for S55
2025-05-19 23:21:53,452 - INFO - [__main__] - 
Processing ticker: S74
2025-05-19 23:21:53,453 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:53,453 - INFO - [__main__] - Getting last prediction point for ticker: S74
2025-05-19 23:21:53,453 - INFO - [__main__] - ==================================================
2025-05-19 23:21:53,453 - INFO - [__main__] - Preparing test data for S74...
2025-05-19 23:21:53,492 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:53,492 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:53,492 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:53,513 - INFO - [src.data_preparation] - Ticker S74 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:53,513 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(201), np.int64(1): np.int64(438)}
2025-05-19 23:21:53,792 - INFO - [src.data_preparation] - Ticker S74 - Selected features:
2025-05-19 23:21:53,792 - INFO - [src.data_preparation] -   TVV: 0.0919
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   vnipc_t: 0.0779
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   ma21_t: 0.0664
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   SK: 0.0635
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   ma7_t: 0.0624
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   s_d7_t: 0.0611
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   ATR: 0.0571
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   insec_t: 0.0554
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   Median_HL: 0.0540
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   HL: 0.0514
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:21:53,793 - INFO - [src.data_preparation] -   SR: 0.0437
2025-05-19 23:21:53,794 - INFO - [src.data_preparation] -   variation_t: 0.0435
2025-05-19 23:21:53,796 - INFO - [src.data_preparation] - Ticker S74 - Using features: ['Date', 'TVV', 'vnipc_t', 'Volatility', 'ma21_t', 'SK', 'ma7_t', 's_d7_t', 'ma14_t', 'ATR', 'insec_t', 'Median_HL', 'HL', 'PM', 'SR', 'variation_t']
2025-05-19 23:21:53,918 - INFO - [src.data_preparation] - Ticker S74 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:53,919 - INFO - [src.data_preparation] - Ticker S74 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:53,920 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker S74
2025-05-19 23:21:53,921 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:53,921 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:21:53,921 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:21:53,929 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:21:53,929 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:21:53,933 - INFO - [src.data_preparation] - Ticker S74 - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:53,933 - INFO - [__main__] - Using best model for S74: svm (F1: 0.8571)
2025-05-19 23:21:53,933 - INFO - [__main__] - Loading svm model for S74...
2025-05-19 23:21:53,935 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:53,937 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:21:53,937 - INFO - [__main__] - Making predictions for S74 using svm
2025-05-19 23:21:53,938 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:53,938 - INFO - [__main__] - Successfully got last prediction for S74
2025-05-19 23:21:53,938 - INFO - [__main__] - 
Processing ticker: S96
2025-05-19 23:21:53,938 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:53,938 - INFO - [__main__] - Getting last prediction point for ticker: S96
2025-05-19 23:21:53,938 - INFO - [__main__] - ==================================================
2025-05-19 23:21:53,938 - INFO - [__main__] - Preparing test data for S96...
2025-05-19 23:21:53,978 - INFO - [src.data_preparation] - After processing - X shape: (628, 19), y shape: (628,)
2025-05-19 23:21:53,978 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:53,978 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:54,009 - INFO - [src.data_preparation] - Ticker S96 - Original shapes: X=(628, 18), y=(628,)
2025-05-19 23:21:54,010 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(176), np.int64(1): np.int64(452)}
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] - Ticker S96 - Selected features:
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   vnipc_t: 0.1063
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   insec_t: 0.0876
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   ma21_t: 0.0865
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   TVV: 0.0851
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   ma14_t: 0.0788
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   Volatility: 0.0633
2025-05-19 23:21:54,262 - INFO - [src.data_preparation] -   ma7_t: 0.0632
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   SK: 0.0530
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   ATR: 0.0525
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   Median_HL: 0.0510
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   PM: 0.0488
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   variation_t: 0.0421
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   ret: 0.0367
2025-05-19 23:21:54,263 - INFO - [src.data_preparation] -   LO: 0.0238
2025-05-19 23:21:54,265 - INFO - [src.data_preparation] - Ticker S96 - Using features: ['Date', 'vnipc_t', 'insec_t', 'ma21_t', 'TVV', 'ma14_t', 's_d7_t', 'Volatility', 'ma7_t', 'SK', 'ATR', 'Median_HL', 'PM', 'variation_t', 'ret', 'LO']
2025-05-19 23:21:54,362 - INFO - [src.data_preparation] - Ticker S96 - 2D shapes: X_train=(452, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:54,362 - INFO - [src.data_preparation] - Ticker S96 - 3D shapes: X_train=(452, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:54,364 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker S96
2025-05-19 23:21:54,364 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (452, 13, 15), y shape: (452,)
2025-05-19 23:21:54,364 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(138), np.int64(1): np.int64(314)}
2025-05-19 23:21:54,364 - INFO - [src.data_preparation] - Generating 176 synthetic minority samples
2025-05-19 23:21:54,371 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (628, 13, 15), y shape: (628,)
2025-05-19 23:21:54,371 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(314), np.int64(1): np.int64(314)}
2025-05-19 23:21:54,379 - INFO - [src.data_preparation] - Ticker S96 - Final 3D shapes: X_train=(628, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:54,379 - INFO - [__main__] - Using best model for S96: lstm (F1: 0.9885)
2025-05-19 23:21:54,379 - INFO - [__main__] - Loading lstm model for S96...
2025-05-19 23:21:54,388 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:54,388 - INFO - [__main__] - Model size: 0.18 MB
2025-05-19 23:21:54,388 - INFO - [__main__] - Making predictions for S96 using lstm
2025-05-19 23:21:54,392 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:54,392 - INFO - [__main__] - Successfully got last prediction for S96
2025-05-19 23:21:54,393 - INFO - [__main__] - 
Processing ticker: S99
2025-05-19 23:21:54,393 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:54,393 - INFO - [__main__] - Getting last prediction point for ticker: S99
2025-05-19 23:21:54,393 - INFO - [__main__] - ==================================================
2025-05-19 23:21:54,393 - INFO - [__main__] - Preparing test data for S99...
2025-05-19 23:21:54,450 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:54,451 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:54,451 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:54,489 - INFO - [src.data_preparation] - Ticker S99 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:54,489 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:21:54,864 - INFO - [src.data_preparation] - Ticker S99 - Selected features:
2025-05-19 23:21:54,864 - INFO - [src.data_preparation] -   Volatility: 0.0785
2025-05-19 23:21:54,864 - INFO - [src.data_preparation] -   insec_t: 0.0766
2025-05-19 23:21:54,864 - INFO - [src.data_preparation] -   vnipc_t: 0.0761
2025-05-19 23:21:54,864 - INFO - [src.data_preparation] -   TVV: 0.0717
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   SK: 0.0710
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   LO: 0.0583
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   s_d7_t: 0.0580
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   HL: 0.0566
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   ma14_t: 0.0542
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   ma21_t: 0.0528
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   ATR: 0.0518
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   variation_t: 0.0505
2025-05-19 23:21:54,865 - INFO - [src.data_preparation] -   ret: 0.0495
2025-05-19 23:21:54,869 - INFO - [src.data_preparation] - Ticker S99 - Using features: ['Date', 'Volatility', 'insec_t', 'vnipc_t', 'TVV', 'SK', 'LO', 's_d7_t', 'HL', 'ma14_t', 'PM', 'ma21_t', 'ATR', 'Median_HL', 'variation_t', 'ret']
2025-05-19 23:21:54,959 - INFO - [src.data_preparation] - Ticker S99 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:54,959 - INFO - [src.data_preparation] - Ticker S99 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:54,959 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker S99
2025-05-19 23:21:54,959 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:54,959 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:21:54,959 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:21:54,966 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:21:54,966 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:21:54,970 - INFO - [src.data_preparation] - Ticker S99 - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:54,971 - INFO - [__main__] - Using best model for S99: svm (F1: 0.6545)
2025-05-19 23:21:54,971 - INFO - [__main__] - Loading svm model for S99...
2025-05-19 23:21:54,972 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:54,972 - INFO - [__main__] - Model size: 0.56 MB
2025-05-19 23:21:54,972 - INFO - [__main__] - Making predictions for S99 using svm
2025-05-19 23:21:54,973 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:54,973 - INFO - [__main__] - Successfully got last prediction for S99
2025-05-19 23:21:54,973 - INFO - [__main__] - 
Processing ticker: SAF
2025-05-19 23:21:54,973 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:54,973 - INFO - [__main__] - Getting last prediction point for ticker: SAF
2025-05-19 23:21:54,973 - INFO - [__main__] - ==================================================
2025-05-19 23:21:54,973 - INFO - [__main__] - Preparing test data for SAF...
2025-05-19 23:21:55,017 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:55,017 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:55,017 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:55,039 - INFO - [src.data_preparation] - Ticker SAF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:55,039 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(188), np.int64(1): np.int64(451)}
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] - Ticker SAF - Selected features:
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   TVV: 0.0806
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   vnipc_t: 0.0769
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   ATR: 0.0746
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   s_d7_t: 0.0732
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   Volatility: 0.0731
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   SK: 0.0662
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   ma14_t: 0.0653
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   ma21_t: 0.0635
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   Median_HL: 0.0576
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   PM: 0.0536
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   insec_t: 0.0503
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   variation_t: 0.0470
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   ret: 0.0449
2025-05-19 23:21:55,346 - INFO - [src.data_preparation] -   HL: 0.0427
2025-05-19 23:21:55,349 - INFO - [src.data_preparation] - Ticker SAF - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 's_d7_t', 'Volatility', 'SK', 'ma14_t', 'ma21_t', 'ma7_t', 'Median_HL', 'PM', 'insec_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:21:55,449 - INFO - [src.data_preparation] - Ticker SAF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:55,449 - INFO - [src.data_preparation] - Ticker SAF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:55,452 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SAF
2025-05-19 23:21:55,453 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:55,453 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(132), np.int64(1): np.int64(331)}
2025-05-19 23:21:55,453 - INFO - [src.data_preparation] - Generating 199 synthetic minority samples
2025-05-19 23:21:55,461 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (662, 13, 15), y shape: (662,)
2025-05-19 23:21:55,461 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(331), np.int64(1): np.int64(331)}
2025-05-19 23:21:55,465 - INFO - [src.data_preparation] - Ticker SAF - Final 3D shapes: X_train=(662, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:55,466 - INFO - [__main__] - Using best model for SAF: svm (F1: 0.7945)
2025-05-19 23:21:55,466 - INFO - [__main__] - Loading svm model for SAF...
2025-05-19 23:21:55,469 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:55,470 - INFO - [__main__] - Model size: 1.00 MB
2025-05-19 23:21:55,470 - INFO - [__main__] - Making predictions for SAF using svm
2025-05-19 23:21:55,471 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:55,471 - INFO - [__main__] - Successfully got last prediction for SAF
2025-05-19 23:21:55,471 - INFO - [__main__] - 
Processing ticker: SAM
2025-05-19 23:21:55,471 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:55,471 - INFO - [__main__] - Getting last prediction point for ticker: SAM
2025-05-19 23:21:55,471 - INFO - [__main__] - ==================================================
2025-05-19 23:21:55,471 - INFO - [__main__] - Preparing test data for SAM...
2025-05-19 23:21:55,509 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:55,509 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:55,509 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:55,529 - INFO - [src.data_preparation] - Ticker SAM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:55,529 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] - Ticker SAM - Selected features:
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   insec_t: 0.0701
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   s_d7_t: 0.0693
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   vnipc_t: 0.0693
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   TVV: 0.0666
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   ATR: 0.0607
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   ma14_t: 0.0600
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   ma21_t: 0.0586
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   ma7_t: 0.0576
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   SR: 0.0538
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   HL: 0.0533
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   variation_t: 0.0528
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   PM: 0.0526
2025-05-19 23:21:55,903 - INFO - [src.data_preparation] -   ret: 0.0502
2025-05-19 23:21:55,908 - INFO - [src.data_preparation] - Ticker SAM - Using features: ['Date', 'insec_t', 's_d7_t', 'vnipc_t', 'TVV', 'SK', 'Volatility', 'ATR', 'ma14_t', 'ma21_t', 'ma7_t', 'SR', 'HL', 'variation_t', 'PM', 'ret']
2025-05-19 23:21:56,023 - INFO - [src.data_preparation] - Ticker SAM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:56,023 - INFO - [src.data_preparation] - Ticker SAM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:56,024 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SAM
2025-05-19 23:21:56,024 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:56,024 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:21:56,024 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:21:56,029 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:21:56,029 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:21:56,033 - INFO - [src.data_preparation] - Ticker SAM - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:56,034 - INFO - [__main__] - Using best model for SAM: transformer (F1: 0.5263)
2025-05-19 23:21:56,034 - INFO - [__main__] - Loading transformer model for SAM...
2025-05-19 23:21:56,047 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:56,053 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:21:56,053 - INFO - [__main__] - Making predictions for SAM using transformer
2025-05-19 23:21:56,055 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:56,057 - INFO - [__main__] - Successfully got last prediction for SAM
2025-05-19 23:21:56,057 - INFO - [__main__] - 
Processing ticker: SAP
2025-05-19 23:21:56,057 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:56,057 - INFO - [__main__] - Getting last prediction point for ticker: SAP
2025-05-19 23:21:56,057 - INFO - [__main__] - ==================================================
2025-05-19 23:21:56,057 - INFO - [__main__] - Preparing test data for SAP...
2025-05-19 23:21:56,121 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:56,121 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:56,121 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:56,167 - INFO - [src.data_preparation] - Ticker SAP - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:56,167 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(118), np.int64(1): np.int64(520)}
2025-05-19 23:21:56,501 - INFO - [src.data_preparation] - Ticker SAP - Selected features:
2025-05-19 23:21:56,502 - INFO - [src.data_preparation] -   ma21_t: 0.1033
2025-05-19 23:21:56,502 - INFO - [src.data_preparation] -   ma14_t: 0.0991
2025-05-19 23:21:56,502 - INFO - [src.data_preparation] -   vnipc_t: 0.0987
2025-05-19 23:21:56,502 - INFO - [src.data_preparation] -   ma7_t: 0.0821
2025-05-19 23:21:56,502 - INFO - [src.data_preparation] -   PM: 0.0746
2025-05-19 23:21:56,503 - INFO - [src.data_preparation] -   TVV: 0.0644
2025-05-19 23:21:56,503 - INFO - [src.data_preparation] -   s_d7_t: 0.0642
2025-05-19 23:21:56,503 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:21:56,503 - INFO - [src.data_preparation] -   Median_HL: 0.0629
2025-05-19 23:21:56,503 - INFO - [src.data_preparation] -   ATR: 0.0629
2025-05-19 23:21:56,503 - INFO - [src.data_preparation] -   Volatility: 0.0590
2025-05-19 23:21:56,504 - INFO - [src.data_preparation] -   insec_t: 0.0329
2025-05-19 23:21:56,504 - INFO - [src.data_preparation] -   HL: 0.0266
2025-05-19 23:21:56,504 - INFO - [src.data_preparation] -   variation_t: 0.0259
2025-05-19 23:21:56,504 - INFO - [src.data_preparation] -   ret: 0.0258
2025-05-19 23:21:56,511 - INFO - [src.data_preparation] - Ticker SAP - Using features: ['Date', 'ma21_t', 'ma14_t', 'vnipc_t', 'ma7_t', 'PM', 'TVV', 's_d7_t', 'SK', 'Median_HL', 'ATR', 'Volatility', 'insec_t', 'HL', 'variation_t', 'ret']
2025-05-19 23:21:56,613 - INFO - [src.data_preparation] - Ticker SAP - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:56,613 - INFO - [src.data_preparation] - Ticker SAP - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:56,615 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SAP
2025-05-19 23:21:56,616 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:21:56,616 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(95), np.int64(1): np.int64(367)}
2025-05-19 23:21:56,616 - INFO - [src.data_preparation] - Generating 272 synthetic minority samples
2025-05-19 23:21:56,629 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (734, 13, 15), y shape: (734,)
2025-05-19 23:21:56,629 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(367), np.int64(1): np.int64(367)}
2025-05-19 23:21:56,634 - INFO - [src.data_preparation] - Ticker SAP - Final 3D shapes: X_train=(734, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:56,634 - INFO - [__main__] - Using best model for SAP: svm (F1: 0.9136)
2025-05-19 23:21:56,634 - INFO - [__main__] - Loading svm model for SAP...
2025-05-19 23:21:56,636 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:56,637 - INFO - [__main__] - Model size: 0.62 MB
2025-05-19 23:21:56,637 - INFO - [__main__] - Making predictions for SAP using svm
2025-05-19 23:21:56,638 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:56,638 - INFO - [__main__] - Successfully got last prediction for SAP
2025-05-19 23:21:56,638 - INFO - [__main__] - 
Processing ticker: SAV
2025-05-19 23:21:56,638 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:56,638 - INFO - [__main__] - Getting last prediction point for ticker: SAV
2025-05-19 23:21:56,638 - INFO - [__main__] - ==================================================
2025-05-19 23:21:56,638 - INFO - [__main__] - Preparing test data for SAV...
2025-05-19 23:21:56,682 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:56,682 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:56,682 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:56,711 - INFO - [src.data_preparation] - Ticker SAV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:56,711 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(315), np.int64(1): np.int64(324)}
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] - Ticker SAV - Selected features:
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   vnipc_t: 0.0775
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   Volatility: 0.0764
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   TVV: 0.0675
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   SK: 0.0659
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   insec_t: 0.0617
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   ATR: 0.0612
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   SR: 0.0584
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   ma21_t: 0.0559
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   LO: 0.0547
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   s_d7_t: 0.0540
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   HL: 0.0539
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   PM: 0.0539
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   Median_HL: 0.0535
2025-05-19 23:21:57,089 - INFO - [src.data_preparation] -   ret: 0.0515
2025-05-19 23:21:57,097 - INFO - [src.data_preparation] - Ticker SAV - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'SK', 'insec_t', 'ATR', 'SR', 'ma21_t', 'ma7_t', 'LO', 's_d7_t', 'HL', 'PM', 'Median_HL', 'ret']
2025-05-19 23:21:57,209 - INFO - [src.data_preparation] - Ticker SAV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:57,209 - INFO - [src.data_preparation] - Ticker SAV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:57,210 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SAV
2025-05-19 23:21:57,210 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:57,210 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(227), np.int64(1): np.int64(236)}
2025-05-19 23:21:57,210 - INFO - [src.data_preparation] - Generating 9 synthetic minority samples
2025-05-19 23:21:57,211 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (472, 13, 15), y shape: (472,)
2025-05-19 23:21:57,211 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(236), np.int64(1): np.int64(236)}
2025-05-19 23:21:57,214 - INFO - [src.data_preparation] - Ticker SAV - Final 3D shapes: X_train=(472, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:57,215 - INFO - [__main__] - Using best model for SAV: lstm (F1: 0.5818)
2025-05-19 23:21:57,215 - INFO - [__main__] - Loading lstm model for SAV...
2025-05-19 23:21:57,221 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:57,223 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:21:57,223 - INFO - [__main__] - Making predictions for SAV using lstm
2025-05-19 23:21:57,226 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:57,226 - INFO - [__main__] - Successfully got last prediction for SAV
2025-05-19 23:21:57,226 - INFO - [__main__] - 
Processing ticker: SBA
2025-05-19 23:21:57,226 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:57,226 - INFO - [__main__] - Getting last prediction point for ticker: SBA
2025-05-19 23:21:57,226 - INFO - [__main__] - ==================================================
2025-05-19 23:21:57,227 - INFO - [__main__] - Preparing test data for SBA...
2025-05-19 23:21:57,272 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:57,272 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:57,272 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:57,303 - INFO - [src.data_preparation] - Ticker SBA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:57,303 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:21:57,681 - INFO - [src.data_preparation] - Ticker SBA - Selected features:
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   insec_t: 0.0801
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   TVV: 0.0754
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   Volatility: 0.0677
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   vnipc_t: 0.0654
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   ATR: 0.0623
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   SR: 0.0585
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   LO: 0.0583
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   s_d7_t: 0.0579
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   HL: 0.0566
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   ret: 0.0551
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   ma21_t: 0.0519
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   ma7_t: 0.0512
2025-05-19 23:21:57,682 - INFO - [src.data_preparation] -   ma14_t: 0.0475
2025-05-19 23:21:57,685 - INFO - [src.data_preparation] - Ticker SBA - Using features: ['Date', 'insec_t', 'TVV', 'Volatility', 'SK', 'vnipc_t', 'ATR', 'SR', 'LO', 's_d7_t', 'HL', 'ret', 'variation_t', 'ma21_t', 'ma7_t', 'ma14_t']
2025-05-19 23:21:57,781 - INFO - [src.data_preparation] - Ticker SBA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:57,781 - INFO - [src.data_preparation] - Ticker SBA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:57,782 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SBA
2025-05-19 23:21:57,783 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:57,783 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(177), np.int64(1): np.int64(286)}
2025-05-19 23:21:57,783 - INFO - [src.data_preparation] - Generating 109 synthetic minority samples
2025-05-19 23:21:57,790 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (572, 13, 15), y shape: (572,)
2025-05-19 23:21:57,790 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(286), np.int64(1): np.int64(286)}
2025-05-19 23:21:57,794 - INFO - [src.data_preparation] - Ticker SBA - Final 3D shapes: X_train=(572, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:57,794 - INFO - [__main__] - Using best model for SBA: lstm (F1: 0.6667)
2025-05-19 23:21:57,794 - INFO - [__main__] - Loading lstm model for SBA...
2025-05-19 23:21:57,799 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:57,800 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:21:57,800 - INFO - [__main__] - Making predictions for SBA using lstm
2025-05-19 23:21:57,805 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:57,806 - INFO - [__main__] - Successfully got last prediction for SBA
2025-05-19 23:21:57,806 - INFO - [__main__] - 
Processing ticker: SBS
2025-05-19 23:21:57,806 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:57,806 - INFO - [__main__] - Getting last prediction point for ticker: SBS
2025-05-19 23:21:57,806 - INFO - [__main__] - ==================================================
2025-05-19 23:21:57,807 - INFO - [__main__] - Preparing test data for SBS...
2025-05-19 23:21:57,860 - INFO - [src.data_preparation] - After processing - X shape: (582, 19), y shape: (582,)
2025-05-19 23:21:57,860 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:57,860 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:57,894 - INFO - [src.data_preparation] - Ticker SBS - Original shapes: X=(582, 18), y=(582,)
2025-05-19 23:21:57,894 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(247), np.int64(1): np.int64(335)}
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] - Ticker SBS - Selected features:
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   SK: 0.0789
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   insec_t: 0.0779
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   vnipc_t: 0.0753
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   Volatility: 0.0742
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   TVV: 0.0711
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   ma14_t: 0.0687
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   Median_HL: 0.0625
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   ma7_t: 0.0602
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   ma21_t: 0.0600
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   s_d7_t: 0.0599
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   ATR: 0.0544
2025-05-19 23:21:58,248 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:21:58,249 - INFO - [src.data_preparation] -   PM: 0.0513
2025-05-19 23:21:58,249 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:21:58,249 - INFO - [src.data_preparation] -   SR: 0.0330
2025-05-19 23:21:58,252 - INFO - [src.data_preparation] - Ticker SBS - Using features: ['Date', 'SK', 'insec_t', 'vnipc_t', 'Volatility', 'TVV', 'ma14_t', 'Median_HL', 'ma7_t', 'ma21_t', 's_d7_t', 'ATR', 'variation_t', 'PM', 'ret', 'SR']
2025-05-19 23:21:58,341 - INFO - [src.data_preparation] - Ticker SBS - 2D shapes: X_train=(406, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:58,342 - INFO - [src.data_preparation] - Ticker SBS - 3D shapes: X_train=(406, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:58,343 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SBS
2025-05-19 23:21:58,343 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (406, 13, 15), y shape: (406,)
2025-05-19 23:21:58,344 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(240)}
2025-05-19 23:21:58,344 - INFO - [src.data_preparation] - Generating 74 synthetic minority samples
2025-05-19 23:21:58,347 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (480, 13, 15), y shape: (480,)
2025-05-19 23:21:58,347 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(240)}
2025-05-19 23:21:58,349 - INFO - [src.data_preparation] - Ticker SBS - Final 3D shapes: X_train=(480, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:58,350 - INFO - [__main__] - Using best model for SBS: svm (F1: 0.4865)
2025-05-19 23:21:58,350 - INFO - [__main__] - Loading svm model for SBS...
2025-05-19 23:21:58,351 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:58,352 - INFO - [__main__] - Model size: 0.61 MB
2025-05-19 23:21:58,352 - INFO - [__main__] - Making predictions for SBS using svm
2025-05-19 23:21:58,352 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:58,352 - INFO - [__main__] - Successfully got last prediction for SBS
2025-05-19 23:21:58,353 - INFO - [__main__] - 
Processing ticker: SBT
2025-05-19 23:21:58,353 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:58,353 - INFO - [__main__] - Getting last prediction point for ticker: SBT
2025-05-19 23:21:58,353 - INFO - [__main__] - ==================================================
2025-05-19 23:21:58,353 - INFO - [__main__] - Preparing test data for SBT...
2025-05-19 23:21:58,392 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:58,392 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:58,392 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:58,415 - INFO - [src.data_preparation] - Ticker SBT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:58,415 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] - Ticker SBT - Selected features:
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   insec_t: 0.0835
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   vnipc_t: 0.0712
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   Volatility: 0.0648
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   ma14_t: 0.0637
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   ma21_t: 0.0618
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   TVV: 0.0600
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   s_d7_t: 0.0598
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   SK: 0.0578
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   LO: 0.0563
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   variation_t: 0.0552
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   ATR: 0.0546
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   HL: 0.0545
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   SR: 0.0543
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   ma7_t: 0.0530
2025-05-19 23:21:58,828 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:21:58,831 - INFO - [src.data_preparation] - Ticker SBT - Using features: ['Date', 'insec_t', 'vnipc_t', 'Volatility', 'ma14_t', 'ma21_t', 'TVV', 's_d7_t', 'SK', 'LO', 'variation_t', 'ATR', 'HL', 'SR', 'ma7_t', 'ret']
2025-05-19 23:21:58,927 - INFO - [src.data_preparation] - Ticker SBT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:58,927 - INFO - [src.data_preparation] - Ticker SBT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:58,929 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SBT
2025-05-19 23:21:58,929 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:58,929 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(260)}
2025-05-19 23:21:58,929 - INFO - [src.data_preparation] - Generating 57 synthetic minority samples
2025-05-19 23:21:58,932 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (520, 13, 15), y shape: (520,)
2025-05-19 23:21:58,932 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(260), np.int64(1): np.int64(260)}
2025-05-19 23:21:58,935 - INFO - [src.data_preparation] - Ticker SBT - Final 3D shapes: X_train=(520, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:58,935 - INFO - [__main__] - Using best model for SBT: svm (F1: 0.7692)
2025-05-19 23:21:58,935 - INFO - [__main__] - Loading svm model for SBT...
2025-05-19 23:21:58,937 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:58,939 - INFO - [__main__] - Model size: 0.68 MB
2025-05-19 23:21:58,939 - INFO - [__main__] - Making predictions for SBT using svm
2025-05-19 23:21:58,939 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:58,940 - INFO - [__main__] - Successfully got last prediction for SBT
2025-05-19 23:21:58,940 - INFO - [__main__] - 
Processing ticker: SC5
2025-05-19 23:21:58,940 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:58,940 - INFO - [__main__] - Getting last prediction point for ticker: SC5
2025-05-19 23:21:58,940 - INFO - [__main__] - ==================================================
2025-05-19 23:21:58,940 - INFO - [__main__] - Preparing test data for SC5...
2025-05-19 23:21:58,974 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:21:58,974 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:58,974 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:58,996 - INFO - [src.data_preparation] - Ticker SC5 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:21:58,997 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:21:59,325 - INFO - [src.data_preparation] - Ticker SC5 - Selected features:
2025-05-19 23:21:59,325 - INFO - [src.data_preparation] -   insec_t: 0.0813
2025-05-19 23:21:59,325 - INFO - [src.data_preparation] -   vnipc_t: 0.0735
2025-05-19 23:21:59,325 - INFO - [src.data_preparation] -   s_d7_t: 0.0636
2025-05-19 23:21:59,325 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:21:59,325 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   SK: 0.0621
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   ATR: 0.0603
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   HL: 0.0599
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   ma14_t: 0.0558
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   SR: 0.0548
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   PM: 0.0545
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   LO: 0.0524
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   Median_HL: 0.0519
2025-05-19 23:21:59,326 - INFO - [src.data_preparation] -   ma21_t: 0.0505
2025-05-19 23:21:59,328 - INFO - [src.data_preparation] - Ticker SC5 - Using features: ['Date', 'insec_t', 'vnipc_t', 's_d7_t', 'TVV', 'Volatility', 'SK', 'ATR', 'HL', 'ma14_t', 'SR', 'PM', 'ret', 'LO', 'Median_HL', 'ma21_t']
2025-05-19 23:21:59,432 - INFO - [src.data_preparation] - Ticker SC5 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:59,432 - INFO - [src.data_preparation] - Ticker SC5 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:59,435 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SC5
2025-05-19 23:21:59,435 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:21:59,436 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(213), np.int64(1): np.int64(250)}
2025-05-19 23:21:59,436 - INFO - [src.data_preparation] - Generating 37 synthetic minority samples
2025-05-19 23:21:59,439 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (500, 13, 15), y shape: (500,)
2025-05-19 23:21:59,439 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(250), np.int64(1): np.int64(250)}
2025-05-19 23:21:59,447 - INFO - [src.data_preparation] - Ticker SC5 - Final 3D shapes: X_train=(500, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:59,448 - INFO - [__main__] - Using best model for SC5: logistic_regression (F1: 0.6441)
2025-05-19 23:21:59,448 - INFO - [__main__] - Loading logistic_regression model for SC5...
2025-05-19 23:21:59,449 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:21:59,450 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:21:59,450 - INFO - [__main__] - Making predictions for SC5 using logistic_regression
2025-05-19 23:21:59,450 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:59,451 - INFO - [__main__] - Successfully got last prediction for SC5
2025-05-19 23:21:59,451 - INFO - [__main__] - 
Processing ticker: SCC
2025-05-19 23:21:59,451 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:59,451 - INFO - [__main__] - Getting last prediction point for ticker: SCC
2025-05-19 23:21:59,451 - INFO - [__main__] - ==================================================
2025-05-19 23:21:59,451 - INFO - [__main__] - Preparing test data for SCC...
2025-05-19 23:21:59,498 - INFO - [src.data_preparation] - After processing - X shape: (577, 19), y shape: (577,)
2025-05-19 23:21:59,498 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:59,498 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:59,519 - INFO - [src.data_preparation] - Ticker SCC - Original shapes: X=(577, 18), y=(577,)
2025-05-19 23:21:59,519 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(172), np.int64(1): np.int64(405)}
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] - Ticker SCC - Selected features:
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   ATR: 0.0853
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   vnipc_t: 0.0825
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   TVV: 0.0788
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   s_d7_t: 0.0756
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   ma14_t: 0.0741
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   ma21_t: 0.0706
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   Volatility: 0.0632
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   ma7_t: 0.0619
2025-05-19 23:21:59,766 - INFO - [src.data_preparation] -   SK: 0.0600
2025-05-19 23:21:59,767 - INFO - [src.data_preparation] -   insec_t: 0.0565
2025-05-19 23:21:59,767 - INFO - [src.data_preparation] -   PM: 0.0505
2025-05-19 23:21:59,767 - INFO - [src.data_preparation] -   Median_HL: 0.0487
2025-05-19 23:21:59,767 - INFO - [src.data_preparation] -   HL: 0.0467
2025-05-19 23:21:59,767 - INFO - [src.data_preparation] -   variation_t: 0.0383
2025-05-19 23:21:59,767 - INFO - [src.data_preparation] -   ret: 0.0374
2025-05-19 23:21:59,769 - INFO - [src.data_preparation] - Ticker SCC - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'ma14_t', 'ma21_t', 'Volatility', 'ma7_t', 'SK', 'insec_t', 'PM', 'Median_HL', 'HL', 'variation_t', 'ret']
2025-05-19 23:21:59,853 - INFO - [src.data_preparation] - Ticker SCC - 2D shapes: X_train=(401, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:21:59,853 - INFO - [src.data_preparation] - Ticker SCC - 3D shapes: X_train=(401, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:59,856 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SCC
2025-05-19 23:21:59,856 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (401, 13, 15), y shape: (401,)
2025-05-19 23:21:59,857 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(107), np.int64(1): np.int64(294)}
2025-05-19 23:21:59,857 - INFO - [src.data_preparation] - Generating 187 synthetic minority samples
2025-05-19 23:21:59,867 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (588, 13, 15), y shape: (588,)
2025-05-19 23:21:59,867 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(294), np.int64(1): np.int64(294)}
2025-05-19 23:21:59,871 - INFO - [src.data_preparation] - Ticker SCC - Final 3D shapes: X_train=(588, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:21:59,872 - INFO - [__main__] - Using best model for SCC: lstm (F1: 0.9000)
2025-05-19 23:21:59,872 - INFO - [__main__] - Loading lstm model for SCC...
2025-05-19 23:21:59,877 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:21:59,878 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:21:59,878 - INFO - [__main__] - Making predictions for SCC using lstm
2025-05-19 23:21:59,879 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:21:59,880 - INFO - [__main__] - Successfully got last prediction for SCC
2025-05-19 23:21:59,880 - INFO - [__main__] - 
Processing ticker: SCD
2025-05-19 23:21:59,880 - INFO - [__main__] - 
==================================================
2025-05-19 23:21:59,880 - INFO - [__main__] - Getting last prediction point for ticker: SCD
2025-05-19 23:21:59,880 - INFO - [__main__] - ==================================================
2025-05-19 23:21:59,880 - INFO - [__main__] - Preparing test data for SCD...
2025-05-19 23:21:59,917 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:21:59,917 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:21:59,917 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:21:59,938 - INFO - [src.data_preparation] - Ticker SCD - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:21:59,939 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(301), np.int64(1): np.int64(337)}
2025-05-19 23:22:00,325 - INFO - [src.data_preparation] - Ticker SCD - Selected features:
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   vnipc_t: 0.0691
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   Volatility: 0.0680
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   s_d7_t: 0.0671
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   SK: 0.0666
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   TVV: 0.0607
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   insec_t: 0.0606
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   ret: 0.0587
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   ATR: 0.0585
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   HL: 0.0579
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   LO: 0.0565
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   SR: 0.0563
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   PM: 0.0560
2025-05-19 23:22:00,326 - INFO - [src.data_preparation] -   ma7_t: 0.0552
2025-05-19 23:22:00,327 - INFO - [src.data_preparation] -   Median_HL: 0.0543
2025-05-19 23:22:00,327 - INFO - [src.data_preparation] -   ma14_t: 0.0531
2025-05-19 23:22:00,330 - INFO - [src.data_preparation] - Ticker SCD - Using features: ['Date', 'vnipc_t', 'Volatility', 's_d7_t', 'SK', 'TVV', 'insec_t', 'ret', 'ATR', 'HL', 'LO', 'SR', 'PM', 'ma7_t', 'Median_HL', 'ma14_t']
2025-05-19 23:22:00,415 - INFO - [src.data_preparation] - Ticker SCD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:22:00,417 - INFO - [src.data_preparation] - Ticker SCD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:22:00,418 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SCD
2025-05-19 23:22:00,418 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:00,418 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:22:00,418 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:22:00,419 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:22:00,419 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:22:00,424 - INFO - [src.data_preparation] - Ticker SCD - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:22:00,424 - INFO - [__main__] - Using best model for SCD: lstm (F1: 0.8378)
2025-05-19 23:22:00,424 - INFO - [__main__] - Loading lstm model for SCD...
2025-05-19 23:22:00,430 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:00,431 - INFO - [__main__] - Model size: 0.18 MB
2025-05-19 23:22:00,431 - INFO - [__main__] - Making predictions for SCD using lstm
2025-05-19 23:22:00,432 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:00,432 - INFO - [__main__] - Successfully got last prediction for SCD
2025-05-19 23:22:00,432 - INFO - [__main__] - 
Processing ticker: SCJ
2025-05-19 23:22:00,432 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:00,432 - INFO - [__main__] - Getting last prediction point for ticker: SCJ
2025-05-19 23:22:00,432 - INFO - [__main__] - ==================================================
2025-05-19 23:22:00,433 - INFO - [__main__] - Preparing test data for SCJ...
2025-05-19 23:22:00,475 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:00,475 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:00,475 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:00,498 - INFO - [src.data_preparation] - Ticker SCJ - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:00,499 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(386)}
2025-05-19 23:22:00,841 - INFO - [src.data_preparation] - Ticker SCJ - Selected features:
2025-05-19 23:22:00,841 - INFO - [src.data_preparation] -   vnipc_t: 0.0830
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   insec_t: 0.0750
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   SK: 0.0701
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   TVV: 0.0668
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   s_d7_t: 0.0657
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   Volatility: 0.0640
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   ATR: 0.0614
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   ret: 0.0582
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   ma7_t: 0.0556
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   ma14_t: 0.0552
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   PM: 0.0541
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   ma21_t: 0.0539
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:22:00,842 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:22:00,843 - INFO - [src.data_preparation] -   HL: 0.0455
2025-05-19 23:22:00,845 - INFO - [src.data_preparation] - Ticker SCJ - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'TVV', 's_d7_t', 'Volatility', 'ATR', 'ret', 'ma7_t', 'ma14_t', 'PM', 'ma21_t', 'variation_t', 'Median_HL', 'HL']
2025-05-19 23:22:00,965 - INFO - [src.data_preparation] - Ticker SCJ - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:00,966 - INFO - [src.data_preparation] - Ticker SCJ - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:00,968 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SCJ
2025-05-19 23:22:00,968 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:22:00,968 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(177), np.int64(1): np.int64(285)}
2025-05-19 23:22:00,968 - INFO - [src.data_preparation] - Generating 108 synthetic minority samples
2025-05-19 23:22:00,974 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (570, 13, 15), y shape: (570,)
2025-05-19 23:22:00,974 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(285), np.int64(1): np.int64(285)}
2025-05-19 23:22:00,978 - INFO - [src.data_preparation] - Ticker SCJ - Final 3D shapes: X_train=(570, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:00,979 - INFO - [__main__] - Using best model for SCJ: svm (F1: 0.7945)
2025-05-19 23:22:00,979 - INFO - [__main__] - Loading svm model for SCJ...
2025-05-19 23:22:00,981 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:00,981 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:22:00,981 - INFO - [__main__] - Making predictions for SCJ using svm
2025-05-19 23:22:00,982 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:00,983 - INFO - [__main__] - Successfully got last prediction for SCJ
2025-05-19 23:22:00,983 - INFO - [__main__] - 
Processing ticker: SCL
2025-05-19 23:22:00,983 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:00,983 - INFO - [__main__] - Getting last prediction point for ticker: SCL
2025-05-19 23:22:00,983 - INFO - [__main__] - ==================================================
2025-05-19 23:22:00,983 - INFO - [__main__] - Preparing test data for SCL...
2025-05-19 23:22:01,038 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:01,038 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:01,038 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:01,065 - INFO - [src.data_preparation] - Ticker SCL - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:01,066 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(283), np.int64(1): np.int64(355)}
2025-05-19 23:22:01,403 - INFO - [src.data_preparation] - Ticker SCL - Selected features:
2025-05-19 23:22:01,403 - INFO - [src.data_preparation] -   vnipc_t: 0.0794
2025-05-19 23:22:01,403 - INFO - [src.data_preparation] -   SK: 0.0705
2025-05-19 23:22:01,403 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   insec_t: 0.0643
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   TVV: 0.0625
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   s_d7_t: 0.0616
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   ret: 0.0607
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   variation_t: 0.0572
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   ATR: 0.0564
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   LO: 0.0542
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   Median_HL: 0.0540
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   ma21_t: 0.0527
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   ma14_t: 0.0524
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   ma7_t: 0.0515
2025-05-19 23:22:01,404 - INFO - [src.data_preparation] -   HL: 0.0511
2025-05-19 23:22:01,407 - INFO - [src.data_preparation] - Ticker SCL - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'insec_t', 'TVV', 's_d7_t', 'ret', 'variation_t', 'ATR', 'LO', 'Median_HL', 'ma21_t', 'ma14_t', 'ma7_t', 'HL']
2025-05-19 23:22:01,497 - INFO - [src.data_preparation] - Ticker SCL - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:01,497 - INFO - [src.data_preparation] - Ticker SCL - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:01,500 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SCL
2025-05-19 23:22:01,500 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:22:01,500 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(259)}
2025-05-19 23:22:01,500 - INFO - [src.data_preparation] - Generating 56 synthetic minority samples
2025-05-19 23:22:01,503 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:22:01,503 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:22:01,508 - INFO - [src.data_preparation] - Ticker SCL - Final 3D shapes: X_train=(518, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:01,509 - INFO - [__main__] - Using best model for SCL: logistic_regression (F1: 0.5116)
2025-05-19 23:22:01,509 - INFO - [__main__] - Loading logistic_regression model for SCL...
2025-05-19 23:22:01,510 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:01,511 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:01,511 - INFO - [__main__] - Making predictions for SCL using logistic_regression
2025-05-19 23:22:01,511 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:01,512 - INFO - [__main__] - Successfully got last prediction for SCL
2025-05-19 23:22:01,512 - INFO - [__main__] - 
Processing ticker: SCO
2025-05-19 23:22:01,512 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:01,512 - INFO - [__main__] - Getting last prediction point for ticker: SCO
2025-05-19 23:22:01,512 - INFO - [__main__] - ==================================================
2025-05-19 23:22:01,513 - INFO - [__main__] - Preparing test data for SCO...
2025-05-19 23:22:01,561 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:01,561 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:01,561 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:01,586 - INFO - [src.data_preparation] - Ticker SCO - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:01,586 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(90), np.int64(1): np.int64(549)}
2025-05-19 23:22:01,834 - INFO - [src.data_preparation] - Ticker SCO - Selected features:
2025-05-19 23:22:01,834 - INFO - [src.data_preparation] -   vnipc_t: 0.1074
2025-05-19 23:22:01,834 - INFO - [src.data_preparation] -   ma21_t: 0.0930
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   ma14_t: 0.0806
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   Volatility: 0.0727
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   ma7_t: 0.0668
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   SK: 0.0586
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   ATR: 0.0536
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   insec_t: 0.0475
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   variation_t: 0.0452
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   ret: 0.0447
2025-05-19 23:22:01,835 - INFO - [src.data_preparation] -   MDD: 0.0295
2025-05-19 23:22:01,838 - INFO - [src.data_preparation] - Ticker SCO - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'Volatility', 'TVV', 'ma7_t', 's_d7_t', 'SK', 'PM', 'ATR', 'Median_HL', 'insec_t', 'variation_t', 'ret', 'MDD']
2025-05-19 23:22:01,938 - INFO - [src.data_preparation] - Ticker SCO - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:01,938 - INFO - [src.data_preparation] - Ticker SCO - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:01,940 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SCO
2025-05-19 23:22:01,941 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:01,941 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(74), np.int64(1): np.int64(389)}
2025-05-19 23:22:01,941 - INFO - [src.data_preparation] - Generating 315 synthetic minority samples
2025-05-19 23:22:01,952 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (778, 13, 15), y shape: (778,)
2025-05-19 23:22:01,953 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(389), np.int64(1): np.int64(389)}
2025-05-19 23:22:01,959 - INFO - [src.data_preparation] - Ticker SCO - Final 3D shapes: X_train=(778, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:01,961 - INFO - [__main__] - Using best model for SCO: logistic_regression (F1: 0.9398)
2025-05-19 23:22:01,961 - INFO - [__main__] - Loading logistic_regression model for SCO...
2025-05-19 23:22:01,962 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:01,962 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:01,962 - INFO - [__main__] - Making predictions for SCO using logistic_regression
2025-05-19 23:22:01,962 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:01,962 - INFO - [__main__] - Successfully got last prediction for SCO
2025-05-19 23:22:01,962 - INFO - [__main__] - 
Processing ticker: SCR
2025-05-19 23:22:01,963 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:01,963 - INFO - [__main__] - Getting last prediction point for ticker: SCR
2025-05-19 23:22:01,963 - INFO - [__main__] - ==================================================
2025-05-19 23:22:01,963 - INFO - [__main__] - Preparing test data for SCR...
2025-05-19 23:22:01,994 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:01,994 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:01,994 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:02,014 - INFO - [src.data_preparation] - Ticker SCR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:02,014 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(307), np.int64(1): np.int64(332)}
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] - Ticker SCR - Selected features:
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] -   Volatility: 0.0782
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] -   TVV: 0.0722
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] -   vnipc_t: 0.0689
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] -   ATR: 0.0634
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] -   SK: 0.0623
2025-05-19 23:22:02,353 - INFO - [src.data_preparation] -   insec_t: 0.0602
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   s_d7_t: 0.0590
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   HL: 0.0582
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   ma7_t: 0.0574
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   ma14_t: 0.0559
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   ma21_t: 0.0556
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   LO: 0.0534
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   Median_HL: 0.0522
2025-05-19 23:22:02,354 - INFO - [src.data_preparation] -   ret: 0.0514
2025-05-19 23:22:02,357 - INFO - [src.data_preparation] - Ticker SCR - Using features: ['Date', 'Volatility', 'TVV', 'vnipc_t', 'ATR', 'SK', 'insec_t', 's_d7_t', 'HL', 'ma7_t', 'ma14_t', 'ma21_t', 'LO', 'PM', 'Median_HL', 'ret']
2025-05-19 23:22:02,449 - INFO - [src.data_preparation] - Ticker SCR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:02,449 - INFO - [src.data_preparation] - Ticker SCR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:02,451 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SCR
2025-05-19 23:22:02,451 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:02,451 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(222), np.int64(1): np.int64(241)}
2025-05-19 23:22:02,451 - INFO - [src.data_preparation] - Generating 19 synthetic minority samples
2025-05-19 23:22:02,452 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (482, 13, 15), y shape: (482,)
2025-05-19 23:22:02,452 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(241), np.int64(1): np.int64(241)}
2025-05-19 23:22:02,455 - INFO - [src.data_preparation] - Ticker SCR - Final 3D shapes: X_train=(482, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:02,455 - INFO - [__main__] - Using best model for SCR: lstm (F1: 0.6780)
2025-05-19 23:22:02,455 - INFO - [__main__] - Loading lstm model for SCR...
2025-05-19 23:22:02,460 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:02,461 - INFO - [__main__] - Model size: 0.12 MB
2025-05-19 23:22:02,461 - INFO - [__main__] - Making predictions for SCR using lstm
2025-05-19 23:22:02,463 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:02,463 - INFO - [__main__] - Successfully got last prediction for SCR
2025-05-19 23:22:02,464 - INFO - [__main__] - 
Processing ticker: SD1
2025-05-19 23:22:02,464 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:02,464 - INFO - [__main__] - Getting last prediction point for ticker: SD1
2025-05-19 23:22:02,464 - INFO - [__main__] - ==================================================
2025-05-19 23:22:02,464 - INFO - [__main__] - Preparing test data for SD1...
2025-05-19 23:22:02,504 - INFO - [src.data_preparation] - After processing - X shape: (636, 19), y shape: (636,)
2025-05-19 23:22:02,504 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:02,504 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:02,533 - INFO - [src.data_preparation] - Ticker SD1 - Original shapes: X=(636, 18), y=(636,)
2025-05-19 23:22:02,534 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(127), np.int64(1): np.int64(509)}
2025-05-19 23:22:02,801 - INFO - [src.data_preparation] - Ticker SD1 - Selected features:
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   vnipc_t: 0.1053
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   TVV: 0.0842
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   ma14_t: 0.0752
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   ma21_t: 0.0730
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   ATR: 0.0688
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   ma7_t: 0.0679
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   Volatility: 0.0649
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   s_d7_t: 0.0618
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   SK: 0.0552
2025-05-19 23:22:02,802 - INFO - [src.data_preparation] -   HL: 0.0549
2025-05-19 23:22:02,803 - INFO - [src.data_preparation] -   Median_HL: 0.0495
2025-05-19 23:22:02,803 - INFO - [src.data_preparation] -   insec_t: 0.0490
2025-05-19 23:22:02,803 - INFO - [src.data_preparation] -   PM: 0.0446
2025-05-19 23:22:02,803 - INFO - [src.data_preparation] -   ret: 0.0421
2025-05-19 23:22:02,803 - INFO - [src.data_preparation] -   variation_t: 0.0419
2025-05-19 23:22:02,810 - INFO - [src.data_preparation] - Ticker SD1 - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 'ma21_t', 'ATR', 'ma7_t', 'Volatility', 's_d7_t', 'SK', 'HL', 'Median_HL', 'insec_t', 'PM', 'ret', 'variation_t']
2025-05-19 23:22:02,928 - INFO - [src.data_preparation] - Ticker SD1 - 2D shapes: X_train=(460, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:02,928 - INFO - [src.data_preparation] - Ticker SD1 - 3D shapes: X_train=(460, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:02,930 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD1
2025-05-19 23:22:02,930 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (460, 13, 15), y shape: (460,)
2025-05-19 23:22:02,930 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(92), np.int64(1): np.int64(368)}
2025-05-19 23:22:02,930 - INFO - [src.data_preparation] - Generating 276 synthetic minority samples
2025-05-19 23:22:02,941 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (736, 13, 15), y shape: (736,)
2025-05-19 23:22:02,941 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(368), np.int64(1): np.int64(368)}
2025-05-19 23:22:02,946 - INFO - [src.data_preparation] - Ticker SD1 - Final 3D shapes: X_train=(736, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:02,946 - INFO - [__main__] - Using best model for SD1: lstm (F1: 0.9885)
2025-05-19 23:22:02,946 - INFO - [__main__] - Loading lstm model for SD1...
2025-05-19 23:22:02,950 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:02,951 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:22:02,951 - INFO - [__main__] - Making predictions for SD1 using lstm
2025-05-19 23:22:02,954 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:02,954 - INFO - [__main__] - Successfully got last prediction for SD1
2025-05-19 23:22:02,954 - INFO - [__main__] - 
Processing ticker: SD2
2025-05-19 23:22:02,954 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:02,954 - INFO - [__main__] - Getting last prediction point for ticker: SD2
2025-05-19 23:22:02,954 - INFO - [__main__] - ==================================================
2025-05-19 23:22:02,955 - INFO - [__main__] - Preparing test data for SD2...
2025-05-19 23:22:02,999 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:02,999 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:03,000 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:03,034 - INFO - [src.data_preparation] - Ticker SD2 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:03,035 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(281), np.int64(1): np.int64(357)}
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] - Ticker SD2 - Selected features:
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   ma21_t: 0.0696
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   ma14_t: 0.0690
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   vnipc_t: 0.0689
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   ATR: 0.0644
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   Volatility: 0.0620
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   TVV: 0.0617
2025-05-19 23:22:03,520 - INFO - [src.data_preparation] -   ma7_t: 0.0616
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   s_d7_t: 0.0594
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   insec_t: 0.0582
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   PM: 0.0572
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   HL: 0.0508
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   SR: 0.0505
2025-05-19 23:22:03,521 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:22:03,524 - INFO - [src.data_preparation] - Ticker SD2 - Using features: ['Date', 'ma21_t', 'SK', 'ma14_t', 'vnipc_t', 'ATR', 'Volatility', 'TVV', 'ma7_t', 's_d7_t', 'insec_t', 'PM', 'ret', 'HL', 'SR', 'Median_HL']
2025-05-19 23:22:03,628 - INFO - [src.data_preparation] - Ticker SD2 - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:22:03,628 - INFO - [src.data_preparation] - Ticker SD2 - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:03,630 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD2
2025-05-19 23:22:03,630 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:03,631 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:22:03,631 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:22:03,634 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:22:03,634 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:22:03,637 - INFO - [src.data_preparation] - Ticker SD2 - Final 3D shapes: X_train=(536, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:03,638 - INFO - [__main__] - Using best model for SD2: lstm (F1: 0.7385)
2025-05-19 23:22:03,638 - INFO - [__main__] - Loading lstm model for SD2...
2025-05-19 23:22:03,642 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:03,643 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:22:03,643 - INFO - [__main__] - Making predictions for SD2 using lstm
2025-05-19 23:22:03,645 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:03,646 - INFO - [__main__] - Successfully got last prediction for SD2
2025-05-19 23:22:03,646 - INFO - [__main__] - 
Processing ticker: SD4
2025-05-19 23:22:03,646 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:03,646 - INFO - [__main__] - Getting last prediction point for ticker: SD4
2025-05-19 23:22:03,646 - INFO - [__main__] - ==================================================
2025-05-19 23:22:03,646 - INFO - [__main__] - Preparing test data for SD4...
2025-05-19 23:22:03,684 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:03,684 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:03,684 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:03,715 - INFO - [src.data_preparation] - Ticker SD4 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:03,715 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(250), np.int64(1): np.int64(388)}
2025-05-19 23:22:04,130 - INFO - [src.data_preparation] - Ticker SD4 - Selected features:
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   vnipc_t: 0.0792
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   TVV: 0.0735
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   ATR: 0.0710
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   insec_t: 0.0685
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   s_d7_t: 0.0684
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   SK: 0.0660
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   variation_t: 0.0571
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   ma21_t: 0.0558
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   ret: 0.0553
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   ma14_t: 0.0544
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   ma7_t: 0.0516
2025-05-19 23:22:04,131 - INFO - [src.data_preparation] -   PM: 0.0504
2025-05-19 23:22:04,132 - INFO - [src.data_preparation] -   HL: 0.0471
2025-05-19 23:22:04,132 - INFO - [src.data_preparation] -   Median_HL: 0.0469
2025-05-19 23:22:04,135 - INFO - [src.data_preparation] - Ticker SD4 - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'Volatility', 'insec_t', 's_d7_t', 'SK', 'variation_t', 'ma21_t', 'ret', 'ma14_t', 'ma7_t', 'PM', 'HL', 'Median_HL']
2025-05-19 23:22:04,225 - INFO - [src.data_preparation] - Ticker SD4 - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:22:04,225 - INFO - [src.data_preparation] - Ticker SD4 - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:04,228 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD4
2025-05-19 23:22:04,228 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:04,228 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(184), np.int64(1): np.int64(279)}
2025-05-19 23:22:04,228 - INFO - [src.data_preparation] - Generating 95 synthetic minority samples
2025-05-19 23:22:04,231 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (558, 13, 15), y shape: (558,)
2025-05-19 23:22:04,232 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(279), np.int64(1): np.int64(279)}
2025-05-19 23:22:04,235 - INFO - [src.data_preparation] - Ticker SD4 - Final 3D shapes: X_train=(558, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:04,235 - INFO - [__main__] - Using best model for SD4: svm (F1: 0.7606)
2025-05-19 23:22:04,235 - INFO - [__main__] - Loading svm model for SD4...
2025-05-19 23:22:04,237 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:04,238 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:22:04,238 - INFO - [__main__] - Making predictions for SD4 using svm
2025-05-19 23:22:04,238 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:04,239 - INFO - [__main__] - Successfully got last prediction for SD4
2025-05-19 23:22:04,239 - INFO - [__main__] - 
Processing ticker: SD5
2025-05-19 23:22:04,239 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:04,239 - INFO - [__main__] - Getting last prediction point for ticker: SD5
2025-05-19 23:22:04,239 - INFO - [__main__] - ==================================================
2025-05-19 23:22:04,239 - INFO - [__main__] - Preparing test data for SD5...
2025-05-19 23:22:04,266 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:04,267 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:04,267 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:04,286 - INFO - [src.data_preparation] - Ticker SD5 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:04,287 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(361)}
2025-05-19 23:22:04,614 - INFO - [src.data_preparation] - Ticker SD5 - Selected features:
2025-05-19 23:22:04,614 - INFO - [src.data_preparation] -   SK: 0.0727
2025-05-19 23:22:04,614 - INFO - [src.data_preparation] -   vnipc_t: 0.0693
2025-05-19 23:22:04,614 - INFO - [src.data_preparation] -   s_d7_t: 0.0665
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   Volatility: 0.0653
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   ma14_t: 0.0626
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   HL: 0.0617
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   insec_t: 0.0615
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   TVV: 0.0587
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   ATR: 0.0574
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   ma21_t: 0.0557
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   ret: 0.0556
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   SR: 0.0540
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   PM: 0.0529
2025-05-19 23:22:04,615 - INFO - [src.data_preparation] -   Median_HL: 0.0513
2025-05-19 23:22:04,618 - INFO - [src.data_preparation] - Ticker SD5 - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'Volatility', 'ma14_t', 'HL', 'insec_t', 'TVV', 'ATR', 'ma21_t', 'ret', 'SR', 'variation_t', 'PM', 'Median_HL']
2025-05-19 23:22:04,705 - INFO - [src.data_preparation] - Ticker SD5 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:04,705 - INFO - [src.data_preparation] - Ticker SD5 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:04,708 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD5
2025-05-19 23:22:04,709 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:04,709 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:22:04,709 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:22:04,711 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:22:04,712 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:22:04,715 - INFO - [src.data_preparation] - Ticker SD5 - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:04,715 - INFO - [__main__] - Using best model for SD5: svm (F1: 0.7037)
2025-05-19 23:22:04,715 - INFO - [__main__] - Loading svm model for SD5...
2025-05-19 23:22:04,716 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:04,717 - INFO - [__main__] - Model size: 0.68 MB
2025-05-19 23:22:04,717 - INFO - [__main__] - Making predictions for SD5 using svm
2025-05-19 23:22:04,717 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:04,718 - INFO - [__main__] - Successfully got last prediction for SD5
2025-05-19 23:22:04,718 - INFO - [__main__] - 
Processing ticker: SD6
2025-05-19 23:22:04,718 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:04,718 - INFO - [__main__] - Getting last prediction point for ticker: SD6
2025-05-19 23:22:04,718 - INFO - [__main__] - ==================================================
2025-05-19 23:22:04,718 - INFO - [__main__] - Preparing test data for SD6...
2025-05-19 23:22:04,751 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:04,751 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:04,751 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:04,771 - INFO - [src.data_preparation] - Ticker SD6 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:04,771 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(263), np.int64(1): np.int64(375)}
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] - Ticker SD6 - Selected features:
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   Volatility: 0.0791
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   insec_t: 0.0744
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   s_d7_t: 0.0731
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   TVV: 0.0703
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   SK: 0.0622
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   ma21_t: 0.0616
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   PM: 0.0556
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   ma14_t: 0.0546
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   ATR: 0.0545
2025-05-19 23:22:05,087 - INFO - [src.data_preparation] -   ma7_t: 0.0527
2025-05-19 23:22:05,088 - INFO - [src.data_preparation] -   variation_t: 0.0511
2025-05-19 23:22:05,088 - INFO - [src.data_preparation] -   Median_HL: 0.0505
2025-05-19 23:22:05,088 - INFO - [src.data_preparation] -   SR: 0.0490
2025-05-19 23:22:05,088 - INFO - [src.data_preparation] -   ret: 0.0462
2025-05-19 23:22:05,091 - INFO - [src.data_preparation] - Ticker SD6 - Using features: ['Date', 'Volatility', 'vnipc_t', 'insec_t', 's_d7_t', 'TVV', 'SK', 'ma21_t', 'PM', 'ma14_t', 'ATR', 'ma7_t', 'variation_t', 'Median_HL', 'SR', 'ret']
2025-05-19 23:22:05,185 - INFO - [src.data_preparation] - Ticker SD6 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(44, 195)
2025-05-19 23:22:05,186 - INFO - [src.data_preparation] - Ticker SD6 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:22:05,187 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD6
2025-05-19 23:22:05,188 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:05,188 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:22:05,188 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:22:05,191 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:22:05,191 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:22:05,194 - INFO - [src.data_preparation] - Ticker SD6 - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(44, 13, 15)
2025-05-19 23:22:05,195 - INFO - [__main__] - Using best model for SD6: lstm (F1: 0.7714)
2025-05-19 23:22:05,195 - INFO - [__main__] - Loading lstm model for SD6...
2025-05-19 23:22:05,199 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:05,199 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:22:05,199 - INFO - [__main__] - Making predictions for SD6 using lstm
2025-05-19 23:22:05,199 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:05,199 - INFO - [__main__] - Successfully got last prediction for SD6
2025-05-19 23:22:05,199 - INFO - [__main__] - 
Processing ticker: SD7
2025-05-19 23:22:05,199 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:05,199 - INFO - [__main__] - Getting last prediction point for ticker: SD7
2025-05-19 23:22:05,199 - INFO - [__main__] - ==================================================
2025-05-19 23:22:05,199 - INFO - [__main__] - Preparing test data for SD7...
2025-05-19 23:22:05,241 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:05,241 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:05,241 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:05,265 - INFO - [src.data_preparation] - Ticker SD7 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:05,266 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(247), np.int64(1): np.int64(392)}
2025-05-19 23:22:05,626 - INFO - [src.data_preparation] - Ticker SD7 - Selected features:
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   TVV: 0.0836
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   vnipc_t: 0.0815
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   ma21_t: 0.0659
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   s_d7_t: 0.0622
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   insec_t: 0.0614
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   ma14_t: 0.0595
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   ma7_t: 0.0595
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   Volatility: 0.0568
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   ret: 0.0511
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   variation_t: 0.0480
2025-05-19 23:22:05,627 - INFO - [src.data_preparation] -   HL: 0.0437
2025-05-19 23:22:05,632 - INFO - [src.data_preparation] - Ticker SD7 - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'ATR', 'SK', 's_d7_t', 'insec_t', 'ma14_t', 'ma7_t', 'Volatility', 'Median_HL', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:22:05,762 - INFO - [src.data_preparation] - Ticker SD7 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:05,762 - INFO - [src.data_preparation] - Ticker SD7 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:05,764 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD7
2025-05-19 23:22:05,765 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:05,765 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(194), np.int64(1): np.int64(269)}
2025-05-19 23:22:05,765 - INFO - [src.data_preparation] - Generating 75 synthetic minority samples
2025-05-19 23:22:05,774 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (538, 13, 15), y shape: (538,)
2025-05-19 23:22:05,774 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(269), np.int64(1): np.int64(269)}
2025-05-19 23:22:05,778 - INFO - [src.data_preparation] - Ticker SD7 - Final 3D shapes: X_train=(538, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:05,779 - INFO - [__main__] - Using best model for SD7: lstm (F1: 0.9136)
2025-05-19 23:22:05,779 - INFO - [__main__] - Loading lstm model for SD7...
2025-05-19 23:22:05,783 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:05,785 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:22:05,785 - INFO - [__main__] - Making predictions for SD7 using lstm
2025-05-19 23:22:05,786 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:05,787 - INFO - [__main__] - Successfully got last prediction for SD7
2025-05-19 23:22:05,787 - INFO - [__main__] - 
Processing ticker: SD8
2025-05-19 23:22:05,787 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:05,787 - INFO - [__main__] - Getting last prediction point for ticker: SD8
2025-05-19 23:22:05,787 - INFO - [__main__] - ==================================================
2025-05-19 23:22:05,787 - INFO - [__main__] - Preparing test data for SD8...
2025-05-19 23:22:05,858 - INFO - [src.data_preparation] - After processing - X shape: (504, 19), y shape: (504,)
2025-05-19 23:22:05,858 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:05,859 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:05,894 - INFO - [src.data_preparation] - Ticker SD8 - Original shapes: X=(504, 18), y=(504,)
2025-05-19 23:22:05,894 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(98), np.int64(1): np.int64(406)}
2025-05-19 23:22:06,138 - INFO - [src.data_preparation] - Ticker SD8 - Selected features:
2025-05-19 23:22:06,138 - INFO - [src.data_preparation] -   vnipc_t: 0.1281
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   ma21_t: 0.0957
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   ma14_t: 0.0850
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   s_d7_t: 0.0745
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   TVV: 0.0724
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   ma7_t: 0.0694
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   SK: 0.0622
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   Volatility: 0.0607
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   PM: 0.0450
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   Median_HL: 0.0427
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   insec_t: 0.0406
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   variation_t: 0.0364
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   ret: 0.0355
2025-05-19 23:22:06,139 - INFO - [src.data_preparation] -   HL: 0.0251
2025-05-19 23:22:06,142 - INFO - [src.data_preparation] - Ticker SD8 - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 's_d7_t', 'TVV', 'ma7_t', 'SK', 'ATR', 'Volatility', 'PM', 'Median_HL', 'insec_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:22:06,216 - INFO - [src.data_preparation] - Ticker SD8 - 2D shapes: X_train=(328, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:06,216 - INFO - [src.data_preparation] - Ticker SD8 - 3D shapes: X_train=(328, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:06,217 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD8
2025-05-19 23:22:06,217 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (328, 13, 15), y shape: (328,)
2025-05-19 23:22:06,217 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(65), np.int64(1): np.int64(263)}
2025-05-19 23:22:06,217 - INFO - [src.data_preparation] - Generating 198 synthetic minority samples
2025-05-19 23:22:06,223 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:22:06,223 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:22:06,227 - INFO - [src.data_preparation] - Ticker SD8 - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:06,228 - INFO - [__main__] - Using best model for SD8: logistic_regression (F1: 0.4000)
2025-05-19 23:22:06,228 - INFO - [__main__] - Loading logistic_regression model for SD8...
2025-05-19 23:22:06,228 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:06,228 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:06,228 - INFO - [__main__] - Making predictions for SD8 using logistic_regression
2025-05-19 23:22:06,229 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:06,229 - INFO - [__main__] - Successfully got last prediction for SD8
2025-05-19 23:22:06,229 - INFO - [__main__] - 
Processing ticker: SD9
2025-05-19 23:22:06,229 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:06,229 - INFO - [__main__] - Getting last prediction point for ticker: SD9
2025-05-19 23:22:06,229 - INFO - [__main__] - ==================================================
2025-05-19 23:22:06,229 - INFO - [__main__] - Preparing test data for SD9...
2025-05-19 23:22:06,266 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:06,266 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:06,266 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:06,287 - INFO - [src.data_preparation] - Ticker SD9 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:06,287 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] - Ticker SD9 - Selected features:
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   vnipc_t: 0.0862
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   SK: 0.0728
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   insec_t: 0.0720
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   TVV: 0.0614
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   ret: 0.0595
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   s_d7_t: 0.0578
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   Volatility: 0.0567
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   Median_HL: 0.0563
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   ma14_t: 0.0553
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   ma21_t: 0.0533
2025-05-19 23:22:06,603 - INFO - [src.data_preparation] -   ATR: 0.0525
2025-05-19 23:22:06,604 - INFO - [src.data_preparation] -   LO: 0.0519
2025-05-19 23:22:06,604 - INFO - [src.data_preparation] -   HL: 0.0519
2025-05-19 23:22:06,607 - INFO - [src.data_preparation] - Ticker SD9 - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'TVV', 'ret', 'PM', 's_d7_t', 'Volatility', 'Median_HL', 'variation_t', 'ma14_t', 'ma21_t', 'ATR', 'LO', 'HL']
2025-05-19 23:22:06,709 - INFO - [src.data_preparation] - Ticker SD9 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:06,709 - INFO - [src.data_preparation] - Ticker SD9 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:06,712 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SD9
2025-05-19 23:22:06,712 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:06,713 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:22:06,713 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:22:06,716 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:22:06,716 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:22:06,720 - INFO - [src.data_preparation] - Ticker SD9 - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:06,720 - INFO - [__main__] - Using best model for SD9: svm (F1: 0.6923)
2025-05-19 23:22:06,720 - INFO - [__main__] - Loading svm model for SD9...
2025-05-19 23:22:06,722 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:06,722 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:22:06,722 - INFO - [__main__] - Making predictions for SD9 using svm
2025-05-19 23:22:06,723 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:06,723 - INFO - [__main__] - Successfully got last prediction for SD9
2025-05-19 23:22:06,723 - INFO - [__main__] - 
Processing ticker: SDA
2025-05-19 23:22:06,723 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:06,723 - INFO - [__main__] - Getting last prediction point for ticker: SDA
2025-05-19 23:22:06,723 - INFO - [__main__] - ==================================================
2025-05-19 23:22:06,723 - INFO - [__main__] - Preparing test data for SDA...
2025-05-19 23:22:06,760 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:06,760 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:06,760 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:06,779 - INFO - [src.data_preparation] - Ticker SDA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:06,779 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(283), np.int64(1): np.int64(356)}
2025-05-19 23:22:07,088 - INFO - [src.data_preparation] - Ticker SDA - Selected features:
2025-05-19 23:22:07,088 - INFO - [src.data_preparation] -   vnipc_t: 0.0794
2025-05-19 23:22:07,088 - INFO - [src.data_preparation] -   TVV: 0.0687
2025-05-19 23:22:07,088 - INFO - [src.data_preparation] -   ma14_t: 0.0676
2025-05-19 23:22:07,088 - INFO - [src.data_preparation] -   ma21_t: 0.0672
2025-05-19 23:22:07,088 - INFO - [src.data_preparation] -   Volatility: 0.0664
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   SK: 0.0648
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   insec_t: 0.0622
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   ma7_t: 0.0615
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   s_d7_t: 0.0611
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   variation_t: 0.0564
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   ATR: 0.0559
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   ret: 0.0549
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   PM: 0.0528
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   Median_HL: 0.0484
2025-05-19 23:22:07,089 - INFO - [src.data_preparation] -   SR: 0.0429
2025-05-19 23:22:07,092 - INFO - [src.data_preparation] - Ticker SDA - Using features: ['Date', 'vnipc_t', 'TVV', 'ma14_t', 'ma21_t', 'Volatility', 'SK', 'insec_t', 'ma7_t', 's_d7_t', 'variation_t', 'ATR', 'ret', 'PM', 'Median_HL', 'SR']
2025-05-19 23:22:07,179 - INFO - [src.data_preparation] - Ticker SDA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:07,179 - INFO - [src.data_preparation] - Ticker SDA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:07,180 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDA
2025-05-19 23:22:07,181 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:07,181 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:22:07,181 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:22:07,184 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:22:07,184 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:22:07,187 - INFO - [src.data_preparation] - Ticker SDA - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:07,188 - INFO - [__main__] - Using best model for SDA: svm (F1: 0.6462)
2025-05-19 23:22:07,188 - INFO - [__main__] - Loading svm model for SDA...
2025-05-19 23:22:07,188 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:07,189 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:22:07,189 - INFO - [__main__] - Making predictions for SDA using svm
2025-05-19 23:22:07,190 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:07,190 - INFO - [__main__] - Successfully got last prediction for SDA
2025-05-19 23:22:07,190 - INFO - [__main__] - 
Processing ticker: SDB
2025-05-19 23:22:07,190 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:07,190 - INFO - [__main__] - Getting last prediction point for ticker: SDB
2025-05-19 23:22:07,190 - INFO - [__main__] - ==================================================
2025-05-19 23:22:07,190 - INFO - [__main__] - Preparing test data for SDB...
2025-05-19 23:22:07,230 - INFO - [src.data_preparation] - After processing - X shape: (636, 19), y shape: (636,)
2025-05-19 23:22:07,230 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:07,230 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:07,253 - INFO - [src.data_preparation] - Ticker SDB - Original shapes: X=(636, 18), y=(636,)
2025-05-19 23:22:07,253 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(132), np.int64(1): np.int64(504)}
2025-05-19 23:22:07,477 - INFO - [src.data_preparation] - Ticker SDB - Selected features:
2025-05-19 23:22:07,477 - INFO - [src.data_preparation] -   vnipc_t: 0.0975
2025-05-19 23:22:07,477 - INFO - [src.data_preparation] -   TVV: 0.0968
2025-05-19 23:22:07,477 - INFO - [src.data_preparation] -   ma21_t: 0.0776
2025-05-19 23:22:07,477 - INFO - [src.data_preparation] -   Volatility: 0.0764
2025-05-19 23:22:07,478 - INFO - [src.data_preparation] -   ma14_t: 0.0756
2025-05-19 23:22:07,478 - INFO - [src.data_preparation] -   s_d7_t: 0.0715
2025-05-19 23:22:07,478 - INFO - [src.data_preparation] -   ATR: 0.0687
2025-05-19 23:22:07,478 - INFO - [src.data_preparation] -   SK: 0.0639
2025-05-19 23:22:07,478 - INFO - [src.data_preparation] -   ma7_t: 0.0615
2025-05-19 23:22:07,478 - INFO - [src.data_preparation] -   PM: 0.0526
2025-05-19 23:22:07,479 - INFO - [src.data_preparation] -   Median_HL: 0.0510
2025-05-19 23:22:07,479 - INFO - [src.data_preparation] -   insec_t: 0.0463
2025-05-19 23:22:07,479 - INFO - [src.data_preparation] -   ret: 0.0370
2025-05-19 23:22:07,479 - INFO - [src.data_preparation] -   variation_t: 0.0354
2025-05-19 23:22:07,479 - INFO - [src.data_preparation] -   MDD: 0.0270
2025-05-19 23:22:07,482 - INFO - [src.data_preparation] - Ticker SDB - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'Volatility', 'ma14_t', 's_d7_t', 'ATR', 'SK', 'ma7_t', 'PM', 'Median_HL', 'insec_t', 'ret', 'variation_t', 'MDD']
2025-05-19 23:22:07,580 - INFO - [src.data_preparation] - Ticker SDB - 2D shapes: X_train=(460, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:07,580 - INFO - [src.data_preparation] - Ticker SDB - 3D shapes: X_train=(460, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:07,582 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDB
2025-05-19 23:22:07,582 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (460, 13, 15), y shape: (460,)
2025-05-19 23:22:07,582 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(98), np.int64(1): np.int64(362)}
2025-05-19 23:22:07,582 - INFO - [src.data_preparation] - Generating 264 synthetic minority samples
2025-05-19 23:22:07,593 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (724, 13, 15), y shape: (724,)
2025-05-19 23:22:07,593 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(362), np.int64(1): np.int64(362)}
2025-05-19 23:22:07,598 - INFO - [src.data_preparation] - Ticker SDB - Final 3D shapes: X_train=(724, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:07,598 - INFO - [__main__] - Using best model for SDB: lstm (F1: 0.9885)
2025-05-19 23:22:07,599 - INFO - [__main__] - Loading lstm model for SDB...
2025-05-19 23:22:07,602 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:07,603 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:22:07,603 - INFO - [__main__] - Making predictions for SDB using lstm
2025-05-19 23:22:07,606 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:07,607 - INFO - [__main__] - Successfully got last prediction for SDB
2025-05-19 23:22:07,607 - INFO - [__main__] - 
Processing ticker: SDC
2025-05-19 23:22:07,607 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:07,607 - INFO - [__main__] - Getting last prediction point for ticker: SDC
2025-05-19 23:22:07,608 - INFO - [__main__] - ==================================================
2025-05-19 23:22:07,608 - INFO - [__main__] - Preparing test data for SDC...
2025-05-19 23:22:07,655 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:07,657 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:07,657 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:07,691 - INFO - [src.data_preparation] - Ticker SDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:07,691 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(132), np.int64(1): np.int64(507)}
2025-05-19 23:22:08,031 - INFO - [src.data_preparation] - Ticker SDC - Selected features:
2025-05-19 23:22:08,031 - INFO - [src.data_preparation] -   TVV: 0.1034
2025-05-19 23:22:08,031 - INFO - [src.data_preparation] -   ma21_t: 0.0996
2025-05-19 23:22:08,031 - INFO - [src.data_preparation] -   vnipc_t: 0.0939
2025-05-19 23:22:08,031 - INFO - [src.data_preparation] -   Volatility: 0.0755
2025-05-19 23:22:08,031 - INFO - [src.data_preparation] -   ma14_t: 0.0698
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   ATR: 0.0681
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   s_d7_t: 0.0656
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   ma7_t: 0.0603
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   Median_HL: 0.0594
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   PM: 0.0581
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   SK: 0.0485
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   SR: 0.0388
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   variation_t: 0.0354
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   insec_t: 0.0351
2025-05-19 23:22:08,032 - INFO - [src.data_preparation] -   ret: 0.0325
2025-05-19 23:22:08,036 - INFO - [src.data_preparation] - Ticker SDC - Using features: ['Date', 'TVV', 'ma21_t', 'vnipc_t', 'Volatility', 'ma14_t', 'ATR', 's_d7_t', 'ma7_t', 'Median_HL', 'PM', 'SK', 'SR', 'variation_t', 'insec_t', 'ret']
2025-05-19 23:22:08,162 - INFO - [src.data_preparation] - Ticker SDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:08,162 - INFO - [src.data_preparation] - Ticker SDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:08,166 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDC
2025-05-19 23:22:08,166 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:08,166 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(89), np.int64(1): np.int64(374)}
2025-05-19 23:22:08,166 - INFO - [src.data_preparation] - Generating 285 synthetic minority samples
2025-05-19 23:22:08,179 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (748, 13, 15), y shape: (748,)
2025-05-19 23:22:08,179 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(374), np.int64(1): np.int64(374)}
2025-05-19 23:22:08,186 - INFO - [src.data_preparation] - Ticker SDC - Final 3D shapes: X_train=(748, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:08,186 - INFO - [__main__] - Using best model for SDC: svm (F1: 0.4898)
2025-05-19 23:22:08,186 - INFO - [__main__] - Loading svm model for SDC...
2025-05-19 23:22:08,188 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:08,189 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:22:08,189 - INFO - [__main__] - Making predictions for SDC using svm
2025-05-19 23:22:08,189 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:08,190 - INFO - [__main__] - Successfully got last prediction for SDC
2025-05-19 23:22:08,190 - INFO - [__main__] - 
Processing ticker: SDD
2025-05-19 23:22:08,190 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:08,190 - INFO - [__main__] - Getting last prediction point for ticker: SDD
2025-05-19 23:22:08,190 - INFO - [__main__] - ==================================================
2025-05-19 23:22:08,190 - INFO - [__main__] - Preparing test data for SDD...
2025-05-19 23:22:08,244 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:08,244 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:08,244 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:08,266 - INFO - [src.data_preparation] - Ticker SDD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:08,267 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(269), np.int64(1): np.int64(370)}
2025-05-19 23:22:08,572 - INFO - [src.data_preparation] - Ticker SDD - Selected features:
2025-05-19 23:22:08,572 - INFO - [src.data_preparation] -   TVV: 0.0832
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   insec_t: 0.0810
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   vnipc_t: 0.0792
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   Volatility: 0.0714
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   ma14_t: 0.0692
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   ma21_t: 0.0644
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   SK: 0.0608
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   ret: 0.0591
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   variation_t: 0.0574
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   ma7_t: 0.0548
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   ATR: 0.0533
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:22:08,573 - INFO - [src.data_preparation] -   HL: 0.0319
2025-05-19 23:22:08,576 - INFO - [src.data_preparation] - Ticker SDD - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 'Volatility', 'ma14_t', 'ma21_t', 's_d7_t', 'SK', 'ret', 'variation_t', 'ma7_t', 'ATR', 'Median_HL', 'PM', 'HL']
2025-05-19 23:22:08,677 - INFO - [src.data_preparation] - Ticker SDD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:08,677 - INFO - [src.data_preparation] - Ticker SDD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:08,680 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDD
2025-05-19 23:22:08,680 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:08,681 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(274)}
2025-05-19 23:22:08,681 - INFO - [src.data_preparation] - Generating 85 synthetic minority samples
2025-05-19 23:22:08,684 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (548, 13, 15), y shape: (548,)
2025-05-19 23:22:08,684 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(274), np.int64(1): np.int64(274)}
2025-05-19 23:22:08,688 - INFO - [src.data_preparation] - Ticker SDD - Final 3D shapes: X_train=(548, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:08,688 - INFO - [__main__] - Using best model for SDD: lstm (F1: 0.7606)
2025-05-19 23:22:08,688 - INFO - [__main__] - Loading lstm model for SDD...
2025-05-19 23:22:08,692 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:08,693 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:22:08,693 - INFO - [__main__] - Making predictions for SDD using lstm
2025-05-19 23:22:08,695 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:08,697 - INFO - [__main__] - Successfully got last prediction for SDD
2025-05-19 23:22:08,697 - INFO - [__main__] - 
Processing ticker: SDG
2025-05-19 23:22:08,697 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:08,697 - INFO - [__main__] - Getting last prediction point for ticker: SDG
2025-05-19 23:22:08,697 - INFO - [__main__] - ==================================================
2025-05-19 23:22:08,697 - INFO - [__main__] - Preparing test data for SDG...
2025-05-19 23:22:08,749 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:08,750 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:08,750 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:08,776 - INFO - [src.data_preparation] - Ticker SDG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:08,777 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(205), np.int64(1): np.int64(434)}
2025-05-19 23:22:09,126 - INFO - [src.data_preparation] - Ticker SDG - Selected features:
2025-05-19 23:22:09,126 - INFO - [src.data_preparation] -   vnipc_t: 0.0819
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   ma21_t: 0.0733
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   ATR: 0.0699
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   s_d7_t: 0.0683
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   ma7_t: 0.0654
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   Volatility: 0.0636
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   ma14_t: 0.0630
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   TVV: 0.0623
2025-05-19 23:22:09,127 - INFO - [src.data_preparation] -   SK: 0.0601
2025-05-19 23:22:09,128 - INFO - [src.data_preparation] -   PM: 0.0508
2025-05-19 23:22:09,128 - INFO - [src.data_preparation] -   SR: 0.0494
2025-05-19 23:22:09,128 - INFO - [src.data_preparation] -   Median_HL: 0.0487
2025-05-19 23:22:09,128 - INFO - [src.data_preparation] -   insec_t: 0.0487
2025-05-19 23:22:09,128 - INFO - [src.data_preparation] -   variation_t: 0.0474
2025-05-19 23:22:09,128 - INFO - [src.data_preparation] -   ret: 0.0459
2025-05-19 23:22:09,132 - INFO - [src.data_preparation] - Ticker SDG - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ATR', 's_d7_t', 'ma7_t', 'Volatility', 'ma14_t', 'TVV', 'SK', 'PM', 'SR', 'Median_HL', 'insec_t', 'variation_t', 'ret']
2025-05-19 23:22:09,223 - INFO - [src.data_preparation] - Ticker SDG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:09,223 - INFO - [src.data_preparation] - Ticker SDG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:09,228 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDG
2025-05-19 23:22:09,228 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:09,229 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(137), np.int64(1): np.int64(326)}
2025-05-19 23:22:09,229 - INFO - [src.data_preparation] - Generating 189 synthetic minority samples
2025-05-19 23:22:09,237 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (652, 13, 15), y shape: (652,)
2025-05-19 23:22:09,237 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(326), np.int64(1): np.int64(326)}
2025-05-19 23:22:09,240 - INFO - [src.data_preparation] - Ticker SDG - Final 3D shapes: X_train=(652, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:09,241 - INFO - [__main__] - Using best model for SDG: svm (F1: 0.8861)
2025-05-19 23:22:09,241 - INFO - [__main__] - Loading svm model for SDG...
2025-05-19 23:22:09,242 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:09,243 - INFO - [__main__] - Model size: 0.98 MB
2025-05-19 23:22:09,243 - INFO - [__main__] - Making predictions for SDG using svm
2025-05-19 23:22:09,244 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:09,244 - INFO - [__main__] - Successfully got last prediction for SDG
2025-05-19 23:22:09,244 - INFO - [__main__] - 
Processing ticker: SDJ
2025-05-19 23:22:09,244 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:09,244 - INFO - [__main__] - Getting last prediction point for ticker: SDJ
2025-05-19 23:22:09,244 - INFO - [__main__] - ==================================================
2025-05-19 23:22:09,244 - INFO - [__main__] - Preparing test data for SDJ...
2025-05-19 23:22:09,272 - INFO - [src.data_preparation] - After processing - X shape: (560, 19), y shape: (560,)
2025-05-19 23:22:09,273 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:09,273 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:09,292 - INFO - [src.data_preparation] - Ticker SDJ - Original shapes: X=(560, 18), y=(560,)
2025-05-19 23:22:09,292 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(116), np.int64(1): np.int64(444)}
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] - Ticker SDJ - Selected features:
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   vnipc_t: 0.1041
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   TVV: 0.0880
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   Volatility: 0.0830
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   ma21_t: 0.0702
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   HL: 0.0678
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   ma14_t: 0.0631
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   s_d7_t: 0.0589
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   ATR: 0.0574
2025-05-19 23:22:09,499 - INFO - [src.data_preparation] -   insec_t: 0.0562
2025-05-19 23:22:09,500 - INFO - [src.data_preparation] -   ma7_t: 0.0544
2025-05-19 23:22:09,500 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:22:09,500 - INFO - [src.data_preparation] -   Median_HL: 0.0471
2025-05-19 23:22:09,500 - INFO - [src.data_preparation] -   ret: 0.0425
2025-05-19 23:22:09,500 - INFO - [src.data_preparation] -   variation_t: 0.0417
2025-05-19 23:22:09,500 - INFO - [src.data_preparation] -   SK: 0.0416
2025-05-19 23:22:09,502 - INFO - [src.data_preparation] - Ticker SDJ - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'ma21_t', 'HL', 'ma14_t', 's_d7_t', 'ATR', 'insec_t', 'ma7_t', 'PM', 'Median_HL', 'ret', 'variation_t', 'SK']
2025-05-19 23:22:09,592 - INFO - [src.data_preparation] - Ticker SDJ - 2D shapes: X_train=(384, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:09,592 - INFO - [src.data_preparation] - Ticker SDJ - 3D shapes: X_train=(384, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:09,594 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDJ
2025-05-19 23:22:09,594 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (384, 13, 15), y shape: (384,)
2025-05-19 23:22:09,594 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(95), np.int64(1): np.int64(289)}
2025-05-19 23:22:09,594 - INFO - [src.data_preparation] - Generating 194 synthetic minority samples
2025-05-19 23:22:09,602 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (578, 13, 15), y shape: (578,)
2025-05-19 23:22:09,602 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(289), np.int64(1): np.int64(289)}
2025-05-19 23:22:09,605 - INFO - [src.data_preparation] - Ticker SDJ - Final 3D shapes: X_train=(578, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:09,605 - INFO - [__main__] - Using best model for SDJ: lstm (F1: 0.9885)
2025-05-19 23:22:09,605 - INFO - [__main__] - Loading lstm model for SDJ...
2025-05-19 23:22:09,609 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:09,611 - INFO - [__main__] - Model size: 0.25 MB
2025-05-19 23:22:09,611 - INFO - [__main__] - Making predictions for SDJ using lstm
2025-05-19 23:22:09,617 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:22:09,618 - INFO - [__main__] - Successfully got last prediction for SDJ
2025-05-19 23:22:09,618 - INFO - [__main__] - 
Processing ticker: SDK
2025-05-19 23:22:09,618 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:09,618 - INFO - [__main__] - Getting last prediction point for ticker: SDK
2025-05-19 23:22:09,618 - INFO - [__main__] - ==================================================
2025-05-19 23:22:09,618 - INFO - [__main__] - Preparing test data for SDK...
2025-05-19 23:22:09,670 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:09,671 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:09,671 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:09,693 - INFO - [src.data_preparation] - Ticker SDK - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:09,693 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(219), np.int64(1): np.int64(420)}
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] - Ticker SDK - Selected features:
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   TVV: 0.0759
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   vnipc_t: 0.0722
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   ATR: 0.0673
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   SK: 0.0656
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:22:10,028 - INFO - [src.data_preparation] -   insec_t: 0.0588
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   ma21_t: 0.0583
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   Median_HL: 0.0582
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   ma14_t: 0.0571
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   PM: 0.0556
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   ma7_t: 0.0551
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   SR: 0.0522
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   ret: 0.0515
2025-05-19 23:22:10,029 - INFO - [src.data_preparation] -   HL: 0.0505
2025-05-19 23:22:10,033 - INFO - [src.data_preparation] - Ticker SDK - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'Volatility', 'SK', 's_d7_t', 'insec_t', 'ma21_t', 'Median_HL', 'ma14_t', 'PM', 'ma7_t', 'SR', 'ret', 'HL']
2025-05-19 23:22:10,127 - INFO - [src.data_preparation] - Ticker SDK - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:10,127 - INFO - [src.data_preparation] - Ticker SDK - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:10,130 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDK
2025-05-19 23:22:10,131 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:10,131 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(153), np.int64(1): np.int64(310)}
2025-05-19 23:22:10,131 - INFO - [src.data_preparation] - Generating 157 synthetic minority samples
2025-05-19 23:22:10,138 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (620, 13, 15), y shape: (620,)
2025-05-19 23:22:10,138 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(310), np.int64(1): np.int64(310)}
2025-05-19 23:22:10,142 - INFO - [src.data_preparation] - Ticker SDK - Final 3D shapes: X_train=(620, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:10,142 - INFO - [__main__] - Using best model for SDK: svm (F1: 0.6866)
2025-05-19 23:22:10,142 - INFO - [__main__] - Loading svm model for SDK...
2025-05-19 23:22:10,143 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:10,144 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:22:10,144 - INFO - [__main__] - Making predictions for SDK using svm
2025-05-19 23:22:10,145 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:10,145 - INFO - [__main__] - Successfully got last prediction for SDK
2025-05-19 23:22:10,145 - INFO - [__main__] - 
Processing ticker: SDN
2025-05-19 23:22:10,145 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:10,145 - INFO - [__main__] - Getting last prediction point for ticker: SDN
2025-05-19 23:22:10,145 - INFO - [__main__] - ==================================================
2025-05-19 23:22:10,145 - INFO - [__main__] - Preparing test data for SDN...
2025-05-19 23:22:10,185 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:10,185 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:10,185 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:10,205 - INFO - [src.data_preparation] - Ticker SDN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:10,205 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(172), np.int64(1): np.int64(467)}
2025-05-19 23:22:10,565 - INFO - [src.data_preparation] - Ticker SDN - Selected features:
2025-05-19 23:22:10,565 - INFO - [src.data_preparation] -   vnipc_t: 0.0819
2025-05-19 23:22:10,565 - INFO - [src.data_preparation] -   ma14_t: 0.0760
2025-05-19 23:22:10,565 - INFO - [src.data_preparation] -   TVV: 0.0739
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   ma21_t: 0.0716
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   ATR: 0.0680
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   s_d7_t: 0.0648
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   PM: 0.0601
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   ma7_t: 0.0591
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   Median_HL: 0.0572
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   Volatility: 0.0558
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   HL: 0.0553
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   SK: 0.0527
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   variation_t: 0.0501
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:22:10,566 - INFO - [src.data_preparation] -   insec_t: 0.0468
2025-05-19 23:22:10,571 - INFO - [src.data_preparation] - Ticker SDN - Using features: ['Date', 'vnipc_t', 'ma14_t', 'TVV', 'ma21_t', 'ATR', 's_d7_t', 'PM', 'ma7_t', 'Median_HL', 'Volatility', 'HL', 'SK', 'variation_t', 'ret', 'insec_t']
2025-05-19 23:22:10,672 - INFO - [src.data_preparation] - Ticker SDN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:10,672 - INFO - [src.data_preparation] - Ticker SDN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:10,673 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDN
2025-05-19 23:22:10,674 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:10,674 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(111), np.int64(1): np.int64(352)}
2025-05-19 23:22:10,674 - INFO - [src.data_preparation] - Generating 241 synthetic minority samples
2025-05-19 23:22:10,685 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (704, 13, 15), y shape: (704,)
2025-05-19 23:22:10,685 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(352), np.int64(1): np.int64(352)}
2025-05-19 23:22:10,689 - INFO - [src.data_preparation] - Ticker SDN - Final 3D shapes: X_train=(704, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:10,691 - INFO - [__main__] - Using best model for SDN: svm (F1: 0.7246)
2025-05-19 23:22:10,691 - INFO - [__main__] - Loading svm model for SDN...
2025-05-19 23:22:10,693 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:10,693 - INFO - [__main__] - Model size: 1.06 MB
2025-05-19 23:22:10,694 - INFO - [__main__] - Making predictions for SDN using svm
2025-05-19 23:22:10,694 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:10,695 - INFO - [__main__] - Successfully got last prediction for SDN
2025-05-19 23:22:10,695 - INFO - [__main__] - 
Processing ticker: SDP
2025-05-19 23:22:10,695 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:10,695 - INFO - [__main__] - Getting last prediction point for ticker: SDP
2025-05-19 23:22:10,695 - INFO - [__main__] - ==================================================
2025-05-19 23:22:10,695 - INFO - [__main__] - Preparing test data for SDP...
2025-05-19 23:22:10,723 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:10,723 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:10,723 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:10,742 - INFO - [src.data_preparation] - Ticker SDP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:10,743 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(265), np.int64(1): np.int64(374)}
2025-05-19 23:22:11,025 - INFO - [src.data_preparation] - Ticker SDP - Selected features:
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   TVV: 0.0796
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   vnipc_t: 0.0773
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   insec_t: 0.0763
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   ma21_t: 0.0661
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   ma7_t: 0.0642
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   s_d7_t: 0.0636
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   Median_HL: 0.0630
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   ma14_t: 0.0624
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   Volatility: 0.0617
2025-05-19 23:22:11,027 - INFO - [src.data_preparation] -   ATR: 0.0593
2025-05-19 23:22:11,028 - INFO - [src.data_preparation] -   SK: 0.0556
2025-05-19 23:22:11,028 - INFO - [src.data_preparation] -   PM: 0.0533
2025-05-19 23:22:11,028 - INFO - [src.data_preparation] -   ret: 0.0468
2025-05-19 23:22:11,028 - INFO - [src.data_preparation] -   variation_t: 0.0436
2025-05-19 23:22:11,028 - INFO - [src.data_preparation] -   HL: 0.0422
2025-05-19 23:22:11,031 - INFO - [src.data_preparation] - Ticker SDP - Using features: ['Date', 'TVV', 'vnipc_t', 'insec_t', 'ma21_t', 'ma7_t', 's_d7_t', 'Median_HL', 'ma14_t', 'Volatility', 'ATR', 'SK', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:22:11,135 - INFO - [src.data_preparation] - Ticker SDP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:11,135 - INFO - [src.data_preparation] - Ticker SDP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:11,137 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDP
2025-05-19 23:22:11,137 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:11,137 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(259)}
2025-05-19 23:22:11,137 - INFO - [src.data_preparation] - Generating 55 synthetic minority samples
2025-05-19 23:22:11,140 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:22:11,140 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:22:11,143 - INFO - [src.data_preparation] - Ticker SDP - Final 3D shapes: X_train=(518, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:11,143 - INFO - [__main__] - Using best model for SDP: lstm (F1: 0.8421)
2025-05-19 23:22:11,143 - INFO - [__main__] - Loading lstm model for SDP...
2025-05-19 23:22:11,147 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:11,149 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:22:11,149 - INFO - [__main__] - Making predictions for SDP using lstm
2025-05-19 23:22:11,152 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:11,153 - INFO - [__main__] - Successfully got last prediction for SDP
2025-05-19 23:22:11,153 - INFO - [__main__] - 
Processing ticker: SDT
2025-05-19 23:22:11,153 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:11,153 - INFO - [__main__] - Getting last prediction point for ticker: SDT
2025-05-19 23:22:11,153 - INFO - [__main__] - ==================================================
2025-05-19 23:22:11,153 - INFO - [__main__] - Preparing test data for SDT...
2025-05-19 23:22:11,216 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:11,217 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:11,217 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:11,241 - INFO - [src.data_preparation] - Ticker SDT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:11,241 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(279), np.int64(1): np.int64(359)}
2025-05-19 23:22:11,582 - INFO - [src.data_preparation] - Ticker SDT - Selected features:
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   TVV: 0.0762
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   vnipc_t: 0.0756
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   insec_t: 0.0677
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   Volatility: 0.0675
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   s_d7_t: 0.0641
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   SK: 0.0633
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   HL: 0.0622
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   ma21_t: 0.0547
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   LO: 0.0543
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   PM: 0.0535
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:22:11,583 - INFO - [src.data_preparation] -   ma14_t: 0.0525
2025-05-19 23:22:11,584 - INFO - [src.data_preparation] -   ma7_t: 0.0515
2025-05-19 23:22:11,584 - INFO - [src.data_preparation] -   Median_HL: 0.0489
2025-05-19 23:22:11,586 - INFO - [src.data_preparation] - Ticker SDT - Using features: ['Date', 'TVV', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'SK', 'HL', 'ATR', 'ma21_t', 'LO', 'PM', 'variation_t', 'ma14_t', 'ma7_t', 'Median_HL']
2025-05-19 23:22:11,680 - INFO - [src.data_preparation] - Ticker SDT - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:22:11,681 - INFO - [src.data_preparation] - Ticker SDT - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:11,684 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDT
2025-05-19 23:22:11,684 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:11,684 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:22:11,685 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:22:11,694 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:22:11,694 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:22:11,702 - INFO - [src.data_preparation] - Ticker SDT - Final 3D shapes: X_train=(530, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:11,702 - INFO - [__main__] - Using best model for SDT: svm (F1: 0.7059)
2025-05-19 23:22:11,703 - INFO - [__main__] - Loading svm model for SDT...
2025-05-19 23:22:11,705 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:11,707 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:22:11,707 - INFO - [__main__] - Making predictions for SDT using svm
2025-05-19 23:22:11,708 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:11,708 - INFO - [__main__] - Successfully got last prediction for SDT
2025-05-19 23:22:11,708 - INFO - [__main__] - 
Processing ticker: SDU
2025-05-19 23:22:11,708 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:11,709 - INFO - [__main__] - Getting last prediction point for ticker: SDU
2025-05-19 23:22:11,709 - INFO - [__main__] - ==================================================
2025-05-19 23:22:11,709 - INFO - [__main__] - Preparing test data for SDU...
2025-05-19 23:22:11,759 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:11,759 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:11,760 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:11,780 - INFO - [src.data_preparation] - Ticker SDU - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:11,780 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(186), np.int64(1): np.int64(453)}
2025-05-19 23:22:12,041 - INFO - [src.data_preparation] - Ticker SDU - Selected features:
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   TVV: 0.1176
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   ATR: 0.0725
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   vnipc_t: 0.0694
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   Volatility: 0.0694
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   insec_t: 0.0643
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   SK: 0.0632
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   ma21_t: 0.0619
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   ma14_t: 0.0578
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:22:12,042 - INFO - [src.data_preparation] -   variation_t: 0.0469
2025-05-19 23:22:12,043 - INFO - [src.data_preparation] -   HL: 0.0452
2025-05-19 23:22:12,043 - INFO - [src.data_preparation] -   ret: 0.0449
2025-05-19 23:22:12,045 - INFO - [src.data_preparation] - Ticker SDU - Using features: ['Date', 'TVV', 'ATR', 'vnipc_t', 'Volatility', 'insec_t', 's_d7_t', 'SK', 'ma21_t', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 'variation_t', 'HL', 'ret']
2025-05-19 23:22:12,141 - INFO - [src.data_preparation] - Ticker SDU - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:12,141 - INFO - [src.data_preparation] - Ticker SDU - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:12,143 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDU
2025-05-19 23:22:12,143 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:12,143 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(142), np.int64(1): np.int64(321)}
2025-05-19 23:22:12,143 - INFO - [src.data_preparation] - Generating 179 synthetic minority samples
2025-05-19 23:22:12,150 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (642, 13, 15), y shape: (642,)
2025-05-19 23:22:12,150 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(321), np.int64(1): np.int64(321)}
2025-05-19 23:22:12,154 - INFO - [src.data_preparation] - Ticker SDU - Final 3D shapes: X_train=(642, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:12,154 - INFO - [__main__] - Using best model for SDU: svm (F1: 0.8861)
2025-05-19 23:22:12,154 - INFO - [__main__] - Loading svm model for SDU...
2025-05-19 23:22:12,155 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:12,156 - INFO - [__main__] - Model size: 0.63 MB
2025-05-19 23:22:12,156 - INFO - [__main__] - Making predictions for SDU using svm
2025-05-19 23:22:12,156 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:12,157 - INFO - [__main__] - Successfully got last prediction for SDU
2025-05-19 23:22:12,157 - INFO - [__main__] - 
Processing ticker: SDV
2025-05-19 23:22:12,157 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:12,157 - INFO - [__main__] - Getting last prediction point for ticker: SDV
2025-05-19 23:22:12,157 - INFO - [__main__] - ==================================================
2025-05-19 23:22:12,157 - INFO - [__main__] - Preparing test data for SDV...
2025-05-19 23:22:12,191 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:12,191 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:12,191 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:12,209 - INFO - [src.data_preparation] - Ticker SDV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:12,209 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(194), np.int64(1): np.int64(445)}
2025-05-19 23:22:12,505 - INFO - [src.data_preparation] - Ticker SDV - Selected features:
2025-05-19 23:22:12,505 - INFO - [src.data_preparation] -   vnipc_t: 0.0761
2025-05-19 23:22:12,505 - INFO - [src.data_preparation] -   TVV: 0.0736
2025-05-19 23:22:12,505 - INFO - [src.data_preparation] -   Volatility: 0.0734
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   SK: 0.0681
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   ATR: 0.0631
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   insec_t: 0.0622
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   ma14_t: 0.0611
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   ma21_t: 0.0593
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   Median_HL: 0.0555
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   ma7_t: 0.0554
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   HL: 0.0544
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   SR: 0.0496
2025-05-19 23:22:12,506 - INFO - [src.data_preparation] -   ret: 0.0453
2025-05-19 23:22:12,509 - INFO - [src.data_preparation] - Ticker SDV - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'SK', 's_d7_t', 'ATR', 'insec_t', 'ma14_t', 'ma21_t', 'Median_HL', 'ma7_t', 'HL', 'PM', 'SR', 'ret']
2025-05-19 23:22:12,608 - INFO - [src.data_preparation] - Ticker SDV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:12,609 - INFO - [src.data_preparation] - Ticker SDV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:12,610 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDV
2025-05-19 23:22:12,610 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:12,610 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(131), np.int64(1): np.int64(332)}
2025-05-19 23:22:12,610 - INFO - [src.data_preparation] - Generating 201 synthetic minority samples
2025-05-19 23:22:12,624 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (664, 13, 15), y shape: (664,)
2025-05-19 23:22:12,624 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(332), np.int64(1): np.int64(332)}
2025-05-19 23:22:12,628 - INFO - [src.data_preparation] - Ticker SDV - Final 3D shapes: X_train=(664, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:12,629 - INFO - [__main__] - Using best model for SDV: logistic_regression (F1: 0.7887)
2025-05-19 23:22:12,629 - INFO - [__main__] - Loading logistic_regression model for SDV...
2025-05-19 23:22:12,630 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:12,630 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:12,630 - INFO - [__main__] - Making predictions for SDV using logistic_regression
2025-05-19 23:22:12,630 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:12,631 - INFO - [__main__] - Successfully got last prediction for SDV
2025-05-19 23:22:12,631 - INFO - [__main__] - 
Processing ticker: SDY
2025-05-19 23:22:12,631 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:12,631 - INFO - [__main__] - Getting last prediction point for ticker: SDY
2025-05-19 23:22:12,631 - INFO - [__main__] - ==================================================
2025-05-19 23:22:12,631 - INFO - [__main__] - Preparing test data for SDY...
2025-05-19 23:22:12,686 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:12,686 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:12,686 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:12,712 - INFO - [src.data_preparation] - Ticker SDY - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:12,712 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(120), np.int64(1): np.int64(519)}
2025-05-19 23:22:12,983 - INFO - [src.data_preparation] - Ticker SDY - Selected features:
2025-05-19 23:22:12,983 - INFO - [src.data_preparation] -   vnipc_t: 0.1177
2025-05-19 23:22:12,983 - INFO - [src.data_preparation] -   ma21_t: 0.0973
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   ma14_t: 0.0756
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   TVV: 0.0703
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   ma7_t: 0.0627
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   Volatility: 0.0626
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   Median_HL: 0.0612
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   s_d7_t: 0.0596
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   PM: 0.0594
2025-05-19 23:22:12,984 - INFO - [src.data_preparation] -   ATR: 0.0529
2025-05-19 23:22:12,985 - INFO - [src.data_preparation] -   SK: 0.0512
2025-05-19 23:22:12,985 - INFO - [src.data_preparation] -   insec_t: 0.0490
2025-05-19 23:22:12,985 - INFO - [src.data_preparation] -   HL: 0.0474
2025-05-19 23:22:12,985 - INFO - [src.data_preparation] -   ret: 0.0414
2025-05-19 23:22:12,985 - INFO - [src.data_preparation] -   variation_t: 0.0405
2025-05-19 23:22:12,988 - INFO - [src.data_preparation] - Ticker SDY - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'TVV', 'ma7_t', 'Volatility', 'Median_HL', 's_d7_t', 'PM', 'ATR', 'SK', 'insec_t', 'HL', 'ret', 'variation_t']
2025-05-19 23:22:13,076 - INFO - [src.data_preparation] - Ticker SDY - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:13,076 - INFO - [src.data_preparation] - Ticker SDY - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:13,077 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SDY
2025-05-19 23:22:13,077 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:13,077 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(73), np.int64(1): np.int64(390)}
2025-05-19 23:22:13,077 - INFO - [src.data_preparation] - Generating 317 synthetic minority samples
2025-05-19 23:22:13,092 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (780, 13, 15), y shape: (780,)
2025-05-19 23:22:13,092 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(390), np.int64(1): np.int64(390)}
2025-05-19 23:22:13,097 - INFO - [src.data_preparation] - Ticker SDY - Final 3D shapes: X_train=(780, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:13,097 - INFO - [__main__] - Using best model for SDY: svm (F1: 0.8108)
2025-05-19 23:22:13,097 - INFO - [__main__] - Loading svm model for SDY...
2025-05-19 23:22:13,099 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:13,099 - INFO - [__main__] - Model size: 0.59 MB
2025-05-19 23:22:13,099 - INFO - [__main__] - Making predictions for SDY using svm
2025-05-19 23:22:13,099 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:13,099 - INFO - [__main__] - Successfully got last prediction for SDY
2025-05-19 23:22:13,099 - INFO - [__main__] - 
Processing ticker: SEB
2025-05-19 23:22:13,099 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:13,099 - INFO - [__main__] - Getting last prediction point for ticker: SEB
2025-05-19 23:22:13,099 - INFO - [__main__] - ==================================================
2025-05-19 23:22:13,099 - INFO - [__main__] - Preparing test data for SEB...
2025-05-19 23:22:13,131 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:13,131 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:13,132 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:13,152 - INFO - [src.data_preparation] - Ticker SEB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:13,152 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(243), np.int64(1): np.int64(396)}
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] - Ticker SEB - Selected features:
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   TVV: 0.0791
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   vnipc_t: 0.0709
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   SK: 0.0708
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   s_d7_t: 0.0667
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   Volatility: 0.0651
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   ma14_t: 0.0647
2025-05-19 23:22:13,458 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   ATR: 0.0567
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   HL: 0.0556
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   PM: 0.0537
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   ma7_t: 0.0523
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   ret: 0.0512
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   SR: 0.0502
2025-05-19 23:22:13,459 - INFO - [src.data_preparation] -   variation_t: 0.0482
2025-05-19 23:22:13,461 - INFO - [src.data_preparation] - Ticker SEB - Using features: ['Date', 'TVV', 'vnipc_t', 'SK', 's_d7_t', 'Volatility', 'ma14_t', 'insec_t', 'ma21_t', 'ATR', 'HL', 'PM', 'ma7_t', 'ret', 'SR', 'variation_t']
2025-05-19 23:22:13,643 - INFO - [src.data_preparation] - Ticker SEB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:13,643 - INFO - [src.data_preparation] - Ticker SEB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:13,645 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SEB
2025-05-19 23:22:13,645 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:13,645 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(169), np.int64(1): np.int64(294)}
2025-05-19 23:22:13,645 - INFO - [src.data_preparation] - Generating 125 synthetic minority samples
2025-05-19 23:22:13,651 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (588, 13, 15), y shape: (588,)
2025-05-19 23:22:13,651 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(294), np.int64(1): np.int64(294)}
2025-05-19 23:22:13,655 - INFO - [src.data_preparation] - Ticker SEB - Final 3D shapes: X_train=(588, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:13,655 - INFO - [__main__] - Using best model for SEB: svm (F1: 0.7246)
2025-05-19 23:22:13,655 - INFO - [__main__] - Loading svm model for SEB...
2025-05-19 23:22:13,657 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:13,657 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:22:13,657 - INFO - [__main__] - Making predictions for SEB using svm
2025-05-19 23:22:13,658 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:13,658 - INFO - [__main__] - Successfully got last prediction for SEB
2025-05-19 23:22:13,658 - INFO - [__main__] - 
Processing ticker: SED
2025-05-19 23:22:13,658 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:13,658 - INFO - [__main__] - Getting last prediction point for ticker: SED
2025-05-19 23:22:13,658 - INFO - [__main__] - ==================================================
2025-05-19 23:22:13,658 - INFO - [__main__] - Preparing test data for SED...
2025-05-19 23:22:13,695 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:13,695 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:13,695 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:13,718 - INFO - [src.data_preparation] - Ticker SED - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:13,718 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:22:14,047 - INFO - [src.data_preparation] - Ticker SED - Selected features:
2025-05-19 23:22:14,047 - INFO - [src.data_preparation] -   vnipc_t: 0.0778
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   insec_t: 0.0691
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   ATR: 0.0685
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   HL: 0.0676
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   Volatility: 0.0668
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   TVV: 0.0649
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   ret: 0.0630
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   SK: 0.0611
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   s_d7_t: 0.0607
2025-05-19 23:22:14,048 - INFO - [src.data_preparation] -   variation_t: 0.0587
2025-05-19 23:22:14,049 - INFO - [src.data_preparation] -   SR: 0.0544
2025-05-19 23:22:14,049 - INFO - [src.data_preparation] -   LO: 0.0532
2025-05-19 23:22:14,049 - INFO - [src.data_preparation] -   ma21_t: 0.0514
2025-05-19 23:22:14,049 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:22:14,049 - INFO - [src.data_preparation] -   ma14_t: 0.0459
2025-05-19 23:22:14,054 - INFO - [src.data_preparation] - Ticker SED - Using features: ['Date', 'vnipc_t', 'insec_t', 'ATR', 'HL', 'Volatility', 'TVV', 'ret', 'SK', 's_d7_t', 'variation_t', 'SR', 'LO', 'ma21_t', 'PM', 'ma14_t']
2025-05-19 23:22:14,172 - INFO - [src.data_preparation] - Ticker SED - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:14,172 - INFO - [src.data_preparation] - Ticker SED - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:14,173 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SED
2025-05-19 23:22:14,173 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:14,174 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:22:14,174 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:22:14,176 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:22:14,176 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:22:14,179 - INFO - [src.data_preparation] - Ticker SED - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:14,179 - INFO - [__main__] - Using best model for SED: svm (F1: 0.7246)
2025-05-19 23:22:14,179 - INFO - [__main__] - Loading svm model for SED...
2025-05-19 23:22:14,180 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:14,181 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:22:14,181 - INFO - [__main__] - Making predictions for SED using svm
2025-05-19 23:22:14,182 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:14,182 - INFO - [__main__] - Successfully got last prediction for SED
2025-05-19 23:22:14,183 - INFO - [__main__] - 
Processing ticker: SFC
2025-05-19 23:22:14,183 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:14,183 - INFO - [__main__] - Getting last prediction point for ticker: SFC
2025-05-19 23:22:14,183 - INFO - [__main__] - ==================================================
2025-05-19 23:22:14,183 - INFO - [__main__] - Preparing test data for SFC...
2025-05-19 23:22:14,219 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:14,219 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:14,219 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:14,240 - INFO - [src.data_preparation] - Ticker SFC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:14,241 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(385)}
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] - Ticker SFC - Selected features:
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   SK: 0.0753
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   ATR: 0.0748
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   s_d7_t: 0.0741
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   Volatility: 0.0722
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   vnipc_t: 0.0713
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   TVV: 0.0642
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   HL: 0.0610
2025-05-19 23:22:14,541 - INFO - [src.data_preparation] -   insec_t: 0.0577
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   PM: 0.0520
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   ma21_t: 0.0509
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   ma14_t: 0.0507
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   SR: 0.0492
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   variation_t: 0.0487
2025-05-19 23:22:14,542 - INFO - [src.data_preparation] -   LO: 0.0485
2025-05-19 23:22:14,544 - INFO - [src.data_preparation] - Ticker SFC - Using features: ['Date', 'SK', 'ATR', 's_d7_t', 'Volatility', 'vnipc_t', 'TVV', 'HL', 'insec_t', 'ma7_t', 'PM', 'ma21_t', 'ma14_t', 'SR', 'variation_t', 'LO']
2025-05-19 23:22:14,632 - INFO - [src.data_preparation] - Ticker SFC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:14,632 - INFO - [src.data_preparation] - Ticker SFC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:14,634 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SFC
2025-05-19 23:22:14,634 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:14,634 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(182), np.int64(1): np.int64(281)}
2025-05-19 23:22:14,634 - INFO - [src.data_preparation] - Generating 99 synthetic minority samples
2025-05-19 23:22:14,639 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (562, 13, 15), y shape: (562,)
2025-05-19 23:22:14,639 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(281), np.int64(1): np.int64(281)}
2025-05-19 23:22:14,643 - INFO - [src.data_preparation] - Ticker SFC - Final 3D shapes: X_train=(562, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:14,643 - INFO - [__main__] - Using best model for SFC: lstm (F1: 0.7200)
2025-05-19 23:22:14,643 - INFO - [__main__] - Loading lstm model for SFC...
2025-05-19 23:22:14,646 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:14,648 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:22:14,648 - INFO - [__main__] - Making predictions for SFC using lstm
2025-05-19 23:22:14,649 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:14,649 - INFO - [__main__] - Successfully got last prediction for SFC
2025-05-19 23:22:14,649 - INFO - [__main__] - 
Processing ticker: SFI
2025-05-19 23:22:14,649 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:14,649 - INFO - [__main__] - Getting last prediction point for ticker: SFI
2025-05-19 23:22:14,650 - INFO - [__main__] - ==================================================
2025-05-19 23:22:14,650 - INFO - [__main__] - Preparing test data for SFI...
2025-05-19 23:22:14,698 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:14,698 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:14,698 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:14,723 - INFO - [src.data_preparation] - Ticker SFI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:14,723 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:22:15,095 - INFO - [src.data_preparation] - Ticker SFI - Selected features:
2025-05-19 23:22:15,095 - INFO - [src.data_preparation] -   vnipc_t: 0.0730
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   insec_t: 0.0704
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   TVV: 0.0691
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   SK: 0.0640
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   Volatility: 0.0619
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   HL: 0.0615
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:22:15,096 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   SR: 0.0577
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   PM: 0.0568
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   ma21_t: 0.0555
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   LO: 0.0545
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   s_d7_t: 0.0543
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   ma14_t: 0.0539
2025-05-19 23:22:15,097 - INFO - [src.data_preparation] -   variation_t: 0.0512
2025-05-19 23:22:15,104 - INFO - [src.data_preparation] - Ticker SFI - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'SK', 'Volatility', 'HL', 'ATR', 'ma7_t', 'SR', 'PM', 'ma21_t', 'LO', 's_d7_t', 'ma14_t', 'variation_t']
2025-05-19 23:22:15,231 - INFO - [src.data_preparation] - Ticker SFI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:15,232 - INFO - [src.data_preparation] - Ticker SFI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:15,235 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SFI
2025-05-19 23:22:15,235 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:15,235 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(243)}
2025-05-19 23:22:15,236 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:22:15,238 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:22:15,238 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:22:15,243 - INFO - [src.data_preparation] - Ticker SFI - Final 3D shapes: X_train=(486, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:15,243 - INFO - [__main__] - Using best model for SFI: logistic_regression (F1: 0.6182)
2025-05-19 23:22:15,243 - INFO - [__main__] - Loading logistic_regression model for SFI...
2025-05-19 23:22:15,245 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:15,245 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:15,245 - INFO - [__main__] - Making predictions for SFI using logistic_regression
2025-05-19 23:22:15,245 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:15,245 - INFO - [__main__] - Successfully got last prediction for SFI
2025-05-19 23:22:15,246 - INFO - [__main__] - 
Processing ticker: SFN
2025-05-19 23:22:15,246 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:15,246 - INFO - [__main__] - Getting last prediction point for ticker: SFN
2025-05-19 23:22:15,246 - INFO - [__main__] - ==================================================
2025-05-19 23:22:15,246 - INFO - [__main__] - Preparing test data for SFN...
2025-05-19 23:22:15,295 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:15,295 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:15,295 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:15,315 - INFO - [src.data_preparation] - Ticker SFN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:15,315 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(209), np.int64(1): np.int64(430)}
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] - Ticker SFN - Selected features:
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   vnipc_t: 0.0775
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   SK: 0.0721
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   s_d7_t: 0.0700
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   insec_t: 0.0646
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   ATR: 0.0634
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   TVV: 0.0628
2025-05-19 23:22:15,624 - INFO - [src.data_preparation] -   ma21_t: 0.0582
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   ma7_t: 0.0573
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   ma14_t: 0.0564
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   variation_t: 0.0542
2025-05-19 23:22:15,625 - INFO - [src.data_preparation] -   ret: 0.0499
2025-05-19 23:22:15,628 - INFO - [src.data_preparation] - Ticker SFN - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'Volatility', 'insec_t', 'ATR', 'TVV', 'ma21_t', 'ma7_t', 'ma14_t', 'Median_HL', 'HL', 'PM', 'variation_t', 'ret']
2025-05-19 23:22:15,715 - INFO - [src.data_preparation] - Ticker SFN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:15,715 - INFO - [src.data_preparation] - Ticker SFN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:15,717 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SFN
2025-05-19 23:22:15,717 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:15,717 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(141), np.int64(1): np.int64(322)}
2025-05-19 23:22:15,717 - INFO - [src.data_preparation] - Generating 181 synthetic minority samples
2025-05-19 23:22:15,724 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (644, 13, 15), y shape: (644,)
2025-05-19 23:22:15,724 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(322), np.int64(1): np.int64(322)}
2025-05-19 23:22:15,728 - INFO - [src.data_preparation] - Ticker SFN - Final 3D shapes: X_train=(644, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:15,728 - INFO - [__main__] - Using best model for SFN: svm (F1: 0.6866)
2025-05-19 23:22:15,728 - INFO - [__main__] - Loading svm model for SFN...
2025-05-19 23:22:15,729 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:15,730 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:22:15,730 - INFO - [__main__] - Making predictions for SFN using svm
2025-05-19 23:22:15,730 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:15,731 - INFO - [__main__] - Successfully got last prediction for SFN
2025-05-19 23:22:15,731 - INFO - [__main__] - 
Processing ticker: SGC
2025-05-19 23:22:15,731 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:15,731 - INFO - [__main__] - Getting last prediction point for ticker: SGC
2025-05-19 23:22:15,731 - INFO - [__main__] - ==================================================
2025-05-19 23:22:15,731 - INFO - [__main__] - Preparing test data for SGC...
2025-05-19 23:22:15,768 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:15,768 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:15,768 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:15,791 - INFO - [src.data_preparation] - Ticker SGC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:15,791 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(188), np.int64(1): np.int64(451)}
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] - Ticker SGC - Selected features:
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   TVV: 0.0806
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   ATR: 0.0766
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   s_d7_t: 0.0747
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   vnipc_t: 0.0736
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   ma21_t: 0.0640
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   SK: 0.0626
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   ma14_t: 0.0612
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   ma7_t: 0.0588
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   insec_t: 0.0539
2025-05-19 23:22:16,080 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:22:16,081 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:22:16,081 - INFO - [src.data_preparation] -   SR: 0.0488
2025-05-19 23:22:16,081 - INFO - [src.data_preparation] -   variation_t: 0.0469
2025-05-19 23:22:16,081 - INFO - [src.data_preparation] -   ret: 0.0466
2025-05-19 23:22:16,083 - INFO - [src.data_preparation] - Ticker SGC - Using features: ['Date', 'TVV', 'ATR', 's_d7_t', 'vnipc_t', 'ma21_t', 'SK', 'ma14_t', 'Volatility', 'ma7_t', 'insec_t', 'Median_HL', 'PM', 'SR', 'variation_t', 'ret']
2025-05-19 23:22:16,183 - INFO - [src.data_preparation] - Ticker SGC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:16,183 - INFO - [src.data_preparation] - Ticker SGC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:16,185 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SGC
2025-05-19 23:22:16,185 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:16,185 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(136), np.int64(1): np.int64(327)}
2025-05-19 23:22:16,185 - INFO - [src.data_preparation] - Generating 191 synthetic minority samples
2025-05-19 23:22:16,194 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (654, 13, 15), y shape: (654,)
2025-05-19 23:22:16,194 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(327), np.int64(1): np.int64(327)}
2025-05-19 23:22:16,198 - INFO - [src.data_preparation] - Ticker SGC - Final 3D shapes: X_train=(654, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:16,198 - INFO - [__main__] - Using best model for SGC: svm (F1: 0.6866)
2025-05-19 23:22:16,198 - INFO - [__main__] - Loading svm model for SGC...
2025-05-19 23:22:16,198 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:16,202 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:22:16,202 - INFO - [__main__] - Making predictions for SGC using svm
2025-05-19 23:22:16,203 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:16,203 - INFO - [__main__] - Successfully got last prediction for SGC
2025-05-19 23:22:16,203 - INFO - [__main__] - 
Processing ticker: SGD
2025-05-19 23:22:16,203 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:16,203 - INFO - [__main__] - Getting last prediction point for ticker: SGD
2025-05-19 23:22:16,203 - INFO - [__main__] - ==================================================
2025-05-19 23:22:16,203 - INFO - [__main__] - Preparing test data for SGD...
2025-05-19 23:22:16,234 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:16,234 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:16,234 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:16,259 - INFO - [src.data_preparation] - Ticker SGD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:16,259 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(197), np.int64(1): np.int64(442)}
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] - Ticker SGD - Selected features:
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   vnipc_t: 0.0750
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   TVV: 0.0748
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   ATR: 0.0703
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   ma14_t: 0.0695
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   Volatility: 0.0674
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   ma21_t: 0.0659
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   ma7_t: 0.0608
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   insec_t: 0.0540
2025-05-19 23:22:16,594 - INFO - [src.data_preparation] -   variation_t: 0.0536
2025-05-19 23:22:16,595 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:22:16,595 - INFO - [src.data_preparation] -   PM: 0.0515
2025-05-19 23:22:16,595 - INFO - [src.data_preparation] -   Median_HL: 0.0495
2025-05-19 23:22:16,595 - INFO - [src.data_preparation] -   SR: 0.0438
2025-05-19 23:22:16,598 - INFO - [src.data_preparation] - Ticker SGD - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'ma14_t', 'Volatility', 'ma21_t', 'SK', 's_d7_t', 'ma7_t', 'insec_t', 'variation_t', 'ret', 'PM', 'Median_HL', 'SR']
2025-05-19 23:22:16,697 - INFO - [src.data_preparation] - Ticker SGD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:16,697 - INFO - [src.data_preparation] - Ticker SGD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:16,698 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SGD
2025-05-19 23:22:16,698 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:16,698 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:22:16,698 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:22:16,705 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:22:16,705 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:22:16,708 - INFO - [src.data_preparation] - Ticker SGD - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:16,709 - INFO - [__main__] - Using best model for SGD: transformer (F1: 0.8533)
2025-05-19 23:22:16,709 - INFO - [__main__] - Loading transformer model for SGD...
2025-05-19 23:22:16,722 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:16,727 - INFO - [__main__] - Model size: 0.18 MB
2025-05-19 23:22:16,727 - INFO - [__main__] - Making predictions for SGD using transformer
2025-05-19 23:22:16,729 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:16,730 - INFO - [__main__] - Successfully got last prediction for SGD
2025-05-19 23:22:16,730 - INFO - [__main__] - 
Processing ticker: SGH
2025-05-19 23:22:16,730 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:16,730 - INFO - [__main__] - Getting last prediction point for ticker: SGH
2025-05-19 23:22:16,730 - INFO - [__main__] - ==================================================
2025-05-19 23:22:16,730 - INFO - [__main__] - Preparing test data for SGH...
2025-05-19 23:22:16,779 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:16,779 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:16,779 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:16,817 - INFO - [src.data_preparation] - Ticker SGH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:16,817 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(176), np.int64(1): np.int64(463)}
2025-05-19 23:22:17,151 - INFO - [src.data_preparation] - Ticker SGH - Selected features:
2025-05-19 23:22:17,151 - INFO - [src.data_preparation] -   ma21_t: 0.0832
2025-05-19 23:22:17,151 - INFO - [src.data_preparation] -   vnipc_t: 0.0769
2025-05-19 23:22:17,151 - INFO - [src.data_preparation] -   TVV: 0.0760
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   ma14_t: 0.0719
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   s_d7_t: 0.0709
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   ATR: 0.0706
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   ma7_t: 0.0693
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   PM: 0.0674
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   Volatility: 0.0644
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   Median_HL: 0.0635
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   SK: 0.0601
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   variation_t: 0.0421
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   ret: 0.0404
2025-05-19 23:22:17,152 - INFO - [src.data_preparation] -   insec_t: 0.0394
2025-05-19 23:22:17,153 - INFO - [src.data_preparation] -   SR: 0.0345
2025-05-19 23:22:17,156 - INFO - [src.data_preparation] - Ticker SGH - Using features: ['Date', 'ma21_t', 'vnipc_t', 'TVV', 'ma14_t', 's_d7_t', 'ATR', 'ma7_t', 'PM', 'Volatility', 'Median_HL', 'SK', 'variation_t', 'ret', 'insec_t', 'SR']
2025-05-19 23:22:17,253 - INFO - [src.data_preparation] - Ticker SGH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:17,253 - INFO - [src.data_preparation] - Ticker SGH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:17,255 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SGH
2025-05-19 23:22:17,255 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:17,255 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(133), np.int64(1): np.int64(330)}
2025-05-19 23:22:17,255 - INFO - [src.data_preparation] - Generating 197 synthetic minority samples
2025-05-19 23:22:17,264 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (660, 13, 15), y shape: (660,)
2025-05-19 23:22:17,264 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(330), np.int64(1): np.int64(330)}
2025-05-19 23:22:17,267 - INFO - [src.data_preparation] - Ticker SGH - Final 3D shapes: X_train=(660, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:17,269 - INFO - [__main__] - Using best model for SGH: svm (F1: 0.8108)
2025-05-19 23:22:17,269 - INFO - [__main__] - Loading svm model for SGH...
2025-05-19 23:22:17,270 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:17,271 - INFO - [__main__] - Model size: 0.99 MB
2025-05-19 23:22:17,271 - INFO - [__main__] - Making predictions for SGH using svm
2025-05-19 23:22:17,272 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:17,272 - INFO - [__main__] - Successfully got last prediction for SGH
2025-05-19 23:22:17,272 - INFO - [__main__] - 
Processing ticker: SGS
2025-05-19 23:22:17,272 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:17,272 - INFO - [__main__] - Getting last prediction point for ticker: SGS
2025-05-19 23:22:17,272 - INFO - [__main__] - ==================================================
2025-05-19 23:22:17,272 - INFO - [__main__] - Preparing test data for SGS...
2025-05-19 23:22:17,314 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:17,314 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:17,314 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:17,344 - INFO - [src.data_preparation] - Ticker SGS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:17,344 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(225), np.int64(1): np.int64(414)}
2025-05-19 23:22:17,723 - INFO - [src.data_preparation] - Ticker SGS - Selected features:
2025-05-19 23:22:17,723 - INFO - [src.data_preparation] -   vnipc_t: 0.0845
2025-05-19 23:22:17,723 - INFO - [src.data_preparation] -   TVV: 0.0700
2025-05-19 23:22:17,723 - INFO - [src.data_preparation] -   ma21_t: 0.0685
2025-05-19 23:22:17,723 - INFO - [src.data_preparation] -   s_d7_t: 0.0684
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   ma14_t: 0.0664
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   ATR: 0.0643
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   Volatility: 0.0635
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   ma7_t: 0.0614
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   SK: 0.0596
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   ret: 0.0525
2025-05-19 23:22:17,724 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:22:17,725 - INFO - [src.data_preparation] -   insec_t: 0.0511
2025-05-19 23:22:17,725 - INFO - [src.data_preparation] -   PM: 0.0504
2025-05-19 23:22:17,725 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:22:17,725 - INFO - [src.data_preparation] -   SR: 0.0477
2025-05-19 23:22:17,727 - INFO - [src.data_preparation] - Ticker SGS - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 's_d7_t', 'ma14_t', 'ATR', 'Volatility', 'ma7_t', 'SK', 'ret', 'variation_t', 'insec_t', 'PM', 'Median_HL', 'SR']
2025-05-19 23:22:17,821 - INFO - [src.data_preparation] - Ticker SGS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:17,821 - INFO - [src.data_preparation] - Ticker SGS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:17,823 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SGS
2025-05-19 23:22:17,823 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:17,823 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(147), np.int64(1): np.int64(316)}
2025-05-19 23:22:17,823 - INFO - [src.data_preparation] - Generating 169 synthetic minority samples
2025-05-19 23:22:17,830 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (632, 13, 15), y shape: (632,)
2025-05-19 23:22:17,830 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(316), np.int64(1): np.int64(316)}
2025-05-19 23:22:17,834 - INFO - [src.data_preparation] - Ticker SGS - Final 3D shapes: X_train=(632, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:17,834 - INFO - [__main__] - Using best model for SGS: svm (F1: 0.7059)
2025-05-19 23:22:17,835 - INFO - [__main__] - Loading svm model for SGS...
2025-05-19 23:22:17,838 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:17,839 - INFO - [__main__] - Model size: 0.95 MB
2025-05-19 23:22:17,839 - INFO - [__main__] - Making predictions for SGS using svm
2025-05-19 23:22:17,840 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:17,840 - INFO - [__main__] - Successfully got last prediction for SGS
2025-05-19 23:22:17,840 - INFO - [__main__] - 
Processing ticker: SGT
2025-05-19 23:22:17,840 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:17,840 - INFO - [__main__] - Getting last prediction point for ticker: SGT
2025-05-19 23:22:17,840 - INFO - [__main__] - ==================================================
2025-05-19 23:22:17,840 - INFO - [__main__] - Preparing test data for SGT...
2025-05-19 23:22:17,877 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:17,878 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:17,878 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:17,899 - INFO - [src.data_preparation] - Ticker SGT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:17,899 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] - Ticker SGT - Selected features:
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   vnipc_t: 0.0726
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   insec_t: 0.0665
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   s_d7_t: 0.0607
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   ret: 0.0607
2025-05-19 23:22:18,253 - INFO - [src.data_preparation] -   TVV: 0.0605
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   Median_HL: 0.0577
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   ATR: 0.0569
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   SR: 0.0559
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   ma21_t: 0.0538
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   variation_t: 0.0533
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   PM: 0.0532
2025-05-19 23:22:18,254 - INFO - [src.data_preparation] -   LO: 0.0530
2025-05-19 23:22:18,257 - INFO - [src.data_preparation] - Ticker SGT - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'Volatility', 's_d7_t', 'ret', 'TVV', 'Median_HL', 'ma14_t', 'ATR', 'SR', 'ma21_t', 'variation_t', 'PM', 'LO']
2025-05-19 23:22:18,344 - INFO - [src.data_preparation] - Ticker SGT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:18,344 - INFO - [src.data_preparation] - Ticker SGT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:18,345 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SGT
2025-05-19 23:22:18,345 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:18,345 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(210), np.int64(1): np.int64(253)}
2025-05-19 23:22:18,345 - INFO - [src.data_preparation] - Generating 43 synthetic minority samples
2025-05-19 23:22:18,348 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (506, 13, 15), y shape: (506,)
2025-05-19 23:22:18,348 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(253), np.int64(1): np.int64(253)}
2025-05-19 23:22:18,350 - INFO - [src.data_preparation] - Ticker SGT - Final 3D shapes: X_train=(506, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:18,351 - INFO - [__main__] - Using best model for SGT: svm (F1: 0.6667)
2025-05-19 23:22:18,351 - INFO - [__main__] - Loading svm model for SGT...
2025-05-19 23:22:18,352 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:18,354 - INFO - [__main__] - Model size: 0.76 MB
2025-05-19 23:22:18,354 - INFO - [__main__] - Making predictions for SGT using svm
2025-05-19 23:22:18,355 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:18,355 - INFO - [__main__] - Successfully got last prediction for SGT
2025-05-19 23:22:18,355 - INFO - [__main__] - 
Processing ticker: SHB
2025-05-19 23:22:18,355 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:18,355 - INFO - [__main__] - Getting last prediction point for ticker: SHB
2025-05-19 23:22:18,355 - INFO - [__main__] - ==================================================
2025-05-19 23:22:18,355 - INFO - [__main__] - Preparing test data for SHB...
2025-05-19 23:22:18,383 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:18,383 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:18,383 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:18,404 - INFO - [src.data_preparation] - Ticker SHB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:18,404 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] - Ticker SHB - Selected features:
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   vnipc_t: 0.0830
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   insec_t: 0.0704
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   SK: 0.0701
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   s_d7_t: 0.0697
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   TVV: 0.0624
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   ATR: 0.0600
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   HL: 0.0581
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   ma7_t: 0.0548
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   ma14_t: 0.0546
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   ma21_t: 0.0529
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   SR: 0.0512
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   variation_t: 0.0495
2025-05-19 23:22:18,699 - INFO - [src.data_preparation] -   PM: 0.0494
2025-05-19 23:22:18,706 - INFO - [src.data_preparation] - Ticker SHB - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 's_d7_t', 'Volatility', 'TVV', 'ATR', 'HL', 'ma7_t', 'ma14_t', 'ma21_t', 'ret', 'SR', 'variation_t', 'PM']
2025-05-19 23:22:18,793 - INFO - [src.data_preparation] - Ticker SHB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:18,793 - INFO - [src.data_preparation] - Ticker SHB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:18,794 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SHB
2025-05-19 23:22:18,794 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:18,795 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(192), np.int64(1): np.int64(271)}
2025-05-19 23:22:18,795 - INFO - [src.data_preparation] - Generating 79 synthetic minority samples
2025-05-19 23:22:18,799 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (542, 13, 15), y shape: (542,)
2025-05-19 23:22:18,799 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(271), np.int64(1): np.int64(271)}
2025-05-19 23:22:18,802 - INFO - [src.data_preparation] - Ticker SHB - Final 3D shapes: X_train=(542, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:18,802 - INFO - [__main__] - Using best model for SHB: logistic_regression (F1: 0.4615)
2025-05-19 23:22:18,802 - INFO - [__main__] - Loading logistic_regression model for SHB...
2025-05-19 23:22:18,803 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:18,804 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:18,804 - INFO - [__main__] - Making predictions for SHB using logistic_regression
2025-05-19 23:22:18,804 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:18,805 - INFO - [__main__] - Successfully got last prediction for SHB
2025-05-19 23:22:18,805 - INFO - [__main__] - 
Processing ticker: SHC
2025-05-19 23:22:18,805 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:18,805 - INFO - [__main__] - Getting last prediction point for ticker: SHC
2025-05-19 23:22:18,805 - INFO - [__main__] - ==================================================
2025-05-19 23:22:18,805 - INFO - [__main__] - Preparing test data for SHC...
2025-05-19 23:22:18,835 - INFO - [src.data_preparation] - After processing - X shape: (413, 19), y shape: (413,)
2025-05-19 23:22:18,835 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:18,835 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:18,858 - INFO - [src.data_preparation] - Ticker SHC - Original shapes: X=(413, 18), y=(413,)
2025-05-19 23:22:18,858 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(159), np.int64(1): np.int64(254)}
2025-05-19 23:22:19,086 - INFO - [src.data_preparation] - Ticker SHC - Selected features:
2025-05-19 23:22:19,086 - INFO - [src.data_preparation] -   vnipc_t: 0.0957
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   TVV: 0.0729
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   Volatility: 0.0647
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   ma14_t: 0.0592
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   insec_t: 0.0590
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   PM: 0.0557
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   Median_HL: 0.0553
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   HL: 0.0546
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   ma21_t: 0.0542
2025-05-19 23:22:19,087 - INFO - [src.data_preparation] -   SR: 0.0524
2025-05-19 23:22:19,088 - INFO - [src.data_preparation] -   s_d7_t: 0.0514
2025-05-19 23:22:19,088 - INFO - [src.data_preparation] -   ret: 0.0501
2025-05-19 23:22:19,088 - INFO - [src.data_preparation] -   variation_t: 0.0501
2025-05-19 23:22:19,090 - INFO - [src.data_preparation] - Ticker SHC - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'ATR', 'Volatility', 'ma14_t', 'insec_t', 'PM', 'Median_HL', 'HL', 'ma21_t', 'SR', 's_d7_t', 'ret', 'variation_t']
2025-05-19 23:22:19,159 - INFO - [src.data_preparation] - Ticker SHC - 2D shapes: X_train=(237, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:19,159 - INFO - [src.data_preparation] - Ticker SHC - 3D shapes: X_train=(237, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:19,160 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SHC
2025-05-19 23:22:19,160 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (237, 13, 15), y shape: (237,)
2025-05-19 23:22:19,160 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(89), np.int64(1): np.int64(148)}
2025-05-19 23:22:19,160 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:22:19,162 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (296, 13, 15), y shape: (296,)
2025-05-19 23:22:19,163 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(148), np.int64(1): np.int64(148)}
2025-05-19 23:22:19,165 - INFO - [src.data_preparation] - Ticker SHC - Final 3D shapes: X_train=(296, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:19,165 - INFO - [__main__] - Using best model for SHC: svm (F1: 0.6667)
2025-05-19 23:22:19,165 - INFO - [__main__] - Loading svm model for SHC...
2025-05-19 23:22:19,165 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:19,167 - INFO - [__main__] - Model size: 0.45 MB
2025-05-19 23:22:19,167 - INFO - [__main__] - Making predictions for SHC using svm
2025-05-19 23:22:19,167 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:19,167 - INFO - [__main__] - Successfully got last prediction for SHC
2025-05-19 23:22:19,167 - INFO - [__main__] - 
Processing ticker: SHI
2025-05-19 23:22:19,167 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:19,168 - INFO - [__main__] - Getting last prediction point for ticker: SHI
2025-05-19 23:22:19,168 - INFO - [__main__] - ==================================================
2025-05-19 23:22:19,168 - INFO - [__main__] - Preparing test data for SHI...
2025-05-19 23:22:19,197 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:19,197 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:19,197 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:19,215 - INFO - [src.data_preparation] - Ticker SHI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:19,215 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(294), np.int64(1): np.int64(345)}
2025-05-19 23:22:19,523 - INFO - [src.data_preparation] - Ticker SHI - Selected features:
2025-05-19 23:22:19,523 - INFO - [src.data_preparation] -   vnipc_t: 0.0730
2025-05-19 23:22:19,523 - INFO - [src.data_preparation] -   s_d7_t: 0.0712
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   TVV: 0.0705
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   insec_t: 0.0665
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   SK: 0.0648
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   ATR: 0.0617
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   Volatility: 0.0608
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   ret: 0.0602
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   ma14_t: 0.0580
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   variation_t: 0.0566
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   HL: 0.0531
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   ma7_t: 0.0526
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   SR: 0.0524
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   PM: 0.0510
2025-05-19 23:22:19,524 - INFO - [src.data_preparation] -   ma21_t: 0.0501
2025-05-19 23:22:19,527 - INFO - [src.data_preparation] - Ticker SHI - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'insec_t', 'SK', 'ATR', 'Volatility', 'ret', 'ma14_t', 'variation_t', 'HL', 'ma7_t', 'SR', 'PM', 'ma21_t']
2025-05-19 23:22:19,619 - INFO - [src.data_preparation] - Ticker SHI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:19,619 - INFO - [src.data_preparation] - Ticker SHI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:19,620 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SHI
2025-05-19 23:22:19,620 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:19,620 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:22:19,620 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:22:19,626 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:22:19,627 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:22:19,630 - INFO - [src.data_preparation] - Ticker SHI - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:19,631 - INFO - [__main__] - Using best model for SHI: transformer (F1: 0.6866)
2025-05-19 23:22:19,631 - INFO - [__main__] - Loading transformer model for SHI...
2025-05-19 23:22:19,642 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:19,646 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:22:19,646 - INFO - [__main__] - Making predictions for SHI using transformer
2025-05-19 23:22:19,649 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:19,649 - INFO - [__main__] - Successfully got last prediction for SHI
2025-05-19 23:22:19,650 - INFO - [__main__] - 
Processing ticker: SHN
2025-05-19 23:22:19,650 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:19,650 - INFO - [__main__] - Getting last prediction point for ticker: SHN
2025-05-19 23:22:19,650 - INFO - [__main__] - ==================================================
2025-05-19 23:22:19,650 - INFO - [__main__] - Preparing test data for SHN...
2025-05-19 23:22:19,709 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:19,709 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:19,710 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:19,743 - INFO - [src.data_preparation] - Ticker SHN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:19,743 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] - Ticker SHN - Selected features:
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   vnipc_t: 0.0806
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   s_d7_t: 0.0661
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   TVV: 0.0654
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   insec_t: 0.0633
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   Volatility: 0.0625
2025-05-19 23:22:20,162 - INFO - [src.data_preparation] -   ma21_t: 0.0606
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   ATR: 0.0602
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   ma14_t: 0.0586
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   HL: 0.0573
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   SR: 0.0540
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   Median_HL: 0.0535
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:22:20,163 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:22:20,165 - INFO - [src.data_preparation] - Ticker SHN - Using features: ['Date', 'vnipc_t', 's_d7_t', 'TVV', 'insec_t', 'SK', 'Volatility', 'ma21_t', 'ATR', 'ma14_t', 'HL', 'ma7_t', 'SR', 'Median_HL', 'PM', 'variation_t']
2025-05-19 23:22:20,252 - INFO - [src.data_preparation] - Ticker SHN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:20,252 - INFO - [src.data_preparation] - Ticker SHN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:20,253 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SHN
2025-05-19 23:22:20,253 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:20,253 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:22:20,253 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:22:20,259 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:22:20,260 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:22:20,263 - INFO - [src.data_preparation] - Ticker SHN - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:20,263 - INFO - [__main__] - Using best model for SHN: lstm (F1: 0.6462)
2025-05-19 23:22:20,263 - INFO - [__main__] - Loading lstm model for SHN...
2025-05-19 23:22:20,267 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:20,268 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:22:20,268 - INFO - [__main__] - Making predictions for SHN using lstm
2025-05-19 23:22:20,269 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:20,269 - INFO - [__main__] - Successfully got last prediction for SHN
2025-05-19 23:22:20,270 - INFO - [__main__] - 
Processing ticker: SHP
2025-05-19 23:22:20,270 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:20,270 - INFO - [__main__] - Getting last prediction point for ticker: SHP
2025-05-19 23:22:20,270 - INFO - [__main__] - ==================================================
2025-05-19 23:22:20,270 - INFO - [__main__] - Preparing test data for SHP...
2025-05-19 23:22:20,302 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:20,302 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:20,302 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:20,325 - INFO - [src.data_preparation] - Ticker SHP - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:20,325 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(225), np.int64(1): np.int64(413)}
2025-05-19 23:22:20,689 - INFO - [src.data_preparation] - Ticker SHP - Selected features:
2025-05-19 23:22:20,689 - INFO - [src.data_preparation] -   vnipc_t: 0.0799
2025-05-19 23:22:20,689 - INFO - [src.data_preparation] -   Volatility: 0.0705
2025-05-19 23:22:20,689 - INFO - [src.data_preparation] -   SK: 0.0692
2025-05-19 23:22:20,689 - INFO - [src.data_preparation] -   insec_t: 0.0683
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   ret: 0.0676
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   TVV: 0.0631
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   s_d7_t: 0.0624
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   SR: 0.0598
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   variation_t: 0.0591
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   HL: 0.0571
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   LO: 0.0564
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   ATR: 0.0541
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   ma14_t: 0.0488
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   Median_HL: 0.0478
2025-05-19 23:22:20,690 - INFO - [src.data_preparation] -   ma7_t: 0.0473
2025-05-19 23:22:20,693 - INFO - [src.data_preparation] - Ticker SHP - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'insec_t', 'ret', 'TVV', 's_d7_t', 'SR', 'variation_t', 'HL', 'LO', 'ATR', 'ma14_t', 'Median_HL', 'ma7_t']
2025-05-19 23:22:20,781 - INFO - [src.data_preparation] - Ticker SHP - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:20,781 - INFO - [src.data_preparation] - Ticker SHP - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:20,783 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SHP
2025-05-19 23:22:20,783 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:22:20,783 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(165), np.int64(1): np.int64(297)}
2025-05-19 23:22:20,783 - INFO - [src.data_preparation] - Generating 132 synthetic minority samples
2025-05-19 23:22:20,789 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:22:20,789 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:22:20,793 - INFO - [src.data_preparation] - Ticker SHP - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:20,794 - INFO - [__main__] - Using best model for SHP: lstm (F1: 0.7077)
2025-05-19 23:22:20,794 - INFO - [__main__] - Loading lstm model for SHP...
2025-05-19 23:22:20,799 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:20,800 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:22:20,800 - INFO - [__main__] - Making predictions for SHP using lstm
2025-05-19 23:22:20,802 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:20,802 - INFO - [__main__] - Successfully got last prediction for SHP
2025-05-19 23:22:20,802 - INFO - [__main__] - 
Processing ticker: SHS
2025-05-19 23:22:20,802 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:20,802 - INFO - [__main__] - Getting last prediction point for ticker: SHS
2025-05-19 23:22:20,802 - INFO - [__main__] - ==================================================
2025-05-19 23:22:20,802 - INFO - [__main__] - Preparing test data for SHS...
2025-05-19 23:22:20,833 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:20,833 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:20,833 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:20,848 - INFO - [src.data_preparation] - Ticker SHS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:20,848 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(272), np.int64(1): np.int64(367)}
2025-05-19 23:22:21,234 - INFO - [src.data_preparation] - Ticker SHS - Selected features:
2025-05-19 23:22:21,234 - INFO - [src.data_preparation] -   insec_t: 0.0778
2025-05-19 23:22:21,234 - INFO - [src.data_preparation] -   vnipc_t: 0.0765
2025-05-19 23:22:21,234 - INFO - [src.data_preparation] -   SK: 0.0724
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   TVV: 0.0700
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   Volatility: 0.0638
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   ret: 0.0586
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   LO: 0.0558
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   HL: 0.0554
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   ma14_t: 0.0541
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   ATR: 0.0539
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   ma7_t: 0.0538
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:22:21,235 - INFO - [src.data_preparation] -   Median_HL: 0.0491
2025-05-19 23:22:21,238 - INFO - [src.data_preparation] - Ticker SHS - Using features: ['Date', 'insec_t', 'vnipc_t', 'SK', 'TVV', 'Volatility', 's_d7_t', 'ret', 'LO', 'HL', 'ma21_t', 'ma14_t', 'ATR', 'ma7_t', 'variation_t', 'Median_HL']
2025-05-19 23:22:21,332 - INFO - [src.data_preparation] - Ticker SHS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:21,332 - INFO - [src.data_preparation] - Ticker SHS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:21,334 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SHS
2025-05-19 23:22:21,334 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:21,334 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:22:21,334 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:22:21,338 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:22:21,338 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:22:21,342 - INFO - [src.data_preparation] - Ticker SHS - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:21,342 - INFO - [__main__] - Using best model for SHS: transformer (F1: 0.6667)
2025-05-19 23:22:21,342 - INFO - [__main__] - Loading transformer model for SHS...
2025-05-19 23:22:21,355 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:21,361 - INFO - [__main__] - Model size: 0.10 MB
2025-05-19 23:22:21,361 - INFO - [__main__] - Making predictions for SHS using transformer
2025-05-19 23:22:21,364 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:21,365 - INFO - [__main__] - Successfully got last prediction for SHS
2025-05-19 23:22:21,365 - INFO - [__main__] - 
Processing ticker: SII
2025-05-19 23:22:21,365 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:21,365 - INFO - [__main__] - Getting last prediction point for ticker: SII
2025-05-19 23:22:21,365 - INFO - [__main__] - ==================================================
2025-05-19 23:22:21,365 - INFO - [__main__] - Preparing test data for SII...
2025-05-19 23:22:21,406 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:21,406 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:21,407 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:21,440 - INFO - [src.data_preparation] - Ticker SII - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:21,440 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(365)}
2025-05-19 23:22:21,780 - INFO - [src.data_preparation] - Ticker SII - Selected features:
2025-05-19 23:22:21,780 - INFO - [src.data_preparation] -   vnipc_t: 0.0744
2025-05-19 23:22:21,780 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   SK: 0.0650
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   ATR: 0.0638
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   ma21_t: 0.0586
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   insec_t: 0.0569
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   ma14_t: 0.0544
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   ret: 0.0532
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   HL: 0.0503
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:22:21,781 - INFO - [src.data_preparation] -   LO: 0.0499
2025-05-19 23:22:21,784 - INFO - [src.data_preparation] - Ticker SII - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'ATR', 's_d7_t', 'Volatility', 'ma21_t', 'ma7_t', 'insec_t', 'ma14_t', 'PM', 'ret', 'HL', 'variation_t', 'LO']
2025-05-19 23:22:21,875 - INFO - [src.data_preparation] - Ticker SII - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:22:21,875 - INFO - [src.data_preparation] - Ticker SII - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:21,878 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SII
2025-05-19 23:22:21,878 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:21,878 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(259)}
2025-05-19 23:22:21,878 - INFO - [src.data_preparation] - Generating 55 synthetic minority samples
2025-05-19 23:22:21,880 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:22:21,880 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:22:21,883 - INFO - [src.data_preparation] - Ticker SII - Final 3D shapes: X_train=(518, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:21,883 - INFO - [__main__] - Using best model for SII: svm (F1: 0.7429)
2025-05-19 23:22:21,883 - INFO - [__main__] - Loading svm model for SII...
2025-05-19 23:22:21,884 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:21,885 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:22:21,885 - INFO - [__main__] - Making predictions for SII using svm
2025-05-19 23:22:21,885 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:21,885 - INFO - [__main__] - Successfully got last prediction for SII
2025-05-19 23:22:21,885 - INFO - [__main__] - 
Processing ticker: SJ1
2025-05-19 23:22:21,885 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:21,885 - INFO - [__main__] - Getting last prediction point for ticker: SJ1
2025-05-19 23:22:21,887 - INFO - [__main__] - ==================================================
2025-05-19 23:22:21,887 - INFO - [__main__] - Preparing test data for SJ1...
2025-05-19 23:22:21,922 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:21,922 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:21,923 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:21,943 - INFO - [src.data_preparation] - Ticker SJ1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:21,943 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(239), np.int64(1): np.int64(400)}
2025-05-19 23:22:22,273 - INFO - [src.data_preparation] - Ticker SJ1 - Selected features:
2025-05-19 23:22:22,273 - INFO - [src.data_preparation] -   vnipc_t: 0.0747
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   ma14_t: 0.0717
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   Volatility: 0.0711
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   TVV: 0.0658
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   ATR: 0.0649
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   ma21_t: 0.0642
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   ma7_t: 0.0618
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   SK: 0.0611
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   Median_HL: 0.0553
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:22:22,274 - INFO - [src.data_preparation] -   insec_t: 0.0536
2025-05-19 23:22:22,275 - INFO - [src.data_preparation] -   variation_t: 0.0506
2025-05-19 23:22:22,275 - INFO - [src.data_preparation] -   SR: 0.0501
2025-05-19 23:22:22,275 - INFO - [src.data_preparation] -   ret: 0.0497
2025-05-19 23:22:22,278 - INFO - [src.data_preparation] - Ticker SJ1 - Using features: ['Date', 'vnipc_t', 'ma14_t', 'Volatility', 'TVV', 'ATR', 'ma21_t', 's_d7_t', 'ma7_t', 'SK', 'Median_HL', 'PM', 'insec_t', 'variation_t', 'SR', 'ret']
2025-05-19 23:22:22,383 - INFO - [src.data_preparation] - Ticker SJ1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:22,383 - INFO - [src.data_preparation] - Ticker SJ1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:22,385 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SJ1
2025-05-19 23:22:22,385 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:22,385 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(164), np.int64(1): np.int64(299)}
2025-05-19 23:22:22,385 - INFO - [src.data_preparation] - Generating 135 synthetic minority samples
2025-05-19 23:22:22,393 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (598, 13, 15), y shape: (598,)
2025-05-19 23:22:22,394 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(299), np.int64(1): np.int64(299)}
2025-05-19 23:22:22,398 - INFO - [src.data_preparation] - Ticker SJ1 - Final 3D shapes: X_train=(598, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:22,399 - INFO - [__main__] - Using best model for SJ1: svm (F1: 0.6866)
2025-05-19 23:22:22,399 - INFO - [__main__] - Loading svm model for SJ1...
2025-05-19 23:22:22,401 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:22,401 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:22:22,401 - INFO - [__main__] - Making predictions for SJ1 using svm
2025-05-19 23:22:22,402 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:22,402 - INFO - [__main__] - Successfully got last prediction for SJ1
2025-05-19 23:22:22,402 - INFO - [__main__] - 
Processing ticker: SJC
2025-05-19 23:22:22,403 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:22,403 - INFO - [__main__] - Getting last prediction point for ticker: SJC
2025-05-19 23:22:22,403 - INFO - [__main__] - ==================================================
2025-05-19 23:22:22,403 - INFO - [__main__] - Preparing test data for SJC...
2025-05-19 23:22:22,447 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:22,447 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:22,447 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:22,465 - INFO - [src.data_preparation] - Ticker SJC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:22,465 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(245), np.int64(1): np.int64(394)}
2025-05-19 23:22:22,743 - INFO - [src.data_preparation] - Ticker SJC - Selected features:
2025-05-19 23:22:22,743 - INFO - [src.data_preparation] -   Volatility: 0.0831
2025-05-19 23:22:22,743 - INFO - [src.data_preparation] -   ATR: 0.0791
2025-05-19 23:22:22,743 - INFO - [src.data_preparation] -   vnipc_t: 0.0772
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   TVV: 0.0699
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   s_d7_t: 0.0650
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   ret: 0.0624
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   SK: 0.0614
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   variation_t: 0.0549
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   ma21_t: 0.0546
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   ma7_t: 0.0507
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   Median_HL: 0.0499
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   insec_t: 0.0490
2025-05-19 23:22:22,744 - INFO - [src.data_preparation] -   SR: 0.0413
2025-05-19 23:22:22,747 - INFO - [src.data_preparation] - Ticker SJC - Using features: ['Date', 'Volatility', 'ATR', 'vnipc_t', 'TVV', 's_d7_t', 'ret', 'SK', 'ma14_t', 'variation_t', 'ma21_t', 'PM', 'ma7_t', 'Median_HL', 'insec_t', 'SR']
2025-05-19 23:22:22,837 - INFO - [src.data_preparation] - Ticker SJC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:22,837 - INFO - [src.data_preparation] - Ticker SJC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:22,839 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SJC
2025-05-19 23:22:22,839 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:22,839 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(183), np.int64(1): np.int64(280)}
2025-05-19 23:22:22,839 - INFO - [src.data_preparation] - Generating 97 synthetic minority samples
2025-05-19 23:22:22,846 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (560, 13, 15), y shape: (560,)
2025-05-19 23:22:22,846 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(280), np.int64(1): np.int64(280)}
2025-05-19 23:22:22,849 - INFO - [src.data_preparation] - Ticker SJC - Final 3D shapes: X_train=(560, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:22,849 - INFO - [__main__] - Using best model for SJC: svm (F1: 0.9398)
2025-05-19 23:22:22,849 - INFO - [__main__] - Loading svm model for SJC...
2025-05-19 23:22:22,850 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:22,851 - INFO - [__main__] - Model size: 0.64 MB
2025-05-19 23:22:22,851 - INFO - [__main__] - Making predictions for SJC using svm
2025-05-19 23:22:22,851 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:22,852 - INFO - [__main__] - Successfully got last prediction for SJC
2025-05-19 23:22:22,852 - INFO - [__main__] - 
Processing ticker: SJD
2025-05-19 23:22:22,852 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:22,852 - INFO - [__main__] - Getting last prediction point for ticker: SJD
2025-05-19 23:22:22,852 - INFO - [__main__] - ==================================================
2025-05-19 23:22:22,852 - INFO - [__main__] - Preparing test data for SJD...
2025-05-19 23:22:22,878 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:22,879 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:22,879 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:22,899 - INFO - [src.data_preparation] - Ticker SJD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:22,899 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(272), np.int64(1): np.int64(367)}
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] - Ticker SJD - Selected features:
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   TVV: 0.0778
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   SK: 0.0762
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   vnipc_t: 0.0683
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   insec_t: 0.0635
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   ret: 0.0622
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   s_d7_t: 0.0618
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   HL: 0.0615
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   ATR: 0.0600
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   variation_t: 0.0593
2025-05-19 23:22:23,206 - INFO - [src.data_preparation] -   Volatility: 0.0590
2025-05-19 23:22:23,207 - INFO - [src.data_preparation] -   SR: 0.0574
2025-05-19 23:22:23,207 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:22:23,207 - INFO - [src.data_preparation] -   LO: 0.0506
2025-05-19 23:22:23,207 - INFO - [src.data_preparation] -   ma14_t: 0.0493
2025-05-19 23:22:23,207 - INFO - [src.data_preparation] -   ma7_t: 0.0490
2025-05-19 23:22:23,210 - INFO - [src.data_preparation] - Ticker SJD - Using features: ['Date', 'TVV', 'SK', 'vnipc_t', 'insec_t', 'ret', 's_d7_t', 'HL', 'ATR', 'variation_t', 'Volatility', 'SR', 'PM', 'LO', 'ma14_t', 'ma7_t']
2025-05-19 23:22:23,297 - INFO - [src.data_preparation] - Ticker SJD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:23,297 - INFO - [src.data_preparation] - Ticker SJD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:23,299 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SJD
2025-05-19 23:22:23,299 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:23,299 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:22:23,299 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:22:23,302 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:22:23,302 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:22:23,305 - INFO - [src.data_preparation] - Ticker SJD - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:23,305 - INFO - [__main__] - Using best model for SJD: logistic_regression (F1: 0.6000)
2025-05-19 23:22:23,305 - INFO - [__main__] - Loading logistic_regression model for SJD...
2025-05-19 23:22:23,305 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:23,307 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:23,307 - INFO - [__main__] - Making predictions for SJD using logistic_regression
2025-05-19 23:22:23,308 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:23,308 - INFO - [__main__] - Successfully got last prediction for SJD
2025-05-19 23:22:23,308 - INFO - [__main__] - 
Processing ticker: SJE
2025-05-19 23:22:23,308 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:23,308 - INFO - [__main__] - Getting last prediction point for ticker: SJE
2025-05-19 23:22:23,308 - INFO - [__main__] - ==================================================
2025-05-19 23:22:23,308 - INFO - [__main__] - Preparing test data for SJE...
2025-05-19 23:22:23,338 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:23,338 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:23,338 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:23,357 - INFO - [src.data_preparation] - Ticker SJE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:23,358 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] - Ticker SJE - Selected features:
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   vnipc_t: 0.0782
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   SK: 0.0766
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   ATR: 0.0632
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   insec_t: 0.0631
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   s_d7_t: 0.0615
2025-05-19 23:22:23,698 - INFO - [src.data_preparation] -   TVV: 0.0613
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   ret: 0.0583
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   HL: 0.0571
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   ma14_t: 0.0565
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   PM: 0.0553
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   ma21_t: 0.0540
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   ma7_t: 0.0535
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   SR: 0.0507
2025-05-19 23:22:23,699 - INFO - [src.data_preparation] -   Median_HL: 0.0503
2025-05-19 23:22:23,702 - INFO - [src.data_preparation] - Ticker SJE - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'ATR', 'insec_t', 's_d7_t', 'TVV', 'ret', 'HL', 'ma14_t', 'PM', 'ma21_t', 'ma7_t', 'SR', 'Median_HL']
2025-05-19 23:22:23,791 - INFO - [src.data_preparation] - Ticker SJE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:23,791 - INFO - [src.data_preparation] - Ticker SJE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:23,794 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SJE
2025-05-19 23:22:23,794 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:23,794 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(175), np.int64(1): np.int64(288)}
2025-05-19 23:22:23,794 - INFO - [src.data_preparation] - Generating 113 synthetic minority samples
2025-05-19 23:22:23,799 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (576, 13, 15), y shape: (576,)
2025-05-19 23:22:23,799 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(288), np.int64(1): np.int64(288)}
2025-05-19 23:22:23,803 - INFO - [src.data_preparation] - Ticker SJE - Final 3D shapes: X_train=(576, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:23,803 - INFO - [__main__] - Using best model for SJE: svm (F1: 0.6032)
2025-05-19 23:22:23,804 - INFO - [__main__] - Loading svm model for SJE...
2025-05-19 23:22:23,806 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:23,807 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:22:23,807 - INFO - [__main__] - Making predictions for SJE using svm
2025-05-19 23:22:23,809 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:23,809 - INFO - [__main__] - Successfully got last prediction for SJE
2025-05-19 23:22:23,809 - INFO - [__main__] - 
Processing ticker: SJM
2025-05-19 23:22:23,809 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:23,809 - INFO - [__main__] - Getting last prediction point for ticker: SJM
2025-05-19 23:22:23,809 - INFO - [__main__] - ==================================================
2025-05-19 23:22:23,810 - INFO - [__main__] - Preparing test data for SJM...
2025-05-19 23:22:23,845 - INFO - [src.data_preparation] - After processing - X shape: (635, 19), y shape: (635,)
2025-05-19 23:22:23,845 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:23,847 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:23,871 - INFO - [src.data_preparation] - Ticker SJM - Original shapes: X=(635, 18), y=(635,)
2025-05-19 23:22:23,871 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(240), np.int64(1): np.int64(395)}
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] - Ticker SJM - Selected features:
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   vnipc_t: 0.0960
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   Volatility: 0.0755
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   SK: 0.0707
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   s_d7_t: 0.0651
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   insec_t: 0.0651
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   ma14_t: 0.0608
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   ma21_t: 0.0594
2025-05-19 23:22:24,178 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:22:24,179 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:22:24,179 - INFO - [src.data_preparation] -   variation_t: 0.0530
2025-05-19 23:22:24,179 - INFO - [src.data_preparation] -   ret: 0.0522
2025-05-19 23:22:24,179 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:22:24,179 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:22:24,179 - INFO - [src.data_preparation] -   HL: 0.0369
2025-05-19 23:22:24,182 - INFO - [src.data_preparation] - Ticker SJM - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'TVV', 's_d7_t', 'insec_t', 'ma14_t', 'ma21_t', 'ma7_t', 'ATR', 'variation_t', 'ret', 'PM', 'Median_HL', 'HL']
2025-05-19 23:22:24,284 - INFO - [src.data_preparation] - Ticker SJM - 2D shapes: X_train=(459, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:24,284 - INFO - [src.data_preparation] - Ticker SJM - 3D shapes: X_train=(459, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:24,286 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SJM
2025-05-19 23:22:24,286 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (459, 13, 15), y shape: (459,)
2025-05-19 23:22:24,286 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(158), np.int64(1): np.int64(301)}
2025-05-19 23:22:24,286 - INFO - [src.data_preparation] - Generating 143 synthetic minority samples
2025-05-19 23:22:24,294 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (602, 13, 15), y shape: (602,)
2025-05-19 23:22:24,294 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(301), np.int64(1): np.int64(301)}
2025-05-19 23:22:24,298 - INFO - [src.data_preparation] - Ticker SJM - Final 3D shapes: X_train=(602, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:24,298 - INFO - [__main__] - Using best model for SJM: svm (F1: 0.6462)
2025-05-19 23:22:24,298 - INFO - [__main__] - Loading svm model for SJM...
2025-05-19 23:22:24,300 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:24,301 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:22:24,301 - INFO - [__main__] - Making predictions for SJM using svm
2025-05-19 23:22:24,302 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:24,302 - INFO - [__main__] - Successfully got last prediction for SJM
2025-05-19 23:22:24,302 - INFO - [__main__] - 
Processing ticker: SJS
2025-05-19 23:22:24,302 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:24,302 - INFO - [__main__] - Getting last prediction point for ticker: SJS
2025-05-19 23:22:24,302 - INFO - [__main__] - ==================================================
2025-05-19 23:22:24,302 - INFO - [__main__] - Preparing test data for SJS...
2025-05-19 23:22:24,335 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:24,335 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:24,335 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:24,348 - INFO - [src.data_preparation] - Ticker SJS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:24,348 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(326), np.int64(1): np.int64(313)}
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] - Ticker SJS - Selected features:
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   SK: 0.0732
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   s_d7_t: 0.0694
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   TVV: 0.0630
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   Volatility: 0.0626
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:22:24,746 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   insec_t: 0.0600
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   variation_t: 0.0567
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   SR: 0.0566
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   ma21_t: 0.0565
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   ma14_t: 0.0552
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   LO: 0.0551
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   ret: 0.0546
2025-05-19 23:22:24,747 - INFO - [src.data_preparation] -   ma7_t: 0.0499
2025-05-19 23:22:24,750 - INFO - [src.data_preparation] - Ticker SJS - Using features: ['Date', 'SK', 's_d7_t', 'vnipc_t', 'TVV', 'Volatility', 'HL', 'ATR', 'insec_t', 'variation_t', 'SR', 'ma21_t', 'ma14_t', 'LO', 'ret', 'ma7_t']
2025-05-19 23:22:24,862 - INFO - [src.data_preparation] - Ticker SJS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:24,862 - INFO - [src.data_preparation] - Ticker SJS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:24,864 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SJS
2025-05-19 23:22:24,864 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:24,864 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(230)}
2025-05-19 23:22:24,865 - INFO - [src.data_preparation] - Generating 3 synthetic minority samples
2025-05-19 23:22:24,865 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (466, 13, 15), y shape: (466,)
2025-05-19 23:22:24,865 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(233)}
2025-05-19 23:22:24,869 - INFO - [src.data_preparation] - Ticker SJS - Final 3D shapes: X_train=(466, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:24,869 - INFO - [__main__] - Using best model for SJS: lstm (F1: 0.7429)
2025-05-19 23:22:24,869 - INFO - [__main__] - Loading lstm model for SJS...
2025-05-19 23:22:24,874 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:24,875 - INFO - [__main__] - Model size: 0.21 MB
2025-05-19 23:22:24,876 - INFO - [__main__] - Making predictions for SJS using lstm
2025-05-19 23:22:24,880 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:24,881 - INFO - [__main__] - Successfully got last prediction for SJS
2025-05-19 23:22:24,881 - INFO - [__main__] - 
Processing ticker: SLS
2025-05-19 23:22:24,881 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:24,881 - INFO - [__main__] - Getting last prediction point for ticker: SLS
2025-05-19 23:22:24,881 - INFO - [__main__] - ==================================================
2025-05-19 23:22:24,881 - INFO - [__main__] - Preparing test data for SLS...
2025-05-19 23:22:24,940 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:24,940 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:24,940 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:24,970 - INFO - [src.data_preparation] - Ticker SLS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:24,971 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:22:25,321 - INFO - [src.data_preparation] - Ticker SLS - Selected features:
2025-05-19 23:22:25,321 - INFO - [src.data_preparation] -   vnipc_t: 0.0727
2025-05-19 23:22:25,321 - INFO - [src.data_preparation] -   insec_t: 0.0685
2025-05-19 23:22:25,321 - INFO - [src.data_preparation] -   Volatility: 0.0673
2025-05-19 23:22:25,321 - INFO - [src.data_preparation] -   LO: 0.0634
2025-05-19 23:22:25,321 - INFO - [src.data_preparation] -   TVV: 0.0633
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   SK: 0.0620
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   variation_t: 0.0605
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   HL: 0.0603
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   ATR: 0.0600
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   ret: 0.0568
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   SR: 0.0518
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   Median_HL: 0.0474
2025-05-19 23:22:25,322 - INFO - [src.data_preparation] -   ma14_t: 0.0473
2025-05-19 23:22:25,325 - INFO - [src.data_preparation] - Ticker SLS - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'LO', 'TVV', 'SK', 's_d7_t', 'variation_t', 'HL', 'ATR', 'ret', 'SR', 'PM', 'Median_HL', 'ma14_t']
2025-05-19 23:22:25,418 - INFO - [src.data_preparation] - Ticker SLS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:25,418 - INFO - [src.data_preparation] - Ticker SLS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:25,420 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SLS
2025-05-19 23:22:25,420 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:25,420 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:22:25,420 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:22:25,423 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:22:25,424 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:22:25,428 - INFO - [src.data_preparation] - Ticker SLS - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:25,428 - INFO - [__main__] - Using best model for SLS: logistic_regression (F1: 0.5660)
2025-05-19 23:22:25,428 - INFO - [__main__] - Loading logistic_regression model for SLS...
2025-05-19 23:22:25,429 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:25,429 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:25,429 - INFO - [__main__] - Making predictions for SLS using logistic_regression
2025-05-19 23:22:25,429 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:25,430 - INFO - [__main__] - Successfully got last prediction for SLS
2025-05-19 23:22:25,430 - INFO - [__main__] - 
Processing ticker: SMA
2025-05-19 23:22:25,430 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:25,430 - INFO - [__main__] - Getting last prediction point for ticker: SMA
2025-05-19 23:22:25,430 - INFO - [__main__] - ==================================================
2025-05-19 23:22:25,430 - INFO - [__main__] - Preparing test data for SMA...
2025-05-19 23:22:25,462 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:25,462 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:25,462 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:25,484 - INFO - [src.data_preparation] - Ticker SMA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:25,484 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:22:25,817 - INFO - [src.data_preparation] - Ticker SMA - Selected features:
2025-05-19 23:22:25,817 - INFO - [src.data_preparation] -   Volatility: 0.0849
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   SK: 0.0720
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   TVV: 0.0697
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   vnipc_t: 0.0671
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   insec_t: 0.0633
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   Median_HL: 0.0588
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   PM: 0.0586
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   s_d7_t: 0.0585
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   ma7_t: 0.0562
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   ma21_t: 0.0522
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   SR: 0.0519
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   ma14_t: 0.0515
2025-05-19 23:22:25,818 - INFO - [src.data_preparation] -   ret: 0.0490
2025-05-19 23:22:25,821 - INFO - [src.data_preparation] - Ticker SMA - Using features: ['Date', 'Volatility', 'SK', 'TVV', 'vnipc_t', 'insec_t', 'ATR', 'Median_HL', 'PM', 's_d7_t', 'ma7_t', 'variation_t', 'ma21_t', 'SR', 'ma14_t', 'ret']
2025-05-19 23:22:25,920 - INFO - [src.data_preparation] - Ticker SMA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:25,921 - INFO - [src.data_preparation] - Ticker SMA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:25,923 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SMA
2025-05-19 23:22:25,923 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:25,923 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(196), np.int64(1): np.int64(267)}
2025-05-19 23:22:25,923 - INFO - [src.data_preparation] - Generating 71 synthetic minority samples
2025-05-19 23:22:25,929 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (534, 13, 15), y shape: (534,)
2025-05-19 23:22:25,929 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(267), np.int64(1): np.int64(267)}
2025-05-19 23:22:25,933 - INFO - [src.data_preparation] - Ticker SMA - Final 3D shapes: X_train=(534, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:25,933 - INFO - [__main__] - Using best model for SMA: logistic_regression (F1: 0.7059)
2025-05-19 23:22:25,934 - INFO - [__main__] - Loading logistic_regression model for SMA...
2025-05-19 23:22:25,934 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:25,935 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:25,935 - INFO - [__main__] - Making predictions for SMA using logistic_regression
2025-05-19 23:22:25,935 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:25,935 - INFO - [__main__] - Successfully got last prediction for SMA
2025-05-19 23:22:25,935 - INFO - [__main__] - 
Processing ticker: SMB
2025-05-19 23:22:25,935 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:25,935 - INFO - [__main__] - Getting last prediction point for ticker: SMB
2025-05-19 23:22:25,935 - INFO - [__main__] - ==================================================
2025-05-19 23:22:25,935 - INFO - [__main__] - Preparing test data for SMB...
2025-05-19 23:22:25,980 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:22:25,980 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:25,980 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:26,004 - INFO - [src.data_preparation] - Ticker SMB - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:22:26,005 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(383)}
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] - Ticker SMB - Selected features:
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] -   Volatility: 0.0661
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] -   HL: 0.0650
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] -   insec_t: 0.0642
2025-05-19 23:22:26,339 - INFO - [src.data_preparation] -   TVV: 0.0618
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   SR: 0.0601
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   ATR: 0.0587
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   variation_t: 0.0567
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   ma14_t: 0.0546
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   ma21_t: 0.0539
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   LO: 0.0525
2025-05-19 23:22:26,340 - INFO - [src.data_preparation] -   Median_HL: 0.0507
2025-05-19 23:22:26,342 - INFO - [src.data_preparation] - Ticker SMB - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'HL', 'insec_t', 'TVV', 's_d7_t', 'SR', 'ATR', 'variation_t', 'ma14_t', 'ret', 'ma21_t', 'LO', 'Median_HL']
2025-05-19 23:22:26,433 - INFO - [src.data_preparation] - Ticker SMB - 2D shapes: X_train=(461, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:26,433 - INFO - [src.data_preparation] - Ticker SMB - 3D shapes: X_train=(461, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:26,435 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SMB
2025-05-19 23:22:26,435 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (461, 13, 15), y shape: (461,)
2025-05-19 23:22:26,435 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(178), np.int64(1): np.int64(283)}
2025-05-19 23:22:26,435 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:22:26,441 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (566, 13, 15), y shape: (566,)
2025-05-19 23:22:26,441 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(283), np.int64(1): np.int64(283)}
2025-05-19 23:22:26,446 - INFO - [src.data_preparation] - Ticker SMB - Final 3D shapes: X_train=(566, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:26,446 - INFO - [__main__] - Using best model for SMB: svm (F1: 0.7429)
2025-05-19 23:22:26,446 - INFO - [__main__] - Loading svm model for SMB...
2025-05-19 23:22:26,448 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:26,448 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:22:26,449 - INFO - [__main__] - Making predictions for SMB using svm
2025-05-19 23:22:26,449 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:26,449 - INFO - [__main__] - Successfully got last prediction for SMB
2025-05-19 23:22:26,449 - INFO - [__main__] - 
Processing ticker: SMC
2025-05-19 23:22:26,450 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:26,450 - INFO - [__main__] - Getting last prediction point for ticker: SMC
2025-05-19 23:22:26,450 - INFO - [__main__] - ==================================================
2025-05-19 23:22:26,450 - INFO - [__main__] - Preparing test data for SMC...
2025-05-19 23:22:26,478 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:26,478 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:26,478 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:26,507 - INFO - [src.data_preparation] - Ticker SMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:26,507 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(301), np.int64(1): np.int64(338)}
2025-05-19 23:22:26,855 - INFO - [src.data_preparation] - Ticker SMC - Selected features:
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   TVV: 0.0791
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   insec_t: 0.0762
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   vnipc_t: 0.0711
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   Volatility: 0.0643
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   s_d7_t: 0.0616
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   SK: 0.0612
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   HL: 0.0600
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   ma14_t: 0.0581
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   ATR: 0.0541
2025-05-19 23:22:26,857 - INFO - [src.data_preparation] -   SR: 0.0536
2025-05-19 23:22:26,858 - INFO - [src.data_preparation] -   ma21_t: 0.0531
2025-05-19 23:22:26,858 - INFO - [src.data_preparation] -   LO: 0.0525
2025-05-19 23:22:26,858 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:22:26,858 - INFO - [src.data_preparation] -   Median_HL: 0.0512
2025-05-19 23:22:26,862 - INFO - [src.data_preparation] - Ticker SMC - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 'Volatility', 's_d7_t', 'SK', 'HL', 'ma14_t', 'ret', 'ATR', 'SR', 'ma21_t', 'LO', 'variation_t', 'Median_HL']
2025-05-19 23:22:26,990 - INFO - [src.data_preparation] - Ticker SMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:26,990 - INFO - [src.data_preparation] - Ticker SMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:26,992 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SMC
2025-05-19 23:22:26,992 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:26,992 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:22:26,992 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:22:26,997 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:22:26,997 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:22:27,001 - INFO - [src.data_preparation] - Ticker SMC - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:27,002 - INFO - [__main__] - Using best model for SMC: lstm (F1: 0.5574)
2025-05-19 23:22:27,002 - INFO - [__main__] - Loading lstm model for SMC...
2025-05-19 23:22:27,007 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:27,008 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:22:27,008 - INFO - [__main__] - Making predictions for SMC using lstm
2025-05-19 23:22:27,010 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:27,011 - INFO - [__main__] - Successfully got last prediction for SMC
2025-05-19 23:22:27,011 - INFO - [__main__] - 
Processing ticker: SMT
2025-05-19 23:22:27,011 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:27,011 - INFO - [__main__] - Getting last prediction point for ticker: SMT
2025-05-19 23:22:27,012 - INFO - [__main__] - ==================================================
2025-05-19 23:22:27,012 - INFO - [__main__] - Preparing test data for SMT...
2025-05-19 23:22:27,073 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:27,074 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:27,074 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:27,104 - INFO - [src.data_preparation] - Ticker SMT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:27,104 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:22:27,476 - INFO - [src.data_preparation] - Ticker SMT - Selected features:
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   TVV: 0.0808
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   Volatility: 0.0710
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   SK: 0.0697
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   insec_t: 0.0685
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   vnipc_t: 0.0677
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   ATR: 0.0639
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   s_d7_t: 0.0629
2025-05-19 23:22:27,477 - INFO - [src.data_preparation] -   ma14_t: 0.0572
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   SR: 0.0544
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   PM: 0.0533
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   ma7_t: 0.0491
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:22:27,478 - INFO - [src.data_preparation] -   HL: 0.0482
2025-05-19 23:22:27,481 - INFO - [src.data_preparation] - Ticker SMT - Using features: ['Date', 'TVV', 'Volatility', 'SK', 'insec_t', 'vnipc_t', 'ATR', 's_d7_t', 'ma14_t', 'ma21_t', 'SR', 'PM', 'Median_HL', 'ma7_t', 'ret', 'HL']
2025-05-19 23:22:27,574 - INFO - [src.data_preparation] - Ticker SMT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:27,574 - INFO - [src.data_preparation] - Ticker SMT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:27,575 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SMT
2025-05-19 23:22:27,575 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:27,575 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:22:27,575 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:22:27,582 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:22:27,582 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:22:27,585 - INFO - [src.data_preparation] - Ticker SMT - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:27,585 - INFO - [__main__] - Using best model for SMT: svm (F1: 0.7246)
2025-05-19 23:22:27,587 - INFO - [__main__] - Loading svm model for SMT...
2025-05-19 23:22:27,587 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:27,589 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:22:27,589 - INFO - [__main__] - Making predictions for SMT using svm
2025-05-19 23:22:27,590 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:27,590 - INFO - [__main__] - Successfully got last prediction for SMT
2025-05-19 23:22:27,590 - INFO - [__main__] - 
Processing ticker: SPC
2025-05-19 23:22:27,590 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:27,590 - INFO - [__main__] - Getting last prediction point for ticker: SPC
2025-05-19 23:22:27,590 - INFO - [__main__] - ==================================================
2025-05-19 23:22:27,590 - INFO - [__main__] - Preparing test data for SPC...
2025-05-19 23:22:27,620 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:27,620 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:27,620 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:27,647 - INFO - [src.data_preparation] - Ticker SPC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:27,648 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(185), np.int64(1): np.int64(454)}
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] - Ticker SPC - Selected features:
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   ma14_t: 0.0804
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   ma21_t: 0.0796
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   vnipc_t: 0.0769
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   SK: 0.0710
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   ma7_t: 0.0690
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   ATR: 0.0632
2025-05-19 23:22:27,928 - INFO - [src.data_preparation] -   PM: 0.0621
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   Median_HL: 0.0609
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   Volatility: 0.0603
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   s_d7_t: 0.0601
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   TVV: 0.0580
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   insec_t: 0.0529
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   HL: 0.0472
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   SR: 0.0438
2025-05-19 23:22:27,937 - INFO - [src.data_preparation] -   ret: 0.0412
2025-05-19 23:22:27,941 - INFO - [src.data_preparation] - Ticker SPC - Using features: ['Date', 'ma14_t', 'ma21_t', 'vnipc_t', 'SK', 'ma7_t', 'ATR', 'PM', 'Median_HL', 'Volatility', 's_d7_t', 'TVV', 'insec_t', 'HL', 'SR', 'ret']
2025-05-19 23:22:28,029 - INFO - [src.data_preparation] - Ticker SPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:28,029 - INFO - [src.data_preparation] - Ticker SPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:28,031 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SPC
2025-05-19 23:22:28,031 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:28,031 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(121), np.int64(1): np.int64(342)}
2025-05-19 23:22:28,031 - INFO - [src.data_preparation] - Generating 221 synthetic minority samples
2025-05-19 23:22:28,039 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (684, 13, 15), y shape: (684,)
2025-05-19 23:22:28,039 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(342), np.int64(1): np.int64(342)}
2025-05-19 23:22:28,042 - INFO - [src.data_preparation] - Ticker SPC - Final 3D shapes: X_train=(684, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:28,043 - INFO - [__main__] - Using best model for SPC: svm (F1: 0.8718)
2025-05-19 23:22:28,043 - INFO - [__main__] - Loading svm model for SPC...
2025-05-19 23:22:28,045 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:28,046 - INFO - [__main__] - Model size: 1.03 MB
2025-05-19 23:22:28,046 - INFO - [__main__] - Making predictions for SPC using svm
2025-05-19 23:22:28,047 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:28,048 - INFO - [__main__] - Successfully got last prediction for SPC
2025-05-19 23:22:28,048 - INFO - [__main__] - 
Processing ticker: SPD
2025-05-19 23:22:28,048 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:28,048 - INFO - [__main__] - Getting last prediction point for ticker: SPD
2025-05-19 23:22:28,048 - INFO - [__main__] - ==================================================
2025-05-19 23:22:28,049 - INFO - [__main__] - Preparing test data for SPD...
2025-05-19 23:22:28,075 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:28,075 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:28,075 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:28,096 - INFO - [src.data_preparation] - Ticker SPD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:28,096 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(85), np.int64(1): np.int64(554)}
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] - Ticker SPD - Selected features:
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   vnipc_t: 0.1445
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   ma21_t: 0.0805
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   TVV: 0.0799
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   ma14_t: 0.0728
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   s_d7_t: 0.0723
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   ATR: 0.0683
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   ma7_t: 0.0631
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   SK: 0.0555
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   Median_HL: 0.0512
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   PM: 0.0506
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   insec_t: 0.0452
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   SR: 0.0312
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   HL: 0.0307
2025-05-19 23:22:28,324 - INFO - [src.data_preparation] -   ret: 0.0275
2025-05-19 23:22:28,328 - INFO - [src.data_preparation] - Ticker SPD - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ma14_t', 's_d7_t', 'ATR', 'Volatility', 'ma7_t', 'SK', 'Median_HL', 'PM', 'insec_t', 'SR', 'HL', 'ret']
2025-05-19 23:22:28,424 - INFO - [src.data_preparation] - Ticker SPD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:28,424 - INFO - [src.data_preparation] - Ticker SPD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:28,425 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SPD
2025-05-19 23:22:28,425 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:28,425 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(74), np.int64(1): np.int64(389)}
2025-05-19 23:22:28,425 - INFO - [src.data_preparation] - Generating 315 synthetic minority samples
2025-05-19 23:22:28,438 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (778, 13, 15), y shape: (778,)
2025-05-19 23:22:28,438 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(389), np.int64(1): np.int64(389)}
2025-05-19 23:22:28,442 - INFO - [src.data_preparation] - Ticker SPD - Final 3D shapes: X_train=(778, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:28,443 - INFO - [__main__] - Using best model for SPD: logistic_regression (F1: 0.9647)
2025-05-19 23:22:28,443 - INFO - [__main__] - Loading logistic_regression model for SPD...
2025-05-19 23:22:28,443 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:28,444 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:28,444 - INFO - [__main__] - Making predictions for SPD using logistic_regression
2025-05-19 23:22:28,444 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:28,444 - INFO - [__main__] - Successfully got last prediction for SPD
2025-05-19 23:22:28,444 - INFO - [__main__] - 
Processing ticker: SPI
2025-05-19 23:22:28,445 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:28,445 - INFO - [__main__] - Getting last prediction point for ticker: SPI
2025-05-19 23:22:28,445 - INFO - [__main__] - ==================================================
2025-05-19 23:22:28,445 - INFO - [__main__] - Preparing test data for SPI...
2025-05-19 23:22:28,473 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:28,473 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:28,473 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:28,501 - INFO - [src.data_preparation] - Ticker SPI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:28,502 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(272), np.int64(1): np.int64(367)}
2025-05-19 23:22:28,837 - INFO - [src.data_preparation] - Ticker SPI - Selected features:
2025-05-19 23:22:28,837 - INFO - [src.data_preparation] -   vnipc_t: 0.0942
2025-05-19 23:22:28,837 - INFO - [src.data_preparation] -   Volatility: 0.0739
2025-05-19 23:22:28,837 - INFO - [src.data_preparation] -   s_d7_t: 0.0718
2025-05-19 23:22:28,837 - INFO - [src.data_preparation] -   TVV: 0.0700
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   ma21_t: 0.0692
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   insec_t: 0.0683
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   ma14_t: 0.0658
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   SK: 0.0616
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   ATR: 0.0548
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   variation_t: 0.0488
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   ret: 0.0481
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   Median_HL: 0.0478
2025-05-19 23:22:28,838 - INFO - [src.data_preparation] -   SR: 0.0384
2025-05-19 23:22:28,842 - INFO - [src.data_preparation] - Ticker SPI - Using features: ['Date', 'vnipc_t', 'Volatility', 's_d7_t', 'TVV', 'ma21_t', 'insec_t', 'ma14_t', 'SK', 'ATR', 'ma7_t', 'PM', 'variation_t', 'ret', 'Median_HL', 'SR']
2025-05-19 23:22:28,947 - INFO - [src.data_preparation] - Ticker SPI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:28,947 - INFO - [src.data_preparation] - Ticker SPI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:28,958 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SPI
2025-05-19 23:22:28,958 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:28,958 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(274)}
2025-05-19 23:22:28,959 - INFO - [src.data_preparation] - Generating 85 synthetic minority samples
2025-05-19 23:22:28,967 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (548, 13, 15), y shape: (548,)
2025-05-19 23:22:28,967 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(274), np.int64(1): np.int64(274)}
2025-05-19 23:22:28,967 - INFO - [src.data_preparation] - Ticker SPI - Final 3D shapes: X_train=(548, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:28,967 - INFO - [__main__] - Using best model for SPI: transformer (F1: 0.7576)
2025-05-19 23:22:28,967 - INFO - [__main__] - Loading transformer model for SPI...
2025-05-19 23:22:28,989 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:29,000 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:22:29,001 - INFO - [__main__] - Making predictions for SPI using transformer
2025-05-19 23:22:29,003 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:29,004 - INFO - [__main__] - Successfully got last prediction for SPI
2025-05-19 23:22:29,004 - INFO - [__main__] - 
Processing ticker: SPM
2025-05-19 23:22:29,004 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:29,005 - INFO - [__main__] - Getting last prediction point for ticker: SPM
2025-05-19 23:22:29,005 - INFO - [__main__] - ==================================================
2025-05-19 23:22:29,005 - INFO - [__main__] - Preparing test data for SPM...
2025-05-19 23:22:29,057 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:29,057 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:29,057 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:29,084 - INFO - [src.data_preparation] - Ticker SPM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:29,084 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(325), np.int64(1): np.int64(314)}
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] - Ticker SPM - Selected features:
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] -   insec_t: 0.0769
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] -   SK: 0.0682
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] -   vnipc_t: 0.0641
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] -   TVV: 0.0638
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:22:29,487 - INFO - [src.data_preparation] -   SR: 0.0586
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   ret: 0.0578
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   s_d7_t: 0.0568
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   ATR: 0.0558
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   variation_t: 0.0552
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   PM: 0.0545
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   HL: 0.0540
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   Median_HL: 0.0534
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   ma14_t: 0.0520
2025-05-19 23:22:29,488 - INFO - [src.data_preparation] -   ma21_t: 0.0510
2025-05-19 23:22:29,491 - INFO - [src.data_preparation] - Ticker SPM - Using features: ['Date', 'insec_t', 'SK', 'vnipc_t', 'TVV', 'Volatility', 'SR', 'ret', 's_d7_t', 'ATR', 'variation_t', 'PM', 'HL', 'Median_HL', 'ma14_t', 'ma21_t']
2025-05-19 23:22:29,593 - INFO - [src.data_preparation] - Ticker SPM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:29,593 - INFO - [src.data_preparation] - Ticker SPM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:29,595 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SPM
2025-05-19 23:22:29,595 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:29,595 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(230), np.int64(1): np.int64(233)}
2025-05-19 23:22:29,595 - INFO - [src.data_preparation] - Generating 3 synthetic minority samples
2025-05-19 23:22:29,596 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (466, 13, 15), y shape: (466,)
2025-05-19 23:22:29,596 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(233)}
2025-05-19 23:22:29,600 - INFO - [src.data_preparation] - Ticker SPM - Final 3D shapes: X_train=(466, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:29,601 - INFO - [__main__] - Using best model for SPM: logistic_regression (F1: 0.7119)
2025-05-19 23:22:29,601 - INFO - [__main__] - Loading logistic_regression model for SPM...
2025-05-19 23:22:29,602 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:29,602 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:29,602 - INFO - [__main__] - Making predictions for SPM using logistic_regression
2025-05-19 23:22:29,602 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:29,602 - INFO - [__main__] - Successfully got last prediction for SPM
2025-05-19 23:22:29,603 - INFO - [__main__] - 
Processing ticker: SQC
2025-05-19 23:22:29,603 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:29,603 - INFO - [__main__] - Getting last prediction point for ticker: SQC
2025-05-19 23:22:29,603 - INFO - [__main__] - ==================================================
2025-05-19 23:22:29,603 - INFO - [__main__] - Preparing test data for SQC...
2025-05-19 23:22:29,634 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:29,635 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:29,635 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:29,656 - INFO - [src.data_preparation] - Ticker SQC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:29,656 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(64), np.int64(1): np.int64(575)}
2025-05-19 23:22:29,859 - INFO - [src.data_preparation] - Ticker SQC - Selected features:
2025-05-19 23:22:29,859 - INFO - [src.data_preparation] -   vnipc_t: 0.1334
2025-05-19 23:22:29,859 - INFO - [src.data_preparation] -   ma14_t: 0.0898
2025-05-19 23:22:29,859 - INFO - [src.data_preparation] -   ma21_t: 0.0837
2025-05-19 23:22:29,859 - INFO - [src.data_preparation] -   Median_HL: 0.0748
2025-05-19 23:22:29,859 - INFO - [src.data_preparation] -   TVV: 0.0718
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   PM: 0.0678
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   ATR: 0.0663
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   ma7_t: 0.0591
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   Volatility: 0.0515
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   HL: 0.0487
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   SK: 0.0394
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   ret: 0.0350
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   insec_t: 0.0336
2025-05-19 23:22:29,860 - INFO - [src.data_preparation] -   variation_t: 0.0312
2025-05-19 23:22:29,864 - INFO - [src.data_preparation] - Ticker SQC - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'Median_HL', 'TVV', 'PM', 'ATR', 's_d7_t', 'ma7_t', 'Volatility', 'HL', 'SK', 'ret', 'insec_t', 'variation_t']
2025-05-19 23:22:29,957 - INFO - [src.data_preparation] - Ticker SQC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:29,957 - INFO - [src.data_preparation] - Ticker SQC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:29,959 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SQC
2025-05-19 23:22:29,959 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:29,959 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(17), np.int64(1): np.int64(446)}
2025-05-19 23:22:29,959 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:29,962 - INFO - [src.data_preparation] - Ticker SQC - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:29,963 - INFO - [__main__] - Using best model for SQC: lstm (F1: 0.9398)
2025-05-19 23:22:29,963 - INFO - [__main__] - Loading lstm model for SQC...
2025-05-19 23:22:29,967 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:29,968 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:22:29,968 - INFO - [__main__] - Making predictions for SQC using lstm
2025-05-19 23:22:29,971 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:29,971 - INFO - [__main__] - Successfully got last prediction for SQC
2025-05-19 23:22:29,971 - INFO - [__main__] - 
Processing ticker: SRA
2025-05-19 23:22:29,971 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:29,971 - INFO - [__main__] - Getting last prediction point for ticker: SRA
2025-05-19 23:22:29,971 - INFO - [__main__] - ==================================================
2025-05-19 23:22:29,971 - INFO - [__main__] - Preparing test data for SRA...
2025-05-19 23:22:30,015 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:30,015 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:30,015 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:30,041 - INFO - [src.data_preparation] - Ticker SRA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:30,042 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(261), np.int64(1): np.int64(378)}
2025-05-19 23:22:30,373 - INFO - [src.data_preparation] - Ticker SRA - Selected features:
2025-05-19 23:22:30,373 - INFO - [src.data_preparation] -   s_d7_t: 0.0704
2025-05-19 23:22:30,373 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:22:30,373 - INFO - [src.data_preparation] -   vnipc_t: 0.0684
2025-05-19 23:22:30,373 - INFO - [src.data_preparation] -   ma21_t: 0.0674
2025-05-19 23:22:30,373 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   ma14_t: 0.0635
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   ma7_t: 0.0616
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   PM: 0.0585
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   insec_t: 0.0584
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   SK: 0.0582
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   ret: 0.0581
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   Median_HL: 0.0573
2025-05-19 23:22:30,377 - INFO - [src.data_preparation] -   ATR: 0.0551
2025-05-19 23:22:30,378 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:22:30,378 - INFO - [src.data_preparation] -   HL: 0.0474
2025-05-19 23:22:30,381 - INFO - [src.data_preparation] - Ticker SRA - Using features: ['Date', 's_d7_t', 'TVV', 'vnipc_t', 'ma21_t', 'Volatility', 'ma14_t', 'ma7_t', 'PM', 'insec_t', 'SK', 'ret', 'Median_HL', 'ATR', 'variation_t', 'HL']
2025-05-19 23:22:30,471 - INFO - [src.data_preparation] - Ticker SRA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:30,471 - INFO - [src.data_preparation] - Ticker SRA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:30,472 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SRA
2025-05-19 23:22:30,472 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:30,473 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(186), np.int64(1): np.int64(277)}
2025-05-19 23:22:30,473 - INFO - [src.data_preparation] - Generating 91 synthetic minority samples
2025-05-19 23:22:30,477 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (554, 13, 15), y shape: (554,)
2025-05-19 23:22:30,477 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(277), np.int64(1): np.int64(277)}
2025-05-19 23:22:30,480 - INFO - [src.data_preparation] - Ticker SRA - Final 3D shapes: X_train=(554, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:30,481 - INFO - [__main__] - Using best model for SRA: logistic_regression (F1: 0.1714)
2025-05-19 23:22:30,481 - INFO - [__main__] - Loading logistic_regression model for SRA...
2025-05-19 23:22:30,483 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:30,483 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:30,483 - INFO - [__main__] - Making predictions for SRA using logistic_regression
2025-05-19 23:22:30,483 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:30,484 - INFO - [__main__] - Successfully got last prediction for SRA
2025-05-19 23:22:30,484 - INFO - [__main__] - 
Processing ticker: SRB
2025-05-19 23:22:30,484 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:30,484 - INFO - [__main__] - Getting last prediction point for ticker: SRB
2025-05-19 23:22:30,484 - INFO - [__main__] - ==================================================
2025-05-19 23:22:30,484 - INFO - [__main__] - Preparing test data for SRB...
2025-05-19 23:22:30,522 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:30,522 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:30,522 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:30,543 - INFO - [src.data_preparation] - Ticker SRB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:30,543 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:22:30,852 - INFO - [src.data_preparation] - Ticker SRB - Selected features:
2025-05-19 23:22:30,852 - INFO - [src.data_preparation] -   vnipc_t: 0.0900
2025-05-19 23:22:30,852 - INFO - [src.data_preparation] -   insec_t: 0.0785
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   Volatility: 0.0745
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   TVV: 0.0717
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   ma21_t: 0.0688
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   SK: 0.0679
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   ma14_t: 0.0641
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   s_d7_t: 0.0635
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   ma7_t: 0.0570
2025-05-19 23:22:30,853 - INFO - [src.data_preparation] -   ret: 0.0543
2025-05-19 23:22:30,854 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:22:30,854 - INFO - [src.data_preparation] -   PM: 0.0508
2025-05-19 23:22:30,854 - INFO - [src.data_preparation] -   ATR: 0.0486
2025-05-19 23:22:30,854 - INFO - [src.data_preparation] -   Median_HL: 0.0481
2025-05-19 23:22:30,854 - INFO - [src.data_preparation] -   HL: 0.0350
2025-05-19 23:22:30,857 - INFO - [src.data_preparation] - Ticker SRB - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'TVV', 'ma21_t', 'SK', 'ma14_t', 's_d7_t', 'ma7_t', 'ret', 'variation_t', 'PM', 'ATR', 'Median_HL', 'HL']
2025-05-19 23:22:30,944 - INFO - [src.data_preparation] - Ticker SRB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:30,945 - INFO - [src.data_preparation] - Ticker SRB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:30,949 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SRB
2025-05-19 23:22:30,950 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:30,950 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(176), np.int64(1): np.int64(287)}
2025-05-19 23:22:30,950 - INFO - [src.data_preparation] - Generating 111 synthetic minority samples
2025-05-19 23:22:30,959 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (574, 13, 15), y shape: (574,)
2025-05-19 23:22:30,959 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(287), np.int64(1): np.int64(287)}
2025-05-19 23:22:30,966 - INFO - [src.data_preparation] - Ticker SRB - Final 3D shapes: X_train=(574, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:30,967 - INFO - [__main__] - Using best model for SRB: svm (F1: 0.7246)
2025-05-19 23:22:30,967 - INFO - [__main__] - Loading svm model for SRB...
2025-05-19 23:22:30,971 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:30,972 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:22:30,973 - INFO - [__main__] - Making predictions for SRB using svm
2025-05-19 23:22:30,974 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:30,975 - INFO - [__main__] - Successfully got last prediction for SRB
2025-05-19 23:22:30,975 - INFO - [__main__] - 
Processing ticker: SRC
2025-05-19 23:22:30,975 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:30,975 - INFO - [__main__] - Getting last prediction point for ticker: SRC
2025-05-19 23:22:30,975 - INFO - [__main__] - ==================================================
2025-05-19 23:22:30,975 - INFO - [__main__] - Preparing test data for SRC...
2025-05-19 23:22:31,017 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:31,017 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:31,017 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:31,043 - INFO - [src.data_preparation] - Ticker SRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:31,043 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] - Ticker SRC - Selected features:
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   SK: 0.0695
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   vnipc_t: 0.0694
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   s_d7_t: 0.0690
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   HL: 0.0687
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   TVV: 0.0652
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   insec_t: 0.0616
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   Volatility: 0.0611
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   ret: 0.0590
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   ATR: 0.0562
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   SR: 0.0551
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   LO: 0.0548
2025-05-19 23:22:31,417 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:22:31,418 - INFO - [src.data_preparation] -   ma21_t: 0.0526
2025-05-19 23:22:31,418 - INFO - [src.data_preparation] -   ma14_t: 0.0518
2025-05-19 23:22:31,418 - INFO - [src.data_preparation] -   variation_t: 0.0517
2025-05-19 23:22:31,421 - INFO - [src.data_preparation] - Ticker SRC - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'HL', 'TVV', 'insec_t', 'Volatility', 'ret', 'ATR', 'SR', 'LO', 'ma7_t', 'ma21_t', 'ma14_t', 'variation_t']
2025-05-19 23:22:31,512 - INFO - [src.data_preparation] - Ticker SRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:31,512 - INFO - [src.data_preparation] - Ticker SRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:31,513 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SRC
2025-05-19 23:22:31,513 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:31,513 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(231), np.int64(1): np.int64(232)}
2025-05-19 23:22:31,514 - INFO - [src.data_preparation] - Generating 1 synthetic minority samples
2025-05-19 23:22:31,514 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:22:31,515 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:22:31,518 - INFO - [src.data_preparation] - Ticker SRC - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:31,518 - INFO - [__main__] - Using best model for SRC: transformer (F1: 0.1481)
2025-05-19 23:22:31,518 - INFO - [__main__] - Loading transformer model for SRC...
2025-05-19 23:22:31,533 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:31,537 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:22:31,538 - INFO - [__main__] - Making predictions for SRC using transformer
2025-05-19 23:22:31,540 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:31,541 - INFO - [__main__] - Successfully got last prediction for SRC
2025-05-19 23:22:31,541 - INFO - [__main__] - 
Processing ticker: SRF
2025-05-19 23:22:31,541 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:31,541 - INFO - [__main__] - Getting last prediction point for ticker: SRF
2025-05-19 23:22:31,541 - INFO - [__main__] - ==================================================
2025-05-19 23:22:31,542 - INFO - [__main__] - Preparing test data for SRF...
2025-05-19 23:22:31,597 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:31,598 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:31,599 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:31,630 - INFO - [src.data_preparation] - Ticker SRF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:31,630 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(318), np.int64(1): np.int64(321)}
2025-05-19 23:22:32,085 - INFO - [src.data_preparation] - Ticker SRF - Selected features:
2025-05-19 23:22:32,085 - INFO - [src.data_preparation] -   vnipc_t: 0.0731
2025-05-19 23:22:32,085 - INFO - [src.data_preparation] -   SK: 0.0692
2025-05-19 23:22:32,085 - INFO - [src.data_preparation] -   s_d7_t: 0.0677
2025-05-19 23:22:32,085 - INFO - [src.data_preparation] -   insec_t: 0.0630
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   Volatility: 0.0627
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   ret: 0.0616
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   TVV: 0.0615
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   SR: 0.0615
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   ATR: 0.0591
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   variation_t: 0.0567
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   LO: 0.0566
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   PM: 0.0495
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   ma21_t: 0.0495
2025-05-19 23:22:32,086 - INFO - [src.data_preparation] -   ma7_t: 0.0493
2025-05-19 23:22:32,090 - INFO - [src.data_preparation] - Ticker SRF - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'insec_t', 'Volatility', 'ret', 'TVV', 'SR', 'ATR', 'variation_t', 'LO', 'HL', 'PM', 'ma21_t', 'ma7_t']
2025-05-19 23:22:32,185 - INFO - [src.data_preparation] - Ticker SRF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:32,185 - INFO - [src.data_preparation] - Ticker SRF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:32,187 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SRF
2025-05-19 23:22:32,188 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:32,188 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:22:32,188 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:22:32,189 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:22:32,189 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:22:32,192 - INFO - [src.data_preparation] - Ticker SRF - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:32,192 - INFO - [__main__] - Using best model for SRF: logistic_regression (F1: 0.5385)
2025-05-19 23:22:32,192 - INFO - [__main__] - Loading logistic_regression model for SRF...
2025-05-19 23:22:32,193 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:32,193 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:32,193 - INFO - [__main__] - Making predictions for SRF using logistic_regression
2025-05-19 23:22:32,194 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:32,194 - INFO - [__main__] - Successfully got last prediction for SRF
2025-05-19 23:22:32,194 - INFO - [__main__] - 
Processing ticker: SSC
2025-05-19 23:22:32,194 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:32,194 - INFO - [__main__] - Getting last prediction point for ticker: SSC
2025-05-19 23:22:32,194 - INFO - [__main__] - ==================================================
2025-05-19 23:22:32,194 - INFO - [__main__] - Preparing test data for SSC...
2025-05-19 23:22:32,251 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:32,251 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:32,251 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:32,272 - INFO - [src.data_preparation] - Ticker SSC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:32,272 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(350)}
2025-05-19 23:22:32,650 - INFO - [src.data_preparation] - Ticker SSC - Selected features:
2025-05-19 23:22:32,650 - INFO - [src.data_preparation] -   TVV: 0.0816
2025-05-19 23:22:32,650 - INFO - [src.data_preparation] -   insec_t: 0.0720
2025-05-19 23:22:32,650 - INFO - [src.data_preparation] -   SK: 0.0684
2025-05-19 23:22:32,650 - INFO - [src.data_preparation] -   vnipc_t: 0.0679
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   LO: 0.0631
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   Volatility: 0.0606
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   SR: 0.0586
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   s_d7_t: 0.0584
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   ret: 0.0569
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   ma21_t: 0.0556
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   HL: 0.0542
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   ma14_t: 0.0513
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:22:32,651 - INFO - [src.data_preparation] -   Median_HL: 0.0496
2025-05-19 23:22:32,655 - INFO - [src.data_preparation] - Ticker SSC - Using features: ['Date', 'TVV', 'insec_t', 'SK', 'vnipc_t', 'LO', 'Volatility', 'SR', 's_d7_t', 'ATR', 'ret', 'ma21_t', 'HL', 'ma14_t', 'variation_t', 'Median_HL']
2025-05-19 23:22:32,766 - INFO - [src.data_preparation] - Ticker SSC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:32,766 - INFO - [src.data_preparation] - Ticker SSC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:32,768 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SSC
2025-05-19 23:22:32,768 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:22:32,768 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(223), np.int64(1): np.int64(239)}
2025-05-19 23:22:32,768 - INFO - [src.data_preparation] - Generating 16 synthetic minority samples
2025-05-19 23:22:32,770 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:22:32,770 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:22:32,773 - INFO - [src.data_preparation] - Ticker SSC - Final 3D shapes: X_train=(478, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:32,774 - INFO - [__main__] - Using best model for SSC: transformer (F1: 0.7463)
2025-05-19 23:22:32,774 - INFO - [__main__] - Loading transformer model for SSC...
2025-05-19 23:22:32,790 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:32,798 - INFO - [__main__] - Model size: 0.25 MB
2025-05-19 23:22:32,798 - INFO - [__main__] - Making predictions for SSC using transformer
2025-05-19 23:22:32,799 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:32,799 - INFO - [__main__] - Successfully got last prediction for SSC
2025-05-19 23:22:32,799 - INFO - [__main__] - 
Processing ticker: SSF
2025-05-19 23:22:32,799 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:32,799 - INFO - [__main__] - Getting last prediction point for ticker: SSF
2025-05-19 23:22:32,799 - INFO - [__main__] - ==================================================
2025-05-19 23:22:32,799 - INFO - [__main__] - Preparing test data for SSF...
2025-05-19 23:22:32,864 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:32,864 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:32,865 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:32,892 - INFO - [src.data_preparation] - Ticker SSF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:32,893 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(54), np.int64(1): np.int64(585)}
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] - Ticker SSF - Selected features:
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   vnipc_t: 0.1525
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   TVV: 0.1150
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   ma21_t: 0.0865
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   ma7_t: 0.0700
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   ma14_t: 0.0682
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   ATR: 0.0554
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   Volatility: 0.0536
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   SR: 0.0506
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   Median_HL: 0.0489
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   SK: 0.0456
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   PM: 0.0426
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   insec_t: 0.0402
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   HL: 0.0355
2025-05-19 23:22:33,178 - INFO - [src.data_preparation] -   ret: 0.0326
2025-05-19 23:22:33,182 - INFO - [src.data_preparation] - Ticker SSF - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'ma7_t', 'ma14_t', 's_d7_t', 'ATR', 'Volatility', 'SR', 'Median_HL', 'SK', 'PM', 'insec_t', 'HL', 'ret']
2025-05-19 23:22:33,283 - INFO - [src.data_preparation] - Ticker SSF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:33,283 - INFO - [src.data_preparation] - Ticker SSF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:33,285 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SSF
2025-05-19 23:22:33,285 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:33,285 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(47), np.int64(1): np.int64(416)}
2025-05-19 23:22:33,285 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:33,289 - INFO - [src.data_preparation] - Ticker SSF - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:33,290 - INFO - [__main__] - Using best model for SSF: lstm (F1: 0.9885)
2025-05-19 23:22:33,290 - INFO - [__main__] - Loading lstm model for SSF...
2025-05-19 23:22:33,294 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:33,295 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:22:33,295 - INFO - [__main__] - Making predictions for SSF using lstm
2025-05-19 23:22:33,302 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:22:33,302 - INFO - [__main__] - Successfully got last prediction for SSF
2025-05-19 23:22:33,302 - INFO - [__main__] - 
Processing ticker: SSG
2025-05-19 23:22:33,302 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:33,302 - INFO - [__main__] - Getting last prediction point for ticker: SSG
2025-05-19 23:22:33,302 - INFO - [__main__] - ==================================================
2025-05-19 23:22:33,302 - INFO - [__main__] - Preparing test data for SSG...
2025-05-19 23:22:33,353 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:22:33,353 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:33,353 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:33,383 - INFO - [src.data_preparation] - Ticker SSG - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:22:33,384 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(134), np.int64(1): np.int64(503)}
2025-05-19 23:22:33,657 - INFO - [src.data_preparation] - Ticker SSG - Selected features:
2025-05-19 23:22:33,657 - INFO - [src.data_preparation] -   vnipc_t: 0.0844
2025-05-19 23:22:33,657 - INFO - [src.data_preparation] -   ATR: 0.0762
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   PM: 0.0721
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   ma14_t: 0.0687
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   TVV: 0.0680
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   Median_HL: 0.0676
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   ma7_t: 0.0653
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   ma21_t: 0.0652
2025-05-19 23:22:33,658 - INFO - [src.data_preparation] -   Volatility: 0.0649
2025-05-19 23:22:33,659 - INFO - [src.data_preparation] -   HL: 0.0632
2025-05-19 23:22:33,659 - INFO - [src.data_preparation] -   s_d7_t: 0.0562
2025-05-19 23:22:33,659 - INFO - [src.data_preparation] -   SK: 0.0494
2025-05-19 23:22:33,659 - INFO - [src.data_preparation] -   insec_t: 0.0482
2025-05-19 23:22:33,659 - INFO - [src.data_preparation] -   LO: 0.0396
2025-05-19 23:22:33,660 - INFO - [src.data_preparation] -   variation_t: 0.0344
2025-05-19 23:22:33,662 - INFO - [src.data_preparation] - Ticker SSG - Using features: ['Date', 'vnipc_t', 'ATR', 'PM', 'ma14_t', 'TVV', 'Median_HL', 'ma7_t', 'ma21_t', 'Volatility', 'HL', 's_d7_t', 'SK', 'insec_t', 'LO', 'variation_t']
2025-05-19 23:22:33,776 - INFO - [src.data_preparation] - Ticker SSG - 2D shapes: X_train=(461, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:33,776 - INFO - [src.data_preparation] - Ticker SSG - 3D shapes: X_train=(461, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:33,777 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SSG
2025-05-19 23:22:33,778 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (461, 13, 15), y shape: (461,)
2025-05-19 23:22:33,778 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(70), np.int64(1): np.int64(391)}
2025-05-19 23:22:33,778 - INFO - [src.data_preparation] - Generating 321 synthetic minority samples
2025-05-19 23:22:33,796 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (782, 13, 15), y shape: (782,)
2025-05-19 23:22:33,796 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(391), np.int64(1): np.int64(391)}
2025-05-19 23:22:33,809 - INFO - [src.data_preparation] - Ticker SSG - Final 3D shapes: X_train=(782, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:33,810 - INFO - [__main__] - Using best model for SSG: svm (F1: 0.7429)
2025-05-19 23:22:33,810 - INFO - [__main__] - Loading svm model for SSG...
2025-05-19 23:22:33,812 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:33,813 - INFO - [__main__] - Model size: 0.46 MB
2025-05-19 23:22:33,813 - INFO - [__main__] - Making predictions for SSG using svm
2025-05-19 23:22:33,814 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:33,814 - INFO - [__main__] - Successfully got last prediction for SSG
2025-05-19 23:22:33,814 - INFO - [__main__] - 
Processing ticker: SSI
2025-05-19 23:22:33,814 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:33,814 - INFO - [__main__] - Getting last prediction point for ticker: SSI
2025-05-19 23:22:33,814 - INFO - [__main__] - ==================================================
2025-05-19 23:22:33,814 - INFO - [__main__] - Preparing test data for SSI...
2025-05-19 23:22:33,888 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:33,889 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:33,889 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:33,922 - INFO - [src.data_preparation] - Ticker SSI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:33,922 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(361)}
2025-05-19 23:22:34,422 - INFO - [src.data_preparation] - Ticker SSI - Selected features:
2025-05-19 23:22:34,422 - INFO - [src.data_preparation] -   insec_t: 0.0711
2025-05-19 23:22:34,422 - INFO - [src.data_preparation] -   Volatility: 0.0693
2025-05-19 23:22:34,422 - INFO - [src.data_preparation] -   SK: 0.0663
2025-05-19 23:22:34,423 - INFO - [src.data_preparation] -   ma21_t: 0.0628
2025-05-19 23:22:34,423 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:22:34,423 - INFO - [src.data_preparation] -   ATR: 0.0614
2025-05-19 23:22:34,423 - INFO - [src.data_preparation] -   ret: 0.0612
2025-05-19 23:22:34,423 - INFO - [src.data_preparation] -   vnipc_t: 0.0607
2025-05-19 23:22:34,423 - INFO - [src.data_preparation] -   HL: 0.0600
2025-05-19 23:22:34,424 - INFO - [src.data_preparation] -   s_d7_t: 0.0571
2025-05-19 23:22:34,424 - INFO - [src.data_preparation] -   ma7_t: 0.0556
2025-05-19 23:22:34,424 - INFO - [src.data_preparation] -   variation_t: 0.0544
2025-05-19 23:22:34,424 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:22:34,424 - INFO - [src.data_preparation] -   Median_HL: 0.0519
2025-05-19 23:22:34,424 - INFO - [src.data_preparation] -   ma14_t: 0.0518
2025-05-19 23:22:34,430 - INFO - [src.data_preparation] - Ticker SSI - Using features: ['Date', 'insec_t', 'Volatility', 'SK', 'ma21_t', 'TVV', 'ATR', 'ret', 'vnipc_t', 'HL', 's_d7_t', 'ma7_t', 'variation_t', 'PM', 'Median_HL', 'ma14_t']
2025-05-19 23:22:34,542 - INFO - [src.data_preparation] - Ticker SSI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:34,543 - INFO - [src.data_preparation] - Ticker SSI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:34,545 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SSI
2025-05-19 23:22:34,545 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:34,545 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(192), np.int64(1): np.int64(271)}
2025-05-19 23:22:34,545 - INFO - [src.data_preparation] - Generating 79 synthetic minority samples
2025-05-19 23:22:34,549 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (542, 13, 15), y shape: (542,)
2025-05-19 23:22:34,549 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(271), np.int64(1): np.int64(271)}
2025-05-19 23:22:34,554 - INFO - [src.data_preparation] - Ticker SSI - Final 3D shapes: X_train=(542, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:34,555 - INFO - [__main__] - Using best model for SSI: lstm (F1: 0.0000)
2025-05-19 23:22:34,555 - INFO - [__main__] - Loading lstm model for SSI...
2025-05-19 23:22:34,559 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:34,560 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:22:34,560 - INFO - [__main__] - Making predictions for SSI using lstm
2025-05-19 23:22:34,561 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:34,561 - INFO - [__main__] - Successfully got last prediction for SSI
2025-05-19 23:22:34,562 - INFO - [__main__] - 
Processing ticker: SSM
2025-05-19 23:22:34,562 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:34,562 - INFO - [__main__] - Getting last prediction point for ticker: SSM
2025-05-19 23:22:34,562 - INFO - [__main__] - ==================================================
2025-05-19 23:22:34,562 - INFO - [__main__] - Preparing test data for SSM...
2025-05-19 23:22:34,628 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:34,628 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:34,629 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:34,657 - INFO - [src.data_preparation] - Ticker SSM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:34,658 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(206), np.int64(1): np.int64(433)}
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] - Ticker SSM - Selected features:
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   ATR: 0.0747
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   SK: 0.0734
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   TVV: 0.0715
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   vnipc_t: 0.0671
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   s_d7_t: 0.0660
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   Volatility: 0.0652
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   PM: 0.0633
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   Median_HL: 0.0626
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   ma7_t: 0.0607
2025-05-19 23:22:35,040 - INFO - [src.data_preparation] -   ma21_t: 0.0605
2025-05-19 23:22:35,041 - INFO - [src.data_preparation] -   ma14_t: 0.0600
2025-05-19 23:22:35,041 - INFO - [src.data_preparation] -   insec_t: 0.0538
2025-05-19 23:22:35,041 - INFO - [src.data_preparation] -   ret: 0.0458
2025-05-19 23:22:35,041 - INFO - [src.data_preparation] -   HL: 0.0458
2025-05-19 23:22:35,041 - INFO - [src.data_preparation] -   variation_t: 0.0444
2025-05-19 23:22:35,043 - INFO - [src.data_preparation] - Ticker SSM - Using features: ['Date', 'ATR', 'SK', 'TVV', 'vnipc_t', 's_d7_t', 'Volatility', 'PM', 'Median_HL', 'ma7_t', 'ma21_t', 'ma14_t', 'insec_t', 'ret', 'HL', 'variation_t']
2025-05-19 23:22:35,146 - INFO - [src.data_preparation] - Ticker SSM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:35,146 - INFO - [src.data_preparation] - Ticker SSM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:35,148 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SSM
2025-05-19 23:22:35,148 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:35,148 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(149), np.int64(1): np.int64(314)}
2025-05-19 23:22:35,148 - INFO - [src.data_preparation] - Generating 165 synthetic minority samples
2025-05-19 23:22:35,158 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (628, 13, 15), y shape: (628,)
2025-05-19 23:22:35,158 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(314), np.int64(1): np.int64(314)}
2025-05-19 23:22:35,162 - INFO - [src.data_preparation] - Ticker SSM - Final 3D shapes: X_train=(628, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:35,162 - INFO - [__main__] - Using best model for SSM: lstm (F1: 0.7778)
2025-05-19 23:22:35,162 - INFO - [__main__] - Loading lstm model for SSM...
2025-05-19 23:22:35,167 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:35,168 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:22:35,169 - INFO - [__main__] - Making predictions for SSM using lstm
2025-05-19 23:22:35,170 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:35,171 - INFO - [__main__] - Successfully got last prediction for SSM
2025-05-19 23:22:35,171 - INFO - [__main__] - 
Processing ticker: ST8
2025-05-19 23:22:35,171 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:35,171 - INFO - [__main__] - Getting last prediction point for ticker: ST8
2025-05-19 23:22:35,172 - INFO - [__main__] - ==================================================
2025-05-19 23:22:35,172 - INFO - [__main__] - Preparing test data for ST8...
2025-05-19 23:22:35,239 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:35,239 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:35,240 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:35,280 - INFO - [src.data_preparation] - Ticker ST8 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:35,280 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(308), np.int64(1): np.int64(331)}
2025-05-19 23:22:35,825 - INFO - [src.data_preparation] - Ticker ST8 - Selected features:
2025-05-19 23:22:35,825 - INFO - [src.data_preparation] -   insec_t: 0.0821
2025-05-19 23:22:35,825 - INFO - [src.data_preparation] -   vnipc_t: 0.0710
2025-05-19 23:22:35,825 - INFO - [src.data_preparation] -   TVV: 0.0709
2025-05-19 23:22:35,825 - INFO - [src.data_preparation] -   ATR: 0.0648
2025-05-19 23:22:35,825 - INFO - [src.data_preparation] -   SR: 0.0609
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   ma21_t: 0.0595
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   SK: 0.0589
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   s_d7_t: 0.0588
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   Volatility: 0.0578
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   HL: 0.0555
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   ma14_t: 0.0550
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   LO: 0.0535
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   variation_t: 0.0509
2025-05-19 23:22:35,826 - INFO - [src.data_preparation] -   ma7_t: 0.0502
2025-05-19 23:22:35,829 - INFO - [src.data_preparation] - Ticker ST8 - Using features: ['Date', 'insec_t', 'vnipc_t', 'TVV', 'ATR', 'SR', 'ma21_t', 'SK', 's_d7_t', 'Volatility', 'HL', 'ma14_t', 'LO', 'ret', 'variation_t', 'ma7_t']
2025-05-19 23:22:35,955 - INFO - [src.data_preparation] - Ticker ST8 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:35,955 - INFO - [src.data_preparation] - Ticker ST8 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:35,959 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker ST8
2025-05-19 23:22:35,959 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:35,959 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(259)}
2025-05-19 23:22:35,959 - INFO - [src.data_preparation] - Generating 55 synthetic minority samples
2025-05-19 23:22:35,967 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:22:35,967 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:22:35,975 - INFO - [src.data_preparation] - Ticker ST8 - Final 3D shapes: X_train=(518, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:35,975 - INFO - [__main__] - Using best model for ST8: lstm (F1: 0.0000)
2025-05-19 23:22:35,976 - INFO - [__main__] - Loading lstm model for ST8...
2025-05-19 23:22:35,982 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:35,983 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:22:35,983 - INFO - [__main__] - Making predictions for ST8 using lstm
2025-05-19 23:22:35,989 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:22:35,989 - INFO - [__main__] - Successfully got last prediction for ST8
2025-05-19 23:22:35,989 - INFO - [__main__] - 
Processing ticker: STB
2025-05-19 23:22:35,989 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:35,990 - INFO - [__main__] - Getting last prediction point for ticker: STB
2025-05-19 23:22:35,990 - INFO - [__main__] - ==================================================
2025-05-19 23:22:35,990 - INFO - [__main__] - Preparing test data for STB...
2025-05-19 23:22:36,059 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:36,060 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:36,060 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:36,099 - INFO - [src.data_preparation] - Ticker STB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:36,100 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(310), np.int64(1): np.int64(329)}
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] - Ticker STB - Selected features:
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   vnipc_t: 0.0704
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   Volatility: 0.0698
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   insec_t: 0.0678
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   TVV: 0.0651
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   SK: 0.0644
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   ret: 0.0601
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   PM: 0.0582
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   ATR: 0.0569
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   Median_HL: 0.0569
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   HL: 0.0563
2025-05-19 23:22:36,475 - INFO - [src.data_preparation] -   ma21_t: 0.0558
2025-05-19 23:22:36,477 - INFO - [src.data_preparation] -   ma7_t: 0.0555
2025-05-19 23:22:36,477 - INFO - [src.data_preparation] -   ma14_t: 0.0536
2025-05-19 23:22:36,477 - INFO - [src.data_preparation] -   LO: 0.0500
2025-05-19 23:22:36,480 - INFO - [src.data_preparation] - Ticker STB - Using features: ['Date', 'vnipc_t', 'Volatility', 'insec_t', 'TVV', 'SK', 's_d7_t', 'ret', 'PM', 'ATR', 'Median_HL', 'HL', 'ma21_t', 'ma7_t', 'ma14_t', 'LO']
2025-05-19 23:22:36,594 - INFO - [src.data_preparation] - Ticker STB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:36,594 - INFO - [src.data_preparation] - Ticker STB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:36,596 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STB
2025-05-19 23:22:36,596 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:36,596 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(223), np.int64(1): np.int64(240)}
2025-05-19 23:22:36,596 - INFO - [src.data_preparation] - Generating 17 synthetic minority samples
2025-05-19 23:22:36,597 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (480, 13, 15), y shape: (480,)
2025-05-19 23:22:36,597 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(240), np.int64(1): np.int64(240)}
2025-05-19 23:22:36,601 - INFO - [src.data_preparation] - Ticker STB - Final 3D shapes: X_train=(480, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:36,602 - INFO - [__main__] - Using best model for STB: lstm (F1: 0.0000)
2025-05-19 23:22:36,602 - INFO - [__main__] - Loading lstm model for STB...
2025-05-19 23:22:36,607 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:36,609 - INFO - [__main__] - Model size: 0.32 MB
2025-05-19 23:22:36,609 - INFO - [__main__] - Making predictions for STB using lstm
2025-05-19 23:22:36,612 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:36,613 - INFO - [__main__] - Successfully got last prediction for STB
2025-05-19 23:22:36,613 - INFO - [__main__] - 
Processing ticker: STC
2025-05-19 23:22:36,613 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:36,613 - INFO - [__main__] - Getting last prediction point for ticker: STC
2025-05-19 23:22:36,613 - INFO - [__main__] - ==================================================
2025-05-19 23:22:36,613 - INFO - [__main__] - Preparing test data for STC...
2025-05-19 23:22:36,662 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:36,663 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:36,663 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:36,689 - INFO - [src.data_preparation] - Ticker STC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:36,690 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(238), np.int64(1): np.int64(401)}
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] - Ticker STC - Selected features:
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   SK: 0.0813
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   vnipc_t: 0.0714
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   TVV: 0.0662
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   Volatility: 0.0607
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   ATR: 0.0597
2025-05-19 23:22:37,114 - INFO - [src.data_preparation] -   HL: 0.0588
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   ma7_t: 0.0586
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   variation_t: 0.0570
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   ma14_t: 0.0562
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   SR: 0.0561
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   LO: 0.0547
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   ma21_t: 0.0524
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:22:37,115 - INFO - [src.data_preparation] -   insec_t: 0.0519
2025-05-19 23:22:37,118 - INFO - [src.data_preparation] - Ticker STC - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 's_d7_t', 'Volatility', 'ATR', 'HL', 'ma7_t', 'variation_t', 'ma14_t', 'SR', 'LO', 'ma21_t', 'ret', 'insec_t']
2025-05-19 23:22:37,219 - INFO - [src.data_preparation] - Ticker STC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:37,219 - INFO - [src.data_preparation] - Ticker STC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:37,222 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STC
2025-05-19 23:22:37,223 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:37,223 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(174), np.int64(1): np.int64(289)}
2025-05-19 23:22:37,223 - INFO - [src.data_preparation] - Generating 115 synthetic minority samples
2025-05-19 23:22:37,230 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (578, 13, 15), y shape: (578,)
2025-05-19 23:22:37,230 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(289), np.int64(1): np.int64(289)}
2025-05-19 23:22:37,233 - INFO - [src.data_preparation] - Ticker STC - Final 3D shapes: X_train=(578, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:37,234 - INFO - [__main__] - Using best model for STC: logistic_regression (F1: 0.8060)
2025-05-19 23:22:37,234 - INFO - [__main__] - Loading logistic_regression model for STC...
2025-05-19 23:22:37,234 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:37,235 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:37,235 - INFO - [__main__] - Making predictions for STC using logistic_regression
2025-05-19 23:22:37,236 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:37,236 - INFO - [__main__] - Successfully got last prediction for STC
2025-05-19 23:22:37,236 - INFO - [__main__] - 
Processing ticker: STG
2025-05-19 23:22:37,236 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:37,236 - INFO - [__main__] - Getting last prediction point for ticker: STG
2025-05-19 23:22:37,236 - INFO - [__main__] - ==================================================
2025-05-19 23:22:37,236 - INFO - [__main__] - Preparing test data for STG...
2025-05-19 23:22:37,268 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:37,269 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:37,269 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:37,292 - INFO - [src.data_preparation] - Ticker STG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:37,292 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:22:37,609 - INFO - [src.data_preparation] - Ticker STG - Selected features:
2025-05-19 23:22:37,609 - INFO - [src.data_preparation] -   SK: 0.0730
2025-05-19 23:22:37,609 - INFO - [src.data_preparation] -   ATR: 0.0702
2025-05-19 23:22:37,609 - INFO - [src.data_preparation] -   TVV: 0.0665
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   s_d7_t: 0.0660
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   vnipc_t: 0.0643
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   Volatility: 0.0636
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   insec_t: 0.0617
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   ret: 0.0585
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   HL: 0.0584
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   ma21_t: 0.0563
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   Median_HL: 0.0529
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   SR: 0.0521
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   PM: 0.0510
2025-05-19 23:22:37,610 - INFO - [src.data_preparation] -   ma14_t: 0.0509
2025-05-19 23:22:37,613 - INFO - [src.data_preparation] - Ticker STG - Using features: ['Date', 'SK', 'ATR', 'TVV', 's_d7_t', 'vnipc_t', 'Volatility', 'insec_t', 'ret', 'HL', 'ma21_t', 'variation_t', 'Median_HL', 'SR', 'PM', 'ma14_t']
2025-05-19 23:22:37,707 - INFO - [src.data_preparation] - Ticker STG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:37,708 - INFO - [src.data_preparation] - Ticker STG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:37,711 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STG
2025-05-19 23:22:37,711 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:37,711 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:22:37,711 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:22:37,715 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:22:37,715 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:22:37,722 - INFO - [src.data_preparation] - Ticker STG - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:37,723 - INFO - [__main__] - Using best model for STG: svm (F1: 0.6462)
2025-05-19 23:22:37,723 - INFO - [__main__] - Loading svm model for STG...
2025-05-19 23:22:37,725 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:37,726 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:22:37,726 - INFO - [__main__] - Making predictions for STG using svm
2025-05-19 23:22:37,727 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:37,728 - INFO - [__main__] - Successfully got last prediction for STG
2025-05-19 23:22:37,728 - INFO - [__main__] - 
Processing ticker: STL
2025-05-19 23:22:37,728 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:37,728 - INFO - [__main__] - Getting last prediction point for ticker: STL
2025-05-19 23:22:37,728 - INFO - [__main__] - ==================================================
2025-05-19 23:22:37,728 - INFO - [__main__] - Preparing test data for STL...
2025-05-19 23:22:37,761 - INFO - [src.data_preparation] - After processing - X shape: (624, 19), y shape: (624,)
2025-05-19 23:22:37,761 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:37,761 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:37,784 - INFO - [src.data_preparation] - Ticker STL - Original shapes: X=(624, 18), y=(624,)
2025-05-19 23:22:37,784 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(204), np.int64(1): np.int64(420)}
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] - Ticker STL - Selected features:
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   vnipc_t: 0.0858
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   ma21_t: 0.0755
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   TVV: 0.0742
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   ma7_t: 0.0731
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   ma14_t: 0.0709
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   SK: 0.0680
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   s_d7_t: 0.0620
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   ATR: 0.0610
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   Volatility: 0.0593
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   insec_t: 0.0591
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   Median_HL: 0.0535
2025-05-19 23:22:38,044 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:22:38,045 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:22:38,045 - INFO - [src.data_preparation] -   SR: 0.0438
2025-05-19 23:22:38,045 - INFO - [src.data_preparation] -   variation_t: 0.0424
2025-05-19 23:22:38,047 - INFO - [src.data_preparation] - Ticker STL - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ma7_t', 'ma14_t', 'SK', 's_d7_t', 'ATR', 'Volatility', 'insec_t', 'Median_HL', 'PM', 'ret', 'SR', 'variation_t']
2025-05-19 23:22:38,145 - INFO - [src.data_preparation] - Ticker STL - 2D shapes: X_train=(448, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:38,146 - INFO - [src.data_preparation] - Ticker STL - 3D shapes: X_train=(448, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:38,148 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STL
2025-05-19 23:22:38,148 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (448, 13, 15), y shape: (448,)
2025-05-19 23:22:38,148 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(160), np.int64(1): np.int64(288)}
2025-05-19 23:22:38,148 - INFO - [src.data_preparation] - Generating 128 synthetic minority samples
2025-05-19 23:22:38,154 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (576, 13, 15), y shape: (576,)
2025-05-19 23:22:38,154 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(288), np.int64(1): np.int64(288)}
2025-05-19 23:22:38,159 - INFO - [src.data_preparation] - Ticker STL - Final 3D shapes: X_train=(576, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:38,159 - INFO - [__main__] - Using best model for STL: lstm (F1: 0.9885)
2025-05-19 23:22:38,159 - INFO - [__main__] - Loading lstm model for STL...
2025-05-19 23:22:38,163 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:38,165 - INFO - [__main__] - Model size: 0.19 MB
2025-05-19 23:22:38,165 - INFO - [__main__] - Making predictions for STL using lstm
2025-05-19 23:22:38,169 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:38,169 - INFO - [__main__] - Successfully got last prediction for STL
2025-05-19 23:22:38,170 - INFO - [__main__] - 
Processing ticker: STP
2025-05-19 23:22:38,170 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:38,170 - INFO - [__main__] - Getting last prediction point for ticker: STP
2025-05-19 23:22:38,170 - INFO - [__main__] - ==================================================
2025-05-19 23:22:38,170 - INFO - [__main__] - Preparing test data for STP...
2025-05-19 23:22:38,219 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:38,219 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:38,219 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:38,255 - INFO - [src.data_preparation] - Ticker STP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:38,255 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(238), np.int64(1): np.int64(401)}
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] - Ticker STP - Selected features:
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   Volatility: 0.0767
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   s_d7_t: 0.0689
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   ATR: 0.0668
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   TVV: 0.0667
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   insec_t: 0.0663
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   SK: 0.0661
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   HL: 0.0555
2025-05-19 23:22:38,750 - INFO - [src.data_preparation] -   ma14_t: 0.0543
2025-05-19 23:22:38,751 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:22:38,751 - INFO - [src.data_preparation] -   variation_t: 0.0537
2025-05-19 23:22:38,751 - INFO - [src.data_preparation] -   ma21_t: 0.0536
2025-05-19 23:22:38,751 - INFO - [src.data_preparation] -   Median_HL: 0.0536
2025-05-19 23:22:38,751 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:22:38,751 - INFO - [src.data_preparation] -   PM: 0.0487
2025-05-19 23:22:38,755 - INFO - [src.data_preparation] - Ticker STP - Using features: ['Date', 'Volatility', 'vnipc_t', 's_d7_t', 'ATR', 'TVV', 'insec_t', 'SK', 'HL', 'ma14_t', 'ma7_t', 'variation_t', 'ma21_t', 'Median_HL', 'ret', 'PM']
2025-05-19 23:22:38,878 - INFO - [src.data_preparation] - Ticker STP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:38,878 - INFO - [src.data_preparation] - Ticker STP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:38,880 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STP
2025-05-19 23:22:38,880 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:38,880 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(169), np.int64(1): np.int64(294)}
2025-05-19 23:22:38,880 - INFO - [src.data_preparation] - Generating 125 synthetic minority samples
2025-05-19 23:22:38,885 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (588, 13, 15), y shape: (588,)
2025-05-19 23:22:38,885 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(294), np.int64(1): np.int64(294)}
2025-05-19 23:22:38,889 - INFO - [src.data_preparation] - Ticker STP - Final 3D shapes: X_train=(588, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:38,890 - INFO - [__main__] - Using best model for STP: svm (F1: 0.7606)
2025-05-19 23:22:38,890 - INFO - [__main__] - Loading svm model for STP...
2025-05-19 23:22:38,893 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:38,894 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:22:38,894 - INFO - [__main__] - Making predictions for STP using svm
2025-05-19 23:22:38,895 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:38,895 - INFO - [__main__] - Successfully got last prediction for STP
2025-05-19 23:22:38,895 - INFO - [__main__] - 
Processing ticker: STS
2025-05-19 23:22:38,896 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:38,896 - INFO - [__main__] - Getting last prediction point for ticker: STS
2025-05-19 23:22:38,896 - INFO - [__main__] - ==================================================
2025-05-19 23:22:38,896 - INFO - [__main__] - Preparing test data for STS...
2025-05-19 23:22:38,933 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:38,934 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:38,934 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:38,959 - INFO - [src.data_preparation] - Ticker STS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:38,959 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(50), np.int64(1): np.int64(589)}
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] - Ticker STS - Selected features:
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] -   vnipc_t: 0.1715
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] -   ma21_t: 0.0969
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] -   TVV: 0.0842
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] -   ATR: 0.0659
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:22:39,188 - INFO - [src.data_preparation] -   ma14_t: 0.0656
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   s_d7_t: 0.0596
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   PM: 0.0588
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   ma7_t: 0.0548
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   Median_HL: 0.0490
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   SK: 0.0434
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   SR: 0.0373
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   insec_t: 0.0347
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   ret: 0.0323
2025-05-19 23:22:39,189 - INFO - [src.data_preparation] -   variation_t: 0.0306
2025-05-19 23:22:39,192 - INFO - [src.data_preparation] - Ticker STS - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ATR', 'Volatility', 'ma14_t', 's_d7_t', 'PM', 'ma7_t', 'Median_HL', 'SK', 'SR', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:22:39,287 - INFO - [src.data_preparation] - Ticker STS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:39,287 - INFO - [src.data_preparation] - Ticker STS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:39,290 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STS
2025-05-19 23:22:39,290 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:39,290 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(47), np.int64(1): np.int64(416)}
2025-05-19 23:22:39,290 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:39,294 - INFO - [src.data_preparation] - Ticker STS - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:39,295 - INFO - [__main__] - Using best model for STS: lstm (F1: 0.9885)
2025-05-19 23:22:39,295 - INFO - [__main__] - Loading lstm model for STS...
2025-05-19 23:22:39,299 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:39,301 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:22:39,301 - INFO - [__main__] - Making predictions for STS using lstm
2025-05-19 23:22:39,303 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:39,303 - INFO - [__main__] - Successfully got last prediction for STS
2025-05-19 23:22:39,303 - INFO - [__main__] - 
Processing ticker: STT
2025-05-19 23:22:39,303 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:39,303 - INFO - [__main__] - Getting last prediction point for ticker: STT
2025-05-19 23:22:39,304 - INFO - [__main__] - ==================================================
2025-05-19 23:22:39,304 - INFO - [__main__] - Preparing test data for STT...
2025-05-19 23:22:39,360 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:39,360 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:39,361 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:39,396 - INFO - [src.data_preparation] - Ticker STT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:39,397 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(225), np.int64(1): np.int64(414)}
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] - Ticker STT - Selected features:
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   vnipc_t: 0.0888
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   ma14_t: 0.0758
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   ma21_t: 0.0688
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   SK: 0.0663
2025-05-19 23:22:39,716 - INFO - [src.data_preparation] -   ma7_t: 0.0656
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   s_d7_t: 0.0656
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   insec_t: 0.0631
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   PM: 0.0549
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   Median_HL: 0.0522
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   ATR: 0.0491
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   ret: 0.0467
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   variation_t: 0.0463
2025-05-19 23:22:39,717 - INFO - [src.data_preparation] -   HL: 0.0400
2025-05-19 23:22:39,720 - INFO - [src.data_preparation] - Ticker STT - Using features: ['Date', 'vnipc_t', 'ma14_t', 'Volatility', 'ma21_t', 'TVV', 'SK', 'ma7_t', 's_d7_t', 'insec_t', 'PM', 'Median_HL', 'ATR', 'ret', 'variation_t', 'HL']
2025-05-19 23:22:39,818 - INFO - [src.data_preparation] - Ticker STT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:39,819 - INFO - [src.data_preparation] - Ticker STT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:39,822 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker STT
2025-05-19 23:22:39,822 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:39,822 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(157), np.int64(1): np.int64(306)}
2025-05-19 23:22:39,822 - INFO - [src.data_preparation] - Generating 149 synthetic minority samples
2025-05-19 23:22:39,827 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (612, 13, 15), y shape: (612,)
2025-05-19 23:22:39,827 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(306), np.int64(1): np.int64(306)}
2025-05-19 23:22:39,830 - INFO - [src.data_preparation] - Ticker STT - Final 3D shapes: X_train=(612, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:39,831 - INFO - [__main__] - Using best model for STT: svm (F1: 0.8267)
2025-05-19 23:22:39,831 - INFO - [__main__] - Loading svm model for STT...
2025-05-19 23:22:39,832 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:39,833 - INFO - [__main__] - Model size: 0.92 MB
2025-05-19 23:22:39,833 - INFO - [__main__] - Making predictions for STT using svm
2025-05-19 23:22:39,834 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:39,834 - INFO - [__main__] - Successfully got last prediction for STT
2025-05-19 23:22:39,834 - INFO - [__main__] - 
Processing ticker: SVC
2025-05-19 23:22:39,834 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:39,834 - INFO - [__main__] - Getting last prediction point for ticker: SVC
2025-05-19 23:22:39,834 - INFO - [__main__] - ==================================================
2025-05-19 23:22:39,834 - INFO - [__main__] - Preparing test data for SVC...
2025-05-19 23:22:39,875 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:39,875 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:39,875 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:39,895 - INFO - [src.data_preparation] - Ticker SVC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:39,895 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(295), np.int64(1): np.int64(344)}
2025-05-19 23:22:40,234 - INFO - [src.data_preparation] - Ticker SVC - Selected features:
2025-05-19 23:22:40,234 - INFO - [src.data_preparation] -   s_d7_t: 0.0705
2025-05-19 23:22:40,234 - INFO - [src.data_preparation] -   HL: 0.0679
2025-05-19 23:22:40,234 - INFO - [src.data_preparation] -   SK: 0.0664
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   ATR: 0.0651
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   TVV: 0.0640
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   Volatility: 0.0622
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   vnipc_t: 0.0620
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   SR: 0.0563
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   ret: 0.0563
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   variation_t: 0.0562
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   PM: 0.0538
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   LO: 0.0532
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   ma14_t: 0.0526
2025-05-19 23:22:40,235 - INFO - [src.data_preparation] -   Median_HL: 0.0519
2025-05-19 23:22:40,240 - INFO - [src.data_preparation] - Ticker SVC - Using features: ['Date', 's_d7_t', 'HL', 'SK', 'ATR', 'insec_t', 'TVV', 'Volatility', 'vnipc_t', 'SR', 'ret', 'variation_t', 'PM', 'LO', 'ma14_t', 'Median_HL']
2025-05-19 23:22:40,337 - INFO - [src.data_preparation] - Ticker SVC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:40,338 - INFO - [src.data_preparation] - Ticker SVC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:40,341 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SVC
2025-05-19 23:22:40,341 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:40,341 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:22:40,341 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:22:40,343 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:22:40,343 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:22:40,346 - INFO - [src.data_preparation] - Ticker SVC - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:40,346 - INFO - [__main__] - Using best model for SVC: logistic_regression (F1: 0.3448)
2025-05-19 23:22:40,346 - INFO - [__main__] - Loading logistic_regression model for SVC...
2025-05-19 23:22:40,347 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:40,347 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:40,347 - INFO - [__main__] - Making predictions for SVC using logistic_regression
2025-05-19 23:22:40,348 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:40,348 - INFO - [__main__] - Successfully got last prediction for SVC
2025-05-19 23:22:40,348 - INFO - [__main__] - 
Processing ticker: SVI
2025-05-19 23:22:40,348 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:40,348 - INFO - [__main__] - Getting last prediction point for ticker: SVI
2025-05-19 23:22:40,348 - INFO - [__main__] - ==================================================
2025-05-19 23:22:40,348 - INFO - [__main__] - Preparing test data for SVI...
2025-05-19 23:22:40,377 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:40,377 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:40,377 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:40,398 - INFO - [src.data_preparation] - Ticker SVI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:40,398 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:22:40,809 - INFO - [src.data_preparation] - Ticker SVI - Selected features:
2025-05-19 23:22:40,809 - INFO - [src.data_preparation] -   vnipc_t: 0.0755
2025-05-19 23:22:40,809 - INFO - [src.data_preparation] -   TVV: 0.0723
2025-05-19 23:22:40,809 - INFO - [src.data_preparation] -   insec_t: 0.0712
2025-05-19 23:22:40,809 - INFO - [src.data_preparation] -   ATR: 0.0697
2025-05-19 23:22:40,809 - INFO - [src.data_preparation] -   SK: 0.0673
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   Volatility: 0.0662
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   s_d7_t: 0.0602
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   ret: 0.0591
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   variation_t: 0.0552
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   HL: 0.0535
2025-05-19 23:22:40,810 - INFO - [src.data_preparation] -   ma14_t: 0.0534
2025-05-19 23:22:40,811 - INFO - [src.data_preparation] -   Median_HL: 0.0518
2025-05-19 23:22:40,811 - INFO - [src.data_preparation] -   ma7_t: 0.0480
2025-05-19 23:22:40,811 - INFO - [src.data_preparation] -   ma21_t: 0.0476
2025-05-19 23:22:40,814 - INFO - [src.data_preparation] - Ticker SVI - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ATR', 'SK', 'Volatility', 's_d7_t', 'ret', 'variation_t', 'SR', 'HL', 'ma14_t', 'Median_HL', 'ma7_t', 'ma21_t']
2025-05-19 23:22:40,927 - INFO - [src.data_preparation] - Ticker SVI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:40,928 - INFO - [src.data_preparation] - Ticker SVI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:40,929 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SVI
2025-05-19 23:22:40,929 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:40,929 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:22:40,929 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:22:40,932 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:22:40,932 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:22:40,935 - INFO - [src.data_preparation] - Ticker SVI - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:40,936 - INFO - [__main__] - Using best model for SVI: svm (F1: 0.8421)
2025-05-19 23:22:40,936 - INFO - [__main__] - Loading svm model for SVI...
2025-05-19 23:22:40,937 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:40,938 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:22:40,938 - INFO - [__main__] - Making predictions for SVI using svm
2025-05-19 23:22:40,940 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:40,940 - INFO - [__main__] - Successfully got last prediction for SVI
2025-05-19 23:22:40,940 - INFO - [__main__] - 
Processing ticker: SVN
2025-05-19 23:22:40,940 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:40,940 - INFO - [__main__] - Getting last prediction point for ticker: SVN
2025-05-19 23:22:40,941 - INFO - [__main__] - ==================================================
2025-05-19 23:22:40,941 - INFO - [__main__] - Preparing test data for SVN...
2025-05-19 23:22:40,969 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:40,969 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:40,971 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:40,995 - INFO - [src.data_preparation] - Ticker SVN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:40,996 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(242), np.int64(1): np.int64(397)}
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] - Ticker SVN - Selected features:
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   TVV: 0.0817
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   vnipc_t: 0.0780
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   insec_t: 0.0724
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   Volatility: 0.0662
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   s_d7_t: 0.0647
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   ma14_t: 0.0624
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   ATR: 0.0624
2025-05-19 23:22:41,323 - INFO - [src.data_preparation] -   ma7_t: 0.0619
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   ma21_t: 0.0614
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   SK: 0.0604
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   HL: 0.0572
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   variation_t: 0.0512
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   PM: 0.0468
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   ret: 0.0463
2025-05-19 23:22:41,324 - INFO - [src.data_preparation] -   Median_HL: 0.0460
2025-05-19 23:22:41,328 - INFO - [src.data_preparation] - Ticker SVN - Using features: ['Date', 'TVV', 'vnipc_t', 'insec_t', 'Volatility', 's_d7_t', 'ma14_t', 'ATR', 'ma7_t', 'ma21_t', 'SK', 'HL', 'variation_t', 'PM', 'ret', 'Median_HL']
2025-05-19 23:22:41,428 - INFO - [src.data_preparation] - Ticker SVN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:41,428 - INFO - [src.data_preparation] - Ticker SVN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:41,432 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SVN
2025-05-19 23:22:41,432 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:41,432 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(160), np.int64(1): np.int64(303)}
2025-05-19 23:22:41,432 - INFO - [src.data_preparation] - Generating 143 synthetic minority samples
2025-05-19 23:22:41,439 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (606, 13, 15), y shape: (606,)
2025-05-19 23:22:41,439 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(303), np.int64(1): np.int64(303)}
2025-05-19 23:22:41,442 - INFO - [src.data_preparation] - Ticker SVN - Final 3D shapes: X_train=(606, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:41,443 - INFO - [__main__] - Using best model for SVN: svm (F1: 0.6441)
2025-05-19 23:22:41,443 - INFO - [__main__] - Loading svm model for SVN...
2025-05-19 23:22:41,444 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:41,444 - INFO - [__main__] - Model size: 0.62 MB
2025-05-19 23:22:41,445 - INFO - [__main__] - Making predictions for SVN using svm
2025-05-19 23:22:41,445 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:41,445 - INFO - [__main__] - Successfully got last prediction for SVN
2025-05-19 23:22:41,446 - INFO - [__main__] - 
Processing ticker: SVT
2025-05-19 23:22:41,446 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:41,446 - INFO - [__main__] - Getting last prediction point for ticker: SVT
2025-05-19 23:22:41,446 - INFO - [__main__] - ==================================================
2025-05-19 23:22:41,446 - INFO - [__main__] - Preparing test data for SVT...
2025-05-19 23:22:41,481 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:41,481 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:41,481 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:41,502 - INFO - [src.data_preparation] - Ticker SVT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:41,502 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:22:41,819 - INFO - [src.data_preparation] - Ticker SVT - Selected features:
2025-05-19 23:22:41,819 - INFO - [src.data_preparation] -   SK: 0.0682
2025-05-19 23:22:41,819 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:22:41,819 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:22:41,819 - INFO - [src.data_preparation] -   s_d7_t: 0.0673
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   ATR: 0.0663
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   insec_t: 0.0640
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   ma21_t: 0.0606
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   ma7_t: 0.0568
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   variation_t: 0.0528
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   SR: 0.0527
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   PM: 0.0522
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   Median_HL: 0.0511
2025-05-19 23:22:41,820 - INFO - [src.data_preparation] -   HL: 0.0504
2025-05-19 23:22:41,824 - INFO - [src.data_preparation] - Ticker SVT - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 's_d7_t', 'ATR', 'insec_t', 'Volatility', 'ma21_t', 'ma7_t', 'ma14_t', 'variation_t', 'SR', 'PM', 'Median_HL', 'HL']
2025-05-19 23:22:41,918 - INFO - [src.data_preparation] - Ticker SVT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:41,918 - INFO - [src.data_preparation] - Ticker SVT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:41,920 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SVT
2025-05-19 23:22:41,920 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:41,920 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(191), np.int64(1): np.int64(272)}
2025-05-19 23:22:41,920 - INFO - [src.data_preparation] - Generating 81 synthetic minority samples
2025-05-19 23:22:41,924 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (544, 13, 15), y shape: (544,)
2025-05-19 23:22:41,924 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(272), np.int64(1): np.int64(272)}
2025-05-19 23:22:41,928 - INFO - [src.data_preparation] - Ticker SVT - Final 3D shapes: X_train=(544, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:41,928 - INFO - [__main__] - Using best model for SVT: transformer (F1: 0.1333)
2025-05-19 23:22:41,929 - INFO - [__main__] - Loading transformer model for SVT...
2025-05-19 23:22:41,944 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:41,949 - INFO - [__main__] - Model size: 0.16 MB
2025-05-19 23:22:41,949 - INFO - [__main__] - Making predictions for SVT using transformer
2025-05-19 23:22:41,951 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:41,952 - INFO - [__main__] - Successfully got last prediction for SVT
2025-05-19 23:22:41,952 - INFO - [__main__] - 
Processing ticker: SWC
2025-05-19 23:22:41,952 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:41,952 - INFO - [__main__] - Getting last prediction point for ticker: SWC
2025-05-19 23:22:41,952 - INFO - [__main__] - ==================================================
2025-05-19 23:22:41,953 - INFO - [__main__] - Preparing test data for SWC...
2025-05-19 23:22:41,999 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:41,999 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:41,999 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:42,034 - INFO - [src.data_preparation] - Ticker SWC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:42,035 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(257), np.int64(1): np.int64(382)}
2025-05-19 23:22:42,383 - INFO - [src.data_preparation] - Ticker SWC - Selected features:
2025-05-19 23:22:42,384 - INFO - [src.data_preparation] -   TVV: 0.0799
2025-05-19 23:22:42,384 - INFO - [src.data_preparation] -   ATR: 0.0741
2025-05-19 23:22:42,384 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:22:42,384 - INFO - [src.data_preparation] -   vnipc_t: 0.0670
2025-05-19 23:22:42,384 - INFO - [src.data_preparation] -   ret: 0.0640
2025-05-19 23:22:42,384 - INFO - [src.data_preparation] -   SK: 0.0626
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   s_d7_t: 0.0602
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   PM: 0.0593
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   variation_t: 0.0581
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   ma21_t: 0.0577
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   insec_t: 0.0550
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   ma14_t: 0.0525
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   HL: 0.0498
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   Median_HL: 0.0485
2025-05-19 23:22:42,385 - INFO - [src.data_preparation] -   SR: 0.0478
2025-05-19 23:22:42,388 - INFO - [src.data_preparation] - Ticker SWC - Using features: ['Date', 'TVV', 'ATR', 'Volatility', 'vnipc_t', 'ret', 'SK', 's_d7_t', 'PM', 'variation_t', 'ma21_t', 'insec_t', 'ma14_t', 'HL', 'Median_HL', 'SR']
2025-05-19 23:22:42,485 - INFO - [src.data_preparation] - Ticker SWC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:42,485 - INFO - [src.data_preparation] - Ticker SWC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:42,488 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SWC
2025-05-19 23:22:42,488 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:42,488 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(177), np.int64(1): np.int64(286)}
2025-05-19 23:22:42,489 - INFO - [src.data_preparation] - Generating 109 synthetic minority samples
2025-05-19 23:22:42,494 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (572, 13, 15), y shape: (572,)
2025-05-19 23:22:42,494 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(286), np.int64(1): np.int64(286)}
2025-05-19 23:22:42,498 - INFO - [src.data_preparation] - Ticker SWC - Final 3D shapes: X_train=(572, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:42,498 - INFO - [__main__] - Using best model for SWC: svm (F1: 0.6667)
2025-05-19 23:22:42,499 - INFO - [__main__] - Loading svm model for SWC...
2025-05-19 23:22:42,500 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:42,501 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:22:42,501 - INFO - [__main__] - Making predictions for SWC using svm
2025-05-19 23:22:42,502 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:42,502 - INFO - [__main__] - Successfully got last prediction for SWC
2025-05-19 23:22:42,502 - INFO - [__main__] - 
Processing ticker: SZL
2025-05-19 23:22:42,502 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:42,503 - INFO - [__main__] - Getting last prediction point for ticker: SZL
2025-05-19 23:22:42,503 - INFO - [__main__] - ==================================================
2025-05-19 23:22:42,503 - INFO - [__main__] - Preparing test data for SZL...
2025-05-19 23:22:42,544 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:42,544 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:42,544 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:42,562 - INFO - [src.data_preparation] - Ticker SZL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:42,563 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] - Ticker SZL - Selected features:
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   ATR: 0.0805
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   vnipc_t: 0.0723
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   SK: 0.0673
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   insec_t: 0.0635
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   Volatility: 0.0622
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   LO: 0.0581
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   SR: 0.0564
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   HL: 0.0560
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   ret: 0.0536
2025-05-19 23:22:42,921 - INFO - [src.data_preparation] -   variation_t: 0.0530
2025-05-19 23:22:42,922 - INFO - [src.data_preparation] -   ma14_t: 0.0520
2025-05-19 23:22:42,922 - INFO - [src.data_preparation] -   ma21_t: 0.0506
2025-05-19 23:22:42,922 - INFO - [src.data_preparation] -   PM: 0.0473
2025-05-19 23:22:42,925 - INFO - [src.data_preparation] - Ticker SZL - Using features: ['Date', 'ATR', 'vnipc_t', 'TVV', 'SK', 's_d7_t', 'insec_t', 'Volatility', 'LO', 'SR', 'HL', 'ret', 'variation_t', 'ma14_t', 'ma21_t', 'PM']
2025-05-19 23:22:43,031 - INFO - [src.data_preparation] - Ticker SZL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:43,031 - INFO - [src.data_preparation] - Ticker SZL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:43,033 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker SZL
2025-05-19 23:22:43,033 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:43,033 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:22:43,033 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:22:43,035 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:22:43,035 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:22:43,039 - INFO - [src.data_preparation] - Ticker SZL - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:43,039 - INFO - [__main__] - Using best model for SZL: logistic_regression (F1: 0.5000)
2025-05-19 23:22:43,039 - INFO - [__main__] - Loading logistic_regression model for SZL...
2025-05-19 23:22:43,041 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:43,041 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:43,041 - INFO - [__main__] - Making predictions for SZL using logistic_regression
2025-05-19 23:22:43,041 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:43,042 - INFO - [__main__] - Successfully got last prediction for SZL
2025-05-19 23:22:43,042 - INFO - [__main__] - 
Processing ticker: TBC
2025-05-19 23:22:43,042 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:43,042 - INFO - [__main__] - Getting last prediction point for ticker: TBC
2025-05-19 23:22:43,043 - INFO - [__main__] - ==================================================
2025-05-19 23:22:43,043 - INFO - [__main__] - Preparing test data for TBC...
2025-05-19 23:22:43,080 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:43,080 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:43,080 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:43,099 - INFO - [src.data_preparation] - Ticker TBC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:43,099 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(238), np.int64(1): np.int64(401)}
2025-05-19 23:22:43,420 - INFO - [src.data_preparation] - Ticker TBC - Selected features:
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   vnipc_t: 0.0735
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   Volatility: 0.0683
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   SK: 0.0668
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   ret: 0.0662
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   insec_t: 0.0657
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   variation_t: 0.0650
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   s_d7_t: 0.0645
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   TVV: 0.0635
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   HL: 0.0622
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   SR: 0.0620
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   ATR: 0.0579
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   LO: 0.0542
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   PM: 0.0495
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   ma21_t: 0.0490
2025-05-19 23:22:43,421 - INFO - [src.data_preparation] -   ma14_t: 0.0454
2025-05-19 23:22:43,425 - INFO - [src.data_preparation] - Ticker TBC - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'ret', 'insec_t', 'variation_t', 's_d7_t', 'TVV', 'HL', 'SR', 'ATR', 'LO', 'PM', 'ma21_t', 'ma14_t']
2025-05-19 23:22:43,533 - INFO - [src.data_preparation] - Ticker TBC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:43,533 - INFO - [src.data_preparation] - Ticker TBC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:43,536 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TBC
2025-05-19 23:22:43,536 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:43,536 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:22:43,536 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:22:43,545 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:22:43,545 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:22:43,549 - INFO - [src.data_preparation] - Ticker TBC - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:43,550 - INFO - [__main__] - Using best model for TBC: lstm (F1: 0.6866)
2025-05-19 23:22:43,550 - INFO - [__main__] - Loading lstm model for TBC...
2025-05-19 23:22:43,554 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:43,556 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:22:43,556 - INFO - [__main__] - Making predictions for TBC using lstm
2025-05-19 23:22:43,560 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:43,561 - INFO - [__main__] - Successfully got last prediction for TBC
2025-05-19 23:22:43,561 - INFO - [__main__] - 
Processing ticker: TBT
2025-05-19 23:22:43,561 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:43,561 - INFO - [__main__] - Getting last prediction point for ticker: TBT
2025-05-19 23:22:43,561 - INFO - [__main__] - ==================================================
2025-05-19 23:22:43,561 - INFO - [__main__] - Preparing test data for TBT...
2025-05-19 23:22:43,623 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:43,623 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:43,623 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:43,654 - INFO - [src.data_preparation] - Ticker TBT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:43,655 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(79), np.int64(1): np.int64(560)}
2025-05-19 23:22:43,907 - INFO - [src.data_preparation] - Ticker TBT - Selected features:
2025-05-19 23:22:43,907 - INFO - [src.data_preparation] -   vnipc_t: 0.1498
2025-05-19 23:22:43,907 - INFO - [src.data_preparation] -   ma21_t: 0.0944
2025-05-19 23:22:43,907 - INFO - [src.data_preparation] -   TVV: 0.0881
2025-05-19 23:22:43,907 - INFO - [src.data_preparation] -   ret: 0.0782
2025-05-19 23:22:43,907 - INFO - [src.data_preparation] -   variation_t: 0.0709
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   ma14_t: 0.0634
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   Volatility: 0.0590
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   SR: 0.0585
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   ma7_t: 0.0529
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   s_d7_t: 0.0472
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   Median_HL: 0.0457
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   PM: 0.0428
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   SK: 0.0412
2025-05-19 23:22:43,908 - INFO - [src.data_preparation] -   ATR: 0.0399
2025-05-19 23:22:43,909 - INFO - [src.data_preparation] -   HL: 0.0287
2025-05-19 23:22:43,911 - INFO - [src.data_preparation] - Ticker TBT - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ret', 'variation_t', 'ma14_t', 'Volatility', 'SR', 'ma7_t', 's_d7_t', 'Median_HL', 'PM', 'SK', 'ATR', 'HL']
2025-05-19 23:22:44,005 - INFO - [src.data_preparation] - Ticker TBT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:44,005 - INFO - [src.data_preparation] - Ticker TBT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:44,007 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TBT
2025-05-19 23:22:44,007 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:44,008 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(59), np.int64(1): np.int64(404)}
2025-05-19 23:22:44,008 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:44,014 - INFO - [src.data_preparation] - Ticker TBT - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:44,014 - INFO - [__main__] - Using best model for TBT: lstm (F1: 0.9885)
2025-05-19 23:22:44,014 - INFO - [__main__] - Loading lstm model for TBT...
2025-05-19 23:22:44,018 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:44,019 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:22:44,019 - INFO - [__main__] - Making predictions for TBT using lstm
2025-05-19 23:22:44,022 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:44,022 - INFO - [__main__] - Successfully got last prediction for TBT
2025-05-19 23:22:44,022 - INFO - [__main__] - 
Processing ticker: TBX
2025-05-19 23:22:44,022 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:44,022 - INFO - [__main__] - Getting last prediction point for ticker: TBX
2025-05-19 23:22:44,022 - INFO - [__main__] - ==================================================
2025-05-19 23:22:44,022 - INFO - [__main__] - Preparing test data for TBX...
2025-05-19 23:22:44,079 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:44,079 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:44,080 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:44,106 - INFO - [src.data_preparation] - Ticker TBX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:44,107 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(35), np.int64(1): np.int64(604)}
2025-05-19 23:22:44,312 - INFO - [src.data_preparation] - Ticker TBX - Selected features:
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   vnipc_t: 0.1727
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   ma21_t: 0.1068
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   ma14_t: 0.0760
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   TVV: 0.0711
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   s_d7_t: 0.0709
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   Median_HL: 0.0602
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   ATR: 0.0595
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   Volatility: 0.0582
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   ma7_t: 0.0561
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   PM: 0.0549
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   insec_t: 0.0511
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   SK: 0.0430
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   SR: 0.0304
2025-05-19 23:22:44,313 - INFO - [src.data_preparation] -   ret: 0.0287
2025-05-19 23:22:44,314 - INFO - [src.data_preparation] -   HL: 0.0273
2025-05-19 23:22:44,316 - INFO - [src.data_preparation] - Ticker TBX - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'TVV', 's_d7_t', 'Median_HL', 'ATR', 'Volatility', 'ma7_t', 'PM', 'insec_t', 'SK', 'SR', 'ret', 'HL']
2025-05-19 23:22:44,409 - INFO - [src.data_preparation] - Ticker TBX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:44,409 - INFO - [src.data_preparation] - Ticker TBX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:44,411 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TBX
2025-05-19 23:22:44,411 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:44,411 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(30), np.int64(1): np.int64(433)}
2025-05-19 23:22:44,411 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:44,414 - INFO - [src.data_preparation] - Ticker TBX - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:44,415 - INFO - [__main__] - Using best model for TBX: lstm (F1: 0.9767)
2025-05-19 23:22:44,415 - INFO - [__main__] - Loading lstm model for TBX...
2025-05-19 23:22:44,419 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:44,421 - INFO - [__main__] - Model size: 0.41 MB
2025-05-19 23:22:44,421 - INFO - [__main__] - Making predictions for TBX using lstm
2025-05-19 23:22:44,426 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:44,427 - INFO - [__main__] - Successfully got last prediction for TBX
2025-05-19 23:22:44,427 - INFO - [__main__] - 
Processing ticker: TCL
2025-05-19 23:22:44,427 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:44,427 - INFO - [__main__] - Getting last prediction point for ticker: TCL
2025-05-19 23:22:44,427 - INFO - [__main__] - ==================================================
2025-05-19 23:22:44,427 - INFO - [__main__] - Preparing test data for TCL...
2025-05-19 23:22:44,479 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:44,480 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:44,480 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:44,500 - INFO - [src.data_preparation] - Ticker TCL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:44,500 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] - Ticker TCL - Selected features:
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   vnipc_t: 0.0746
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   insec_t: 0.0713
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   SK: 0.0674
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   Volatility: 0.0668
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   HL: 0.0588
2025-05-19 23:22:44,859 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   LO: 0.0582
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   variation_t: 0.0574
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   ret: 0.0567
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   ma7_t: 0.0523
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   SR: 0.0519
2025-05-19 23:22:44,860 - INFO - [src.data_preparation] -   ma14_t: 0.0496
2025-05-19 23:22:44,862 - INFO - [src.data_preparation] - Ticker TCL - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 's_d7_t', 'TVV', 'HL', 'ATR', 'LO', 'variation_t', 'ret', 'PM', 'ma7_t', 'SR', 'ma14_t']
2025-05-19 23:22:44,952 - INFO - [src.data_preparation] - Ticker TCL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:44,952 - INFO - [src.data_preparation] - Ticker TCL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:44,953 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TCL
2025-05-19 23:22:44,954 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:44,954 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:22:44,954 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:22:44,955 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:22:44,955 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:22:44,960 - INFO - [src.data_preparation] - Ticker TCL - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:44,961 - INFO - [__main__] - Using best model for TCL: transformer (F1: 0.4762)
2025-05-19 23:22:44,961 - INFO - [__main__] - Loading transformer model for TCL...
2025-05-19 23:22:44,977 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:44,980 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:22:44,980 - INFO - [__main__] - Making predictions for TCL using transformer
2025-05-19 23:22:44,981 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:44,982 - INFO - [__main__] - Successfully got last prediction for TCL
2025-05-19 23:22:44,982 - INFO - [__main__] - 
Processing ticker: TCM
2025-05-19 23:22:44,982 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:44,982 - INFO - [__main__] - Getting last prediction point for ticker: TCM
2025-05-19 23:22:44,982 - INFO - [__main__] - ==================================================
2025-05-19 23:22:44,982 - INFO - [__main__] - Preparing test data for TCM...
2025-05-19 23:22:45,035 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:45,035 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:45,035 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:45,059 - INFO - [src.data_preparation] - Ticker TCM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:45,059 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(308), np.int64(1): np.int64(331)}
2025-05-19 23:22:45,442 - INFO - [src.data_preparation] - Ticker TCM - Selected features:
2025-05-19 23:22:45,442 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:22:45,443 - INFO - [src.data_preparation] -   insec_t: 0.0677
2025-05-19 23:22:45,443 - INFO - [src.data_preparation] -   TVV: 0.0643
2025-05-19 23:22:45,443 - INFO - [src.data_preparation] -   ma21_t: 0.0640
2025-05-19 23:22:45,443 - INFO - [src.data_preparation] -   Volatility: 0.0611
2025-05-19 23:22:45,443 - INFO - [src.data_preparation] -   ma14_t: 0.0607
2025-05-19 23:22:45,443 - INFO - [src.data_preparation] -   PM: 0.0599
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   SR: 0.0598
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   s_d7_t: 0.0592
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   SK: 0.0578
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   ma7_t: 0.0553
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   ret: 0.0547
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   Median_HL: 0.0543
2025-05-19 23:22:45,444 - INFO - [src.data_preparation] -   variation_t: 0.0536
2025-05-19 23:22:45,447 - INFO - [src.data_preparation] - Ticker TCM - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'ma21_t', 'Volatility', 'ma14_t', 'PM', 'SR', 's_d7_t', 'ATR', 'SK', 'ma7_t', 'ret', 'Median_HL', 'variation_t']
2025-05-19 23:22:45,536 - INFO - [src.data_preparation] - Ticker TCM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:45,536 - INFO - [src.data_preparation] - Ticker TCM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:45,538 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TCM
2025-05-19 23:22:45,538 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:45,538 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:22:45,538 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:22:45,540 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:22:45,540 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:22:45,544 - INFO - [src.data_preparation] - Ticker TCM - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:45,544 - INFO - [__main__] - Using best model for TCM: lstm (F1: 0.4828)
2025-05-19 23:22:45,544 - INFO - [__main__] - Loading lstm model for TCM...
2025-05-19 23:22:45,549 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:45,549 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:22:45,549 - INFO - [__main__] - Making predictions for TCM using lstm
2025-05-19 23:22:45,549 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:45,549 - INFO - [__main__] - Successfully got last prediction for TCM
2025-05-19 23:22:45,549 - INFO - [__main__] - 
Processing ticker: TCO
2025-05-19 23:22:45,549 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:45,549 - INFO - [__main__] - Getting last prediction point for ticker: TCO
2025-05-19 23:22:45,549 - INFO - [__main__] - ==================================================
2025-05-19 23:22:45,549 - INFO - [__main__] - Preparing test data for TCO...
2025-05-19 23:22:45,583 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:45,584 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:45,584 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:45,608 - INFO - [src.data_preparation] - Ticker TCO - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:45,608 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:22:46,016 - INFO - [src.data_preparation] - Ticker TCO - Selected features:
2025-05-19 23:22:46,016 - INFO - [src.data_preparation] -   ATR: 0.0700
2025-05-19 23:22:46,016 - INFO - [src.data_preparation] -   SK: 0.0694
2025-05-19 23:22:46,016 - INFO - [src.data_preparation] -   vnipc_t: 0.0689
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   TVV: 0.0631
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   insec_t: 0.0614
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   PM: 0.0597
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   Median_HL: 0.0577
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   Volatility: 0.0564
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   ma14_t: 0.0556
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   variation_t: 0.0542
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   ret: 0.0537
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   ma21_t: 0.0537
2025-05-19 23:22:46,017 - INFO - [src.data_preparation] -   ma7_t: 0.0511
2025-05-19 23:22:46,019 - INFO - [src.data_preparation] - Ticker TCO - Using features: ['Date', 'ATR', 'SK', 'vnipc_t', 's_d7_t', 'TVV', 'insec_t', 'PM', 'Median_HL', 'Volatility', 'ma14_t', 'HL', 'variation_t', 'ret', 'ma21_t', 'ma7_t']
2025-05-19 23:22:46,108 - INFO - [src.data_preparation] - Ticker TCO - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:46,108 - INFO - [src.data_preparation] - Ticker TCO - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:46,111 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TCO
2025-05-19 23:22:46,112 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:46,112 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(194), np.int64(1): np.int64(269)}
2025-05-19 23:22:46,112 - INFO - [src.data_preparation] - Generating 75 synthetic minority samples
2025-05-19 23:22:46,119 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (538, 13, 15), y shape: (538,)
2025-05-19 23:22:46,119 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(269), np.int64(1): np.int64(269)}
2025-05-19 23:22:46,124 - INFO - [src.data_preparation] - Ticker TCO - Final 3D shapes: X_train=(538, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:46,124 - INFO - [__main__] - Using best model for TCO: logistic_regression (F1: 0.4242)
2025-05-19 23:22:46,124 - INFO - [__main__] - Loading logistic_regression model for TCO...
2025-05-19 23:22:46,125 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:46,125 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:46,125 - INFO - [__main__] - Making predictions for TCO using logistic_regression
2025-05-19 23:22:46,126 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:46,126 - INFO - [__main__] - Successfully got last prediction for TCO
2025-05-19 23:22:46,127 - INFO - [__main__] - 
Processing ticker: TCR
2025-05-19 23:22:46,127 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:46,127 - INFO - [__main__] - Getting last prediction point for ticker: TCR
2025-05-19 23:22:46,127 - INFO - [__main__] - ==================================================
2025-05-19 23:22:46,127 - INFO - [__main__] - Preparing test data for TCR...
2025-05-19 23:22:46,163 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:46,163 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:46,163 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:46,183 - INFO - [src.data_preparation] - Ticker TCR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:46,184 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] - Ticker TCR - Selected features:
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   vnipc_t: 0.0771
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   s_d7_t: 0.0702
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   insec_t: 0.0651
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   SK: 0.0650
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   Volatility: 0.0638
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   TVV: 0.0595
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   ma21_t: 0.0579
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   LO: 0.0577
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   ATR: 0.0562
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   SR: 0.0556
2025-05-19 23:22:46,494 - INFO - [src.data_preparation] -   ma14_t: 0.0542
2025-05-19 23:22:46,495 - INFO - [src.data_preparation] -   variation_t: 0.0517
2025-05-19 23:22:46,495 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:22:46,495 - INFO - [src.data_preparation] -   HL: 0.0491
2025-05-19 23:22:46,495 - INFO - [src.data_preparation] -   ma7_t: 0.0484
2025-05-19 23:22:46,497 - INFO - [src.data_preparation] - Ticker TCR - Using features: ['Date', 'vnipc_t', 's_d7_t', 'insec_t', 'SK', 'Volatility', 'TVV', 'ma21_t', 'LO', 'ATR', 'SR', 'ma14_t', 'variation_t', 'Median_HL', 'HL', 'ma7_t']
2025-05-19 23:22:46,590 - INFO - [src.data_preparation] - Ticker TCR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:46,590 - INFO - [src.data_preparation] - Ticker TCR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:46,592 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TCR
2025-05-19 23:22:46,592 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:46,592 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(191), np.int64(1): np.int64(272)}
2025-05-19 23:22:46,592 - INFO - [src.data_preparation] - Generating 81 synthetic minority samples
2025-05-19 23:22:46,597 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (544, 13, 15), y shape: (544,)
2025-05-19 23:22:46,597 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(272), np.int64(1): np.int64(272)}
2025-05-19 23:22:46,600 - INFO - [src.data_preparation] - Ticker TCR - Final 3D shapes: X_train=(544, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:46,601 - INFO - [__main__] - Using best model for TCR: transformer (F1: 0.5778)
2025-05-19 23:22:46,601 - INFO - [__main__] - Loading transformer model for TCR...
2025-05-19 23:22:46,611 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:46,614 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:22:46,614 - INFO - [__main__] - Making predictions for TCR using transformer
2025-05-19 23:22:46,615 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:46,616 - INFO - [__main__] - Successfully got last prediction for TCR
2025-05-19 23:22:46,616 - INFO - [__main__] - 
Processing ticker: TCT
2025-05-19 23:22:46,616 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:46,616 - INFO - [__main__] - Getting last prediction point for ticker: TCT
2025-05-19 23:22:46,616 - INFO - [__main__] - ==================================================
2025-05-19 23:22:46,616 - INFO - [__main__] - Preparing test data for TCT...
2025-05-19 23:22:46,663 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:22:46,663 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:46,663 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:46,688 - INFO - [src.data_preparation] - Ticker TCT - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:22:46,689 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(330), np.int64(1): np.int64(308)}
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] - Ticker TCT - Selected features:
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   SK: 0.0682
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   Volatility: 0.0660
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   insec_t: 0.0655
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   TVV: 0.0651
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   s_d7_t: 0.0649
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   vnipc_t: 0.0641
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   LO: 0.0617
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   HL: 0.0607
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   ATR: 0.0557
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   PM: 0.0544
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   SR: 0.0541
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   ma14_t: 0.0534
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   Median_HL: 0.0531
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   ma21_t: 0.0520
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:22:47,049 - INFO - [src.data_preparation] - Ticker TCT - Using features: ['Date', 'SK', 'Volatility', 'insec_t', 'TVV', 's_d7_t', 'vnipc_t', 'LO', 'HL', 'ATR', 'PM', 'SR', 'ma14_t', 'Median_HL', 'ma21_t', 'ret']
2025-05-19 23:22:47,142 - INFO - [src.data_preparation] - Ticker TCT - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:47,142 - INFO - [src.data_preparation] - Ticker TCT - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:47,144 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TCT
2025-05-19 23:22:47,144 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:22:47,144 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(227), np.int64(1): np.int64(235)}
2025-05-19 23:22:47,145 - INFO - [src.data_preparation] - Generating 8 synthetic minority samples
2025-05-19 23:22:47,146 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:22:47,146 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:22:47,149 - INFO - [src.data_preparation] - Ticker TCT - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:47,150 - INFO - [__main__] - Using best model for TCT: lstm (F1: 0.5574)
2025-05-19 23:22:47,150 - INFO - [__main__] - Loading lstm model for TCT...
2025-05-19 23:22:47,154 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:47,155 - INFO - [__main__] - Model size: 0.08 MB
2025-05-19 23:22:47,155 - INFO - [__main__] - Making predictions for TCT using lstm
2025-05-19 23:22:47,158 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:47,159 - INFO - [__main__] - Successfully got last prediction for TCT
2025-05-19 23:22:47,159 - INFO - [__main__] - 
Processing ticker: TDC
2025-05-19 23:22:47,159 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:47,159 - INFO - [__main__] - Getting last prediction point for ticker: TDC
2025-05-19 23:22:47,159 - INFO - [__main__] - ==================================================
2025-05-19 23:22:47,159 - INFO - [__main__] - Preparing test data for TDC...
2025-05-19 23:22:47,207 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:47,207 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:47,207 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:47,234 - INFO - [src.data_preparation] - Ticker TDC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:47,234 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(298), np.int64(1): np.int64(341)}
2025-05-19 23:22:47,597 - INFO - [src.data_preparation] - Ticker TDC - Selected features:
2025-05-19 23:22:47,598 - INFO - [src.data_preparation] -   vnipc_t: 0.0802
2025-05-19 23:22:47,598 - INFO - [src.data_preparation] -   insec_t: 0.0694
2025-05-19 23:22:47,598 - INFO - [src.data_preparation] -   SK: 0.0684
2025-05-19 23:22:47,598 - INFO - [src.data_preparation] -   Volatility: 0.0684
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   ma21_t: 0.0577
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   ret: 0.0569
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   ma14_t: 0.0567
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   PM: 0.0554
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   variation_t: 0.0544
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   TVV: 0.0528
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   HL: 0.0526
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   SR: 0.0525
2025-05-19 23:22:47,599 - INFO - [src.data_preparation] -   ATR: 0.0515
2025-05-19 23:22:47,604 - INFO - [src.data_preparation] - Ticker TDC - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 's_d7_t', 'ma21_t', 'ret', 'ma14_t', 'PM', 'variation_t', 'ma7_t', 'TVV', 'HL', 'SR', 'ATR']
2025-05-19 23:22:47,708 - INFO - [src.data_preparation] - Ticker TDC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:47,708 - INFO - [src.data_preparation] - Ticker TDC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:47,709 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TDC
2025-05-19 23:22:47,709 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:47,709 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:22:47,709 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:22:47,713 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:22:47,713 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:22:47,717 - INFO - [src.data_preparation] - Ticker TDC - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:47,718 - INFO - [__main__] - Using best model for TDC: transformer (F1: 0.5128)
2025-05-19 23:22:47,718 - INFO - [__main__] - Loading transformer model for TDC...
2025-05-19 23:22:47,734 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:47,739 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:22:47,739 - INFO - [__main__] - Making predictions for TDC using transformer
2025-05-19 23:22:47,741 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:47,741 - INFO - [__main__] - Successfully got last prediction for TDC
2025-05-19 23:22:47,741 - INFO - [__main__] - 
Processing ticker: TDH
2025-05-19 23:22:47,742 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:47,742 - INFO - [__main__] - Getting last prediction point for ticker: TDH
2025-05-19 23:22:47,742 - INFO - [__main__] - ==================================================
2025-05-19 23:22:47,742 - INFO - [__main__] - Preparing test data for TDH...
2025-05-19 23:22:47,804 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:47,804 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:47,804 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:47,837 - INFO - [src.data_preparation] - Ticker TDH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:47,837 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(339), np.int64(1): np.int64(300)}
2025-05-19 23:22:48,202 - INFO - [src.data_preparation] - Ticker TDH - Selected features:
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   SK: 0.0765
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   Volatility: 0.0689
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   s_d7_t: 0.0666
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   ATR: 0.0658
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   ma21_t: 0.0643
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   vnipc_t: 0.0635
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   insec_t: 0.0610
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   TVV: 0.0579
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   SR: 0.0554
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   PM: 0.0552
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   ma7_t: 0.0536
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   LO: 0.0535
2025-05-19 23:22:48,203 - INFO - [src.data_preparation] -   ma14_t: 0.0524
2025-05-19 23:22:48,204 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:22:48,204 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:22:48,206 - INFO - [src.data_preparation] - Ticker TDH - Using features: ['Date', 'SK', 'Volatility', 's_d7_t', 'ATR', 'ma21_t', 'vnipc_t', 'insec_t', 'TVV', 'SR', 'PM', 'ma7_t', 'LO', 'ma14_t', 'variation_t', 'ret']
2025-05-19 23:22:48,307 - INFO - [src.data_preparation] - Ticker TDH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:48,307 - INFO - [src.data_preparation] - Ticker TDH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:48,309 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TDH
2025-05-19 23:22:48,309 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:48,309 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(230), np.int64(1): np.int64(233)}
2025-05-19 23:22:48,309 - INFO - [src.data_preparation] - Generating 3 synthetic minority samples
2025-05-19 23:22:48,310 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (466, 13, 15), y shape: (466,)
2025-05-19 23:22:48,310 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(233), np.int64(1): np.int64(233)}
2025-05-19 23:22:48,313 - INFO - [src.data_preparation] - Ticker TDH - Final 3D shapes: X_train=(466, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:48,314 - INFO - [__main__] - Using best model for TDH: logistic_regression (F1: 0.4912)
2025-05-19 23:22:48,315 - INFO - [__main__] - Loading logistic_regression model for TDH...
2025-05-19 23:22:48,315 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:48,316 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:48,316 - INFO - [__main__] - Making predictions for TDH using logistic_regression
2025-05-19 23:22:48,316 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:48,316 - INFO - [__main__] - Successfully got last prediction for TDH
2025-05-19 23:22:48,316 - INFO - [__main__] - 
Processing ticker: TDS
2025-05-19 23:22:48,316 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:48,316 - INFO - [__main__] - Getting last prediction point for ticker: TDS
2025-05-19 23:22:48,316 - INFO - [__main__] - ==================================================
2025-05-19 23:22:48,317 - INFO - [__main__] - Preparing test data for TDS...
2025-05-19 23:22:48,355 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:48,355 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:48,355 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:48,378 - INFO - [src.data_preparation] - Ticker TDS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:48,378 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(242), np.int64(1): np.int64(397)}
2025-05-19 23:22:48,662 - INFO - [src.data_preparation] - Ticker TDS - Selected features:
2025-05-19 23:22:48,662 - INFO - [src.data_preparation] -   ma14_t: 0.0763
2025-05-19 23:22:48,662 - INFO - [src.data_preparation] -   ma21_t: 0.0741
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   ATR: 0.0721
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   vnipc_t: 0.0707
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   Median_HL: 0.0649
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   ma7_t: 0.0647
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   PM: 0.0643
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   TVV: 0.0643
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   s_d7_t: 0.0548
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   SK: 0.0537
2025-05-19 23:22:48,663 - INFO - [src.data_preparation] -   Volatility: 0.0533
2025-05-19 23:22:48,664 - INFO - [src.data_preparation] -   HL: 0.0501
2025-05-19 23:22:48,664 - INFO - [src.data_preparation] -   insec_t: 0.0489
2025-05-19 23:22:48,664 - INFO - [src.data_preparation] -   SR: 0.0472
2025-05-19 23:22:48,664 - INFO - [src.data_preparation] -   ret: 0.0471
2025-05-19 23:22:48,667 - INFO - [src.data_preparation] - Ticker TDS - Using features: ['Date', 'ma14_t', 'ma21_t', 'ATR', 'vnipc_t', 'Median_HL', 'ma7_t', 'PM', 'TVV', 's_d7_t', 'SK', 'Volatility', 'HL', 'insec_t', 'SR', 'ret']
2025-05-19 23:22:48,761 - INFO - [src.data_preparation] - Ticker TDS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:48,761 - INFO - [src.data_preparation] - Ticker TDS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:48,763 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TDS
2025-05-19 23:22:48,763 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:48,764 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(150), np.int64(1): np.int64(313)}
2025-05-19 23:22:48,764 - INFO - [src.data_preparation] - Generating 163 synthetic minority samples
2025-05-19 23:22:48,773 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (626, 13, 15), y shape: (626,)
2025-05-19 23:22:48,773 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(313), np.int64(1): np.int64(313)}
2025-05-19 23:22:48,777 - INFO - [src.data_preparation] - Ticker TDS - Final 3D shapes: X_train=(626, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:48,777 - INFO - [__main__] - Using best model for TDS: svm (F1: 0.2609)
2025-05-19 23:22:48,778 - INFO - [__main__] - Loading svm model for TDS...
2025-05-19 23:22:48,781 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:48,782 - INFO - [__main__] - Model size: 0.66 MB
2025-05-19 23:22:48,782 - INFO - [__main__] - Making predictions for TDS using svm
2025-05-19 23:22:48,783 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:48,783 - INFO - [__main__] - Successfully got last prediction for TDS
2025-05-19 23:22:48,783 - INFO - [__main__] - 
Processing ticker: TDW
2025-05-19 23:22:48,783 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:48,783 - INFO - [__main__] - Getting last prediction point for ticker: TDW
2025-05-19 23:22:48,783 - INFO - [__main__] - ==================================================
2025-05-19 23:22:48,784 - INFO - [__main__] - Preparing test data for TDW...
2025-05-19 23:22:48,823 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:48,823 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:48,823 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:48,843 - INFO - [src.data_preparation] - Ticker TDW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:48,843 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(233), np.int64(1): np.int64(406)}
2025-05-19 23:22:49,171 - INFO - [src.data_preparation] - Ticker TDW - Selected features:
2025-05-19 23:22:49,171 - INFO - [src.data_preparation] -   vnipc_t: 0.0722
2025-05-19 23:22:49,171 - INFO - [src.data_preparation] -   Volatility: 0.0706
2025-05-19 23:22:49,172 - INFO - [src.data_preparation] -   SR: 0.0660
2025-05-19 23:22:49,172 - INFO - [src.data_preparation] -   SK: 0.0643
2025-05-19 23:22:49,172 - INFO - [src.data_preparation] -   ATR: 0.0630
2025-05-19 23:22:49,172 - INFO - [src.data_preparation] -   s_d7_t: 0.0611
2025-05-19 23:22:49,172 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:22:49,172 - INFO - [src.data_preparation] -   ma14_t: 0.0586
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   ma7_t: 0.0585
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   HL: 0.0557
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   ret: 0.0551
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   Median_HL: 0.0545
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   PM: 0.0527
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   insec_t: 0.0524
2025-05-19 23:22:49,173 - INFO - [src.data_preparation] -   ma21_t: 0.0523
2025-05-19 23:22:49,179 - INFO - [src.data_preparation] - Ticker TDW - Using features: ['Date', 'vnipc_t', 'Volatility', 'SR', 'SK', 'ATR', 's_d7_t', 'TVV', 'ma14_t', 'ma7_t', 'HL', 'ret', 'Median_HL', 'PM', 'insec_t', 'ma21_t']
2025-05-19 23:22:49,285 - INFO - [src.data_preparation] - Ticker TDW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:49,285 - INFO - [src.data_preparation] - Ticker TDW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:49,287 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TDW
2025-05-19 23:22:49,287 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:49,287 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(187), np.int64(1): np.int64(276)}
2025-05-19 23:22:49,287 - INFO - [src.data_preparation] - Generating 89 synthetic minority samples
2025-05-19 23:22:49,292 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (552, 13, 15), y shape: (552,)
2025-05-19 23:22:49,292 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(276), np.int64(1): np.int64(276)}
2025-05-19 23:22:49,296 - INFO - [src.data_preparation] - Ticker TDW - Final 3D shapes: X_train=(552, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:49,296 - INFO - [__main__] - Using best model for TDW: svm (F1: 0.8571)
2025-05-19 23:22:49,296 - INFO - [__main__] - Loading svm model for TDW...
2025-05-19 23:22:49,298 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:49,299 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:22:49,299 - INFO - [__main__] - Making predictions for TDW using svm
2025-05-19 23:22:49,300 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:49,301 - INFO - [__main__] - Successfully got last prediction for TDW
2025-05-19 23:22:49,301 - INFO - [__main__] - 
Processing ticker: TET
2025-05-19 23:22:49,301 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:49,301 - INFO - [__main__] - Getting last prediction point for ticker: TET
2025-05-19 23:22:49,301 - INFO - [__main__] - ==================================================
2025-05-19 23:22:49,301 - INFO - [__main__] - Preparing test data for TET...
2025-05-19 23:22:49,352 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:49,352 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:49,352 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:49,374 - INFO - [src.data_preparation] - Ticker TET - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:49,374 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(64), np.int64(1): np.int64(575)}
2025-05-19 23:22:49,586 - INFO - [src.data_preparation] - Ticker TET - Selected features:
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   vnipc_t: 0.1325
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   ma14_t: 0.0934
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   ma21_t: 0.0884
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   TVV: 0.0859
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   ma7_t: 0.0729
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   ATR: 0.0668
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   s_d7_t: 0.0597
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   Median_HL: 0.0563
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   PM: 0.0563
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   SR: 0.0399
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   SK: 0.0362
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   HL: 0.0320
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   insec_t: 0.0304
2025-05-19 23:22:49,587 - INFO - [src.data_preparation] -   ret: 0.0293
2025-05-19 23:22:49,591 - INFO - [src.data_preparation] - Ticker TET - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'TVV', 'ma7_t', 'ATR', 'Volatility', 's_d7_t', 'Median_HL', 'PM', 'SR', 'SK', 'HL', 'insec_t', 'ret']
2025-05-19 23:22:49,680 - INFO - [src.data_preparation] - Ticker TET - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:49,680 - INFO - [src.data_preparation] - Ticker TET - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:49,682 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TET
2025-05-19 23:22:49,682 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:49,682 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(51), np.int64(1): np.int64(412)}
2025-05-19 23:22:49,683 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:49,686 - INFO - [src.data_preparation] - Ticker TET - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:49,687 - INFO - [__main__] - Using best model for TET: lstm (F1: 0.9647)
2025-05-19 23:22:49,687 - INFO - [__main__] - Loading lstm model for TET...
2025-05-19 23:22:49,691 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:49,692 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:22:49,692 - INFO - [__main__] - Making predictions for TET using lstm
2025-05-19 23:22:49,695 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:49,695 - INFO - [__main__] - Successfully got last prediction for TET
2025-05-19 23:22:49,696 - INFO - [__main__] - 
Processing ticker: TGP
2025-05-19 23:22:49,696 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:49,696 - INFO - [__main__] - Getting last prediction point for ticker: TGP
2025-05-19 23:22:49,696 - INFO - [__main__] - ==================================================
2025-05-19 23:22:49,696 - INFO - [__main__] - Preparing test data for TGP...
2025-05-19 23:22:49,733 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:49,733 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:49,733 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:49,749 - INFO - [src.data_preparation] - Ticker TGP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:49,749 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(202), np.int64(1): np.int64(437)}
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] - Ticker TGP - Selected features:
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   vnipc_t: 0.0916
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   TVV: 0.0829
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   SK: 0.0739
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   s_d7_t: 0.0705
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   Volatility: 0.0670
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   ma14_t: 0.0662
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   ma21_t: 0.0659
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   ma7_t: 0.0657
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   ATR: 0.0569
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   PM: 0.0551
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   insec_t: 0.0546
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   variation_t: 0.0463
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   ret: 0.0439
2025-05-19 23:22:50,136 - INFO - [src.data_preparation] -   SR: 0.0400
2025-05-19 23:22:50,140 - INFO - [src.data_preparation] - Ticker TGP - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 's_d7_t', 'Volatility', 'ma14_t', 'ma21_t', 'ma7_t', 'ATR', 'PM', 'insec_t', 'Median_HL', 'variation_t', 'ret', 'SR']
2025-05-19 23:22:50,237 - INFO - [src.data_preparation] - Ticker TGP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:50,237 - INFO - [src.data_preparation] - Ticker TGP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:50,239 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TGP
2025-05-19 23:22:50,239 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:50,239 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(151), np.int64(1): np.int64(312)}
2025-05-19 23:22:50,239 - INFO - [src.data_preparation] - Generating 161 synthetic minority samples
2025-05-19 23:22:50,247 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (624, 13, 15), y shape: (624,)
2025-05-19 23:22:50,247 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(312), np.int64(1): np.int64(312)}
2025-05-19 23:22:50,252 - INFO - [src.data_preparation] - Ticker TGP - Final 3D shapes: X_train=(624, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:50,252 - INFO - [__main__] - Using best model for TGP: svm (F1: 0.8267)
2025-05-19 23:22:50,252 - INFO - [__main__] - Loading svm model for TGP...
2025-05-19 23:22:50,254 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:50,255 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:22:50,255 - INFO - [__main__] - Making predictions for TGP using svm
2025-05-19 23:22:50,256 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:50,256 - INFO - [__main__] - Successfully got last prediction for TGP
2025-05-19 23:22:50,256 - INFO - [__main__] - 
Processing ticker: TH1
2025-05-19 23:22:50,256 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:50,256 - INFO - [__main__] - Getting last prediction point for ticker: TH1
2025-05-19 23:22:50,256 - INFO - [__main__] - ==================================================
2025-05-19 23:22:50,256 - INFO - [__main__] - Preparing test data for TH1...
2025-05-19 23:22:50,295 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:50,295 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:50,295 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:50,319 - INFO - [src.data_preparation] - Ticker TH1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:50,319 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(163), np.int64(1): np.int64(476)}
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] - Ticker TH1 - Selected features:
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   vnipc_t: 0.0900
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   ma14_t: 0.0872
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   ma21_t: 0.0813
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   s_d7_t: 0.0695
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   ma7_t: 0.0685
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   TVV: 0.0680
2025-05-19 23:22:50,627 - INFO - [src.data_preparation] -   Median_HL: 0.0669
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   PM: 0.0666
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   SK: 0.0600
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   Volatility: 0.0592
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   ATR: 0.0567
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   HL: 0.0428
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   insec_t: 0.0424
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   variation_t: 0.0401
2025-05-19 23:22:50,628 - INFO - [src.data_preparation] -   SR: 0.0340
2025-05-19 23:22:50,633 - INFO - [src.data_preparation] - Ticker TH1 - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 's_d7_t', 'ma7_t', 'TVV', 'Median_HL', 'PM', 'SK', 'Volatility', 'ATR', 'HL', 'insec_t', 'variation_t', 'SR']
2025-05-19 23:22:50,743 - INFO - [src.data_preparation] - Ticker TH1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:50,743 - INFO - [src.data_preparation] - Ticker TH1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:50,744 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TH1
2025-05-19 23:22:50,745 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:50,745 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(115), np.int64(1): np.int64(348)}
2025-05-19 23:22:50,745 - INFO - [src.data_preparation] - Generating 233 synthetic minority samples
2025-05-19 23:22:50,755 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (696, 13, 15), y shape: (696,)
2025-05-19 23:22:50,755 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(348), np.int64(1): np.int64(348)}
2025-05-19 23:22:50,759 - INFO - [src.data_preparation] - Ticker TH1 - Final 3D shapes: X_train=(696, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:50,759 - INFO - [__main__] - Using best model for TH1: logistic_regression (F1: 0.8800)
2025-05-19 23:22:50,759 - INFO - [__main__] - Loading logistic_regression model for TH1...
2025-05-19 23:22:50,761 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:50,761 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:50,761 - INFO - [__main__] - Making predictions for TH1 using logistic_regression
2025-05-19 23:22:50,762 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:50,762 - INFO - [__main__] - Successfully got last prediction for TH1
2025-05-19 23:22:50,762 - INFO - [__main__] - 
Processing ticker: THB
2025-05-19 23:22:50,762 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:50,762 - INFO - [__main__] - Getting last prediction point for ticker: THB
2025-05-19 23:22:50,762 - INFO - [__main__] - ==================================================
2025-05-19 23:22:50,762 - INFO - [__main__] - Preparing test data for THB...
2025-05-19 23:22:50,799 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:50,799 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:50,799 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:50,821 - INFO - [src.data_preparation] - Ticker THB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:50,821 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(218), np.int64(1): np.int64(421)}
2025-05-19 23:22:51,125 - INFO - [src.data_preparation] - Ticker THB - Selected features:
2025-05-19 23:22:51,125 - INFO - [src.data_preparation] -   s_d7_t: 0.0775
2025-05-19 23:22:51,125 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:22:51,125 - INFO - [src.data_preparation] -   TVV: 0.0724
2025-05-19 23:22:51,125 - INFO - [src.data_preparation] -   ATR: 0.0724
2025-05-19 23:22:51,125 - INFO - [src.data_preparation] -   SK: 0.0703
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   ma14_t: 0.0615
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   ma21_t: 0.0591
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   PM: 0.0579
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   Volatility: 0.0578
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   Median_HL: 0.0551
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   ma7_t: 0.0532
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   insec_t: 0.0501
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   SR: 0.0499
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   variation_t: 0.0479
2025-05-19 23:22:51,127 - INFO - [src.data_preparation] -   ret: 0.0472
2025-05-19 23:22:51,130 - INFO - [src.data_preparation] - Ticker THB - Using features: ['Date', 's_d7_t', 'vnipc_t', 'TVV', 'ATR', 'SK', 'ma14_t', 'ma21_t', 'PM', 'Volatility', 'Median_HL', 'ma7_t', 'insec_t', 'SR', 'variation_t', 'ret']
2025-05-19 23:22:51,219 - INFO - [src.data_preparation] - Ticker THB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:51,219 - INFO - [src.data_preparation] - Ticker THB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:51,221 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker THB
2025-05-19 23:22:51,221 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:51,221 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(168), np.int64(1): np.int64(295)}
2025-05-19 23:22:51,221 - INFO - [src.data_preparation] - Generating 127 synthetic minority samples
2025-05-19 23:22:51,228 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (590, 13, 15), y shape: (590,)
2025-05-19 23:22:51,228 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(295), np.int64(1): np.int64(295)}
2025-05-19 23:22:51,234 - INFO - [src.data_preparation] - Ticker THB - Final 3D shapes: X_train=(590, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:51,235 - INFO - [__main__] - Using best model for THB: svm (F1: 0.9136)
2025-05-19 23:22:51,235 - INFO - [__main__] - Loading svm model for THB...
2025-05-19 23:22:51,239 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:51,240 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:22:51,240 - INFO - [__main__] - Making predictions for THB using svm
2025-05-19 23:22:51,241 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:51,241 - INFO - [__main__] - Successfully got last prediction for THB
2025-05-19 23:22:51,241 - INFO - [__main__] - 
Processing ticker: THG
2025-05-19 23:22:51,241 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:51,241 - INFO - [__main__] - Getting last prediction point for ticker: THG
2025-05-19 23:22:51,242 - INFO - [__main__] - ==================================================
2025-05-19 23:22:51,242 - INFO - [__main__] - Preparing test data for THG...
2025-05-19 23:22:51,274 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:51,274 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:51,274 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:51,299 - INFO - [src.data_preparation] - Ticker THG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:51,300 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(269), np.int64(1): np.int64(370)}
2025-05-19 23:22:51,613 - INFO - [src.data_preparation] - Ticker THG - Selected features:
2025-05-19 23:22:51,613 - INFO - [src.data_preparation] -   insec_t: 0.0708
2025-05-19 23:22:51,613 - INFO - [src.data_preparation] -   vnipc_t: 0.0708
2025-05-19 23:22:51,613 - INFO - [src.data_preparation] -   TVV: 0.0673
2025-05-19 23:22:51,614 - INFO - [src.data_preparation] -   SK: 0.0662
2025-05-19 23:22:51,614 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:22:51,614 - INFO - [src.data_preparation] -   Volatility: 0.0639
2025-05-19 23:22:51,614 - INFO - [src.data_preparation] -   LO: 0.0636
2025-05-19 23:22:51,614 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   ATR: 0.0555
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   SR: 0.0552
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   ret: 0.0550
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   PM: 0.0526
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   ma14_t: 0.0521
2025-05-19 23:22:51,615 - INFO - [src.data_preparation] -   Median_HL: 0.0503
2025-05-19 23:22:51,619 - INFO - [src.data_preparation] - Ticker THG - Using features: ['Date', 'insec_t', 'vnipc_t', 'TVV', 'SK', 's_d7_t', 'Volatility', 'LO', 'HL', 'ma21_t', 'ATR', 'SR', 'ret', 'PM', 'ma14_t', 'Median_HL']
2025-05-19 23:22:51,708 - INFO - [src.data_preparation] - Ticker THG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:51,708 - INFO - [src.data_preparation] - Ticker THG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:51,709 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker THG
2025-05-19 23:22:51,709 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:51,709 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:22:51,709 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:22:51,713 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:22:51,713 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:22:51,717 - INFO - [src.data_preparation] - Ticker THG - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:51,718 - INFO - [__main__] - Using best model for THG: svm (F1: 0.7059)
2025-05-19 23:22:51,718 - INFO - [__main__] - Loading svm model for THG...
2025-05-19 23:22:51,719 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:51,720 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:22:51,720 - INFO - [__main__] - Making predictions for THG using svm
2025-05-19 23:22:51,721 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:51,721 - INFO - [__main__] - Successfully got last prediction for THG
2025-05-19 23:22:51,721 - INFO - [__main__] - 
Processing ticker: THT
2025-05-19 23:22:51,721 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:51,721 - INFO - [__main__] - Getting last prediction point for ticker: THT
2025-05-19 23:22:51,721 - INFO - [__main__] - ==================================================
2025-05-19 23:22:51,721 - INFO - [__main__] - Preparing test data for THT...
2025-05-19 23:22:51,755 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:51,756 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:51,756 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:51,780 - INFO - [src.data_preparation] - Ticker THT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:51,780 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(264), np.int64(1): np.int64(375)}
2025-05-19 23:22:52,115 - INFO - [src.data_preparation] - Ticker THT - Selected features:
2025-05-19 23:22:52,115 - INFO - [src.data_preparation] -   TVV: 0.0723
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   insec_t: 0.0704
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   ATR: 0.0690
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   Volatility: 0.0674
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   SK: 0.0673
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   vnipc_t: 0.0648
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   s_d7_t: 0.0630
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   ret: 0.0566
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   HL: 0.0566
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   variation_t: 0.0562
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   ma21_t: 0.0534
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   ma7_t: 0.0531
2025-05-19 23:22:52,116 - INFO - [src.data_preparation] -   SR: 0.0518
2025-05-19 23:22:52,117 - INFO - [src.data_preparation] -   LO: 0.0517
2025-05-19 23:22:52,117 - INFO - [src.data_preparation] -   PM: 0.0504
2025-05-19 23:22:52,121 - INFO - [src.data_preparation] - Ticker THT - Using features: ['Date', 'TVV', 'insec_t', 'ATR', 'Volatility', 'SK', 'vnipc_t', 's_d7_t', 'ret', 'HL', 'variation_t', 'ma21_t', 'ma7_t', 'SR', 'LO', 'PM']
2025-05-19 23:22:52,219 - INFO - [src.data_preparation] - Ticker THT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:52,219 - INFO - [src.data_preparation] - Ticker THT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:52,221 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker THT
2025-05-19 23:22:52,221 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:52,222 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(187), np.int64(1): np.int64(276)}
2025-05-19 23:22:52,222 - INFO - [src.data_preparation] - Generating 89 synthetic minority samples
2025-05-19 23:22:52,226 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (552, 13, 15), y shape: (552,)
2025-05-19 23:22:52,226 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(276), np.int64(1): np.int64(276)}
2025-05-19 23:22:52,230 - INFO - [src.data_preparation] - Ticker THT - Final 3D shapes: X_train=(552, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:52,231 - INFO - [__main__] - Using best model for THT: transformer (F1: 0.7143)
2025-05-19 23:22:52,231 - INFO - [__main__] - Loading transformer model for THT...
2025-05-19 23:22:52,247 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:52,255 - INFO - [__main__] - Model size: 0.19 MB
2025-05-19 23:22:52,256 - INFO - [__main__] - Making predictions for THT using transformer
2025-05-19 23:22:52,259 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:52,260 - INFO - [__main__] - Successfully got last prediction for THT
2025-05-19 23:22:52,260 - INFO - [__main__] - 
Processing ticker: TIE
2025-05-19 23:22:52,261 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:52,261 - INFO - [__main__] - Getting last prediction point for ticker: TIE
2025-05-19 23:22:52,261 - INFO - [__main__] - ==================================================
2025-05-19 23:22:52,261 - INFO - [__main__] - Preparing test data for TIE...
2025-05-19 23:22:52,327 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:52,328 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:52,328 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:52,360 - INFO - [src.data_preparation] - Ticker TIE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:52,360 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(283), np.int64(1): np.int64(356)}
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] - Ticker TIE - Selected features:
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   SK: 0.0780
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   vnipc_t: 0.0758
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   TVV: 0.0695
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   insec_t: 0.0684
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   ATR: 0.0635
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   ma14_t: 0.0587
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   HL: 0.0580
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   ma21_t: 0.0577
2025-05-19 23:22:52,693 - INFO - [src.data_preparation] -   Volatility: 0.0576
2025-05-19 23:22:52,694 - INFO - [src.data_preparation] -   s_d7_t: 0.0564
2025-05-19 23:22:52,694 - INFO - [src.data_preparation] -   ma7_t: 0.0560
2025-05-19 23:22:52,694 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:22:52,694 - INFO - [src.data_preparation] -   ret: 0.0520
2025-05-19 23:22:52,694 - INFO - [src.data_preparation] -   LO: 0.0494
2025-05-19 23:22:52,694 - INFO - [src.data_preparation] -   PM: 0.0487
2025-05-19 23:22:52,697 - INFO - [src.data_preparation] - Ticker TIE - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'insec_t', 'ATR', 'ma14_t', 'HL', 'ma21_t', 'Volatility', 's_d7_t', 'ma7_t', 'variation_t', 'ret', 'LO', 'PM']
2025-05-19 23:22:52,807 - INFO - [src.data_preparation] - Ticker TIE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:52,807 - INFO - [src.data_preparation] - Ticker TIE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:52,810 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TIE
2025-05-19 23:22:52,810 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:52,811 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:22:52,811 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:22:52,814 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:22:52,814 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:22:52,819 - INFO - [src.data_preparation] - Ticker TIE - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:52,820 - INFO - [__main__] - Using best model for TIE: svm (F1: 0.7945)
2025-05-19 23:22:52,820 - INFO - [__main__] - Loading svm model for TIE...
2025-05-19 23:22:52,822 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:52,822 - INFO - [__main__] - Model size: 0.77 MB
2025-05-19 23:22:52,822 - INFO - [__main__] - Making predictions for TIE using svm
2025-05-19 23:22:52,823 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:52,823 - INFO - [__main__] - Successfully got last prediction for TIE
2025-05-19 23:22:52,823 - INFO - [__main__] - 
Processing ticker: TIG
2025-05-19 23:22:52,824 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:52,824 - INFO - [__main__] - Getting last prediction point for ticker: TIG
2025-05-19 23:22:52,824 - INFO - [__main__] - ==================================================
2025-05-19 23:22:52,825 - INFO - [__main__] - Preparing test data for TIG...
2025-05-19 23:22:52,855 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:52,855 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:52,855 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:52,877 - INFO - [src.data_preparation] - Ticker TIG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:52,878 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] - Ticker TIG - Selected features:
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] -   SK: 0.0755
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] -   Volatility: 0.0707
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] -   vnipc_t: 0.0676
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] -   TVV: 0.0652
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:22:53,209 - INFO - [src.data_preparation] -   insec_t: 0.0607
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   HL: 0.0599
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   ma14_t: 0.0575
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   PM: 0.0565
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   ma7_t: 0.0562
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   ma21_t: 0.0547
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   ATR: 0.0547
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   Median_HL: 0.0540
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:22:53,210 - INFO - [src.data_preparation] -   LO: 0.0531
2025-05-19 23:22:53,213 - INFO - [src.data_preparation] - Ticker TIG - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'TVV', 's_d7_t', 'insec_t', 'HL', 'ma14_t', 'PM', 'ma7_t', 'ma21_t', 'ATR', 'Median_HL', 'ret', 'LO']
2025-05-19 23:22:53,323 - INFO - [src.data_preparation] - Ticker TIG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:53,323 - INFO - [src.data_preparation] - Ticker TIG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:53,324 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TIG
2025-05-19 23:22:53,324 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:53,324 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:22:53,324 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:22:53,328 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:22:53,328 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:22:53,331 - INFO - [src.data_preparation] - Ticker TIG - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:53,332 - INFO - [__main__] - Using best model for TIG: logistic_regression (F1: 0.5806)
2025-05-19 23:22:53,332 - INFO - [__main__] - Loading logistic_regression model for TIG...
2025-05-19 23:22:53,332 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:53,332 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:53,332 - INFO - [__main__] - Making predictions for TIG using logistic_regression
2025-05-19 23:22:53,333 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:53,333 - INFO - [__main__] - Successfully got last prediction for TIG
2025-05-19 23:22:53,333 - INFO - [__main__] - 
Processing ticker: TIS
2025-05-19 23:22:53,333 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:53,333 - INFO - [__main__] - Getting last prediction point for ticker: TIS
2025-05-19 23:22:53,333 - INFO - [__main__] - ==================================================
2025-05-19 23:22:53,333 - INFO - [__main__] - Preparing test data for TIS...
2025-05-19 23:22:53,364 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:53,365 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:53,365 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:53,385 - INFO - [src.data_preparation] - Ticker TIS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:53,385 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(266), np.int64(1): np.int64(373)}
2025-05-19 23:22:53,688 - INFO - [src.data_preparation] - Ticker TIS - Selected features:
2025-05-19 23:22:53,688 - INFO - [src.data_preparation] -   vnipc_t: 0.0834
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   s_d7_t: 0.0756
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   ma21_t: 0.0724
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   TVV: 0.0717
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   SK: 0.0643
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   insec_t: 0.0622
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   ma14_t: 0.0585
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   ma7_t: 0.0580
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   Median_HL: 0.0558
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   ret: 0.0553
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   ATR: 0.0548
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:22:53,689 - INFO - [src.data_preparation] -   HL: 0.0431
2025-05-19 23:22:53,692 - INFO - [src.data_preparation] - Ticker TIS - Using features: ['Date', 'vnipc_t', 's_d7_t', 'ma21_t', 'TVV', 'Volatility', 'SK', 'insec_t', 'ma14_t', 'ma7_t', 'Median_HL', 'ret', 'ATR', 'variation_t', 'PM', 'HL']
2025-05-19 23:22:53,783 - INFO - [src.data_preparation] - Ticker TIS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:53,783 - INFO - [src.data_preparation] - Ticker TIS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:53,785 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TIS
2025-05-19 23:22:53,785 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:53,785 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(185), np.int64(1): np.int64(278)}
2025-05-19 23:22:53,785 - INFO - [src.data_preparation] - Generating 93 synthetic minority samples
2025-05-19 23:22:53,790 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (556, 13, 15), y shape: (556,)
2025-05-19 23:22:53,790 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(278), np.int64(1): np.int64(278)}
2025-05-19 23:22:53,794 - INFO - [src.data_preparation] - Ticker TIS - Final 3D shapes: X_train=(556, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:53,794 - INFO - [__main__] - Using best model for TIS: svm (F1: 0.7606)
2025-05-19 23:22:53,794 - INFO - [__main__] - Loading svm model for TIS...
2025-05-19 23:22:53,795 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:53,795 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:22:53,795 - INFO - [__main__] - Making predictions for TIS using svm
2025-05-19 23:22:53,797 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:53,798 - INFO - [__main__] - Successfully got last prediction for TIS
2025-05-19 23:22:53,798 - INFO - [__main__] - 
Processing ticker: TIX
2025-05-19 23:22:53,798 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:53,798 - INFO - [__main__] - Getting last prediction point for ticker: TIX
2025-05-19 23:22:53,798 - INFO - [__main__] - ==================================================
2025-05-19 23:22:53,798 - INFO - [__main__] - Preparing test data for TIX...
2025-05-19 23:22:53,830 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:53,830 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:53,830 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:53,849 - INFO - [src.data_preparation] - Ticker TIX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:53,850 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(230), np.int64(1): np.int64(409)}
2025-05-19 23:22:54,188 - INFO - [src.data_preparation] - Ticker TIX - Selected features:
2025-05-19 23:22:54,188 - INFO - [src.data_preparation] -   vnipc_t: 0.0837
2025-05-19 23:22:54,188 - INFO - [src.data_preparation] -   SK: 0.0736
2025-05-19 23:22:54,188 - INFO - [src.data_preparation] -   Volatility: 0.0722
2025-05-19 23:22:54,188 - INFO - [src.data_preparation] -   s_d7_t: 0.0696
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   ATR: 0.0687
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   TVV: 0.0651
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   ma14_t: 0.0576
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   ma7_t: 0.0569
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   HL: 0.0559
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   insec_t: 0.0523
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   variation_t: 0.0518
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   ma21_t: 0.0506
2025-05-19 23:22:54,189 - INFO - [src.data_preparation] -   Median_HL: 0.0482
2025-05-19 23:22:54,192 - INFO - [src.data_preparation] - Ticker TIX - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 's_d7_t', 'ATR', 'TVV', 'ma14_t', 'ma7_t', 'HL', 'SR', 'ret', 'insec_t', 'variation_t', 'ma21_t', 'Median_HL']
2025-05-19 23:22:54,280 - INFO - [src.data_preparation] - Ticker TIX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:54,280 - INFO - [src.data_preparation] - Ticker TIX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:54,282 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TIX
2025-05-19 23:22:54,282 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:54,282 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:22:54,282 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:22:54,288 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:22:54,288 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:22:54,291 - INFO - [src.data_preparation] - Ticker TIX - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:54,292 - INFO - [__main__] - Using best model for TIX: svm (F1: 0.8267)
2025-05-19 23:22:54,292 - INFO - [__main__] - Loading svm model for TIX...
2025-05-19 23:22:54,293 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:54,294 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:22:54,294 - INFO - [__main__] - Making predictions for TIX using svm
2025-05-19 23:22:54,294 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:54,294 - INFO - [__main__] - Successfully got last prediction for TIX
2025-05-19 23:22:54,294 - INFO - [__main__] - 
Processing ticker: TJC
2025-05-19 23:22:54,295 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:54,295 - INFO - [__main__] - Getting last prediction point for ticker: TJC
2025-05-19 23:22:54,295 - INFO - [__main__] - ==================================================
2025-05-19 23:22:54,295 - INFO - [__main__] - Preparing test data for TJC...
2025-05-19 23:22:54,323 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:54,323 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:54,324 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:54,344 - INFO - [src.data_preparation] - Ticker TJC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:54,344 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(249), np.int64(1): np.int64(390)}
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] - Ticker TJC - Selected features:
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   vnipc_t: 0.0828
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   TVV: 0.0721
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   Volatility: 0.0697
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   ATR: 0.0691
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   insec_t: 0.0671
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   SK: 0.0648
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   s_d7_t: 0.0598
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   ma21_t: 0.0581
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   ma14_t: 0.0567
2025-05-19 23:22:54,663 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:22:54,664 - INFO - [src.data_preparation] -   ma7_t: 0.0535
2025-05-19 23:22:54,664 - INFO - [src.data_preparation] -   HL: 0.0524
2025-05-19 23:22:54,664 - INFO - [src.data_preparation] -   PM: 0.0496
2025-05-19 23:22:54,664 - INFO - [src.data_preparation] -   SR: 0.0495
2025-05-19 23:22:54,664 - INFO - [src.data_preparation] -   variation_t: 0.0475
2025-05-19 23:22:54,668 - INFO - [src.data_preparation] - Ticker TJC - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'ATR', 'insec_t', 'SK', 's_d7_t', 'ma21_t', 'ma14_t', 'Median_HL', 'ma7_t', 'HL', 'PM', 'SR', 'variation_t']
2025-05-19 23:22:54,768 - INFO - [src.data_preparation] - Ticker TJC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:54,768 - INFO - [src.data_preparation] - Ticker TJC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:54,771 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TJC
2025-05-19 23:22:54,771 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:54,771 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:22:54,772 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:22:54,778 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:22:54,778 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:22:54,783 - INFO - [src.data_preparation] - Ticker TJC - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:54,784 - INFO - [__main__] - Using best model for TJC: svm (F1: 0.8108)
2025-05-19 23:22:54,784 - INFO - [__main__] - Loading svm model for TJC...
2025-05-19 23:22:54,785 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:54,786 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:22:54,786 - INFO - [__main__] - Making predictions for TJC using svm
2025-05-19 23:22:54,787 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:54,788 - INFO - [__main__] - Successfully got last prediction for TJC
2025-05-19 23:22:54,788 - INFO - [__main__] - 
Processing ticker: TKC
2025-05-19 23:22:54,789 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:54,789 - INFO - [__main__] - Getting last prediction point for ticker: TKC
2025-05-19 23:22:54,789 - INFO - [__main__] - ==================================================
2025-05-19 23:22:54,789 - INFO - [__main__] - Preparing test data for TKC...
2025-05-19 23:22:54,831 - INFO - [src.data_preparation] - After processing - X shape: (627, 19), y shape: (627,)
2025-05-19 23:22:54,831 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:54,831 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:54,853 - INFO - [src.data_preparation] - Ticker TKC - Original shapes: X=(627, 18), y=(627,)
2025-05-19 23:22:54,853 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(260), np.int64(1): np.int64(367)}
2025-05-19 23:22:55,191 - INFO - [src.data_preparation] - Ticker TKC - Selected features:
2025-05-19 23:22:55,191 - INFO - [src.data_preparation] -   vnipc_t: 0.0777
2025-05-19 23:22:55,191 - INFO - [src.data_preparation] -   ATR: 0.0689
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   HL: 0.0628
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   ma21_t: 0.0624
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   s_d7_t: 0.0601
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   TVV: 0.0598
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   Median_HL: 0.0592
2025-05-19 23:22:55,192 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:22:55,193 - INFO - [src.data_preparation] -   Volatility: 0.0554
2025-05-19 23:22:55,193 - INFO - [src.data_preparation] -   ma14_t: 0.0547
2025-05-19 23:22:55,193 - INFO - [src.data_preparation] -   insec_t: 0.0532
2025-05-19 23:22:55,193 - INFO - [src.data_preparation] -   ret: 0.0529
2025-05-19 23:22:55,193 - INFO - [src.data_preparation] -   ma7_t: 0.0504
2025-05-19 23:22:55,193 - INFO - [src.data_preparation] -   SR: 0.0502
2025-05-19 23:22:55,198 - INFO - [src.data_preparation] - Ticker TKC - Using features: ['Date', 'vnipc_t', 'ATR', 'SK', 'HL', 'ma21_t', 's_d7_t', 'TVV', 'Median_HL', 'PM', 'Volatility', 'ma14_t', 'insec_t', 'ret', 'ma7_t', 'SR']
2025-05-19 23:22:55,321 - INFO - [src.data_preparation] - Ticker TKC - 2D shapes: X_train=(463, 195), X_valid=(78, 195), X_test=(45, 195)
2025-05-19 23:22:55,321 - INFO - [src.data_preparation] - Ticker TKC - 3D shapes: X_train=(463, 13, 15), X_valid=(78, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:55,322 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TKC
2025-05-19 23:22:55,322 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:55,322 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:22:55,323 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:22:55,325 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:22:55,325 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:22:55,329 - INFO - [src.data_preparation] - Ticker TKC - Final 3D shapes: X_train=(510, 13, 15), X_valid=(78, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:55,329 - INFO - [__main__] - Using best model for TKC: lstm (F1: 0.9885)
2025-05-19 23:22:55,329 - INFO - [__main__] - Loading lstm model for TKC...
2025-05-19 23:22:55,333 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:55,334 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:22:55,336 - INFO - [__main__] - Making predictions for TKC using lstm
2025-05-19 23:22:55,337 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:55,337 - INFO - [__main__] - Successfully got last prediction for TKC
2025-05-19 23:22:55,338 - INFO - [__main__] - 
Processing ticker: TKU
2025-05-19 23:22:55,338 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:55,338 - INFO - [__main__] - Getting last prediction point for ticker: TKU
2025-05-19 23:22:55,338 - INFO - [__main__] - ==================================================
2025-05-19 23:22:55,338 - INFO - [__main__] - Preparing test data for TKU...
2025-05-19 23:22:55,383 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:55,383 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:55,383 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:55,409 - INFO - [src.data_preparation] - Ticker TKU - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:55,410 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(247), np.int64(1): np.int64(392)}
2025-05-19 23:22:55,748 - INFO - [src.data_preparation] - Ticker TKU - Selected features:
2025-05-19 23:22:55,748 - INFO - [src.data_preparation] -   vnipc_t: 0.0860
2025-05-19 23:22:55,748 - INFO - [src.data_preparation] -   s_d7_t: 0.0738
2025-05-19 23:22:55,748 - INFO - [src.data_preparation] -   SK: 0.0729
2025-05-19 23:22:55,748 - INFO - [src.data_preparation] -   TVV: 0.0725
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   ma7_t: 0.0624
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   Volatility: 0.0602
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   insec_t: 0.0589
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   ma21_t: 0.0588
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   ma14_t: 0.0581
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   ATR: 0.0579
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   variation_t: 0.0511
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   ret: 0.0506
2025-05-19 23:22:55,749 - INFO - [src.data_preparation] -   HL: 0.0492
2025-05-19 23:22:55,753 - INFO - [src.data_preparation] - Ticker TKU - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'TVV', 'ma7_t', 'Volatility', 'insec_t', 'ma21_t', 'ma14_t', 'ATR', 'Median_HL', 'PM', 'variation_t', 'ret', 'HL']
2025-05-19 23:22:55,853 - INFO - [src.data_preparation] - Ticker TKU - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:55,853 - INFO - [src.data_preparation] - Ticker TKU - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:55,855 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TKU
2025-05-19 23:22:55,855 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:55,855 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(174), np.int64(1): np.int64(289)}
2025-05-19 23:22:55,855 - INFO - [src.data_preparation] - Generating 115 synthetic minority samples
2025-05-19 23:22:55,860 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (578, 13, 15), y shape: (578,)
2025-05-19 23:22:55,860 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(289), np.int64(1): np.int64(289)}
2025-05-19 23:22:55,864 - INFO - [src.data_preparation] - Ticker TKU - Final 3D shapes: X_train=(578, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:55,864 - INFO - [__main__] - Using best model for TKU: svm (F1: 0.7429)
2025-05-19 23:22:55,864 - INFO - [__main__] - Loading svm model for TKU...
2025-05-19 23:22:55,866 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:55,867 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:22:55,867 - INFO - [__main__] - Making predictions for TKU using svm
2025-05-19 23:22:55,869 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:55,869 - INFO - [__main__] - Successfully got last prediction for TKU
2025-05-19 23:22:55,869 - INFO - [__main__] - 
Processing ticker: TLG
2025-05-19 23:22:55,869 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:55,869 - INFO - [__main__] - Getting last prediction point for ticker: TLG
2025-05-19 23:22:55,871 - INFO - [__main__] - ==================================================
2025-05-19 23:22:55,871 - INFO - [__main__] - Preparing test data for TLG...
2025-05-19 23:22:55,913 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:55,913 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:55,913 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:55,934 - INFO - [src.data_preparation] - Ticker TLG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:55,934 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] - Ticker TLG - Selected features:
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] -   HL: 0.0667
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] -   LO: 0.0659
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] -   vnipc_t: 0.0658
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:22:56,252 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   s_d7_t: 0.0601
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   insec_t: 0.0601
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   ret: 0.0596
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   ma14_t: 0.0573
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   TVV: 0.0571
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   variation_t: 0.0566
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   SR: 0.0565
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   ma21_t: 0.0534
2025-05-19 23:22:56,257 - INFO - [src.data_preparation] -   ma7_t: 0.0516
2025-05-19 23:22:56,258 - INFO - [src.data_preparation] - Ticker TLG - Using features: ['Date', 'HL', 'Volatility', 'LO', 'vnipc_t', 'SK', 'ATR', 's_d7_t', 'insec_t', 'ret', 'ma14_t', 'TVV', 'variation_t', 'SR', 'ma21_t', 'ma7_t']
2025-05-19 23:22:56,356 - INFO - [src.data_preparation] - Ticker TLG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:56,356 - INFO - [src.data_preparation] - Ticker TLG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:56,358 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TLG
2025-05-19 23:22:56,358 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:56,358 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(205), np.int64(1): np.int64(258)}
2025-05-19 23:22:56,359 - INFO - [src.data_preparation] - Generating 53 synthetic minority samples
2025-05-19 23:22:56,361 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:22:56,361 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:22:56,363 - INFO - [src.data_preparation] - Ticker TLG - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:56,363 - INFO - [__main__] - Using best model for TLG: logistic_regression (F1: 0.5500)
2025-05-19 23:22:56,364 - INFO - [__main__] - Loading logistic_regression model for TLG...
2025-05-19 23:22:56,364 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:56,364 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:56,365 - INFO - [__main__] - Making predictions for TLG using logistic_regression
2025-05-19 23:22:56,365 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:56,365 - INFO - [__main__] - Successfully got last prediction for TLG
2025-05-19 23:22:56,365 - INFO - [__main__] - 
Processing ticker: TLH
2025-05-19 23:22:56,365 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:56,365 - INFO - [__main__] - Getting last prediction point for ticker: TLH
2025-05-19 23:22:56,365 - INFO - [__main__] - ==================================================
2025-05-19 23:22:56,365 - INFO - [__main__] - Preparing test data for TLH...
2025-05-19 23:22:56,394 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:56,395 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:56,395 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:56,413 - INFO - [src.data_preparation] - Ticker TLH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:56,413 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(318), np.int64(1): np.int64(321)}
2025-05-19 23:22:56,722 - INFO - [src.data_preparation] - Ticker TLH - Selected features:
2025-05-19 23:22:56,722 - INFO - [src.data_preparation] -   vnipc_t: 0.0746
2025-05-19 23:22:56,722 - INFO - [src.data_preparation] -   insec_t: 0.0694
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   TVV: 0.0686
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   s_d7_t: 0.0645
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   Volatility: 0.0632
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   SR: 0.0617
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   ma21_t: 0.0591
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   ma14_t: 0.0571
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   ret: 0.0568
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   ATR: 0.0548
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   HL: 0.0528
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   Median_HL: 0.0524
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   PM: 0.0513
2025-05-19 23:22:56,723 - INFO - [src.data_preparation] -   ma7_t: 0.0511
2025-05-19 23:22:56,725 - INFO - [src.data_preparation] - Ticker TLH - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 's_d7_t', 'Volatility', 'SK', 'SR', 'ma21_t', 'ma14_t', 'ret', 'ATR', 'HL', 'Median_HL', 'PM', 'ma7_t']
2025-05-19 23:22:56,824 - INFO - [src.data_preparation] - Ticker TLH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:56,824 - INFO - [src.data_preparation] - Ticker TLH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:56,827 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TLH
2025-05-19 23:22:56,827 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:56,827 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(228), np.int64(1): np.int64(235)}
2025-05-19 23:22:56,827 - INFO - [src.data_preparation] - Generating 7 synthetic minority samples
2025-05-19 23:22:56,827 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (470, 13, 15), y shape: (470,)
2025-05-19 23:22:56,827 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(235), np.int64(1): np.int64(235)}
2025-05-19 23:22:56,830 - INFO - [src.data_preparation] - Ticker TLH - Final 3D shapes: X_train=(470, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:56,831 - INFO - [__main__] - Using best model for TLH: logistic_regression (F1: 0.3200)
2025-05-19 23:22:56,831 - INFO - [__main__] - Loading logistic_regression model for TLH...
2025-05-19 23:22:56,832 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:56,832 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:22:56,832 - INFO - [__main__] - Making predictions for TLH using logistic_regression
2025-05-19 23:22:56,832 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:56,832 - INFO - [__main__] - Successfully got last prediction for TLH
2025-05-19 23:22:56,833 - INFO - [__main__] - 
Processing ticker: TLT
2025-05-19 23:22:56,833 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:56,833 - INFO - [__main__] - Getting last prediction point for ticker: TLT
2025-05-19 23:22:56,833 - INFO - [__main__] - ==================================================
2025-05-19 23:22:56,833 - INFO - [__main__] - Preparing test data for TLT...
2025-05-19 23:22:56,867 - INFO - [src.data_preparation] - After processing - X shape: (624, 19), y shape: (624,)
2025-05-19 23:22:56,867 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:56,867 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:56,890 - INFO - [src.data_preparation] - Ticker TLT - Original shapes: X=(624, 18), y=(624,)
2025-05-19 23:22:56,890 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(221), np.int64(1): np.int64(403)}
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] - Ticker TLT - Selected features:
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   vnipc_t: 0.0855
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   TVV: 0.0688
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   s_d7_t: 0.0679
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   ATR: 0.0629
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   ma21_t: 0.0602
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   insec_t: 0.0597
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   ma14_t: 0.0581
2025-05-19 23:22:57,205 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:22:57,207 - INFO - [src.data_preparation] -   ret: 0.0529
2025-05-19 23:22:57,207 - INFO - [src.data_preparation] -   HL: 0.0514
2025-05-19 23:22:57,207 - INFO - [src.data_preparation] -   Median_HL: 0.0497
2025-05-19 23:22:57,207 - INFO - [src.data_preparation] -   PM: 0.0488
2025-05-19 23:22:57,207 - INFO - [src.data_preparation] -   variation_t: 0.0473
2025-05-19 23:22:57,209 - INFO - [src.data_preparation] - Ticker TLT - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 's_d7_t', 'SK', 'ATR', 'ma21_t', 'insec_t', 'ma14_t', 'ma7_t', 'ret', 'HL', 'Median_HL', 'PM', 'variation_t']
2025-05-19 23:22:57,318 - INFO - [src.data_preparation] - Ticker TLT - 2D shapes: X_train=(448, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:57,318 - INFO - [src.data_preparation] - Ticker TLT - 3D shapes: X_train=(448, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:57,320 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TLT
2025-05-19 23:22:57,320 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (448, 13, 15), y shape: (448,)
2025-05-19 23:22:57,320 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(173), np.int64(1): np.int64(275)}
2025-05-19 23:22:57,320 - INFO - [src.data_preparation] - Generating 102 synthetic minority samples
2025-05-19 23:22:57,324 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:22:57,324 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:22:57,328 - INFO - [src.data_preparation] - Ticker TLT - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:57,328 - INFO - [__main__] - Using best model for TLT: svm (F1: 0.7778)
2025-05-19 23:22:57,328 - INFO - [__main__] - Loading svm model for TLT...
2025-05-19 23:22:57,331 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:57,332 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:22:57,332 - INFO - [__main__] - Making predictions for TLT using svm
2025-05-19 23:22:57,333 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:57,333 - INFO - [__main__] - Successfully got last prediction for TLT
2025-05-19 23:22:57,333 - INFO - [__main__] - 
Processing ticker: TMC
2025-05-19 23:22:57,333 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:57,333 - INFO - [__main__] - Getting last prediction point for ticker: TMC
2025-05-19 23:22:57,333 - INFO - [__main__] - ==================================================
2025-05-19 23:22:57,333 - INFO - [__main__] - Preparing test data for TMC...
2025-05-19 23:22:57,373 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:57,373 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:57,373 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:57,398 - INFO - [src.data_preparation] - Ticker TMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:57,398 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(208), np.int64(1): np.int64(431)}
2025-05-19 23:22:57,720 - INFO - [src.data_preparation] - Ticker TMC - Selected features:
2025-05-19 23:22:57,720 - INFO - [src.data_preparation] -   SK: 0.0795
2025-05-19 23:22:57,720 - INFO - [src.data_preparation] -   vnipc_t: 0.0788
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   s_d7_t: 0.0759
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   TVV: 0.0678
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   ATR: 0.0663
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   ma14_t: 0.0633
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   ma21_t: 0.0623
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   Volatility: 0.0619
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   ma7_t: 0.0608
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   PM: 0.0565
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   insec_t: 0.0514
2025-05-19 23:22:57,721 - INFO - [src.data_preparation] -   ret: 0.0510
2025-05-19 23:22:57,722 - INFO - [src.data_preparation] -   variation_t: 0.0506
2025-05-19 23:22:57,722 - INFO - [src.data_preparation] -   SR: 0.0428
2025-05-19 23:22:57,725 - INFO - [src.data_preparation] - Ticker TMC - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'TVV', 'ATR', 'ma14_t', 'ma21_t', 'Volatility', 'ma7_t', 'PM', 'Median_HL', 'insec_t', 'ret', 'variation_t', 'SR']
2025-05-19 23:22:57,836 - INFO - [src.data_preparation] - Ticker TMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:57,836 - INFO - [src.data_preparation] - Ticker TMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:57,838 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TMC
2025-05-19 23:22:57,838 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:57,839 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(141), np.int64(1): np.int64(322)}
2025-05-19 23:22:57,839 - INFO - [src.data_preparation] - Generating 181 synthetic minority samples
2025-05-19 23:22:57,846 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (644, 13, 15), y shape: (644,)
2025-05-19 23:22:57,846 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(322), np.int64(1): np.int64(322)}
2025-05-19 23:22:57,850 - INFO - [src.data_preparation] - Ticker TMC - Final 3D shapes: X_train=(644, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:57,850 - INFO - [__main__] - Using best model for TMC: svm (F1: 0.7059)
2025-05-19 23:22:57,851 - INFO - [__main__] - Loading svm model for TMC...
2025-05-19 23:22:57,852 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:57,853 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:22:57,853 - INFO - [__main__] - Making predictions for TMC using svm
2025-05-19 23:22:57,854 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:57,854 - INFO - [__main__] - Successfully got last prediction for TMC
2025-05-19 23:22:57,854 - INFO - [__main__] - 
Processing ticker: TMP
2025-05-19 23:22:57,854 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:57,855 - INFO - [__main__] - Getting last prediction point for ticker: TMP
2025-05-19 23:22:57,855 - INFO - [__main__] - ==================================================
2025-05-19 23:22:57,855 - INFO - [__main__] - Preparing test data for TMP...
2025-05-19 23:22:57,883 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:57,883 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:57,883 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:57,903 - INFO - [src.data_preparation] - Ticker TMP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:57,904 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(250), np.int64(1): np.int64(389)}
2025-05-19 23:22:58,214 - INFO - [src.data_preparation] - Ticker TMP - Selected features:
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   insec_t: 0.0804
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   s_d7_t: 0.0702
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   vnipc_t: 0.0699
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   HL: 0.0697
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   SK: 0.0681
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   TVV: 0.0639
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   ATR: 0.0594
2025-05-19 23:22:58,215 - INFO - [src.data_preparation] -   Volatility: 0.0590
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   LO: 0.0589
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   SR: 0.0576
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   variation_t: 0.0542
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   ret: 0.0530
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   ma7_t: 0.0486
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   PM: 0.0484
2025-05-19 23:22:58,216 - INFO - [src.data_preparation] -   ma14_t: 0.0471
2025-05-19 23:22:58,219 - INFO - [src.data_preparation] - Ticker TMP - Using features: ['Date', 'insec_t', 's_d7_t', 'vnipc_t', 'HL', 'SK', 'TVV', 'ATR', 'Volatility', 'LO', 'SR', 'variation_t', 'ret', 'ma7_t', 'PM', 'ma14_t']
2025-05-19 23:22:58,317 - INFO - [src.data_preparation] - Ticker TMP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:58,317 - INFO - [src.data_preparation] - Ticker TMP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:58,319 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TMP
2025-05-19 23:22:58,319 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:58,319 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(172), np.int64(1): np.int64(291)}
2025-05-19 23:22:58,319 - INFO - [src.data_preparation] - Generating 119 synthetic minority samples
2025-05-19 23:22:58,326 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (582, 13, 15), y shape: (582,)
2025-05-19 23:22:58,326 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(291), np.int64(1): np.int64(291)}
2025-05-19 23:22:58,329 - INFO - [src.data_preparation] - Ticker TMP - Final 3D shapes: X_train=(582, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:58,329 - INFO - [__main__] - Using best model for TMP: lstm (F1: 0.6462)
2025-05-19 23:22:58,329 - INFO - [__main__] - Loading lstm model for TMP...
2025-05-19 23:22:58,333 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:58,335 - INFO - [__main__] - Model size: 0.12 MB
2025-05-19 23:22:58,335 - INFO - [__main__] - Making predictions for TMP using lstm
2025-05-19 23:22:58,340 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:22:58,340 - INFO - [__main__] - Successfully got last prediction for TMP
2025-05-19 23:22:58,340 - INFO - [__main__] - 
Processing ticker: TMS
2025-05-19 23:22:58,340 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:58,340 - INFO - [__main__] - Getting last prediction point for ticker: TMS
2025-05-19 23:22:58,340 - INFO - [__main__] - ==================================================
2025-05-19 23:22:58,341 - INFO - [__main__] - Preparing test data for TMS...
2025-05-19 23:22:58,377 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:58,377 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:58,377 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:58,399 - INFO - [src.data_preparation] - Ticker TMS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:58,399 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] - Ticker TMS - Selected features:
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   s_d7_t: 0.0688
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   SR: 0.0679
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   vnipc_t: 0.0651
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   Volatility: 0.0620
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   insec_t: 0.0620
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   variation_t: 0.0619
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   SK: 0.0603
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   HL: 0.0576
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   ATR: 0.0570
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   ret: 0.0569
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   ma14_t: 0.0549
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   LO: 0.0536
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   ma7_t: 0.0526
2025-05-19 23:22:58,757 - INFO - [src.data_preparation] -   ma21_t: 0.0526
2025-05-19 23:22:58,763 - INFO - [src.data_preparation] - Ticker TMS - Using features: ['Date', 's_d7_t', 'SR', 'vnipc_t', 'Volatility', 'insec_t', 'variation_t', 'TVV', 'SK', 'HL', 'ATR', 'ret', 'ma14_t', 'LO', 'ma7_t', 'ma21_t']
2025-05-19 23:22:58,874 - INFO - [src.data_preparation] - Ticker TMS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:58,874 - INFO - [src.data_preparation] - Ticker TMS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:58,875 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TMS
2025-05-19 23:22:58,875 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:58,877 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:22:58,877 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:22:58,879 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:22:58,879 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:22:58,882 - INFO - [src.data_preparation] - Ticker TMS - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:58,882 - INFO - [__main__] - Using best model for TMS: svm (F1: 0.7246)
2025-05-19 23:22:58,883 - INFO - [__main__] - Loading svm model for TMS...
2025-05-19 23:22:58,884 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:22:58,884 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:22:58,885 - INFO - [__main__] - Making predictions for TMS using svm
2025-05-19 23:22:58,885 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:58,885 - INFO - [__main__] - Successfully got last prediction for TMS
2025-05-19 23:22:58,885 - INFO - [__main__] - 
Processing ticker: TMT
2025-05-19 23:22:58,885 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:58,887 - INFO - [__main__] - Getting last prediction point for ticker: TMT
2025-05-19 23:22:58,887 - INFO - [__main__] - ==================================================
2025-05-19 23:22:58,887 - INFO - [__main__] - Preparing test data for TMT...
2025-05-19 23:22:58,917 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:58,917 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:58,917 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:58,937 - INFO - [src.data_preparation] - Ticker TMT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:58,937 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(341), np.int64(1): np.int64(298)}
2025-05-19 23:22:59,256 - INFO - [src.data_preparation] - Ticker TMT - Selected features:
2025-05-19 23:22:59,256 - INFO - [src.data_preparation] -   insec_t: 0.0770
2025-05-19 23:22:59,256 - INFO - [src.data_preparation] -   SK: 0.0732
2025-05-19 23:22:59,256 - INFO - [src.data_preparation] -   HL: 0.0709
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   vnipc_t: 0.0640
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   ma21_t: 0.0630
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   Volatility: 0.0624
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   TVV: 0.0615
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   s_d7_t: 0.0600
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   LO: 0.0551
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   ATR: 0.0549
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   SR: 0.0528
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   variation_t: 0.0527
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   ma14_t: 0.0517
2025-05-19 23:22:59,257 - INFO - [src.data_preparation] -   ma7_t: 0.0487
2025-05-19 23:22:59,260 - INFO - [src.data_preparation] - Ticker TMT - Using features: ['Date', 'insec_t', 'SK', 'HL', 'vnipc_t', 'ma21_t', 'Volatility', 'TVV', 's_d7_t', 'LO', 'ATR', 'SR', 'variation_t', 'ret', 'ma14_t', 'ma7_t']
2025-05-19 23:22:59,376 - INFO - [src.data_preparation] - Ticker TMT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:59,376 - INFO - [src.data_preparation] - Ticker TMT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:59,378 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TMT
2025-05-19 23:22:59,378 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:59,378 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(220)}
2025-05-19 23:22:59,378 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:22:59,380 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:22:59,380 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:22:59,384 - INFO - [src.data_preparation] - Ticker TMT - Final 3D shapes: X_train=(486, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:59,384 - INFO - [__main__] - Using best model for TMT: transformer (F1: 0.5769)
2025-05-19 23:22:59,384 - INFO - [__main__] - Loading transformer model for TMT...
2025-05-19 23:22:59,401 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:22:59,405 - INFO - [__main__] - Model size: 0.17 MB
2025-05-19 23:22:59,405 - INFO - [__main__] - Making predictions for TMT using transformer
2025-05-19 23:22:59,408 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:59,409 - INFO - [__main__] - Successfully got last prediction for TMT
2025-05-19 23:22:59,409 - INFO - [__main__] - 
Processing ticker: TMW
2025-05-19 23:22:59,409 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:59,409 - INFO - [__main__] - Getting last prediction point for ticker: TMW
2025-05-19 23:22:59,409 - INFO - [__main__] - ==================================================
2025-05-19 23:22:59,409 - INFO - [__main__] - Preparing test data for TMW...
2025-05-19 23:22:59,462 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:59,462 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:59,462 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:59,491 - INFO - [src.data_preparation] - Ticker TMW - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:59,492 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(70), np.int64(1): np.int64(569)}
2025-05-19 23:22:59,742 - INFO - [src.data_preparation] - Ticker TMW - Selected features:
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   vnipc_t: 0.1463
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   ma14_t: 0.0947
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   ma21_t: 0.0901
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   Median_HL: 0.0729
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   s_d7_t: 0.0694
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   ma7_t: 0.0690
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   PM: 0.0654
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   ATR: 0.0608
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   Volatility: 0.0569
2025-05-19 23:22:59,743 - INFO - [src.data_preparation] -   TVV: 0.0538
2025-05-19 23:22:59,744 - INFO - [src.data_preparation] -   SK: 0.0481
2025-05-19 23:22:59,744 - INFO - [src.data_preparation] -   insec_t: 0.0473
2025-05-19 23:22:59,744 - INFO - [src.data_preparation] -   ret: 0.0323
2025-05-19 23:22:59,744 - INFO - [src.data_preparation] -   variation_t: 0.0307
2025-05-19 23:22:59,744 - INFO - [src.data_preparation] -   HL: 0.0286
2025-05-19 23:22:59,746 - INFO - [src.data_preparation] - Ticker TMW - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'Median_HL', 's_d7_t', 'ma7_t', 'PM', 'ATR', 'Volatility', 'TVV', 'SK', 'insec_t', 'ret', 'variation_t', 'HL']
2025-05-19 23:22:59,858 - INFO - [src.data_preparation] - Ticker TMW - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:22:59,858 - INFO - [src.data_preparation] - Ticker TMW - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:59,858 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TMW
2025-05-19 23:22:59,858 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:22:59,858 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(51), np.int64(1): np.int64(412)}
2025-05-19 23:22:59,858 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:22:59,866 - INFO - [src.data_preparation] - Ticker TMW - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:22:59,866 - INFO - [__main__] - Using best model for TMW: lstm (F1: 0.8718)
2025-05-19 23:22:59,867 - INFO - [__main__] - Loading lstm model for TMW...
2025-05-19 23:22:59,874 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:22:59,876 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:22:59,876 - INFO - [__main__] - Making predictions for TMW using lstm
2025-05-19 23:22:59,880 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:22:59,880 - INFO - [__main__] - Successfully got last prediction for TMW
2025-05-19 23:22:59,881 - INFO - [__main__] - 
Processing ticker: TMX
2025-05-19 23:22:59,881 - INFO - [__main__] - 
==================================================
2025-05-19 23:22:59,881 - INFO - [__main__] - Getting last prediction point for ticker: TMX
2025-05-19 23:22:59,881 - INFO - [__main__] - ==================================================
2025-05-19 23:22:59,881 - INFO - [__main__] - Preparing test data for TMX...
2025-05-19 23:22:59,948 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:22:59,948 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:22:59,949 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:22:59,983 - INFO - [src.data_preparation] - Ticker TMX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:22:59,983 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(204), np.int64(1): np.int64(435)}
2025-05-19 23:23:00,316 - INFO - [src.data_preparation] - Ticker TMX - Selected features:
2025-05-19 23:23:00,316 - INFO - [src.data_preparation] -   ATR: 0.0833
2025-05-19 23:23:00,316 - INFO - [src.data_preparation] -   vnipc_t: 0.0812
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   s_d7_t: 0.0730
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   Volatility: 0.0722
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   TVV: 0.0719
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   SK: 0.0693
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   ma21_t: 0.0663
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   ma14_t: 0.0609
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   ma7_t: 0.0599
2025-05-19 23:23:00,317 - INFO - [src.data_preparation] -   Median_HL: 0.0553
2025-05-19 23:23:00,318 - INFO - [src.data_preparation] -   PM: 0.0542
2025-05-19 23:23:00,318 - INFO - [src.data_preparation] -   insec_t: 0.0510
2025-05-19 23:23:00,318 - INFO - [src.data_preparation] -   HL: 0.0454
2025-05-19 23:23:00,318 - INFO - [src.data_preparation] -   SR: 0.0411
2025-05-19 23:23:00,318 - INFO - [src.data_preparation] -   ret: 0.0410
2025-05-19 23:23:00,320 - INFO - [src.data_preparation] - Ticker TMX - Using features: ['Date', 'ATR', 'vnipc_t', 's_d7_t', 'Volatility', 'TVV', 'SK', 'ma21_t', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 'insec_t', 'HL', 'SR', 'ret']
2025-05-19 23:23:00,411 - INFO - [src.data_preparation] - Ticker TMX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:00,412 - INFO - [src.data_preparation] - Ticker TMX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:00,413 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TMX
2025-05-19 23:23:00,413 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:00,413 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(146), np.int64(1): np.int64(317)}
2025-05-19 23:23:00,413 - INFO - [src.data_preparation] - Generating 171 synthetic minority samples
2025-05-19 23:23:00,422 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (634, 13, 15), y shape: (634,)
2025-05-19 23:23:00,422 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(317), np.int64(1): np.int64(317)}
2025-05-19 23:23:00,427 - INFO - [src.data_preparation] - Ticker TMX - Final 3D shapes: X_train=(634, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:00,428 - INFO - [__main__] - Using best model for TMX: svm (F1: 0.8267)
2025-05-19 23:23:00,428 - INFO - [__main__] - Loading svm model for TMX...
2025-05-19 23:23:00,429 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:00,430 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:23:00,430 - INFO - [__main__] - Making predictions for TMX using svm
2025-05-19 23:23:00,431 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:00,431 - INFO - [__main__] - Successfully got last prediction for TMX
2025-05-19 23:23:00,431 - INFO - [__main__] - 
Processing ticker: TNA
2025-05-19 23:23:00,431 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:00,431 - INFO - [__main__] - Getting last prediction point for ticker: TNA
2025-05-19 23:23:00,431 - INFO - [__main__] - ==================================================
2025-05-19 23:23:00,431 - INFO - [__main__] - Preparing test data for TNA...
2025-05-19 23:23:00,461 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:00,461 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:00,461 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:00,484 - INFO - [src.data_preparation] - Ticker TNA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:00,485 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] - Ticker TNA - Selected features:
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   vnipc_t: 0.0761
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   TVV: 0.0697
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   ATR: 0.0688
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   insec_t: 0.0617
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   Volatility: 0.0603
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   SK: 0.0591
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   ma21_t: 0.0588
2025-05-19 23:23:00,794 - INFO - [src.data_preparation] -   HL: 0.0579
2025-05-19 23:23:00,795 - INFO - [src.data_preparation] -   LO: 0.0570
2025-05-19 23:23:00,795 - INFO - [src.data_preparation] -   ret: 0.0561
2025-05-19 23:23:00,795 - INFO - [src.data_preparation] -   Median_HL: 0.0547
2025-05-19 23:23:00,795 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:23:00,795 - INFO - [src.data_preparation] -   SR: 0.0529
2025-05-19 23:23:00,795 - INFO - [src.data_preparation] -   ma14_t: 0.0494
2025-05-19 23:23:00,798 - INFO - [src.data_preparation] - Ticker TNA - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 's_d7_t', 'insec_t', 'Volatility', 'SK', 'ma21_t', 'HL', 'LO', 'ret', 'Median_HL', 'variation_t', 'SR', 'ma14_t']
2025-05-19 23:23:00,888 - INFO - [src.data_preparation] - Ticker TNA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:00,888 - INFO - [src.data_preparation] - Ticker TNA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:00,890 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TNA
2025-05-19 23:23:00,890 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:00,890 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:23:00,890 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:23:00,892 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:23:00,892 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:23:00,895 - INFO - [src.data_preparation] - Ticker TNA - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:00,895 - INFO - [__main__] - Using best model for TNA: lstm (F1: 0.8861)
2025-05-19 23:23:00,895 - INFO - [__main__] - Loading lstm model for TNA...
2025-05-19 23:23:00,900 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:00,901 - INFO - [__main__] - Model size: 0.39 MB
2025-05-19 23:23:00,901 - INFO - [__main__] - Making predictions for TNA using lstm
2025-05-19 23:23:00,904 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:00,905 - INFO - [__main__] - Successfully got last prediction for TNA
2025-05-19 23:23:00,905 - INFO - [__main__] - 
Processing ticker: TNB
2025-05-19 23:23:00,905 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:00,905 - INFO - [__main__] - Getting last prediction point for ticker: TNB
2025-05-19 23:23:00,905 - INFO - [__main__] - ==================================================
2025-05-19 23:23:00,905 - INFO - [__main__] - Preparing test data for TNB...
2025-05-19 23:23:00,943 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:00,944 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:00,944 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:00,971 - INFO - [src.data_preparation] - Ticker TNB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:00,972 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(218), np.int64(1): np.int64(421)}
2025-05-19 23:23:01,322 - INFO - [src.data_preparation] - Ticker TNB - Selected features:
2025-05-19 23:23:01,322 - INFO - [src.data_preparation] -   vnipc_t: 0.0917
2025-05-19 23:23:01,322 - INFO - [src.data_preparation] -   TVV: 0.0806
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   Volatility: 0.0654
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   SK: 0.0638
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   ma21_t: 0.0626
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   s_d7_t: 0.0591
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   ma7_t: 0.0581
2025-05-19 23:23:01,323 - INFO - [src.data_preparation] -   insec_t: 0.0563
2025-05-19 23:23:01,324 - INFO - [src.data_preparation] -   ma14_t: 0.0551
2025-05-19 23:23:01,324 - INFO - [src.data_preparation] -   PM: 0.0543
2025-05-19 23:23:01,324 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:23:01,324 - INFO - [src.data_preparation] -   Median_HL: 0.0526
2025-05-19 23:23:01,324 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:23:01,324 - INFO - [src.data_preparation] -   SR: 0.0513
2025-05-19 23:23:01,327 - INFO - [src.data_preparation] - Ticker TNB - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'SK', 'ma21_t', 's_d7_t', 'ATR', 'ma7_t', 'insec_t', 'ma14_t', 'PM', 'HL', 'Median_HL', 'variation_t', 'SR']
2025-05-19 23:23:01,416 - INFO - [src.data_preparation] - Ticker TNB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:01,417 - INFO - [src.data_preparation] - Ticker TNB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:01,419 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TNB
2025-05-19 23:23:01,419 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:01,419 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(165), np.int64(1): np.int64(298)}
2025-05-19 23:23:01,419 - INFO - [src.data_preparation] - Generating 133 synthetic minority samples
2025-05-19 23:23:01,426 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (596, 13, 15), y shape: (596,)
2025-05-19 23:23:01,426 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(298), np.int64(1): np.int64(298)}
2025-05-19 23:23:01,430 - INFO - [src.data_preparation] - Ticker TNB - Final 3D shapes: X_train=(596, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:01,430 - INFO - [__main__] - Using best model for TNB: lstm (F1: 0.7606)
2025-05-19 23:23:01,430 - INFO - [__main__] - Loading lstm model for TNB...
2025-05-19 23:23:01,435 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:01,436 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:23:01,437 - INFO - [__main__] - Making predictions for TNB using lstm
2025-05-19 23:23:01,440 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:01,440 - INFO - [__main__] - Successfully got last prediction for TNB
2025-05-19 23:23:01,440 - INFO - [__main__] - 
Processing ticker: TNC
2025-05-19 23:23:01,440 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:01,440 - INFO - [__main__] - Getting last prediction point for ticker: TNC
2025-05-19 23:23:01,441 - INFO - [__main__] - ==================================================
2025-05-19 23:23:01,441 - INFO - [__main__] - Preparing test data for TNC...
2025-05-19 23:23:01,489 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:01,489 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:01,490 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:01,518 - INFO - [src.data_preparation] - Ticker TNC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:01,519 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(366)}
2025-05-19 23:23:01,913 - INFO - [src.data_preparation] - Ticker TNC - Selected features:
2025-05-19 23:23:01,913 - INFO - [src.data_preparation] -   vnipc_t: 0.0786
2025-05-19 23:23:01,913 - INFO - [src.data_preparation] -   SK: 0.0709
2025-05-19 23:23:01,913 - INFO - [src.data_preparation] -   TVV: 0.0687
2025-05-19 23:23:01,913 - INFO - [src.data_preparation] -   Volatility: 0.0679
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   s_d7_t: 0.0615
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   ATR: 0.0601
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   ret: 0.0582
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   ma14_t: 0.0573
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   variation_t: 0.0538
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   SR: 0.0522
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   ma7_t: 0.0510
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   LO: 0.0507
2025-05-19 23:23:01,914 - INFO - [src.data_preparation] -   HL: 0.0503
2025-05-19 23:23:01,917 - INFO - [src.data_preparation] - Ticker TNC - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'Volatility', 'insec_t', 's_d7_t', 'ATR', 'ma21_t', 'ret', 'ma14_t', 'variation_t', 'SR', 'ma7_t', 'LO', 'HL']
2025-05-19 23:23:02,010 - INFO - [src.data_preparation] - Ticker TNC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:02,010 - INFO - [src.data_preparation] - Ticker TNC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:02,012 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TNC
2025-05-19 23:23:02,012 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:02,012 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:23:02,012 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:23:02,015 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:23:02,015 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:23:02,019 - INFO - [src.data_preparation] - Ticker TNC - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:02,019 - INFO - [__main__] - Using best model for TNC: svm (F1: 0.5574)
2025-05-19 23:23:02,019 - INFO - [__main__] - Loading svm model for TNC...
2025-05-19 23:23:02,021 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:02,021 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:23:02,021 - INFO - [__main__] - Making predictions for TNC using svm
2025-05-19 23:23:02,022 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:02,022 - INFO - [__main__] - Successfully got last prediction for TNC
2025-05-19 23:23:02,022 - INFO - [__main__] - 
Processing ticker: TNG
2025-05-19 23:23:02,022 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:02,022 - INFO - [__main__] - Getting last prediction point for ticker: TNG
2025-05-19 23:23:02,022 - INFO - [__main__] - ==================================================
2025-05-19 23:23:02,023 - INFO - [__main__] - Preparing test data for TNG...
2025-05-19 23:23:02,050 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:02,050 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:02,050 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:02,070 - INFO - [src.data_preparation] - Ticker TNG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:02,071 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] - Ticker TNG - Selected features:
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   insec_t: 0.0764
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   TVV: 0.0691
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   s_d7_t: 0.0674
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   SK: 0.0669
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   ATR: 0.0633
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   Volatility: 0.0633
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   vnipc_t: 0.0602
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   ma21_t: 0.0586
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   HL: 0.0567
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   ret: 0.0558
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   LO: 0.0539
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   PM: 0.0521
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   variation_t: 0.0519
2025-05-19 23:23:02,423 - INFO - [src.data_preparation] -   SR: 0.0515
2025-05-19 23:23:02,428 - INFO - [src.data_preparation] - Ticker TNG - Using features: ['Date', 'insec_t', 'TVV', 's_d7_t', 'SK', 'ATR', 'Volatility', 'vnipc_t', 'ma21_t', 'HL', 'ret', 'LO', 'Median_HL', 'PM', 'variation_t', 'SR']
2025-05-19 23:23:02,520 - INFO - [src.data_preparation] - Ticker TNG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:02,520 - INFO - [src.data_preparation] - Ticker TNG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:02,521 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TNG
2025-05-19 23:23:02,522 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:02,522 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(210), np.int64(1): np.int64(253)}
2025-05-19 23:23:02,522 - INFO - [src.data_preparation] - Generating 43 synthetic minority samples
2025-05-19 23:23:02,525 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (506, 13, 15), y shape: (506,)
2025-05-19 23:23:02,525 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(253), np.int64(1): np.int64(253)}
2025-05-19 23:23:02,529 - INFO - [src.data_preparation] - Ticker TNG - Final 3D shapes: X_train=(506, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:02,530 - INFO - [__main__] - Using best model for TNG: svm (F1: 0.6462)
2025-05-19 23:23:02,530 - INFO - [__main__] - Loading svm model for TNG...
2025-05-19 23:23:02,531 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:02,531 - INFO - [__main__] - Model size: 0.76 MB
2025-05-19 23:23:02,531 - INFO - [__main__] - Making predictions for TNG using svm
2025-05-19 23:23:02,532 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:02,532 - INFO - [__main__] - Successfully got last prediction for TNG
2025-05-19 23:23:02,532 - INFO - [__main__] - 
Processing ticker: TNM
2025-05-19 23:23:02,532 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:02,533 - INFO - [__main__] - Getting last prediction point for ticker: TNM
2025-05-19 23:23:02,533 - INFO - [__main__] - ==================================================
2025-05-19 23:23:02,533 - INFO - [__main__] - Preparing test data for TNM...
2025-05-19 23:23:02,561 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:02,561 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:02,561 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:02,580 - INFO - [src.data_preparation] - Ticker TNM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:02,581 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(123), np.int64(1): np.int64(516)}
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] - Ticker TNM - Selected features:
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   vnipc_t: 0.1240
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   Volatility: 0.0770
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   s_d7_t: 0.0736
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   ma14_t: 0.0725
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   ma21_t: 0.0679
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   TVV: 0.0653
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   PM: 0.0638
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   ma7_t: 0.0620
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   ATR: 0.0598
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   SK: 0.0581
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   Median_HL: 0.0555
2025-05-19 23:23:02,827 - INFO - [src.data_preparation] -   ret: 0.0452
2025-05-19 23:23:02,828 - INFO - [src.data_preparation] -   HL: 0.0434
2025-05-19 23:23:02,828 - INFO - [src.data_preparation] -   insec_t: 0.0392
2025-05-19 23:23:02,828 - INFO - [src.data_preparation] -   variation_t: 0.0391
2025-05-19 23:23:02,830 - INFO - [src.data_preparation] - Ticker TNM - Using features: ['Date', 'vnipc_t', 'Volatility', 's_d7_t', 'ma14_t', 'ma21_t', 'TVV', 'PM', 'ma7_t', 'ATR', 'SK', 'Median_HL', 'ret', 'HL', 'insec_t', 'variation_t']
2025-05-19 23:23:02,924 - INFO - [src.data_preparation] - Ticker TNM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:02,924 - INFO - [src.data_preparation] - Ticker TNM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:02,926 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TNM
2025-05-19 23:23:02,926 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:02,926 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(97), np.int64(1): np.int64(366)}
2025-05-19 23:23:02,927 - INFO - [src.data_preparation] - Generating 269 synthetic minority samples
2025-05-19 23:23:02,940 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (732, 13, 15), y shape: (732,)
2025-05-19 23:23:02,940 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(366), np.int64(1): np.int64(366)}
2025-05-19 23:23:02,949 - INFO - [src.data_preparation] - Ticker TNM - Final 3D shapes: X_train=(732, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:02,949 - INFO - [__main__] - Using best model for TNM: svm (F1: 0.9885)
2025-05-19 23:23:02,949 - INFO - [__main__] - Loading svm model for TNM...
2025-05-19 23:23:02,949 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:02,949 - INFO - [__main__] - Model size: 0.63 MB
2025-05-19 23:23:02,949 - INFO - [__main__] - Making predictions for TNM using svm
2025-05-19 23:23:02,949 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:02,949 - INFO - [__main__] - Successfully got last prediction for TNM
2025-05-19 23:23:02,949 - INFO - [__main__] - 
Processing ticker: TNT
2025-05-19 23:23:02,949 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:02,949 - INFO - [__main__] - Getting last prediction point for ticker: TNT
2025-05-19 23:23:02,949 - INFO - [__main__] - ==================================================
2025-05-19 23:23:02,949 - INFO - [__main__] - Preparing test data for TNT...
2025-05-19 23:23:03,025 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:03,025 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:03,025 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:03,048 - INFO - [src.data_preparation] - Ticker TNT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:03,049 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(308), np.int64(1): np.int64(331)}
2025-05-19 23:23:03,384 - INFO - [src.data_preparation] - Ticker TNT - Selected features:
2025-05-19 23:23:03,384 - INFO - [src.data_preparation] -   vnipc_t: 0.0761
2025-05-19 23:23:03,384 - INFO - [src.data_preparation] -   SK: 0.0733
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   s_d7_t: 0.0684
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   insec_t: 0.0650
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   TVV: 0.0648
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   Volatility: 0.0643
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   ATR: 0.0621
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   ma21_t: 0.0579
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   ma14_t: 0.0567
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   ma7_t: 0.0567
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   PM: 0.0549
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   HL: 0.0532
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   SR: 0.0511
2025-05-19 23:23:03,385 - INFO - [src.data_preparation] -   ret: 0.0483
2025-05-19 23:23:03,388 - INFO - [src.data_preparation] - Ticker TNT - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'insec_t', 'TVV', 'Volatility', 'ATR', 'ma21_t', 'ma14_t', 'ma7_t', 'PM', 'HL', 'Median_HL', 'SR', 'ret']
2025-05-19 23:23:03,480 - INFO - [src.data_preparation] - Ticker TNT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:03,480 - INFO - [src.data_preparation] - Ticker TNT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:03,482 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TNT
2025-05-19 23:23:03,482 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:03,482 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(212), np.int64(1): np.int64(251)}
2025-05-19 23:23:03,482 - INFO - [src.data_preparation] - Generating 39 synthetic minority samples
2025-05-19 23:23:03,484 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (502, 13, 15), y shape: (502,)
2025-05-19 23:23:03,484 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(251), np.int64(1): np.int64(251)}
2025-05-19 23:23:03,488 - INFO - [src.data_preparation] - Ticker TNT - Final 3D shapes: X_train=(502, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:03,488 - INFO - [__main__] - Using best model for TNT: logistic_regression (F1: 0.4500)
2025-05-19 23:23:03,488 - INFO - [__main__] - Loading logistic_regression model for TNT...
2025-05-19 23:23:03,489 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:03,489 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:03,489 - INFO - [__main__] - Making predictions for TNT using logistic_regression
2025-05-19 23:23:03,489 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:03,490 - INFO - [__main__] - Successfully got last prediction for TNT
2025-05-19 23:23:03,490 - INFO - [__main__] - 
Processing ticker: TPC
2025-05-19 23:23:03,490 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:03,490 - INFO - [__main__] - Getting last prediction point for ticker: TPC
2025-05-19 23:23:03,491 - INFO - [__main__] - ==================================================
2025-05-19 23:23:03,491 - INFO - [__main__] - Preparing test data for TPC...
2025-05-19 23:23:03,530 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:03,530 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:03,530 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:03,551 - INFO - [src.data_preparation] - Ticker TPC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:03,552 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(366)}
2025-05-19 23:23:03,866 - INFO - [src.data_preparation] - Ticker TPC - Selected features:
2025-05-19 23:23:03,867 - INFO - [src.data_preparation] -   insec_t: 0.0721
2025-05-19 23:23:03,867 - INFO - [src.data_preparation] -   vnipc_t: 0.0684
2025-05-19 23:23:03,867 - INFO - [src.data_preparation] -   ATR: 0.0681
2025-05-19 23:23:03,867 - INFO - [src.data_preparation] -   Volatility: 0.0669
2025-05-19 23:23:03,867 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   TVV: 0.0654
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   SK: 0.0652
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   HL: 0.0635
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   ma14_t: 0.0553
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   LO: 0.0527
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   Median_HL: 0.0524
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   SR: 0.0521
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   ret: 0.0514
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   ma7_t: 0.0512
2025-05-19 23:23:03,868 - INFO - [src.data_preparation] -   ma21_t: 0.0508
2025-05-19 23:23:03,870 - INFO - [src.data_preparation] - Ticker TPC - Using features: ['Date', 'insec_t', 'vnipc_t', 'ATR', 'Volatility', 's_d7_t', 'TVV', 'SK', 'HL', 'ma14_t', 'LO', 'Median_HL', 'SR', 'ret', 'ma7_t', 'ma21_t']
2025-05-19 23:23:03,975 - INFO - [src.data_preparation] - Ticker TPC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:03,975 - INFO - [src.data_preparation] - Ticker TPC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:03,977 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TPC
2025-05-19 23:23:03,978 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:03,978 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:23:03,978 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:23:03,982 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:23:03,982 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:23:03,987 - INFO - [src.data_preparation] - Ticker TPC - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:03,988 - INFO - [__main__] - Using best model for TPC: svm (F1: 0.7778)
2025-05-19 23:23:03,988 - INFO - [__main__] - Loading svm model for TPC...
2025-05-19 23:23:03,990 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:03,990 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:23:03,991 - INFO - [__main__] - Making predictions for TPC using svm
2025-05-19 23:23:03,992 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:03,993 - INFO - [__main__] - Successfully got last prediction for TPC
2025-05-19 23:23:03,993 - INFO - [__main__] - 
Processing ticker: TPH
2025-05-19 23:23:03,993 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:03,993 - INFO - [__main__] - Getting last prediction point for ticker: TPH
2025-05-19 23:23:03,993 - INFO - [__main__] - ==================================================
2025-05-19 23:23:03,993 - INFO - [__main__] - Preparing test data for TPH...
2025-05-19 23:23:04,026 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:04,026 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:04,026 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:04,049 - INFO - [src.data_preparation] - Ticker TPH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:04,049 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(117), np.int64(1): np.int64(522)}
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] - Ticker TPH - Selected features:
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] -   vnipc_t: 0.1073
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] -   ma21_t: 0.0913
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] -   ma14_t: 0.0820
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] -   PM: 0.0745
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] -   ma7_t: 0.0723
2025-05-19 23:23:04,334 - INFO - [src.data_preparation] -   TVV: 0.0715
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   s_d7_t: 0.0713
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   Median_HL: 0.0660
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   ATR: 0.0658
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   Volatility: 0.0580
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   insec_t: 0.0387
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   SR: 0.0319
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   variation_t: 0.0319
2025-05-19 23:23:04,335 - INFO - [src.data_preparation] -   ret: 0.0312
2025-05-19 23:23:04,338 - INFO - [src.data_preparation] - Ticker TPH - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'PM', 'ma7_t', 'TVV', 's_d7_t', 'Median_HL', 'ATR', 'SK', 'Volatility', 'insec_t', 'SR', 'variation_t', 'ret']
2025-05-19 23:23:04,530 - INFO - [src.data_preparation] - Ticker TPH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:04,530 - INFO - [src.data_preparation] - Ticker TPH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:04,531 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TPH
2025-05-19 23:23:04,531 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:04,531 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(78), np.int64(1): np.int64(385)}
2025-05-19 23:23:04,532 - INFO - [src.data_preparation] - Generating 307 synthetic minority samples
2025-05-19 23:23:04,544 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (770, 13, 15), y shape: (770,)
2025-05-19 23:23:04,544 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(385), np.int64(1): np.int64(385)}
2025-05-19 23:23:04,549 - INFO - [src.data_preparation] - Ticker TPH - Final 3D shapes: X_train=(770, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:04,549 - INFO - [__main__] - Using best model for TPH: svm (F1: 0.8718)
2025-05-19 23:23:04,549 - INFO - [__main__] - Loading svm model for TPH...
2025-05-19 23:23:04,551 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:04,551 - INFO - [__main__] - Model size: 0.52 MB
2025-05-19 23:23:04,551 - INFO - [__main__] - Making predictions for TPH using svm
2025-05-19 23:23:04,551 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:04,552 - INFO - [__main__] - Successfully got last prediction for TPH
2025-05-19 23:23:04,552 - INFO - [__main__] - 
Processing ticker: TPP
2025-05-19 23:23:04,552 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:04,552 - INFO - [__main__] - Getting last prediction point for ticker: TPP
2025-05-19 23:23:04,552 - INFO - [__main__] - ==================================================
2025-05-19 23:23:04,552 - INFO - [__main__] - Preparing test data for TPP...
2025-05-19 23:23:04,590 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:04,590 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:04,590 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:04,611 - INFO - [src.data_preparation] - Ticker TPP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:04,612 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(232), np.int64(1): np.int64(407)}
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] - Ticker TPP - Selected features:
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] -   TVV: 0.0896
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] -   Volatility: 0.0724
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] -   ATR: 0.0666
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] -   vnipc_t: 0.0640
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:23:04,917 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   ma14_t: 0.0598
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   HL: 0.0593
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   ma7_t: 0.0556
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   SK: 0.0555
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   insec_t: 0.0541
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   SR: 0.0518
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   LO: 0.0518
2025-05-19 23:23:04,918 - INFO - [src.data_preparation] -   PM: 0.0515
2025-05-19 23:23:04,922 - INFO - [src.data_preparation] - Ticker TPP - Using features: ['Date', 'TVV', 'Volatility', 'ATR', 'vnipc_t', 's_d7_t', 'ma21_t', 'ma14_t', 'HL', 'ma7_t', 'SK', 'insec_t', 'Median_HL', 'SR', 'LO', 'PM']
2025-05-19 23:23:05,012 - INFO - [src.data_preparation] - Ticker TPP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:05,012 - INFO - [src.data_preparation] - Ticker TPP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:05,014 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TPP
2025-05-19 23:23:05,014 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:05,014 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(169), np.int64(1): np.int64(294)}
2025-05-19 23:23:05,014 - INFO - [src.data_preparation] - Generating 125 synthetic minority samples
2025-05-19 23:23:05,019 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (588, 13, 15), y shape: (588,)
2025-05-19 23:23:05,019 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(294), np.int64(1): np.int64(294)}
2025-05-19 23:23:05,023 - INFO - [src.data_preparation] - Ticker TPP - Final 3D shapes: X_train=(588, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:05,024 - INFO - [__main__] - Using best model for TPP: svm (F1: 0.7429)
2025-05-19 23:23:05,024 - INFO - [__main__] - Loading svm model for TPP...
2025-05-19 23:23:05,025 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:05,027 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:23:05,027 - INFO - [__main__] - Making predictions for TPP using svm
2025-05-19 23:23:05,028 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:05,028 - INFO - [__main__] - Successfully got last prediction for TPP
2025-05-19 23:23:05,028 - INFO - [__main__] - 
Processing ticker: TRA
2025-05-19 23:23:05,028 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:05,028 - INFO - [__main__] - Getting last prediction point for ticker: TRA
2025-05-19 23:23:05,028 - INFO - [__main__] - ==================================================
2025-05-19 23:23:05,029 - INFO - [__main__] - Preparing test data for TRA...
2025-05-19 23:23:05,060 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:05,060 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:05,060 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:05,081 - INFO - [src.data_preparation] - Ticker TRA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:05,082 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(295), np.int64(1): np.int64(344)}
2025-05-19 23:23:05,396 - INFO - [src.data_preparation] - Ticker TRA - Selected features:
2025-05-19 23:23:05,397 - INFO - [src.data_preparation] -   vnipc_t: 0.0812
2025-05-19 23:23:05,397 - INFO - [src.data_preparation] -   SK: 0.0671
2025-05-19 23:23:05,397 - INFO - [src.data_preparation] -   Volatility: 0.0663
2025-05-19 23:23:05,397 - INFO - [src.data_preparation] -   TVV: 0.0662
2025-05-19 23:23:05,397 - INFO - [src.data_preparation] -   insec_t: 0.0653
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   HL: 0.0600
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   ATR: 0.0582
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   SR: 0.0573
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   s_d7_t: 0.0557
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   PM: 0.0543
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   ma21_t: 0.0535
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   ma14_t: 0.0534
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   ma7_t: 0.0531
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   LO: 0.0513
2025-05-19 23:23:05,398 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:23:05,399 - INFO - [src.data_preparation] - Ticker TRA - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'TVV', 'insec_t', 'HL', 'ATR', 'SR', 's_d7_t', 'PM', 'ma21_t', 'ma14_t', 'ma7_t', 'LO', 'Median_HL']
2025-05-19 23:23:05,491 - INFO - [src.data_preparation] - Ticker TRA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:05,491 - INFO - [src.data_preparation] - Ticker TRA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:05,493 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TRA
2025-05-19 23:23:05,493 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:05,493 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(260)}
2025-05-19 23:23:05,493 - INFO - [src.data_preparation] - Generating 57 synthetic minority samples
2025-05-19 23:23:05,497 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (520, 13, 15), y shape: (520,)
2025-05-19 23:23:05,497 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(260), np.int64(1): np.int64(260)}
2025-05-19 23:23:05,499 - INFO - [src.data_preparation] - Ticker TRA - Final 3D shapes: X_train=(520, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:05,500 - INFO - [__main__] - Using best model for TRA: svm (F1: 0.6032)
2025-05-19 23:23:05,500 - INFO - [__main__] - Loading svm model for TRA...
2025-05-19 23:23:05,501 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:05,502 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:23:05,502 - INFO - [__main__] - Making predictions for TRA using svm
2025-05-19 23:23:05,502 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:05,503 - INFO - [__main__] - Successfully got last prediction for TRA
2025-05-19 23:23:05,503 - INFO - [__main__] - 
Processing ticker: TRC
2025-05-19 23:23:05,503 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:05,503 - INFO - [__main__] - Getting last prediction point for ticker: TRC
2025-05-19 23:23:05,503 - INFO - [__main__] - ==================================================
2025-05-19 23:23:05,503 - INFO - [__main__] - Preparing test data for TRC...
2025-05-19 23:23:05,532 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:05,532 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:05,532 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:05,554 - INFO - [src.data_preparation] - Ticker TRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:05,554 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:23:05,875 - INFO - [src.data_preparation] - Ticker TRC - Selected features:
2025-05-19 23:23:05,875 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:23:05,875 - INFO - [src.data_preparation] -   TVV: 0.0691
2025-05-19 23:23:05,875 - INFO - [src.data_preparation] -   SK: 0.0668
2025-05-19 23:23:05,875 - INFO - [src.data_preparation] -   Volatility: 0.0649
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   insec_t: 0.0646
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   s_d7_t: 0.0642
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   SR: 0.0627
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   ret: 0.0597
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   HL: 0.0591
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   ATR: 0.0581
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   variation_t: 0.0560
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   LO: 0.0540
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   ma21_t: 0.0526
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   ma7_t: 0.0520
2025-05-19 23:23:05,876 - INFO - [src.data_preparation] -   Median_HL: 0.0480
2025-05-19 23:23:05,880 - INFO - [src.data_preparation] - Ticker TRC - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'Volatility', 'insec_t', 's_d7_t', 'SR', 'ret', 'HL', 'ATR', 'variation_t', 'LO', 'ma21_t', 'ma7_t', 'Median_HL']
2025-05-19 23:23:05,964 - INFO - [src.data_preparation] - Ticker TRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:05,965 - INFO - [src.data_preparation] - Ticker TRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:05,967 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TRC
2025-05-19 23:23:05,967 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:05,967 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:23:05,967 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:23:05,969 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:23:05,970 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:23:05,972 - INFO - [src.data_preparation] - Ticker TRC - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:05,972 - INFO - [__main__] - Using best model for TRC: logistic_regression (F1: 0.4103)
2025-05-19 23:23:05,972 - INFO - [__main__] - Loading logistic_regression model for TRC...
2025-05-19 23:23:05,973 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:05,973 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:05,973 - INFO - [__main__] - Making predictions for TRC using logistic_regression
2025-05-19 23:23:05,973 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:05,973 - INFO - [__main__] - Successfully got last prediction for TRC
2025-05-19 23:23:05,973 - INFO - [__main__] - 
Processing ticker: TS4
2025-05-19 23:23:05,973 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:05,973 - INFO - [__main__] - Getting last prediction point for ticker: TS4
2025-05-19 23:23:05,975 - INFO - [__main__] - ==================================================
2025-05-19 23:23:05,975 - INFO - [__main__] - Preparing test data for TS4...
2025-05-19 23:23:06,027 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:06,027 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:06,027 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:06,047 - INFO - [src.data_preparation] - Ticker TS4 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:06,047 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(263), np.int64(1): np.int64(375)}
2025-05-19 23:23:06,357 - INFO - [src.data_preparation] - Ticker TS4 - Selected features:
2025-05-19 23:23:06,357 - INFO - [src.data_preparation] -   ATR: 0.0845
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   vnipc_t: 0.0733
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   HL: 0.0691
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   s_d7_t: 0.0660
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   TVV: 0.0660
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   Volatility: 0.0655
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   insec_t: 0.0587
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   ma14_t: 0.0582
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   ma21_t: 0.0570
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   Median_HL: 0.0561
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   PM: 0.0547
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   SK: 0.0535
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   SR: 0.0520
2025-05-19 23:23:06,358 - INFO - [src.data_preparation] -   ret: 0.0453
2025-05-19 23:23:06,359 - INFO - [src.data_preparation] -   ma7_t: 0.0452
2025-05-19 23:23:06,362 - INFO - [src.data_preparation] - Ticker TS4 - Using features: ['Date', 'ATR', 'vnipc_t', 'HL', 's_d7_t', 'TVV', 'Volatility', 'insec_t', 'ma14_t', 'ma21_t', 'Median_HL', 'PM', 'SK', 'SR', 'ret', 'ma7_t']
2025-05-19 23:23:06,465 - INFO - [src.data_preparation] - Ticker TS4 - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:06,465 - INFO - [src.data_preparation] - Ticker TS4 - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:06,466 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TS4
2025-05-19 23:23:06,467 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:06,467 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(230)}
2025-05-19 23:23:06,467 - INFO - [src.data_preparation] - Generating 2 synthetic minority samples
2025-05-19 23:23:06,468 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (464, 13, 15), y shape: (464,)
2025-05-19 23:23:06,468 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(232), np.int64(1): np.int64(232)}
2025-05-19 23:23:06,471 - INFO - [src.data_preparation] - Ticker TS4 - Final 3D shapes: X_train=(464, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:06,472 - INFO - [__main__] - Using best model for TS4: logistic_regression (F1: 0.9885)
2025-05-19 23:23:06,473 - INFO - [__main__] - Loading logistic_regression model for TS4...
2025-05-19 23:23:06,473 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:06,474 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:06,474 - INFO - [__main__] - Making predictions for TS4 using logistic_regression
2025-05-19 23:23:06,474 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:06,474 - INFO - [__main__] - Successfully got last prediction for TS4
2025-05-19 23:23:06,474 - INFO - [__main__] - 
Processing ticker: TSB
2025-05-19 23:23:06,474 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:06,474 - INFO - [__main__] - Getting last prediction point for ticker: TSB
2025-05-19 23:23:06,474 - INFO - [__main__] - ==================================================
2025-05-19 23:23:06,474 - INFO - [__main__] - Preparing test data for TSB...
2025-05-19 23:23:06,514 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:06,514 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:06,515 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:06,535 - INFO - [src.data_preparation] - Ticker TSB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:06,535 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(160), np.int64(1): np.int64(479)}
2025-05-19 23:23:06,791 - INFO - [src.data_preparation] - Ticker TSB - Selected features:
2025-05-19 23:23:06,791 - INFO - [src.data_preparation] -   ATR: 0.0919
2025-05-19 23:23:06,791 - INFO - [src.data_preparation] -   s_d7_t: 0.0803
2025-05-19 23:23:06,791 - INFO - [src.data_preparation] -   Median_HL: 0.0744
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   PM: 0.0720
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   vnipc_t: 0.0665
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   ma7_t: 0.0653
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   ma14_t: 0.0639
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   Volatility: 0.0609
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   HL: 0.0604
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   TVV: 0.0560
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   insec_t: 0.0481
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   SR: 0.0479
2025-05-19 23:23:06,792 - INFO - [src.data_preparation] -   SK: 0.0472
2025-05-19 23:23:06,793 - INFO - [src.data_preparation] -   ret: 0.0390
2025-05-19 23:23:06,797 - INFO - [src.data_preparation] - Ticker TSB - Using features: ['Date', 'ATR', 's_d7_t', 'Median_HL', 'PM', 'vnipc_t', 'ma7_t', 'ma14_t', 'Volatility', 'HL', 'ma21_t', 'TVV', 'insec_t', 'SR', 'SK', 'ret']
2025-05-19 23:23:06,906 - INFO - [src.data_preparation] - Ticker TSB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:06,906 - INFO - [src.data_preparation] - Ticker TSB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:06,908 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TSB
2025-05-19 23:23:06,908 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:06,908 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(77), np.int64(1): np.int64(386)}
2025-05-19 23:23:06,908 - INFO - [src.data_preparation] - Generating 309 synthetic minority samples
2025-05-19 23:23:06,921 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (772, 13, 15), y shape: (772,)
2025-05-19 23:23:06,922 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(386), np.int64(1): np.int64(386)}
2025-05-19 23:23:06,926 - INFO - [src.data_preparation] - Ticker TSB - Final 3D shapes: X_train=(772, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:06,927 - INFO - [__main__] - Using best model for TSB: svm (F1: 0.5574)
2025-05-19 23:23:06,927 - INFO - [__main__] - Loading svm model for TSB...
2025-05-19 23:23:06,929 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:06,929 - INFO - [__main__] - Model size: 0.62 MB
2025-05-19 23:23:06,929 - INFO - [__main__] - Making predictions for TSB using svm
2025-05-19 23:23:06,930 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:06,930 - INFO - [__main__] - Successfully got last prediction for TSB
2025-05-19 23:23:06,930 - INFO - [__main__] - 
Processing ticker: TSC
2025-05-19 23:23:06,930 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:06,930 - INFO - [__main__] - Getting last prediction point for ticker: TSC
2025-05-19 23:23:06,930 - INFO - [__main__] - ==================================================
2025-05-19 23:23:06,930 - INFO - [__main__] - Preparing test data for TSC...
2025-05-19 23:23:06,962 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:06,962 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:06,962 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:06,989 - INFO - [src.data_preparation] - Ticker TSC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:06,990 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(306), np.int64(1): np.int64(333)}
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] - Ticker TSC - Selected features:
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   SK: 0.0745
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   vnipc_t: 0.0721
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   TVV: 0.0689
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   ATR: 0.0651
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   insec_t: 0.0626
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   Volatility: 0.0610
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   s_d7_t: 0.0600
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   ma21_t: 0.0578
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   ma14_t: 0.0574
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   SR: 0.0555
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   HL: 0.0547
2025-05-19 23:23:07,374 - INFO - [src.data_preparation] -   ret: 0.0534
2025-05-19 23:23:07,375 - INFO - [src.data_preparation] -   variation_t: 0.0526
2025-05-19 23:23:07,375 - INFO - [src.data_preparation] -   ma7_t: 0.0511
2025-05-19 23:23:07,375 - INFO - [src.data_preparation] -   LO: 0.0502
2025-05-19 23:23:07,379 - INFO - [src.data_preparation] - Ticker TSC - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'ATR', 'insec_t', 'Volatility', 's_d7_t', 'ma21_t', 'ma14_t', 'SR', 'HL', 'ret', 'variation_t', 'ma7_t', 'LO']
2025-05-19 23:23:07,468 - INFO - [src.data_preparation] - Ticker TSC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:07,468 - INFO - [src.data_preparation] - Ticker TSC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:07,470 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TSC
2025-05-19 23:23:07,470 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:07,470 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:23:07,470 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:23:07,472 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:23:07,472 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:23:07,475 - INFO - [src.data_preparation] - Ticker TSC - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:07,475 - INFO - [__main__] - Using best model for TSC: svm (F1: 0.6349)
2025-05-19 23:23:07,475 - INFO - [__main__] - Loading svm model for TSC...
2025-05-19 23:23:07,477 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:07,477 - INFO - [__main__] - Model size: 0.61 MB
2025-05-19 23:23:07,477 - INFO - [__main__] - Making predictions for TSC using svm
2025-05-19 23:23:07,478 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:07,479 - INFO - [__main__] - Successfully got last prediction for TSC
2025-05-19 23:23:07,479 - INFO - [__main__] - 
Processing ticker: TST
2025-05-19 23:23:07,479 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:07,479 - INFO - [__main__] - Getting last prediction point for ticker: TST
2025-05-19 23:23:07,479 - INFO - [__main__] - ==================================================
2025-05-19 23:23:07,479 - INFO - [__main__] - Preparing test data for TST...
2025-05-19 23:23:07,509 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:07,509 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:07,509 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:07,529 - INFO - [src.data_preparation] - Ticker TST - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:07,529 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(226), np.int64(1): np.int64(412)}
2025-05-19 23:23:07,838 - INFO - [src.data_preparation] - Ticker TST - Selected features:
2025-05-19 23:23:07,838 - INFO - [src.data_preparation] -   vnipc_t: 0.0837
2025-05-19 23:23:07,838 - INFO - [src.data_preparation] -   TVV: 0.0774
2025-05-19 23:23:07,838 - INFO - [src.data_preparation] -   SK: 0.0743
2025-05-19 23:23:07,838 - INFO - [src.data_preparation] -   ATR: 0.0649
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   insec_t: 0.0625
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   s_d7_t: 0.0609
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   Volatility: 0.0593
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   HL: 0.0564
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   ma14_t: 0.0563
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   ma21_t: 0.0553
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   ma7_t: 0.0509
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   ret: 0.0492
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   SR: 0.0492
2025-05-19 23:23:07,839 - INFO - [src.data_preparation] -   variation_t: 0.0475
2025-05-19 23:23:07,842 - INFO - [src.data_preparation] - Ticker TST - Using features: ['Date', 'vnipc_t', 'TVV', 'SK', 'ATR', 'insec_t', 's_d7_t', 'Volatility', 'HL', 'ma14_t', 'ma21_t', 'ma7_t', 'Median_HL', 'ret', 'SR', 'variation_t']
2025-05-19 23:23:07,930 - INFO - [src.data_preparation] - Ticker TST - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:23:07,930 - INFO - [src.data_preparation] - Ticker TST - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:07,932 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TST
2025-05-19 23:23:07,932 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:07,932 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(168), np.int64(1): np.int64(295)}
2025-05-19 23:23:07,932 - INFO - [src.data_preparation] - Generating 127 synthetic minority samples
2025-05-19 23:23:07,938 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (590, 13, 15), y shape: (590,)
2025-05-19 23:23:07,939 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(295), np.int64(1): np.int64(295)}
2025-05-19 23:23:07,942 - INFO - [src.data_preparation] - Ticker TST - Final 3D shapes: X_train=(590, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:07,942 - INFO - [__main__] - Using best model for TST: svm (F1: 0.8108)
2025-05-19 23:23:07,942 - INFO - [__main__] - Loading svm model for TST...
2025-05-19 23:23:07,944 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:07,944 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:23:07,944 - INFO - [__main__] - Making predictions for TST using svm
2025-05-19 23:23:07,946 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:07,946 - INFO - [__main__] - Successfully got last prediction for TST
2025-05-19 23:23:07,946 - INFO - [__main__] - 
Processing ticker: TTC
2025-05-19 23:23:07,946 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:07,946 - INFO - [__main__] - Getting last prediction point for ticker: TTC
2025-05-19 23:23:07,946 - INFO - [__main__] - ==================================================
2025-05-19 23:23:07,946 - INFO - [__main__] - Preparing test data for TTC...
2025-05-19 23:23:07,980 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:07,980 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:07,980 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:08,001 - INFO - [src.data_preparation] - Ticker TTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:08,002 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(255), np.int64(1): np.int64(384)}
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] - Ticker TTC - Selected features:
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   vnipc_t: 0.0692
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   insec_t: 0.0670
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   Volatility: 0.0669
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   SK: 0.0665
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   ATR: 0.0657
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   TVV: 0.0630
2025-05-19 23:23:08,304 - INFO - [src.data_preparation] -   s_d7_t: 0.0583
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   ma21_t: 0.0576
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   SR: 0.0574
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   LO: 0.0570
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   PM: 0.0551
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   ma14_t: 0.0539
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:23:08,305 - INFO - [src.data_preparation] -   HL: 0.0532
2025-05-19 23:23:08,308 - INFO - [src.data_preparation] - Ticker TTC - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'SK', 'ATR', 'TVV', 's_d7_t', 'ma7_t', 'ma21_t', 'SR', 'LO', 'PM', 'ma14_t', 'ret', 'HL']
2025-05-19 23:23:08,407 - INFO - [src.data_preparation] - Ticker TTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:08,407 - INFO - [src.data_preparation] - Ticker TTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:08,409 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TTC
2025-05-19 23:23:08,409 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:08,409 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(181), np.int64(1): np.int64(282)}
2025-05-19 23:23:08,409 - INFO - [src.data_preparation] - Generating 101 synthetic minority samples
2025-05-19 23:23:08,414 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:23:08,414 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:23:08,418 - INFO - [src.data_preparation] - Ticker TTC - Final 3D shapes: X_train=(564, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:08,418 - INFO - [__main__] - Using best model for TTC: svm (F1: 0.7246)
2025-05-19 23:23:08,418 - INFO - [__main__] - Loading svm model for TTC...
2025-05-19 23:23:08,419 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:08,420 - INFO - [__main__] - Model size: 0.85 MB
2025-05-19 23:23:08,420 - INFO - [__main__] - Making predictions for TTC using svm
2025-05-19 23:23:08,420 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:08,422 - INFO - [__main__] - Successfully got last prediction for TTC
2025-05-19 23:23:08,422 - INFO - [__main__] - 
Processing ticker: TTF
2025-05-19 23:23:08,422 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:08,422 - INFO - [__main__] - Getting last prediction point for ticker: TTF
2025-05-19 23:23:08,422 - INFO - [__main__] - ==================================================
2025-05-19 23:23:08,422 - INFO - [__main__] - Preparing test data for TTF...
2025-05-19 23:23:08,457 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:08,457 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:08,457 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:08,475 - INFO - [src.data_preparation] - Ticker TTF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:08,475 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:23:08,808 - INFO - [src.data_preparation] - Ticker TTF - Selected features:
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   SK: 0.0755
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   TVV: 0.0648
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   vnipc_t: 0.0646
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   Volatility: 0.0623
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   insec_t: 0.0602
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   ma7_t: 0.0590
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   s_d7_t: 0.0579
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   ma21_t: 0.0576
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   ATR: 0.0563
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   ma14_t: 0.0558
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   Median_HL: 0.0555
2025-05-19 23:23:08,809 - INFO - [src.data_preparation] -   HL: 0.0549
2025-05-19 23:23:08,810 - INFO - [src.data_preparation] -   variation_t: 0.0545
2025-05-19 23:23:08,810 - INFO - [src.data_preparation] -   ret: 0.0510
2025-05-19 23:23:08,813 - INFO - [src.data_preparation] - Ticker TTF - Using features: ['Date', 'SK', 'TVV', 'vnipc_t', 'Volatility', 'insec_t', 'ma7_t', 'PM', 's_d7_t', 'ma21_t', 'ATR', 'ma14_t', 'Median_HL', 'HL', 'variation_t', 'ret']
2025-05-19 23:23:08,904 - INFO - [src.data_preparation] - Ticker TTF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:08,904 - INFO - [src.data_preparation] - Ticker TTF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:08,905 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TTF
2025-05-19 23:23:08,906 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:08,906 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:23:08,906 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:23:08,909 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:23:08,909 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:23:08,912 - INFO - [src.data_preparation] - Ticker TTF - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:08,913 - INFO - [__main__] - Using best model for TTF: svm (F1: 0.5098)
2025-05-19 23:23:08,913 - INFO - [__main__] - Loading svm model for TTF...
2025-05-19 23:23:08,914 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:08,915 - INFO - [__main__] - Model size: 0.55 MB
2025-05-19 23:23:08,915 - INFO - [__main__] - Making predictions for TTF using svm
2025-05-19 23:23:08,915 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:08,916 - INFO - [__main__] - Successfully got last prediction for TTF
2025-05-19 23:23:08,916 - INFO - [__main__] - 
Processing ticker: TTG
2025-05-19 23:23:08,916 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:08,916 - INFO - [__main__] - Getting last prediction point for ticker: TTG
2025-05-19 23:23:08,916 - INFO - [__main__] - ==================================================
2025-05-19 23:23:08,916 - INFO - [__main__] - Preparing test data for TTG...
2025-05-19 23:23:08,942 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:08,942 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:08,942 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:08,964 - INFO - [src.data_preparation] - Ticker TTG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:08,964 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(182), np.int64(1): np.int64(457)}
2025-05-19 23:23:09,291 - INFO - [src.data_preparation] - Ticker TTG - Selected features:
2025-05-19 23:23:09,291 - INFO - [src.data_preparation] -   vnipc_t: 0.0875
2025-05-19 23:23:09,291 - INFO - [src.data_preparation] -   TVV: 0.0875
2025-05-19 23:23:09,291 - INFO - [src.data_preparation] -   ATR: 0.0735
2025-05-19 23:23:09,291 - INFO - [src.data_preparation] -   ma7_t: 0.0682
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   ma21_t: 0.0682
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   Volatility: 0.0657
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   s_d7_t: 0.0652
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   ma14_t: 0.0646
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   SK: 0.0563
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   Median_HL: 0.0502
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   insec_t: 0.0484
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   variation_t: 0.0465
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   ret: 0.0462
2025-05-19 23:23:09,292 - INFO - [src.data_preparation] -   HL: 0.0455
2025-05-19 23:23:09,297 - INFO - [src.data_preparation] - Ticker TTG - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'ma7_t', 'ma21_t', 'Volatility', 's_d7_t', 'ma14_t', 'SK', 'PM', 'Median_HL', 'insec_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:23:09,436 - INFO - [src.data_preparation] - Ticker TTG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:09,437 - INFO - [src.data_preparation] - Ticker TTG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:09,439 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TTG
2025-05-19 23:23:09,439 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:09,439 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(110), np.int64(1): np.int64(353)}
2025-05-19 23:23:09,440 - INFO - [src.data_preparation] - Generating 243 synthetic minority samples
2025-05-19 23:23:09,450 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (706, 13, 15), y shape: (706,)
2025-05-19 23:23:09,451 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(353), np.int64(1): np.int64(353)}
2025-05-19 23:23:09,455 - INFO - [src.data_preparation] - Ticker TTG - Final 3D shapes: X_train=(706, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:09,456 - INFO - [__main__] - Using best model for TTG: svm (F1: 0.7945)
2025-05-19 23:23:09,456 - INFO - [__main__] - Loading svm model for TTG...
2025-05-19 23:23:09,458 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:09,459 - INFO - [__main__] - Model size: 1.06 MB
2025-05-19 23:23:09,459 - INFO - [__main__] - Making predictions for TTG using svm
2025-05-19 23:23:09,460 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:09,460 - INFO - [__main__] - Successfully got last prediction for TTG
2025-05-19 23:23:09,460 - INFO - [__main__] - 
Processing ticker: TV1
2025-05-19 23:23:09,460 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:09,460 - INFO - [__main__] - Getting last prediction point for ticker: TV1
2025-05-19 23:23:09,460 - INFO - [__main__] - ==================================================
2025-05-19 23:23:09,460 - INFO - [__main__] - Preparing test data for TV1...
2025-05-19 23:23:09,494 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:09,494 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:09,494 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:09,516 - INFO - [src.data_preparation] - Ticker TV1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:09,516 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(278), np.int64(1): np.int64(361)}
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] - Ticker TV1 - Selected features:
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   vnipc_t: 0.0749
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   s_d7_t: 0.0688
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   insec_t: 0.0659
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   TVV: 0.0636
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   SK: 0.0634
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   Volatility: 0.0633
2025-05-19 23:23:09,843 - INFO - [src.data_preparation] -   ATR: 0.0630
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   LO: 0.0551
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   HL: 0.0538
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   ma21_t: 0.0528
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   ma14_t: 0.0513
2025-05-19 23:23:09,844 - INFO - [src.data_preparation] -   SR: 0.0509
2025-05-19 23:23:09,850 - INFO - [src.data_preparation] - Ticker TV1 - Using features: ['Date', 'vnipc_t', 's_d7_t', 'insec_t', 'TVV', 'SK', 'Volatility', 'ATR', 'Median_HL', 'LO', 'ret', 'HL', 'variation_t', 'ma21_t', 'ma14_t', 'SR']
2025-05-19 23:23:09,940 - INFO - [src.data_preparation] - Ticker TV1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:09,941 - INFO - [src.data_preparation] - Ticker TV1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:09,942 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TV1
2025-05-19 23:23:09,942 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:09,942 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(197), np.int64(1): np.int64(266)}
2025-05-19 23:23:09,942 - INFO - [src.data_preparation] - Generating 69 synthetic minority samples
2025-05-19 23:23:09,945 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:23:09,945 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:23:09,950 - INFO - [src.data_preparation] - Ticker TV1 - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:09,950 - INFO - [__main__] - Using best model for TV1: svm (F1: 0.6462)
2025-05-19 23:23:09,950 - INFO - [__main__] - Loading svm model for TV1...
2025-05-19 23:23:09,952 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:09,953 - INFO - [__main__] - Model size: 0.80 MB
2025-05-19 23:23:09,953 - INFO - [__main__] - Making predictions for TV1 using svm
2025-05-19 23:23:09,954 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:09,954 - INFO - [__main__] - Successfully got last prediction for TV1
2025-05-19 23:23:09,954 - INFO - [__main__] - 
Processing ticker: TV2
2025-05-19 23:23:09,954 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:09,955 - INFO - [__main__] - Getting last prediction point for ticker: TV2
2025-05-19 23:23:09,955 - INFO - [__main__] - ==================================================
2025-05-19 23:23:09,955 - INFO - [__main__] - Preparing test data for TV2...
2025-05-19 23:23:09,993 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:09,993 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:09,993 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:10,017 - INFO - [src.data_preparation] - Ticker TV2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:10,017 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:23:10,321 - INFO - [src.data_preparation] - Ticker TV2 - Selected features:
2025-05-19 23:23:10,321 - INFO - [src.data_preparation] -   Volatility: 0.0782
2025-05-19 23:23:10,321 - INFO - [src.data_preparation] -   SK: 0.0730
2025-05-19 23:23:10,321 - INFO - [src.data_preparation] -   TVV: 0.0649
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   ATR: 0.0645
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   s_d7_t: 0.0633
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   vnipc_t: 0.0612
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   insec_t: 0.0606
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   PM: 0.0545
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   ret: 0.0544
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   ma7_t: 0.0541
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   LO: 0.0532
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   ma14_t: 0.0524
2025-05-19 23:23:10,322 - INFO - [src.data_preparation] -   variation_t: 0.0520
2025-05-19 23:23:10,325 - INFO - [src.data_preparation] - Ticker TV2 - Using features: ['Date', 'Volatility', 'SK', 'TVV', 'ATR', 's_d7_t', 'vnipc_t', 'insec_t', 'ma21_t', 'SR', 'PM', 'ret', 'ma7_t', 'LO', 'ma14_t', 'variation_t']
2025-05-19 23:23:10,415 - INFO - [src.data_preparation] - Ticker TV2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:10,415 - INFO - [src.data_preparation] - Ticker TV2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:10,417 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TV2
2025-05-19 23:23:10,417 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:10,417 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(191), np.int64(1): np.int64(272)}
2025-05-19 23:23:10,417 - INFO - [src.data_preparation] - Generating 81 synthetic minority samples
2025-05-19 23:23:10,421 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (544, 13, 15), y shape: (544,)
2025-05-19 23:23:10,421 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(272), np.int64(1): np.int64(272)}
2025-05-19 23:23:10,424 - INFO - [src.data_preparation] - Ticker TV2 - Final 3D shapes: X_train=(544, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:10,425 - INFO - [__main__] - Using best model for TV2: svm (F1: 0.6032)
2025-05-19 23:23:10,425 - INFO - [__main__] - Loading svm model for TV2...
2025-05-19 23:23:10,427 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:10,428 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:23:10,428 - INFO - [__main__] - Making predictions for TV2 using svm
2025-05-19 23:23:10,428 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:10,429 - INFO - [__main__] - Successfully got last prediction for TV2
2025-05-19 23:23:10,429 - INFO - [__main__] - 
Processing ticker: TV3
2025-05-19 23:23:10,429 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:10,429 - INFO - [__main__] - Getting last prediction point for ticker: TV3
2025-05-19 23:23:10,429 - INFO - [__main__] - ==================================================
2025-05-19 23:23:10,429 - INFO - [__main__] - Preparing test data for TV3...
2025-05-19 23:23:10,468 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:10,468 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:10,468 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:10,493 - INFO - [src.data_preparation] - Ticker TV3 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:10,493 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(268), np.int64(1): np.int64(371)}
2025-05-19 23:23:10,793 - INFO - [src.data_preparation] - Ticker TV3 - Selected features:
2025-05-19 23:23:10,793 - INFO - [src.data_preparation] -   vnipc_t: 0.0769
2025-05-19 23:23:10,793 - INFO - [src.data_preparation] -   SK: 0.0684
2025-05-19 23:23:10,793 - INFO - [src.data_preparation] -   TVV: 0.0644
2025-05-19 23:23:10,793 - INFO - [src.data_preparation] -   Median_HL: 0.0622
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   ATR: 0.0620
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   PM: 0.0618
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   HL: 0.0595
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   ma14_t: 0.0586
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   s_d7_t: 0.0578
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   insec_t: 0.0571
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   SR: 0.0563
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   ma21_t: 0.0547
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   Volatility: 0.0530
2025-05-19 23:23:10,794 - INFO - [src.data_preparation] -   ret: 0.0513
2025-05-19 23:23:10,798 - INFO - [src.data_preparation] - Ticker TV3 - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'Median_HL', 'ATR', 'PM', 'HL', 'ma14_t', 's_d7_t', 'insec_t', 'SR', 'ma21_t', 'ma7_t', 'Volatility', 'ret']
2025-05-19 23:23:10,914 - INFO - [src.data_preparation] - Ticker TV3 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:10,914 - INFO - [src.data_preparation] - Ticker TV3 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:10,916 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TV3
2025-05-19 23:23:10,916 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:10,916 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(188), np.int64(1): np.int64(275)}
2025-05-19 23:23:10,916 - INFO - [src.data_preparation] - Generating 87 synthetic minority samples
2025-05-19 23:23:10,921 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:23:10,922 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:23:10,925 - INFO - [src.data_preparation] - Ticker TV3 - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:10,925 - INFO - [__main__] - Using best model for TV3: svm (F1: 0.6667)
2025-05-19 23:23:10,925 - INFO - [__main__] - Loading svm model for TV3...
2025-05-19 23:23:10,927 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:10,927 - INFO - [__main__] - Model size: 0.83 MB
2025-05-19 23:23:10,927 - INFO - [__main__] - Making predictions for TV3 using svm
2025-05-19 23:23:10,928 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:10,928 - INFO - [__main__] - Successfully got last prediction for TV3
2025-05-19 23:23:10,929 - INFO - [__main__] - 
Processing ticker: TV4
2025-05-19 23:23:10,929 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:10,929 - INFO - [__main__] - Getting last prediction point for ticker: TV4
2025-05-19 23:23:10,929 - INFO - [__main__] - ==================================================
2025-05-19 23:23:10,929 - INFO - [__main__] - Preparing test data for TV4...
2025-05-19 23:23:10,968 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:10,969 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:10,969 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:10,988 - INFO - [src.data_preparation] - Ticker TV4 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:10,988 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(246), np.int64(1): np.int64(393)}
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] - Ticker TV4 - Selected features:
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   TVV: 0.0757
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   insec_t: 0.0740
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   vnipc_t: 0.0713
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   ATR: 0.0690
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   Volatility: 0.0685
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   HL: 0.0661
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   s_d7_t: 0.0654
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   LO: 0.0554
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   ma14_t: 0.0528
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   variation_t: 0.0517
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   ma7_t: 0.0496
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   ret: 0.0487
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   PM: 0.0484
2025-05-19 23:23:11,315 - INFO - [src.data_preparation] -   ma21_t: 0.0482
2025-05-19 23:23:11,318 - INFO - [src.data_preparation] - Ticker TV4 - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 'ATR', 'Volatility', 'HL', 's_d7_t', 'SK', 'LO', 'ma14_t', 'variation_t', 'ma7_t', 'ret', 'PM', 'ma21_t']
2025-05-19 23:23:11,417 - INFO - [src.data_preparation] - Ticker TV4 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:11,417 - INFO - [src.data_preparation] - Ticker TV4 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:11,420 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TV4
2025-05-19 23:23:11,420 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:11,420 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(179), np.int64(1): np.int64(284)}
2025-05-19 23:23:11,420 - INFO - [src.data_preparation] - Generating 105 synthetic minority samples
2025-05-19 23:23:11,425 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (568, 13, 15), y shape: (568,)
2025-05-19 23:23:11,425 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(284), np.int64(1): np.int64(284)}
2025-05-19 23:23:11,429 - INFO - [src.data_preparation] - Ticker TV4 - Final 3D shapes: X_train=(568, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:11,430 - INFO - [__main__] - Using best model for TV4: svm (F1: 0.8267)
2025-05-19 23:23:11,430 - INFO - [__main__] - Loading svm model for TV4...
2025-05-19 23:23:11,432 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:11,434 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:23:11,434 - INFO - [__main__] - Making predictions for TV4 using svm
2025-05-19 23:23:11,435 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:11,436 - INFO - [__main__] - Successfully got last prediction for TV4
2025-05-19 23:23:11,436 - INFO - [__main__] - 
Processing ticker: TVD
2025-05-19 23:23:11,437 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:11,437 - INFO - [__main__] - Getting last prediction point for ticker: TVD
2025-05-19 23:23:11,437 - INFO - [__main__] - ==================================================
2025-05-19 23:23:11,437 - INFO - [__main__] - Preparing test data for TVD...
2025-05-19 23:23:11,472 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:11,473 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:11,473 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:11,493 - INFO - [src.data_preparation] - Ticker TVD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:11,494 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(366)}
2025-05-19 23:23:11,821 - INFO - [src.data_preparation] - Ticker TVD - Selected features:
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   Volatility: 0.0719
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   vnipc_t: 0.0713
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   TVV: 0.0694
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   insec_t: 0.0648
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   HL: 0.0643
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   LO: 0.0541
2025-05-19 23:23:11,822 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:23:11,823 - INFO - [src.data_preparation] -   PM: 0.0517
2025-05-19 23:23:11,823 - INFO - [src.data_preparation] -   ma7_t: 0.0503
2025-05-19 23:23:11,823 - INFO - [src.data_preparation] -   ma21_t: 0.0493
2025-05-19 23:23:11,823 - INFO - [src.data_preparation] -   variation_t: 0.0487
2025-05-19 23:23:11,823 - INFO - [src.data_preparation] -   SR: 0.0474
2025-05-19 23:23:11,825 - INFO - [src.data_preparation] - Ticker TVD - Using features: ['Date', 'Volatility', 'vnipc_t', 'TVV', 'ATR', 'insec_t', 'HL', 's_d7_t', 'SK', 'LO', 'ret', 'PM', 'ma7_t', 'ma21_t', 'variation_t', 'SR']
2025-05-19 23:23:11,913 - INFO - [src.data_preparation] - Ticker TVD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:11,914 - INFO - [src.data_preparation] - Ticker TVD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:11,917 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TVD
2025-05-19 23:23:11,917 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:11,917 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:23:11,917 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:23:11,920 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:23:11,920 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:23:11,923 - INFO - [src.data_preparation] - Ticker TVD - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:11,923 - INFO - [__main__] - Using best model for TVD: logistic_regression (F1: 0.5806)
2025-05-19 23:23:11,923 - INFO - [__main__] - Loading logistic_regression model for TVD...
2025-05-19 23:23:11,925 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:11,925 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:11,925 - INFO - [__main__] - Making predictions for TVD using logistic_regression
2025-05-19 23:23:11,925 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:11,925 - INFO - [__main__] - Successfully got last prediction for TVD
2025-05-19 23:23:11,925 - INFO - [__main__] - 
Processing ticker: TVG
2025-05-19 23:23:11,925 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:11,925 - INFO - [__main__] - Getting last prediction point for ticker: TVG
2025-05-19 23:23:11,925 - INFO - [__main__] - ==================================================
2025-05-19 23:23:11,925 - INFO - [__main__] - Preparing test data for TVG...
2025-05-19 23:23:11,955 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:11,956 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:11,956 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:11,975 - INFO - [src.data_preparation] - Ticker TVG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:11,975 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(16), np.int64(1): np.int64(623)}
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] - Ticker TVG - Selected features:
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   vnipc_t: 0.2493
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   ma21_t: 0.1500
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   ma14_t: 0.1262
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   ma7_t: 0.0996
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   PM: 0.0686
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   Median_HL: 0.0615
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   s_d7_t: 0.0412
2025-05-19 23:23:12,143 - INFO - [src.data_preparation] -   ATR: 0.0350
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   ret: 0.0326
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   Volatility: 0.0290
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   TVV: 0.0266
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   SK: 0.0223
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   SR: 0.0214
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   variation_t: 0.0203
2025-05-19 23:23:12,144 - INFO - [src.data_preparation] -   HL: 0.0122
2025-05-19 23:23:12,147 - INFO - [src.data_preparation] - Ticker TVG - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'PM', 'Median_HL', 's_d7_t', 'ATR', 'ret', 'Volatility', 'TVV', 'SK', 'SR', 'variation_t', 'HL']
2025-05-19 23:23:12,233 - INFO - [src.data_preparation] - Ticker TVG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:12,233 - INFO - [src.data_preparation] - Ticker TVG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:12,235 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE for ticker TVG - insufficient samples per class or only one class
2025-05-19 23:23:12,238 - INFO - [src.data_preparation] - Ticker TVG - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:12,239 - INFO - [__main__] - Using best model for TVG: lstm (F1: 0.9885)
2025-05-19 23:23:12,239 - INFO - [__main__] - Loading lstm model for TVG...
2025-05-19 23:23:12,243 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:12,245 - INFO - [__main__] - Model size: 0.26 MB
2025-05-19 23:23:12,245 - INFO - [__main__] - Making predictions for TVG using lstm
2025-05-19 23:23:12,249 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:12,249 - INFO - [__main__] - Successfully got last prediction for TVG
2025-05-19 23:23:12,249 - INFO - [__main__] - 
Processing ticker: TXM
2025-05-19 23:23:12,249 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:12,249 - INFO - [__main__] - Getting last prediction point for ticker: TXM
2025-05-19 23:23:12,249 - INFO - [__main__] - ==================================================
2025-05-19 23:23:12,249 - INFO - [__main__] - Preparing test data for TXM...
2025-05-19 23:23:12,279 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:12,279 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:12,279 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:12,304 - INFO - [src.data_preparation] - Ticker TXM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:12,304 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:23:12,666 - INFO - [src.data_preparation] - Ticker TXM - Selected features:
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   TVV: 0.0732
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   insec_t: 0.0682
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   ATR: 0.0665
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   Volatility: 0.0664
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   s_d7_t: 0.0662
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   HL: 0.0642
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   ret: 0.0629
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   SK: 0.0611
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   vnipc_t: 0.0600
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   ma14_t: 0.0525
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   ma21_t: 0.0520
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   variation_t: 0.0511
2025-05-19 23:23:12,667 - INFO - [src.data_preparation] -   Median_HL: 0.0505
2025-05-19 23:23:12,668 - INFO - [src.data_preparation] -   ma7_t: 0.0505
2025-05-19 23:23:12,671 - INFO - [src.data_preparation] - Ticker TXM - Using features: ['Date', 'TVV', 'insec_t', 'ATR', 'Volatility', 's_d7_t', 'HL', 'ret', 'SK', 'vnipc_t', 'PM', 'ma14_t', 'ma21_t', 'variation_t', 'Median_HL', 'ma7_t']
2025-05-19 23:23:12,762 - INFO - [src.data_preparation] - Ticker TXM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:12,763 - INFO - [src.data_preparation] - Ticker TXM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:12,764 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TXM
2025-05-19 23:23:12,765 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:12,765 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(259)}
2025-05-19 23:23:12,765 - INFO - [src.data_preparation] - Generating 55 synthetic minority samples
2025-05-19 23:23:12,769 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (518, 13, 15), y shape: (518,)
2025-05-19 23:23:12,769 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(259), np.int64(1): np.int64(259)}
2025-05-19 23:23:12,772 - INFO - [src.data_preparation] - Ticker TXM - Final 3D shapes: X_train=(518, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:12,773 - INFO - [__main__] - Using best model for TXM: svm (F1: 0.6250)
2025-05-19 23:23:12,773 - INFO - [__main__] - Loading svm model for TXM...
2025-05-19 23:23:12,775 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:12,775 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:23:12,775 - INFO - [__main__] - Making predictions for TXM using svm
2025-05-19 23:23:12,776 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:12,776 - INFO - [__main__] - Successfully got last prediction for TXM
2025-05-19 23:23:12,776 - INFO - [__main__] - 
Processing ticker: TYA
2025-05-19 23:23:12,776 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:12,776 - INFO - [__main__] - Getting last prediction point for ticker: TYA
2025-05-19 23:23:12,776 - INFO - [__main__] - ==================================================
2025-05-19 23:23:12,777 - INFO - [__main__] - Preparing test data for TYA...
2025-05-19 23:23:12,818 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:12,819 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:12,819 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:12,840 - INFO - [src.data_preparation] - Ticker TYA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:12,840 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:23:13,158 - INFO - [src.data_preparation] - Ticker TYA - Selected features:
2025-05-19 23:23:13,158 - INFO - [src.data_preparation] -   Volatility: 0.0774
2025-05-19 23:23:13,158 - INFO - [src.data_preparation] -   vnipc_t: 0.0725
2025-05-19 23:23:13,158 - INFO - [src.data_preparation] -   TVV: 0.0707
2025-05-19 23:23:13,158 - INFO - [src.data_preparation] -   insec_t: 0.0697
2025-05-19 23:23:13,158 - INFO - [src.data_preparation] -   SK: 0.0666
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   ret: 0.0602
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   s_d7_t: 0.0583
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   HL: 0.0583
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   SR: 0.0568
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   ATR: 0.0553
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   LO: 0.0551
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   ma21_t: 0.0521
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   ma14_t: 0.0506
2025-05-19 23:23:13,159 - INFO - [src.data_preparation] -   ma7_t: 0.0483
2025-05-19 23:23:13,162 - INFO - [src.data_preparation] - Ticker TYA - Using features: ['Date', 'Volatility', 'vnipc_t', 'TVV', 'insec_t', 'SK', 'ret', 's_d7_t', 'HL', 'SR', 'variation_t', 'ATR', 'LO', 'ma21_t', 'ma14_t', 'ma7_t']
2025-05-19 23:23:13,265 - INFO - [src.data_preparation] - Ticker TYA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:13,266 - INFO - [src.data_preparation] - Ticker TYA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:13,269 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker TYA
2025-05-19 23:23:13,269 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:13,270 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(192), np.int64(1): np.int64(271)}
2025-05-19 23:23:13,270 - INFO - [src.data_preparation] - Generating 79 synthetic minority samples
2025-05-19 23:23:13,274 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (542, 13, 15), y shape: (542,)
2025-05-19 23:23:13,274 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(271), np.int64(1): np.int64(271)}
2025-05-19 23:23:13,278 - INFO - [src.data_preparation] - Ticker TYA - Final 3D shapes: X_train=(542, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:13,278 - INFO - [__main__] - Using best model for TYA: lstm (F1: 0.7606)
2025-05-19 23:23:13,279 - INFO - [__main__] - Loading lstm model for TYA...
2025-05-19 23:23:13,284 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:13,287 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:23:13,287 - INFO - [__main__] - Making predictions for TYA using lstm
2025-05-19 23:23:13,289 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:13,290 - INFO - [__main__] - Successfully got last prediction for TYA
2025-05-19 23:23:13,290 - INFO - [__main__] - 
Processing ticker: UDC
2025-05-19 23:23:13,290 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:13,290 - INFO - [__main__] - Getting last prediction point for ticker: UDC
2025-05-19 23:23:13,291 - INFO - [__main__] - ==================================================
2025-05-19 23:23:13,291 - INFO - [__main__] - Preparing test data for UDC...
2025-05-19 23:23:13,361 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:13,361 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:13,361 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:13,393 - INFO - [src.data_preparation] - Ticker UDC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:13,393 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(316), np.int64(1): np.int64(322)}
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] - Ticker UDC - Selected features:
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] -   vnipc_t: 0.0884
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] -   SK: 0.0692
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] -   insec_t: 0.0666
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] -   TVV: 0.0644
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] -   ma21_t: 0.0636
2025-05-19 23:23:13,754 - INFO - [src.data_preparation] -   s_d7_t: 0.0633
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   ma14_t: 0.0616
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   Volatility: 0.0605
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   ATR: 0.0570
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   ma7_t: 0.0520
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   ret: 0.0514
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   LO: 0.0511
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   Median_HL: 0.0492
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   HL: 0.0486
2025-05-19 23:23:13,755 - INFO - [src.data_preparation] -   PM: 0.0483
2025-05-19 23:23:13,758 - INFO - [src.data_preparation] - Ticker UDC - Using features: ['Date', 'vnipc_t', 'SK', 'insec_t', 'TVV', 'ma21_t', 's_d7_t', 'ma14_t', 'Volatility', 'ATR', 'ma7_t', 'ret', 'LO', 'Median_HL', 'HL', 'PM']
2025-05-19 23:23:13,874 - INFO - [src.data_preparation] - Ticker UDC - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:23:13,874 - INFO - [src.data_preparation] - Ticker UDC - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:13,876 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker UDC
2025-05-19 23:23:13,876 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:13,876 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(220), np.int64(1): np.int64(243)}
2025-05-19 23:23:13,876 - INFO - [src.data_preparation] - Generating 23 synthetic minority samples
2025-05-19 23:23:13,878 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (486, 13, 15), y shape: (486,)
2025-05-19 23:23:13,878 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(243), np.int64(1): np.int64(243)}
2025-05-19 23:23:13,881 - INFO - [src.data_preparation] - Ticker UDC - Final 3D shapes: X_train=(486, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:13,881 - INFO - [__main__] - Using best model for UDC: lstm (F1: 0.5385)
2025-05-19 23:23:13,882 - INFO - [__main__] - Loading lstm model for UDC...
2025-05-19 23:23:13,887 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:13,888 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:23:13,888 - INFO - [__main__] - Making predictions for UDC using lstm
2025-05-19 23:23:13,889 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:13,890 - INFO - [__main__] - Successfully got last prediction for UDC
2025-05-19 23:23:13,890 - INFO - [__main__] - 
Processing ticker: UDJ
2025-05-19 23:23:13,890 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:13,890 - INFO - [__main__] - Getting last prediction point for ticker: UDJ
2025-05-19 23:23:13,890 - INFO - [__main__] - ==================================================
2025-05-19 23:23:13,890 - INFO - [__main__] - Preparing test data for UDJ...
2025-05-19 23:23:13,937 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:13,937 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:13,937 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:13,964 - INFO - [src.data_preparation] - Ticker UDJ - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:13,964 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(241), np.int64(1): np.int64(398)}
2025-05-19 23:23:14,401 - INFO - [src.data_preparation] - Ticker UDJ - Selected features:
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   vnipc_t: 0.0788
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   insec_t: 0.0734
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   ATR: 0.0716
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   TVV: 0.0714
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   SK: 0.0667
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   Volatility: 0.0610
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   ma21_t: 0.0566
2025-05-19 23:23:14,402 - INFO - [src.data_preparation] -   HL: 0.0539
2025-05-19 23:23:14,403 - INFO - [src.data_preparation] -   ret: 0.0537
2025-05-19 23:23:14,403 - INFO - [src.data_preparation] -   ma14_t: 0.0534
2025-05-19 23:23:14,403 - INFO - [src.data_preparation] -   variation_t: 0.0506
2025-05-19 23:23:14,403 - INFO - [src.data_preparation] -   LO: 0.0497
2025-05-19 23:23:14,403 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:23:14,403 - INFO - [src.data_preparation] -   ma7_t: 0.0492
2025-05-19 23:23:14,405 - INFO - [src.data_preparation] - Ticker UDJ - Using features: ['Date', 'vnipc_t', 'insec_t', 'ATR', 'TVV', 'SK', 's_d7_t', 'Volatility', 'ma21_t', 'HL', 'ret', 'ma14_t', 'variation_t', 'LO', 'PM', 'ma7_t']
2025-05-19 23:23:14,494 - INFO - [src.data_preparation] - Ticker UDJ - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:14,494 - INFO - [src.data_preparation] - Ticker UDJ - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:14,496 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker UDJ
2025-05-19 23:23:14,496 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:14,496 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:23:14,496 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:23:14,503 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:23:14,504 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:23:14,507 - INFO - [src.data_preparation] - Ticker UDJ - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:14,508 - INFO - [__main__] - Using best model for UDJ: svm (F1: 0.7429)
2025-05-19 23:23:14,508 - INFO - [__main__] - Loading svm model for UDJ...
2025-05-19 23:23:14,509 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:14,510 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:23:14,510 - INFO - [__main__] - Making predictions for UDJ using svm
2025-05-19 23:23:14,511 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:14,511 - INFO - [__main__] - Successfully got last prediction for UDJ
2025-05-19 23:23:14,511 - INFO - [__main__] - 
Processing ticker: UIC
2025-05-19 23:23:14,511 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:14,511 - INFO - [__main__] - Getting last prediction point for ticker: UIC
2025-05-19 23:23:14,511 - INFO - [__main__] - ==================================================
2025-05-19 23:23:14,511 - INFO - [__main__] - Preparing test data for UIC...
2025-05-19 23:23:14,545 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:14,545 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:14,545 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:14,565 - INFO - [src.data_preparation] - Ticker UIC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:14,565 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:23:14,941 - INFO - [src.data_preparation] - Ticker UIC - Selected features:
2025-05-19 23:23:14,941 - INFO - [src.data_preparation] -   insec_t: 0.0688
2025-05-19 23:23:14,941 - INFO - [src.data_preparation] -   SK: 0.0672
2025-05-19 23:23:14,941 - INFO - [src.data_preparation] -   s_d7_t: 0.0670
2025-05-19 23:23:14,941 - INFO - [src.data_preparation] -   vnipc_t: 0.0669
2025-05-19 23:23:14,941 - INFO - [src.data_preparation] -   ret: 0.0658
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   ATR: 0.0651
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   LO: 0.0640
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   Volatility: 0.0634
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   variation_t: 0.0630
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   HL: 0.0600
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   TVV: 0.0591
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   SR: 0.0560
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   ma14_t: 0.0477
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   PM: 0.0475
2025-05-19 23:23:14,942 - INFO - [src.data_preparation] -   ma7_t: 0.0471
2025-05-19 23:23:14,945 - INFO - [src.data_preparation] - Ticker UIC - Using features: ['Date', 'insec_t', 'SK', 's_d7_t', 'vnipc_t', 'ret', 'ATR', 'LO', 'Volatility', 'variation_t', 'HL', 'TVV', 'SR', 'ma14_t', 'PM', 'ma7_t']
2025-05-19 23:23:15,042 - INFO - [src.data_preparation] - Ticker UIC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:15,042 - INFO - [src.data_preparation] - Ticker UIC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:15,044 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker UIC
2025-05-19 23:23:15,044 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:15,044 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:23:15,044 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:23:15,047 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:23:15,047 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:23:15,050 - INFO - [src.data_preparation] - Ticker UIC - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:15,051 - INFO - [__main__] - Using best model for UIC: svm (F1: 0.7246)
2025-05-19 23:23:15,051 - INFO - [__main__] - Loading svm model for UIC...
2025-05-19 23:23:15,053 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:15,053 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:23:15,053 - INFO - [__main__] - Making predictions for UIC using svm
2025-05-19 23:23:15,054 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:15,055 - INFO - [__main__] - Successfully got last prediction for UIC
2025-05-19 23:23:15,055 - INFO - [__main__] - 
Processing ticker: UNI
2025-05-19 23:23:15,055 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:15,055 - INFO - [__main__] - Getting last prediction point for ticker: UNI
2025-05-19 23:23:15,055 - INFO - [__main__] - ==================================================
2025-05-19 23:23:15,055 - INFO - [__main__] - Preparing test data for UNI...
2025-05-19 23:23:15,092 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:15,092 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:15,092 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:15,123 - INFO - [src.data_preparation] - Ticker UNI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:15,123 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(295), np.int64(1): np.int64(344)}
2025-05-19 23:23:15,484 - INFO - [src.data_preparation] - Ticker UNI - Selected features:
2025-05-19 23:23:15,484 - INFO - [src.data_preparation] -   vnipc_t: 0.0831
2025-05-19 23:23:15,484 - INFO - [src.data_preparation] -   TVV: 0.0721
2025-05-19 23:23:15,484 - INFO - [src.data_preparation] -   s_d7_t: 0.0720
2025-05-19 23:23:15,484 - INFO - [src.data_preparation] -   insec_t: 0.0708
2025-05-19 23:23:15,484 - INFO - [src.data_preparation] -   Volatility: 0.0658
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   SK: 0.0654
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   ma21_t: 0.0611
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   ATR: 0.0575
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   ma7_t: 0.0555
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   Median_HL: 0.0554
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   ma14_t: 0.0538
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   ret: 0.0518
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   PM: 0.0509
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   SR: 0.0477
2025-05-19 23:23:15,485 - INFO - [src.data_preparation] -   variation_t: 0.0463
2025-05-19 23:23:15,488 - INFO - [src.data_preparation] - Ticker UNI - Using features: ['Date', 'vnipc_t', 'TVV', 's_d7_t', 'insec_t', 'Volatility', 'SK', 'ma21_t', 'ATR', 'ma7_t', 'Median_HL', 'ma14_t', 'ret', 'PM', 'SR', 'variation_t']
2025-05-19 23:23:15,588 - INFO - [src.data_preparation] - Ticker UNI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:15,589 - INFO - [src.data_preparation] - Ticker UNI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:15,591 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker UNI
2025-05-19 23:23:15,591 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:15,591 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(200), np.int64(1): np.int64(263)}
2025-05-19 23:23:15,591 - INFO - [src.data_preparation] - Generating 63 synthetic minority samples
2025-05-19 23:23:15,595 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (526, 13, 15), y shape: (526,)
2025-05-19 23:23:15,595 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(263), np.int64(1): np.int64(263)}
2025-05-19 23:23:15,599 - INFO - [src.data_preparation] - Ticker UNI - Final 3D shapes: X_train=(526, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:15,599 - INFO - [__main__] - Using best model for UNI: logistic_regression (F1: 0.6512)
2025-05-19 23:23:15,599 - INFO - [__main__] - Loading logistic_regression model for UNI...
2025-05-19 23:23:15,601 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:15,601 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:15,601 - INFO - [__main__] - Making predictions for UNI using logistic_regression
2025-05-19 23:23:15,602 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:15,602 - INFO - [__main__] - Successfully got last prediction for UNI
2025-05-19 23:23:15,603 - INFO - [__main__] - 
Processing ticker: V12
2025-05-19 23:23:15,603 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:15,603 - INFO - [__main__] - Getting last prediction point for ticker: V12
2025-05-19 23:23:15,603 - INFO - [__main__] - ==================================================
2025-05-19 23:23:15,603 - INFO - [__main__] - Preparing test data for V12...
2025-05-19 23:23:15,646 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:15,646 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:15,646 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:15,669 - INFO - [src.data_preparation] - Ticker V12 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:15,669 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(213), np.int64(1): np.int64(426)}
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] - Ticker V12 - Selected features:
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   vnipc_t: 0.0772
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   TVV: 0.0752
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   ATR: 0.0738
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   s_d7_t: 0.0714
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   Volatility: 0.0686
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   ma7_t: 0.0600
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   SK: 0.0592
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   ma21_t: 0.0581
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   Median_HL: 0.0563
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   ma14_t: 0.0560
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   PM: 0.0555
2025-05-19 23:23:16,047 - INFO - [src.data_preparation] -   HL: 0.0527
2025-05-19 23:23:16,048 - INFO - [src.data_preparation] -   insec_t: 0.0510
2025-05-19 23:23:16,048 - INFO - [src.data_preparation] -   SR: 0.0491
2025-05-19 23:23:16,048 - INFO - [src.data_preparation] -   variation_t: 0.0468
2025-05-19 23:23:16,051 - INFO - [src.data_preparation] - Ticker V12 - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 's_d7_t', 'Volatility', 'ma7_t', 'SK', 'ma21_t', 'Median_HL', 'ma14_t', 'PM', 'HL', 'insec_t', 'SR', 'variation_t']
2025-05-19 23:23:16,162 - INFO - [src.data_preparation] - Ticker V12 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:16,162 - INFO - [src.data_preparation] - Ticker V12 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:16,164 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker V12
2025-05-19 23:23:16,164 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:16,164 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(144), np.int64(1): np.int64(319)}
2025-05-19 23:23:16,164 - INFO - [src.data_preparation] - Generating 175 synthetic minority samples
2025-05-19 23:23:16,175 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (638, 13, 15), y shape: (638,)
2025-05-19 23:23:16,175 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:23:16,179 - INFO - [src.data_preparation] - Ticker V12 - Final 3D shapes: X_train=(638, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:16,180 - INFO - [__main__] - Using best model for V12: svm (F1: 0.7246)
2025-05-19 23:23:16,180 - INFO - [__main__] - Loading svm model for V12...
2025-05-19 23:23:16,181 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:16,182 - INFO - [__main__] - Model size: 0.96 MB
2025-05-19 23:23:16,182 - INFO - [__main__] - Making predictions for V12 using svm
2025-05-19 23:23:16,182 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:16,183 - INFO - [__main__] - Successfully got last prediction for V12
2025-05-19 23:23:16,183 - INFO - [__main__] - 
Processing ticker: V15
2025-05-19 23:23:16,183 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:16,184 - INFO - [__main__] - Getting last prediction point for ticker: V15
2025-05-19 23:23:16,184 - INFO - [__main__] - ==================================================
2025-05-19 23:23:16,184 - INFO - [__main__] - Preparing test data for V15...
2025-05-19 23:23:16,222 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:16,222 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:16,222 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:16,257 - INFO - [src.data_preparation] - Ticker V15 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:16,257 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(159), np.int64(1): np.int64(480)}
2025-05-19 23:23:16,543 - INFO - [src.data_preparation] - Ticker V15 - Selected features:
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   vnipc_t: 0.1080
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   TVV: 0.0973
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   insec_t: 0.0864
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   ma14_t: 0.0771
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   ma21_t: 0.0740
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   Volatility: 0.0708
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   ATR: 0.0653
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   ma7_t: 0.0647
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   s_d7_t: 0.0601
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   SK: 0.0498
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   PM: 0.0488
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   Median_HL: 0.0418
2025-05-19 23:23:16,544 - INFO - [src.data_preparation] -   ret: 0.0376
2025-05-19 23:23:16,545 - INFO - [src.data_preparation] -   variation_t: 0.0361
2025-05-19 23:23:16,545 - INFO - [src.data_preparation] -   SR: 0.0278
2025-05-19 23:23:16,547 - INFO - [src.data_preparation] - Ticker V15 - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ma14_t', 'ma21_t', 'Volatility', 'ATR', 'ma7_t', 's_d7_t', 'SK', 'PM', 'Median_HL', 'ret', 'variation_t', 'SR']
2025-05-19 23:23:16,635 - INFO - [src.data_preparation] - Ticker V15 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:16,636 - INFO - [src.data_preparation] - Ticker V15 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:16,637 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker V15
2025-05-19 23:23:16,637 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:16,638 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(122), np.int64(1): np.int64(341)}
2025-05-19 23:23:16,638 - INFO - [src.data_preparation] - Generating 219 synthetic minority samples
2025-05-19 23:23:16,646 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (682, 13, 15), y shape: (682,)
2025-05-19 23:23:16,646 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(341), np.int64(1): np.int64(341)}
2025-05-19 23:23:16,650 - INFO - [src.data_preparation] - Ticker V15 - Final 3D shapes: X_train=(682, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:16,650 - INFO - [__main__] - Using best model for V15: lstm (F1: 0.9885)
2025-05-19 23:23:16,650 - INFO - [__main__] - Loading lstm model for V15...
2025-05-19 23:23:16,655 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:16,658 - INFO - [__main__] - Model size: 0.28 MB
2025-05-19 23:23:16,658 - INFO - [__main__] - Making predictions for V15 using lstm
2025-05-19 23:23:16,659 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:16,660 - INFO - [__main__] - Successfully got last prediction for V15
2025-05-19 23:23:16,660 - INFO - [__main__] - 
Processing ticker: V21
2025-05-19 23:23:16,660 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:16,660 - INFO - [__main__] - Getting last prediction point for ticker: V21
2025-05-19 23:23:16,660 - INFO - [__main__] - ==================================================
2025-05-19 23:23:16,660 - INFO - [__main__] - Preparing test data for V21...
2025-05-19 23:23:16,697 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:16,697 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:16,697 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:16,717 - INFO - [src.data_preparation] - Ticker V21 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:16,718 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(221), np.int64(1): np.int64(418)}
2025-05-19 23:23:17,098 - INFO - [src.data_preparation] - Ticker V21 - Selected features:
2025-05-19 23:23:17,098 - INFO - [src.data_preparation] -   TVV: 0.0839
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   ma14_t: 0.0749
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   vnipc_t: 0.0745
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   ma7_t: 0.0708
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   ma21_t: 0.0686
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   Volatility: 0.0641
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   ATR: 0.0626
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   PM: 0.0600
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   s_d7_t: 0.0574
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   SK: 0.0568
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   insec_t: 0.0559
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   Median_HL: 0.0529
2025-05-19 23:23:17,099 - INFO - [src.data_preparation] -   HL: 0.0477
2025-05-19 23:23:17,100 - INFO - [src.data_preparation] -   ret: 0.0461
2025-05-19 23:23:17,100 - INFO - [src.data_preparation] -   variation_t: 0.0407
2025-05-19 23:23:17,104 - INFO - [src.data_preparation] - Ticker V21 - Using features: ['Date', 'TVV', 'ma14_t', 'vnipc_t', 'ma7_t', 'ma21_t', 'Volatility', 'ATR', 'PM', 's_d7_t', 'SK', 'insec_t', 'Median_HL', 'HL', 'ret', 'variation_t']
2025-05-19 23:23:17,197 - INFO - [src.data_preparation] - Ticker V21 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:17,197 - INFO - [src.data_preparation] - Ticker V21 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:17,199 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker V21
2025-05-19 23:23:17,199 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:17,199 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(146), np.int64(1): np.int64(317)}
2025-05-19 23:23:17,199 - INFO - [src.data_preparation] - Generating 171 synthetic minority samples
2025-05-19 23:23:17,208 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (634, 13, 15), y shape: (634,)
2025-05-19 23:23:17,208 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(317), np.int64(1): np.int64(317)}
2025-05-19 23:23:17,211 - INFO - [src.data_preparation] - Ticker V21 - Final 3D shapes: X_train=(634, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:17,212 - INFO - [__main__] - Using best model for V21: logistic_regression (F1: 0.7619)
2025-05-19 23:23:17,212 - INFO - [__main__] - Loading logistic_regression model for V21...
2025-05-19 23:23:17,212 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:17,213 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:17,213 - INFO - [__main__] - Making predictions for V21 using logistic_regression
2025-05-19 23:23:17,213 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:17,213 - INFO - [__main__] - Successfully got last prediction for V21
2025-05-19 23:23:17,213 - INFO - [__main__] - 
Processing ticker: VBC
2025-05-19 23:23:17,214 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:17,214 - INFO - [__main__] - Getting last prediction point for ticker: VBC
2025-05-19 23:23:17,214 - INFO - [__main__] - ==================================================
2025-05-19 23:23:17,214 - INFO - [__main__] - Preparing test data for VBC...
2025-05-19 23:23:17,242 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:17,242 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:17,242 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:17,260 - INFO - [src.data_preparation] - Ticker VBC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:17,260 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(237), np.int64(1): np.int64(402)}
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] - Ticker VBC - Selected features:
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] -   ATR: 0.0733
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] -   SK: 0.0731
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:23:17,586 - INFO - [src.data_preparation] -   insec_t: 0.0614
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   ma21_t: 0.0608
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   variation_t: 0.0602
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   ma14_t: 0.0598
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   Volatility: 0.0597
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   HL: 0.0539
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   PM: 0.0532
2025-05-19 23:23:17,587 - INFO - [src.data_preparation] -   ma7_t: 0.0523
2025-05-19 23:23:17,588 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:23:17,588 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:23:17,590 - INFO - [src.data_preparation] - Ticker VBC - Using features: ['Date', 'ATR', 'SK', 'vnipc_t', 'TVV', 's_d7_t', 'insec_t', 'ma21_t', 'variation_t', 'ma14_t', 'Volatility', 'HL', 'PM', 'ma7_t', 'ret', 'Median_HL']
2025-05-19 23:23:17,678 - INFO - [src.data_preparation] - Ticker VBC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:17,678 - INFO - [src.data_preparation] - Ticker VBC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:17,679 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VBC
2025-05-19 23:23:17,680 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:17,680 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(157), np.int64(1): np.int64(306)}
2025-05-19 23:23:17,680 - INFO - [src.data_preparation] - Generating 149 synthetic minority samples
2025-05-19 23:23:17,685 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (612, 13, 15), y shape: (612,)
2025-05-19 23:23:17,685 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(306), np.int64(1): np.int64(306)}
2025-05-19 23:23:17,691 - INFO - [src.data_preparation] - Ticker VBC - Final 3D shapes: X_train=(612, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:17,691 - INFO - [__main__] - Using best model for VBC: svm (F1: 0.7246)
2025-05-19 23:23:17,691 - INFO - [__main__] - Loading svm model for VBC...
2025-05-19 23:23:17,693 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:17,693 - INFO - [__main__] - Model size: 0.92 MB
2025-05-19 23:23:17,693 - INFO - [__main__] - Making predictions for VBC using svm
2025-05-19 23:23:17,694 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:17,694 - INFO - [__main__] - Successfully got last prediction for VBC
2025-05-19 23:23:17,694 - INFO - [__main__] - 
Processing ticker: VBH
2025-05-19 23:23:17,694 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:17,694 - INFO - [__main__] - Getting last prediction point for ticker: VBH
2025-05-19 23:23:17,694 - INFO - [__main__] - ==================================================
2025-05-19 23:23:17,695 - INFO - [__main__] - Preparing test data for VBH...
2025-05-19 23:23:17,732 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:17,732 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:17,732 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:17,752 - INFO - [src.data_preparation] - Ticker VBH - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:17,752 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(140), np.int64(1): np.int64(498)}
2025-05-19 23:23:18,032 - INFO - [src.data_preparation] - Ticker VBH - Selected features:
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   vnipc_t: 0.0939
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   TVV: 0.0919
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   PM: 0.0696
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   Median_HL: 0.0687
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   ATR: 0.0654
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   ma21_t: 0.0651
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   ma14_t: 0.0639
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   Volatility: 0.0609
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   ma7_t: 0.0601
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   HL: 0.0590
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   s_d7_t: 0.0537
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   insec_t: 0.0483
2025-05-19 23:23:18,033 - INFO - [src.data_preparation] -   SK: 0.0459
2025-05-19 23:23:18,034 - INFO - [src.data_preparation] -   ret: 0.0411
2025-05-19 23:23:18,034 - INFO - [src.data_preparation] -   LO: 0.0376
2025-05-19 23:23:18,038 - INFO - [src.data_preparation] - Ticker VBH - Using features: ['Date', 'vnipc_t', 'TVV', 'PM', 'Median_HL', 'ATR', 'ma21_t', 'ma14_t', 'Volatility', 'ma7_t', 'HL', 's_d7_t', 'insec_t', 'SK', 'ret', 'LO']
2025-05-19 23:23:18,135 - INFO - [src.data_preparation] - Ticker VBH - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:18,136 - INFO - [src.data_preparation] - Ticker VBH - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:18,138 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VBH
2025-05-19 23:23:18,138 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:18,138 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(102), np.int64(1): np.int64(360)}
2025-05-19 23:23:18,138 - INFO - [src.data_preparation] - Generating 258 synthetic minority samples
2025-05-19 23:23:18,148 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (720, 13, 15), y shape: (720,)
2025-05-19 23:23:18,148 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(360), np.int64(1): np.int64(360)}
2025-05-19 23:23:18,153 - INFO - [src.data_preparation] - Ticker VBH - Final 3D shapes: X_train=(720, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:18,153 - INFO - [__main__] - Using best model for VBH: svm (F1: 0.6885)
2025-05-19 23:23:18,153 - INFO - [__main__] - Loading svm model for VBH...
2025-05-19 23:23:18,155 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:18,155 - INFO - [__main__] - Model size: 0.53 MB
2025-05-19 23:23:18,155 - INFO - [__main__] - Making predictions for VBH using svm
2025-05-19 23:23:18,155 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:18,156 - INFO - [__main__] - Successfully got last prediction for VBH
2025-05-19 23:23:18,156 - INFO - [__main__] - 
Processing ticker: VC1
2025-05-19 23:23:18,156 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:18,156 - INFO - [__main__] - Getting last prediction point for ticker: VC1
2025-05-19 23:23:18,156 - INFO - [__main__] - ==================================================
2025-05-19 23:23:18,156 - INFO - [__main__] - Preparing test data for VC1...
2025-05-19 23:23:18,197 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:18,197 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:18,197 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:18,218 - INFO - [src.data_preparation] - Ticker VC1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:18,218 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(242), np.int64(1): np.int64(397)}
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] - Ticker VC1 - Selected features:
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   vnipc_t: 0.0795
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   SK: 0.0698
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   s_d7_t: 0.0674
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   ATR: 0.0666
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   TVV: 0.0656
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   ma21_t: 0.0631
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   HL: 0.0604
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   Volatility: 0.0594
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   insec_t: 0.0593
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   ma14_t: 0.0561
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   ma7_t: 0.0557
2025-05-19 23:23:18,532 - INFO - [src.data_preparation] -   PM: 0.0543
2025-05-19 23:23:18,533 - INFO - [src.data_preparation] -   ret: 0.0521
2025-05-19 23:23:18,533 - INFO - [src.data_preparation] -   Median_HL: 0.0515
2025-05-19 23:23:18,533 - INFO - [src.data_preparation] -   variation_t: 0.0512
2025-05-19 23:23:18,535 - INFO - [src.data_preparation] - Ticker VC1 - Using features: ['Date', 'vnipc_t', 'SK', 's_d7_t', 'ATR', 'TVV', 'ma21_t', 'HL', 'Volatility', 'insec_t', 'ma14_t', 'ma7_t', 'PM', 'ret', 'Median_HL', 'variation_t']
2025-05-19 23:23:18,630 - INFO - [src.data_preparation] - Ticker VC1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:18,630 - INFO - [src.data_preparation] - Ticker VC1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:18,631 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC1
2025-05-19 23:23:18,631 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:18,631 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(157), np.int64(1): np.int64(306)}
2025-05-19 23:23:18,631 - INFO - [src.data_preparation] - Generating 149 synthetic minority samples
2025-05-19 23:23:18,638 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (612, 13, 15), y shape: (612,)
2025-05-19 23:23:18,638 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(306), np.int64(1): np.int64(306)}
2025-05-19 23:23:18,642 - INFO - [src.data_preparation] - Ticker VC1 - Final 3D shapes: X_train=(612, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:18,643 - INFO - [__main__] - Using best model for VC1: svm (F1: 0.7778)
2025-05-19 23:23:18,643 - INFO - [__main__] - Loading svm model for VC1...
2025-05-19 23:23:18,645 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:18,645 - INFO - [__main__] - Model size: 0.92 MB
2025-05-19 23:23:18,645 - INFO - [__main__] - Making predictions for VC1 using svm
2025-05-19 23:23:18,646 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:18,646 - INFO - [__main__] - Successfully got last prediction for VC1
2025-05-19 23:23:18,646 - INFO - [__main__] - 
Processing ticker: VC2
2025-05-19 23:23:18,646 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:18,646 - INFO - [__main__] - Getting last prediction point for ticker: VC2
2025-05-19 23:23:18,646 - INFO - [__main__] - ==================================================
2025-05-19 23:23:18,646 - INFO - [__main__] - Preparing test data for VC2...
2025-05-19 23:23:18,677 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:18,677 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:18,677 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:18,699 - INFO - [src.data_preparation] - Ticker VC2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:18,700 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] - Ticker VC2 - Selected features:
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   SK: 0.0764
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   Volatility: 0.0736
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   vnipc_t: 0.0727
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   TVV: 0.0663
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   insec_t: 0.0628
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   ma14_t: 0.0580
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   s_d7_t: 0.0578
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   HL: 0.0570
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   ma21_t: 0.0560
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   ATR: 0.0559
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   ma7_t: 0.0531
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   Median_HL: 0.0526
2025-05-19 23:23:19,024 - INFO - [src.data_preparation] -   SR: 0.0508
2025-05-19 23:23:19,025 - INFO - [src.data_preparation] -   PM: 0.0507
2025-05-19 23:23:19,027 - INFO - [src.data_preparation] - Ticker VC2 - Using features: ['Date', 'SK', 'Volatility', 'vnipc_t', 'TVV', 'insec_t', 'ma14_t', 's_d7_t', 'HL', 'ma21_t', 'ATR', 'ret', 'ma7_t', 'Median_HL', 'SR', 'PM']
2025-05-19 23:23:19,122 - INFO - [src.data_preparation] - Ticker VC2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:19,123 - INFO - [src.data_preparation] - Ticker VC2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:19,125 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC2
2025-05-19 23:23:19,125 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:19,125 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(193), np.int64(1): np.int64(270)}
2025-05-19 23:23:19,125 - INFO - [src.data_preparation] - Generating 77 synthetic minority samples
2025-05-19 23:23:19,129 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (540, 13, 15), y shape: (540,)
2025-05-19 23:23:19,129 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(270), np.int64(1): np.int64(270)}
2025-05-19 23:23:19,132 - INFO - [src.data_preparation] - Ticker VC2 - Final 3D shapes: X_train=(540, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:19,133 - INFO - [__main__] - Using best model for VC2: svm (F1: 0.6250)
2025-05-19 23:23:19,133 - INFO - [__main__] - Loading svm model for VC2...
2025-05-19 23:23:19,134 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:19,135 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:23:19,135 - INFO - [__main__] - Making predictions for VC2 using svm
2025-05-19 23:23:19,135 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:19,136 - INFO - [__main__] - Successfully got last prediction for VC2
2025-05-19 23:23:19,136 - INFO - [__main__] - 
Processing ticker: VC3
2025-05-19 23:23:19,136 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:19,136 - INFO - [__main__] - Getting last prediction point for ticker: VC3
2025-05-19 23:23:19,136 - INFO - [__main__] - ==================================================
2025-05-19 23:23:19,136 - INFO - [__main__] - Preparing test data for VC3...
2025-05-19 23:23:19,173 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:19,173 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:19,173 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:19,191 - INFO - [src.data_preparation] - Ticker VC3 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:19,192 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:23:19,524 - INFO - [src.data_preparation] - Ticker VC3 - Selected features:
2025-05-19 23:23:19,524 - INFO - [src.data_preparation] -   TVV: 0.0720
2025-05-19 23:23:19,524 - INFO - [src.data_preparation] -   insec_t: 0.0664
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   vnipc_t: 0.0662
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   Volatility: 0.0647
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   SK: 0.0642
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   ma14_t: 0.0612
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   PM: 0.0610
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   ma7_t: 0.0607
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   Median_HL: 0.0591
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   ma21_t: 0.0590
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   ATR: 0.0579
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   LO: 0.0517
2025-05-19 23:23:19,525 - INFO - [src.data_preparation] -   ret: 0.0498
2025-05-19 23:23:19,528 - INFO - [src.data_preparation] - Ticker VC3 - Using features: ['Date', 'TVV', 'insec_t', 'vnipc_t', 'Volatility', 'SK', 's_d7_t', 'ma14_t', 'PM', 'ma7_t', 'Median_HL', 'ma21_t', 'ATR', 'HL', 'LO', 'ret']
2025-05-19 23:23:19,618 - INFO - [src.data_preparation] - Ticker VC3 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:19,618 - INFO - [src.data_preparation] - Ticker VC3 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:19,620 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC3
2025-05-19 23:23:19,620 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:19,621 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(198), np.int64(1): np.int64(265)}
2025-05-19 23:23:19,621 - INFO - [src.data_preparation] - Generating 67 synthetic minority samples
2025-05-19 23:23:19,624 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (530, 13, 15), y shape: (530,)
2025-05-19 23:23:19,624 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(265), np.int64(1): np.int64(265)}
2025-05-19 23:23:19,628 - INFO - [src.data_preparation] - Ticker VC3 - Final 3D shapes: X_train=(530, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:19,628 - INFO - [__main__] - Using best model for VC3: lstm (F1: 0.6250)
2025-05-19 23:23:19,628 - INFO - [__main__] - Loading lstm model for VC3...
2025-05-19 23:23:19,632 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:19,634 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:23:19,634 - INFO - [__main__] - Making predictions for VC3 using lstm
2025-05-19 23:23:19,636 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:19,636 - INFO - [__main__] - Successfully got last prediction for VC3
2025-05-19 23:23:19,636 - INFO - [__main__] - 
Processing ticker: VC5
2025-05-19 23:23:19,636 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:19,636 - INFO - [__main__] - Getting last prediction point for ticker: VC5
2025-05-19 23:23:19,636 - INFO - [__main__] - ==================================================
2025-05-19 23:23:19,636 - INFO - [__main__] - Preparing test data for VC5...
2025-05-19 23:23:19,691 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:19,691 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:19,691 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:19,719 - INFO - [src.data_preparation] - Ticker VC5 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:19,719 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(177), np.int64(1): np.int64(462)}
2025-05-19 23:23:20,001 - INFO - [src.data_preparation] - Ticker VC5 - Selected features:
2025-05-19 23:23:20,001 - INFO - [src.data_preparation] -   vnipc_t: 0.1011
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   ma14_t: 0.0807
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   ma21_t: 0.0795
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   TVV: 0.0772
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   ma7_t: 0.0694
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   Volatility: 0.0615
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   SK: 0.0602
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   insec_t: 0.0572
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   ATR: 0.0550
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   PM: 0.0547
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   Median_HL: 0.0515
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   variation_t: 0.0427
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   HL: 0.0394
2025-05-19 23:23:20,002 - INFO - [src.data_preparation] -   ret: 0.0369
2025-05-19 23:23:20,007 - INFO - [src.data_preparation] - Ticker VC5 - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'TVV', 'ma7_t', 's_d7_t', 'Volatility', 'SK', 'insec_t', 'ATR', 'PM', 'Median_HL', 'variation_t', 'HL', 'ret']
2025-05-19 23:23:20,096 - INFO - [src.data_preparation] - Ticker VC5 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:20,096 - INFO - [src.data_preparation] - Ticker VC5 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:20,097 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC5
2025-05-19 23:23:20,097 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:20,097 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(124), np.int64(1): np.int64(339)}
2025-05-19 23:23:20,097 - INFO - [src.data_preparation] - Generating 215 synthetic minority samples
2025-05-19 23:23:20,105 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (678, 13, 15), y shape: (678,)
2025-05-19 23:23:20,105 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(339), np.int64(1): np.int64(339)}
2025-05-19 23:23:20,110 - INFO - [src.data_preparation] - Ticker VC5 - Final 3D shapes: X_train=(678, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:20,111 - INFO - [__main__] - Using best model for VC5: svm (F1: 0.8718)
2025-05-19 23:23:20,111 - INFO - [__main__] - Loading svm model for VC5...
2025-05-19 23:23:20,112 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:20,112 - INFO - [__main__] - Model size: 0.60 MB
2025-05-19 23:23:20,113 - INFO - [__main__] - Making predictions for VC5 using svm
2025-05-19 23:23:20,113 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:20,113 - INFO - [__main__] - Successfully got last prediction for VC5
2025-05-19 23:23:20,113 - INFO - [__main__] - 
Processing ticker: VC6
2025-05-19 23:23:20,113 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:20,114 - INFO - [__main__] - Getting last prediction point for ticker: VC6
2025-05-19 23:23:20,114 - INFO - [__main__] - ==================================================
2025-05-19 23:23:20,114 - INFO - [__main__] - Preparing test data for VC6...
2025-05-19 23:23:20,144 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:20,145 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:20,145 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:20,165 - INFO - [src.data_preparation] - Ticker VC6 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:20,165 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(218), np.int64(1): np.int64(421)}
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] - Ticker VC6 - Selected features:
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   vnipc_t: 0.0721
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   Volatility: 0.0710
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   TVV: 0.0654
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   SK: 0.0642
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   s_d7_t: 0.0631
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   ATR: 0.0628
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   SR: 0.0610
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:23:20,510 - INFO - [src.data_preparation] -   PM: 0.0596
2025-05-19 23:23:20,511 - INFO - [src.data_preparation] -   insec_t: 0.0594
2025-05-19 23:23:20,511 - INFO - [src.data_preparation] -   ma7_t: 0.0587
2025-05-19 23:23:20,511 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:23:20,511 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:23:20,511 - INFO - [src.data_preparation] -   ma14_t: 0.0527
2025-05-19 23:23:20,511 - INFO - [src.data_preparation] -   HL: 0.0522
2025-05-19 23:23:20,514 - INFO - [src.data_preparation] - Ticker VC6 - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'SK', 's_d7_t', 'ATR', 'SR', 'ma21_t', 'PM', 'insec_t', 'ma7_t', 'variation_t', 'ret', 'ma14_t', 'HL']
2025-05-19 23:23:20,604 - INFO - [src.data_preparation] - Ticker VC6 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:20,605 - INFO - [src.data_preparation] - Ticker VC6 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:20,607 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC6
2025-05-19 23:23:20,607 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:20,607 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(144), np.int64(1): np.int64(319)}
2025-05-19 23:23:20,607 - INFO - [src.data_preparation] - Generating 175 synthetic minority samples
2025-05-19 23:23:20,613 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (638, 13, 15), y shape: (638,)
2025-05-19 23:23:20,613 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:23:20,617 - INFO - [src.data_preparation] - Ticker VC6 - Final 3D shapes: X_train=(638, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:20,618 - INFO - [__main__] - Using best model for VC6: lstm (F1: 0.7945)
2025-05-19 23:23:20,618 - INFO - [__main__] - Loading lstm model for VC6...
2025-05-19 23:23:20,623 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:20,624 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:23:20,624 - INFO - [__main__] - Making predictions for VC6 using lstm
2025-05-19 23:23:20,626 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:20,627 - INFO - [__main__] - Successfully got last prediction for VC6
2025-05-19 23:23:20,627 - INFO - [__main__] - 
Processing ticker: VC7
2025-05-19 23:23:20,627 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:20,627 - INFO - [__main__] - Getting last prediction point for ticker: VC7
2025-05-19 23:23:20,627 - INFO - [__main__] - ==================================================
2025-05-19 23:23:20,627 - INFO - [__main__] - Preparing test data for VC7...
2025-05-19 23:23:20,677 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:20,678 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:20,678 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:20,698 - INFO - [src.data_preparation] - Ticker VC7 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:20,698 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:23:21,093 - INFO - [src.data_preparation] - Ticker VC7 - Selected features:
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   SK: 0.0678
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   HL: 0.0654
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   TVV: 0.0647
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   vnipc_t: 0.0639
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   insec_t: 0.0632
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   Volatility: 0.0622
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   ATR: 0.0567
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   SR: 0.0562
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   Median_HL: 0.0562
2025-05-19 23:23:21,094 - INFO - [src.data_preparation] -   ma7_t: 0.0559
2025-05-19 23:23:21,095 - INFO - [src.data_preparation] -   ma14_t: 0.0552
2025-05-19 23:23:21,095 - INFO - [src.data_preparation] -   ret: 0.0548
2025-05-19 23:23:21,095 - INFO - [src.data_preparation] -   PM: 0.0536
2025-05-19 23:23:21,095 - INFO - [src.data_preparation] -   LO: 0.0535
2025-05-19 23:23:21,098 - INFO - [src.data_preparation] - Ticker VC7 - Using features: ['Date', 'SK', 'HL', 'TVV', 'vnipc_t', 'insec_t', 's_d7_t', 'Volatility', 'ATR', 'SR', 'Median_HL', 'ma7_t', 'ma14_t', 'ret', 'PM', 'LO']
2025-05-19 23:23:21,201 - INFO - [src.data_preparation] - Ticker VC7 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:21,201 - INFO - [src.data_preparation] - Ticker VC7 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:21,202 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC7
2025-05-19 23:23:21,202 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:21,202 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:23:21,203 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:23:21,205 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:23:21,206 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:23:21,209 - INFO - [src.data_preparation] - Ticker VC7 - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:21,210 - INFO - [__main__] - Using best model for VC7: lstm (F1: 0.4211)
2025-05-19 23:23:21,210 - INFO - [__main__] - Loading lstm model for VC7...
2025-05-19 23:23:21,213 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:21,214 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:23:21,214 - INFO - [__main__] - Making predictions for VC7 using lstm
2025-05-19 23:23:21,215 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:21,215 - INFO - [__main__] - Successfully got last prediction for VC7
2025-05-19 23:23:21,215 - INFO - [__main__] - 
Processing ticker: VC9
2025-05-19 23:23:21,217 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:21,217 - INFO - [__main__] - Getting last prediction point for ticker: VC9
2025-05-19 23:23:21,217 - INFO - [__main__] - ==================================================
2025-05-19 23:23:21,217 - INFO - [__main__] - Preparing test data for VC9...
2025-05-19 23:23:21,260 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:21,261 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:21,261 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:21,288 - INFO - [src.data_preparation] - Ticker VC9 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:21,288 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(253), np.int64(1): np.int64(386)}
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] - Ticker VC9 - Selected features:
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] -   TVV: 0.0730
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] -   vnipc_t: 0.0730
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] -   ATR: 0.0670
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] -   insec_t: 0.0652
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] -   SK: 0.0637
2025-05-19 23:23:21,633 - INFO - [src.data_preparation] -   LO: 0.0635
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   s_d7_t: 0.0602
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   ma14_t: 0.0589
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   ma21_t: 0.0584
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   Volatility: 0.0564
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   variation_t: 0.0542
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   HL: 0.0526
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   ma7_t: 0.0526
2025-05-19 23:23:21,634 - INFO - [src.data_preparation] -   SR: 0.0498
2025-05-19 23:23:21,637 - INFO - [src.data_preparation] - Ticker VC9 - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'insec_t', 'SK', 'LO', 's_d7_t', 'ma14_t', 'ma21_t', 'Volatility', 'variation_t', 'ret', 'HL', 'ma7_t', 'SR']
2025-05-19 23:23:21,735 - INFO - [src.data_preparation] - Ticker VC9 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:21,735 - INFO - [src.data_preparation] - Ticker VC9 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:21,735 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VC9
2025-05-19 23:23:21,737 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:21,737 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(166), np.int64(1): np.int64(297)}
2025-05-19 23:23:21,737 - INFO - [src.data_preparation] - Generating 131 synthetic minority samples
2025-05-19 23:23:21,745 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (594, 13, 15), y shape: (594,)
2025-05-19 23:23:21,745 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(297), np.int64(1): np.int64(297)}
2025-05-19 23:23:21,748 - INFO - [src.data_preparation] - Ticker VC9 - Final 3D shapes: X_train=(594, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:21,748 - INFO - [__main__] - Using best model for VC9: svm (F1: 0.7778)
2025-05-19 23:23:21,748 - INFO - [__main__] - Loading svm model for VC9...
2025-05-19 23:23:21,751 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:21,751 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:23:21,751 - INFO - [__main__] - Making predictions for VC9 using svm
2025-05-19 23:23:21,752 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:21,753 - INFO - [__main__] - Successfully got last prediction for VC9
2025-05-19 23:23:21,753 - INFO - [__main__] - 
Processing ticker: VCA
2025-05-19 23:23:21,753 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:21,753 - INFO - [__main__] - Getting last prediction point for ticker: VCA
2025-05-19 23:23:21,753 - INFO - [__main__] - ==================================================
2025-05-19 23:23:21,753 - INFO - [__main__] - Preparing test data for VCA...
2025-05-19 23:23:21,782 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:21,782 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:21,782 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:21,804 - INFO - [src.data_preparation] - Ticker VCA - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:21,804 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(241), np.int64(1): np.int64(397)}
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] - Ticker VCA - Selected features:
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   ATR: 0.0888
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   TVV: 0.0765
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   s_d7_t: 0.0672
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   SK: 0.0657
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   Volatility: 0.0618
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   HL: 0.0618
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   vnipc_t: 0.0613
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   insec_t: 0.0574
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   ma14_t: 0.0564
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   ma21_t: 0.0563
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   variation_t: 0.0515
2025-05-19 23:23:22,114 - INFO - [src.data_preparation] -   PM: 0.0508
2025-05-19 23:23:22,115 - INFO - [src.data_preparation] -   Median_HL: 0.0493
2025-05-19 23:23:22,115 - INFO - [src.data_preparation] -   SR: 0.0485
2025-05-19 23:23:22,115 - INFO - [src.data_preparation] -   ma7_t: 0.0475
2025-05-19 23:23:22,117 - INFO - [src.data_preparation] - Ticker VCA - Using features: ['Date', 'ATR', 'TVV', 's_d7_t', 'SK', 'Volatility', 'HL', 'vnipc_t', 'insec_t', 'ma14_t', 'ma21_t', 'variation_t', 'PM', 'Median_HL', 'SR', 'ma7_t']
2025-05-19 23:23:22,207 - INFO - [src.data_preparation] - Ticker VCA - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:22,208 - INFO - [src.data_preparation] - Ticker VCA - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:22,209 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCA
2025-05-19 23:23:22,209 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:22,209 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(158), np.int64(1): np.int64(304)}
2025-05-19 23:23:22,209 - INFO - [src.data_preparation] - Generating 146 synthetic minority samples
2025-05-19 23:23:22,215 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (608, 13, 15), y shape: (608,)
2025-05-19 23:23:22,215 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(304), np.int64(1): np.int64(304)}
2025-05-19 23:23:22,219 - INFO - [src.data_preparation] - Ticker VCA - Final 3D shapes: X_train=(608, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:22,220 - INFO - [__main__] - Using best model for VCA: logistic_regression (F1: 0.4444)
2025-05-19 23:23:22,220 - INFO - [__main__] - Loading logistic_regression model for VCA...
2025-05-19 23:23:22,220 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:22,220 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:22,221 - INFO - [__main__] - Making predictions for VCA using logistic_regression
2025-05-19 23:23:22,221 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:22,221 - INFO - [__main__] - Successfully got last prediction for VCA
2025-05-19 23:23:22,221 - INFO - [__main__] - 
Processing ticker: VCB
2025-05-19 23:23:22,221 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:22,221 - INFO - [__main__] - Getting last prediction point for ticker: VCB
2025-05-19 23:23:22,221 - INFO - [__main__] - ==================================================
2025-05-19 23:23:22,221 - INFO - [__main__] - Preparing test data for VCB...
2025-05-19 23:23:22,252 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:22,253 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:22,253 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:22,273 - INFO - [src.data_preparation] - Ticker VCB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:22,274 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(313), np.int64(1): np.int64(326)}
2025-05-19 23:23:22,637 - INFO - [src.data_preparation] - Ticker VCB - Selected features:
2025-05-19 23:23:22,637 - INFO - [src.data_preparation] -   TVV: 0.0836
2025-05-19 23:23:22,637 - INFO - [src.data_preparation] -   Volatility: 0.0714
2025-05-19 23:23:22,637 - INFO - [src.data_preparation] -   SK: 0.0700
2025-05-19 23:23:22,637 - INFO - [src.data_preparation] -   vnipc_t: 0.0660
2025-05-19 23:23:22,637 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   insec_t: 0.0619
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   ret: 0.0613
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   LO: 0.0586
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   SR: 0.0583
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   ATR: 0.0572
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   HL: 0.0568
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   ma21_t: 0.0514
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   variation_t: 0.0502
2025-05-19 23:23:22,638 - INFO - [src.data_preparation] -   ma7_t: 0.0492
2025-05-19 23:23:22,639 - INFO - [src.data_preparation] -   Median_HL: 0.0483
2025-05-19 23:23:22,642 - INFO - [src.data_preparation] - Ticker VCB - Using features: ['Date', 'TVV', 'Volatility', 'SK', 'vnipc_t', 's_d7_t', 'insec_t', 'ret', 'LO', 'SR', 'ATR', 'HL', 'ma21_t', 'variation_t', 'ma7_t', 'Median_HL']
2025-05-19 23:23:22,742 - INFO - [src.data_preparation] - Ticker VCB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:22,742 - INFO - [src.data_preparation] - Ticker VCB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:22,744 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCB
2025-05-19 23:23:22,744 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:22,744 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:23:22,744 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:23:22,746 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:23:22,746 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:23:22,749 - INFO - [src.data_preparation] - Ticker VCB - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:22,749 - INFO - [__main__] - Using best model for VCB: svm (F1: 0.6111)
2025-05-19 23:23:22,749 - INFO - [__main__] - Loading svm model for VCB...
2025-05-19 23:23:22,750 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:22,750 - INFO - [__main__] - Model size: 0.51 MB
2025-05-19 23:23:22,750 - INFO - [__main__] - Making predictions for VCB using svm
2025-05-19 23:23:22,751 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:22,751 - INFO - [__main__] - Successfully got last prediction for VCB
2025-05-19 23:23:22,751 - INFO - [__main__] - 
Processing ticker: VCC
2025-05-19 23:23:22,751 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:22,751 - INFO - [__main__] - Getting last prediction point for ticker: VCC
2025-05-19 23:23:22,751 - INFO - [__main__] - ==================================================
2025-05-19 23:23:22,751 - INFO - [__main__] - Preparing test data for VCC...
2025-05-19 23:23:22,784 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:22,784 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:22,784 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:22,805 - INFO - [src.data_preparation] - Ticker VCC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:22,807 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] - Ticker VCC - Selected features:
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   TVV: 0.0733
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   SK: 0.0686
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   insec_t: 0.0686
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   Volatility: 0.0683
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   ATR: 0.0681
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   vnipc_t: 0.0616
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   HL: 0.0606
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   SR: 0.0595
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   ret: 0.0586
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   s_d7_t: 0.0575
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   variation_t: 0.0572
2025-05-19 23:23:23,116 - INFO - [src.data_preparation] -   ma14_t: 0.0557
2025-05-19 23:23:23,117 - INFO - [src.data_preparation] -   ma21_t: 0.0530
2025-05-19 23:23:23,117 - INFO - [src.data_preparation] -   LO: 0.0494
2025-05-19 23:23:23,117 - INFO - [src.data_preparation] -   ma7_t: 0.0488
2025-05-19 23:23:23,119 - INFO - [src.data_preparation] - Ticker VCC - Using features: ['Date', 'TVV', 'SK', 'insec_t', 'Volatility', 'ATR', 'vnipc_t', 'HL', 'SR', 'ret', 's_d7_t', 'variation_t', 'ma14_t', 'ma21_t', 'LO', 'ma7_t']
2025-05-19 23:23:23,217 - INFO - [src.data_preparation] - Ticker VCC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:23,217 - INFO - [src.data_preparation] - Ticker VCC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:23,219 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCC
2025-05-19 23:23:23,219 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:23,219 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(186), np.int64(1): np.int64(277)}
2025-05-19 23:23:23,219 - INFO - [src.data_preparation] - Generating 91 synthetic minority samples
2025-05-19 23:23:23,224 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (554, 13, 15), y shape: (554,)
2025-05-19 23:23:23,225 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(277), np.int64(1): np.int64(277)}
2025-05-19 23:23:23,230 - INFO - [src.data_preparation] - Ticker VCC - Final 3D shapes: X_train=(554, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:23,230 - INFO - [__main__] - Using best model for VCC: svm (F1: 0.6667)
2025-05-19 23:23:23,230 - INFO - [__main__] - Loading svm model for VCC...
2025-05-19 23:23:23,231 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:23,232 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:23:23,232 - INFO - [__main__] - Making predictions for VCC using svm
2025-05-19 23:23:23,232 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:23,233 - INFO - [__main__] - Successfully got last prediction for VCC
2025-05-19 23:23:23,233 - INFO - [__main__] - 
Processing ticker: VCF
2025-05-19 23:23:23,233 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:23,233 - INFO - [__main__] - Getting last prediction point for ticker: VCF
2025-05-19 23:23:23,233 - INFO - [__main__] - ==================================================
2025-05-19 23:23:23,233 - INFO - [__main__] - Preparing test data for VCF...
2025-05-19 23:23:23,270 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:23,270 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:23,270 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:23,295 - INFO - [src.data_preparation] - Ticker VCF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:23,295 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(288), np.int64(1): np.int64(351)}
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] - Ticker VCF - Selected features:
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   SK: 0.0740
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   s_d7_t: 0.0682
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   ATR: 0.0671
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   Volatility: 0.0644
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   vnipc_t: 0.0624
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   TVV: 0.0615
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   HL: 0.0611
2025-05-19 23:23:23,620 - INFO - [src.data_preparation] -   SR: 0.0592
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   insec_t: 0.0582
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   ret: 0.0565
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   variation_t: 0.0550
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   Median_HL: 0.0520
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   ma14_t: 0.0519
2025-05-19 23:23:23,621 - INFO - [src.data_preparation] -   LO: 0.0497
2025-05-19 23:23:23,624 - INFO - [src.data_preparation] - Ticker VCF - Using features: ['Date', 'SK', 's_d7_t', 'ATR', 'Volatility', 'vnipc_t', 'TVV', 'HL', 'SR', 'insec_t', 'ret', 'variation_t', 'ma21_t', 'Median_HL', 'ma14_t', 'LO']
2025-05-19 23:23:23,713 - INFO - [src.data_preparation] - Ticker VCF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:23,713 - INFO - [src.data_preparation] - Ticker VCF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:23,715 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCF
2025-05-19 23:23:23,715 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:23,715 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:23:23,715 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:23:23,717 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:23:23,717 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:23:23,720 - INFO - [src.data_preparation] - Ticker VCF - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:23,720 - INFO - [__main__] - Using best model for VCF: logistic_regression (F1: 0.6774)
2025-05-19 23:23:23,720 - INFO - [__main__] - Loading logistic_regression model for VCF...
2025-05-19 23:23:23,721 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:23,721 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:23,721 - INFO - [__main__] - Making predictions for VCF using logistic_regression
2025-05-19 23:23:23,721 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:23,721 - INFO - [__main__] - Successfully got last prediction for VCF
2025-05-19 23:23:23,722 - INFO - [__main__] - 
Processing ticker: VCG
2025-05-19 23:23:23,722 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:23,722 - INFO - [__main__] - Getting last prediction point for ticker: VCG
2025-05-19 23:23:23,722 - INFO - [__main__] - ==================================================
2025-05-19 23:23:23,722 - INFO - [__main__] - Preparing test data for VCG...
2025-05-19 23:23:23,756 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:23,756 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:23,756 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:23,779 - INFO - [src.data_preparation] - Ticker VCG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:23,780 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(297), np.int64(1): np.int64(342)}
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] - Ticker VCG - Selected features:
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   s_d7_t: 0.0721
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   vnipc_t: 0.0693
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   TVV: 0.0652
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   Volatility: 0.0649
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   HL: 0.0648
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   SK: 0.0617
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   insec_t: 0.0607
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   SR: 0.0602
2025-05-19 23:23:24,095 - INFO - [src.data_preparation] -   LO: 0.0576
2025-05-19 23:23:24,096 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:23:24,096 - INFO - [src.data_preparation] -   ma7_t: 0.0558
2025-05-19 23:23:24,096 - INFO - [src.data_preparation] -   ma21_t: 0.0553
2025-05-19 23:23:24,096 - INFO - [src.data_preparation] -   ATR: 0.0523
2025-05-19 23:23:24,096 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:23:24,096 - INFO - [src.data_preparation] -   Median_HL: 0.0513
2025-05-19 23:23:24,099 - INFO - [src.data_preparation] - Ticker VCG - Using features: ['Date', 's_d7_t', 'vnipc_t', 'TVV', 'Volatility', 'HL', 'SK', 'insec_t', 'SR', 'LO', 'ret', 'ma7_t', 'ma21_t', 'ATR', 'variation_t', 'Median_HL']
2025-05-19 23:23:24,189 - INFO - [src.data_preparation] - Ticker VCG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:24,189 - INFO - [src.data_preparation] - Ticker VCG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:24,191 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCG
2025-05-19 23:23:24,191 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:24,191 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(214), np.int64(1): np.int64(249)}
2025-05-19 23:23:24,191 - INFO - [src.data_preparation] - Generating 35 synthetic minority samples
2025-05-19 23:23:24,194 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (498, 13, 15), y shape: (498,)
2025-05-19 23:23:24,194 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(249), np.int64(1): np.int64(249)}
2025-05-19 23:23:24,197 - INFO - [src.data_preparation] - Ticker VCG - Final 3D shapes: X_train=(498, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:24,197 - INFO - [__main__] - Using best model for VCG: svm (F1: 0.6275)
2025-05-19 23:23:24,198 - INFO - [__main__] - Loading svm model for VCG...
2025-05-19 23:23:24,199 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:24,199 - INFO - [__main__] - Model size: 0.58 MB
2025-05-19 23:23:24,199 - INFO - [__main__] - Making predictions for VCG using svm
2025-05-19 23:23:24,200 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:24,200 - INFO - [__main__] - Successfully got last prediction for VCG
2025-05-19 23:23:24,200 - INFO - [__main__] - 
Processing ticker: VCM
2025-05-19 23:23:24,200 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:24,200 - INFO - [__main__] - Getting last prediction point for ticker: VCM
2025-05-19 23:23:24,200 - INFO - [__main__] - ==================================================
2025-05-19 23:23:24,200 - INFO - [__main__] - Preparing test data for VCM...
2025-05-19 23:23:24,232 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:24,232 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:24,232 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:24,271 - INFO - [src.data_preparation] - Ticker VCM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:24,271 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(222), np.int64(1): np.int64(417)}
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] - Ticker VCM - Selected features:
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   vnipc_t: 0.0762
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   TVV: 0.0724
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   ATR: 0.0723
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   SK: 0.0716
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   Volatility: 0.0672
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   s_d7_t: 0.0640
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   ma21_t: 0.0598
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   ma7_t: 0.0563
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   ma14_t: 0.0551
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   Median_HL: 0.0538
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   HL: 0.0536
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   PM: 0.0536
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   insec_t: 0.0509
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   variation_t: 0.0506
2025-05-19 23:23:24,588 - INFO - [src.data_preparation] -   ret: 0.0471
2025-05-19 23:23:24,592 - INFO - [src.data_preparation] - Ticker VCM - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'SK', 'Volatility', 's_d7_t', 'ma21_t', 'ma7_t', 'ma14_t', 'Median_HL', 'HL', 'PM', 'insec_t', 'variation_t', 'ret']
2025-05-19 23:23:24,686 - INFO - [src.data_preparation] - Ticker VCM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:24,686 - INFO - [src.data_preparation] - Ticker VCM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:24,687 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCM
2025-05-19 23:23:24,687 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:24,687 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(152), np.int64(1): np.int64(311)}
2025-05-19 23:23:24,687 - INFO - [src.data_preparation] - Generating 159 synthetic minority samples
2025-05-19 23:23:24,695 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (622, 13, 15), y shape: (622,)
2025-05-19 23:23:24,695 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(311), np.int64(1): np.int64(311)}
2025-05-19 23:23:24,698 - INFO - [src.data_preparation] - Ticker VCM - Final 3D shapes: X_train=(622, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:24,698 - INFO - [__main__] - Using best model for VCM: svm (F1: 0.6667)
2025-05-19 23:23:24,698 - INFO - [__main__] - Loading svm model for VCM...
2025-05-19 23:23:24,700 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:24,700 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:23:24,700 - INFO - [__main__] - Making predictions for VCM using svm
2025-05-19 23:23:24,701 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:24,701 - INFO - [__main__] - Successfully got last prediction for VCM
2025-05-19 23:23:24,701 - INFO - [__main__] - 
Processing ticker: VCR
2025-05-19 23:23:24,701 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:24,701 - INFO - [__main__] - Getting last prediction point for ticker: VCR
2025-05-19 23:23:24,702 - INFO - [__main__] - ==================================================
2025-05-19 23:23:24,702 - INFO - [__main__] - Preparing test data for VCR...
2025-05-19 23:23:24,734 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:24,734 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:24,734 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:24,755 - INFO - [src.data_preparation] - Ticker VCR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:24,755 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:23:25,106 - INFO - [src.data_preparation] - Ticker VCR - Selected features:
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   vnipc_t: 0.0781
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   SK: 0.0775
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   Volatility: 0.0723
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   TVV: 0.0710
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   s_d7_t: 0.0652
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   insec_t: 0.0629
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   ma14_t: 0.0616
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   ma7_t: 0.0614
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   ret: 0.0553
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   variation_t: 0.0543
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   ATR: 0.0496
2025-05-19 23:23:25,107 - INFO - [src.data_preparation] -   HL: 0.0492
2025-05-19 23:23:25,108 - INFO - [src.data_preparation] -   PM: 0.0488
2025-05-19 23:23:25,112 - INFO - [src.data_preparation] - Ticker VCR - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'TVV', 's_d7_t', 'insec_t', 'ma14_t', 'ma7_t', 'ret', 'ma21_t', 'variation_t', 'Median_HL', 'ATR', 'HL', 'PM']
2025-05-19 23:23:25,215 - INFO - [src.data_preparation] - Ticker VCR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:25,215 - INFO - [src.data_preparation] - Ticker VCR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:25,218 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCR
2025-05-19 23:23:25,218 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:25,218 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:23:25,218 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:23:25,221 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:23:25,221 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:23:25,225 - INFO - [src.data_preparation] - Ticker VCR - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:25,225 - INFO - [__main__] - Using best model for VCR: svm (F1: 0.4545)
2025-05-19 23:23:25,226 - INFO - [__main__] - Loading svm model for VCR...
2025-05-19 23:23:25,227 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:25,228 - INFO - [__main__] - Model size: 0.65 MB
2025-05-19 23:23:25,228 - INFO - [__main__] - Making predictions for VCR using svm
2025-05-19 23:23:25,229 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:25,229 - INFO - [__main__] - Successfully got last prediction for VCR
2025-05-19 23:23:25,229 - INFO - [__main__] - 
Processing ticker: VCS
2025-05-19 23:23:25,229 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:25,229 - INFO - [__main__] - Getting last prediction point for ticker: VCS
2025-05-19 23:23:25,229 - INFO - [__main__] - ==================================================
2025-05-19 23:23:25,229 - INFO - [__main__] - Preparing test data for VCS...
2025-05-19 23:23:25,257 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:25,258 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:25,258 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:25,278 - INFO - [src.data_preparation] - Ticker VCS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:25,279 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(293), np.int64(1): np.int64(346)}
2025-05-19 23:23:25,639 - INFO - [src.data_preparation] - Ticker VCS - Selected features:
2025-05-19 23:23:25,639 - INFO - [src.data_preparation] -   vnipc_t: 0.0747
2025-05-19 23:23:25,639 - INFO - [src.data_preparation] -   SK: 0.0690
2025-05-19 23:23:25,639 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:23:25,639 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   ma14_t: 0.0626
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   TVV: 0.0620
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   ATR: 0.0608
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   ma21_t: 0.0579
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   HL: 0.0557
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   ma7_t: 0.0540
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   Median_HL: 0.0535
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   SR: 0.0531
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   LO: 0.0528
2025-05-19 23:23:25,640 - INFO - [src.data_preparation] -   ret: 0.0500
2025-05-19 23:23:25,644 - INFO - [src.data_preparation] - Ticker VCS - Using features: ['Date', 'vnipc_t', 'SK', 'Volatility', 'insec_t', 's_d7_t', 'ma14_t', 'TVV', 'ATR', 'ma21_t', 'HL', 'ma7_t', 'Median_HL', 'SR', 'LO', 'ret']
2025-05-19 23:23:25,737 - INFO - [src.data_preparation] - Ticker VCS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:25,737 - INFO - [src.data_preparation] - Ticker VCS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:25,739 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCS
2025-05-19 23:23:25,739 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:25,739 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:23:25,739 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:23:25,742 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:23:25,743 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:23:25,745 - INFO - [src.data_preparation] - Ticker VCS - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:25,745 - INFO - [__main__] - Using best model for VCS: svm (F1: 0.4286)
2025-05-19 23:23:25,745 - INFO - [__main__] - Loading svm model for VCS...
2025-05-19 23:23:25,748 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:25,748 - INFO - [__main__] - Model size: 0.46 MB
2025-05-19 23:23:25,748 - INFO - [__main__] - Making predictions for VCS using svm
2025-05-19 23:23:25,749 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:25,749 - INFO - [__main__] - Successfully got last prediction for VCS
2025-05-19 23:23:25,750 - INFO - [__main__] - 
Processing ticker: VCT
2025-05-19 23:23:25,750 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:25,750 - INFO - [__main__] - Getting last prediction point for ticker: VCT
2025-05-19 23:23:25,750 - INFO - [__main__] - ==================================================
2025-05-19 23:23:25,750 - INFO - [__main__] - Preparing test data for VCT...
2025-05-19 23:23:25,785 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:25,785 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:25,785 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:25,804 - INFO - [src.data_preparation] - Ticker VCT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:25,805 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(50), np.int64(1): np.int64(589)}
2025-05-19 23:23:26,000 - INFO - [src.data_preparation] - Ticker VCT - Selected features:
2025-05-19 23:23:26,000 - INFO - [src.data_preparation] -   vnipc_t: 0.1954
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   ma21_t: 0.0908
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   ma14_t: 0.0803
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   ATR: 0.0676
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   ma7_t: 0.0672
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   s_d7_t: 0.0671
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   TVV: 0.0669
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   Median_HL: 0.0495
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   SK: 0.0455
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   Volatility: 0.0431
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   HL: 0.0389
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   ret: 0.0373
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   SR: 0.0351
2025-05-19 23:23:26,001 - INFO - [src.data_preparation] -   insec_t: 0.0284
2025-05-19 23:23:26,004 - INFO - [src.data_preparation] - Ticker VCT - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ATR', 'ma7_t', 's_d7_t', 'TVV', 'PM', 'Median_HL', 'SK', 'Volatility', 'HL', 'ret', 'SR', 'insec_t']
2025-05-19 23:23:26,091 - INFO - [src.data_preparation] - Ticker VCT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:26,091 - INFO - [src.data_preparation] - Ticker VCT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:26,093 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VCT
2025-05-19 23:23:26,093 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:26,093 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(37), np.int64(1): np.int64(426)}
2025-05-19 23:23:26,093 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:23:26,097 - INFO - [src.data_preparation] - Ticker VCT - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:26,097 - INFO - [__main__] - Using best model for VCT: lstm (F1: 0.9885)
2025-05-19 23:23:26,097 - INFO - [__main__] - Loading lstm model for VCT...
2025-05-19 23:23:26,101 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:26,102 - INFO - [__main__] - Model size: 0.17 MB
2025-05-19 23:23:26,102 - INFO - [__main__] - Making predictions for VCT using lstm
2025-05-19 23:23:26,105 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:26,105 - INFO - [__main__] - Successfully got last prediction for VCT
2025-05-19 23:23:26,105 - INFO - [__main__] - 
Processing ticker: VDL
2025-05-19 23:23:26,105 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:26,105 - INFO - [__main__] - Getting last prediction point for ticker: VDL
2025-05-19 23:23:26,105 - INFO - [__main__] - ==================================================
2025-05-19 23:23:26,106 - INFO - [__main__] - Preparing test data for VDL...
2025-05-19 23:23:26,163 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:26,163 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:26,163 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:26,188 - INFO - [src.data_preparation] - Ticker VDL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:26,188 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(213), np.int64(1): np.int64(426)}
2025-05-19 23:23:26,518 - INFO - [src.data_preparation] - Ticker VDL - Selected features:
2025-05-19 23:23:26,518 - INFO - [src.data_preparation] -   vnipc_t: 0.0873
2025-05-19 23:23:26,518 - INFO - [src.data_preparation] -   TVV: 0.0756
2025-05-19 23:23:26,518 - INFO - [src.data_preparation] -   ATR: 0.0718
2025-05-19 23:23:26,518 - INFO - [src.data_preparation] -   s_d7_t: 0.0693
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   Volatility: 0.0666
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   ma14_t: 0.0637
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   ma21_t: 0.0623
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   ma7_t: 0.0593
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   Median_HL: 0.0570
2025-05-19 23:23:26,519 - INFO - [src.data_preparation] -   PM: 0.0570
2025-05-19 23:23:26,520 - INFO - [src.data_preparation] -   insec_t: 0.0484
2025-05-19 23:23:26,520 - INFO - [src.data_preparation] -   HL: 0.0475
2025-05-19 23:23:26,520 - INFO - [src.data_preparation] -   variation_t: 0.0452
2025-05-19 23:23:26,520 - INFO - [src.data_preparation] -   ret: 0.0450
2025-05-19 23:23:26,522 - INFO - [src.data_preparation] - Ticker VDL - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 's_d7_t', 'SK', 'Volatility', 'ma14_t', 'ma21_t', 'ma7_t', 'Median_HL', 'PM', 'insec_t', 'HL', 'variation_t', 'ret']
2025-05-19 23:23:26,631 - INFO - [src.data_preparation] - Ticker VDL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:26,631 - INFO - [src.data_preparation] - Ticker VDL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:26,632 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VDL
2025-05-19 23:23:26,632 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:26,633 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(163), np.int64(1): np.int64(300)}
2025-05-19 23:23:26,633 - INFO - [src.data_preparation] - Generating 137 synthetic minority samples
2025-05-19 23:23:26,638 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (600, 13, 15), y shape: (600,)
2025-05-19 23:23:26,638 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(300), np.int64(1): np.int64(300)}
2025-05-19 23:23:26,641 - INFO - [src.data_preparation] - Ticker VDL - Final 3D shapes: X_train=(600, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:26,641 - INFO - [__main__] - Using best model for VDL: svm (F1: 0.9647)
2025-05-19 23:23:26,641 - INFO - [__main__] - Loading svm model for VDL...
2025-05-19 23:23:26,644 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:26,644 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:23:26,645 - INFO - [__main__] - Making predictions for VDL using svm
2025-05-19 23:23:26,645 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:26,646 - INFO - [__main__] - Successfully got last prediction for VDL
2025-05-19 23:23:26,646 - INFO - [__main__] - 
Processing ticker: VDN
2025-05-19 23:23:26,646 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:26,646 - INFO - [__main__] - Getting last prediction point for ticker: VDN
2025-05-19 23:23:26,646 - INFO - [__main__] - ==================================================
2025-05-19 23:23:26,646 - INFO - [__main__] - Preparing test data for VDN...
2025-05-19 23:23:26,682 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:26,682 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:26,682 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:26,701 - INFO - [src.data_preparation] - Ticker VDN - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:26,701 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(119), np.int64(1): np.int64(520)}
2025-05-19 23:23:26,949 - INFO - [src.data_preparation] - Ticker VDN - Selected features:
2025-05-19 23:23:26,949 - INFO - [src.data_preparation] -   vnipc_t: 0.0990
2025-05-19 23:23:26,949 - INFO - [src.data_preparation] -   ma21_t: 0.0790
2025-05-19 23:23:26,949 - INFO - [src.data_preparation] -   Median_HL: 0.0754
2025-05-19 23:23:26,949 - INFO - [src.data_preparation] -   PM: 0.0754
2025-05-19 23:23:26,949 - INFO - [src.data_preparation] -   ATR: 0.0707
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   s_d7_t: 0.0682
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   ma14_t: 0.0679
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   TVV: 0.0669
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   ma7_t: 0.0613
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   SK: 0.0564
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   HL: 0.0548
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   Volatility: 0.0511
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   LO: 0.0391
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   ret: 0.0354
2025-05-19 23:23:26,950 - INFO - [src.data_preparation] -   variation_t: 0.0349
2025-05-19 23:23:26,953 - INFO - [src.data_preparation] - Ticker VDN - Using features: ['Date', 'vnipc_t', 'ma21_t', 'Median_HL', 'PM', 'ATR', 's_d7_t', 'ma14_t', 'TVV', 'ma7_t', 'SK', 'HL', 'Volatility', 'LO', 'ret', 'variation_t']
2025-05-19 23:23:27,061 - INFO - [src.data_preparation] - Ticker VDN - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:27,062 - INFO - [src.data_preparation] - Ticker VDN - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:27,064 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VDN
2025-05-19 23:23:27,064 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:27,065 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(61), np.int64(1): np.int64(402)}
2025-05-19 23:23:27,065 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:23:27,069 - INFO - [src.data_preparation] - Ticker VDN - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:27,070 - INFO - [__main__] - Using best model for VDN: lstm (F1: 0.7606)
2025-05-19 23:23:27,070 - INFO - [__main__] - Loading lstm model for VDN...
2025-05-19 23:23:27,076 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:27,079 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:23:27,079 - INFO - [__main__] - Making predictions for VDN using lstm
2025-05-19 23:23:27,081 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:27,081 - INFO - [__main__] - Successfully got last prediction for VDN
2025-05-19 23:23:27,082 - INFO - [__main__] - 
Processing ticker: VDS
2025-05-19 23:23:27,082 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:27,082 - INFO - [__main__] - Getting last prediction point for ticker: VDS
2025-05-19 23:23:27,082 - INFO - [__main__] - ==================================================
2025-05-19 23:23:27,082 - INFO - [__main__] - Preparing test data for VDS...
2025-05-19 23:23:27,135 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:27,135 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:27,137 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:27,160 - INFO - [src.data_preparation] - Ticker VDS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:27,161 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(290), np.int64(1): np.int64(349)}
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] - Ticker VDS - Selected features:
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   SK: 0.0734
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   vnipc_t: 0.0688
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   TVV: 0.0650
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   insec_t: 0.0647
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   ret: 0.0625
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   s_d7_t: 0.0605
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   Volatility: 0.0605
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   ATR: 0.0603
2025-05-19 23:23:27,551 - INFO - [src.data_preparation] -   HL: 0.0562
2025-05-19 23:23:27,552 - INFO - [src.data_preparation] -   ma21_t: 0.0562
2025-05-19 23:23:27,552 - INFO - [src.data_preparation] -   variation_t: 0.0560
2025-05-19 23:23:27,552 - INFO - [src.data_preparation] -   ma7_t: 0.0549
2025-05-19 23:23:27,552 - INFO - [src.data_preparation] -   Median_HL: 0.0540
2025-05-19 23:23:27,552 - INFO - [src.data_preparation] -   PM: 0.0529
2025-05-19 23:23:27,552 - INFO - [src.data_preparation] -   ma14_t: 0.0529
2025-05-19 23:23:27,557 - INFO - [src.data_preparation] - Ticker VDS - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'insec_t', 'ret', 's_d7_t', 'Volatility', 'ATR', 'HL', 'ma21_t', 'variation_t', 'ma7_t', 'Median_HL', 'PM', 'ma14_t']
2025-05-19 23:23:27,654 - INFO - [src.data_preparation] - Ticker VDS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:27,654 - INFO - [src.data_preparation] - Ticker VDS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:27,655 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VDS
2025-05-19 23:23:27,655 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:27,655 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(260)}
2025-05-19 23:23:27,655 - INFO - [src.data_preparation] - Generating 57 synthetic minority samples
2025-05-19 23:23:27,658 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (520, 13, 15), y shape: (520,)
2025-05-19 23:23:27,658 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(260), np.int64(1): np.int64(260)}
2025-05-19 23:23:27,662 - INFO - [src.data_preparation] - Ticker VDS - Final 3D shapes: X_train=(520, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:27,662 - INFO - [__main__] - Using best model for VDS: logistic_regression (F1: 0.5806)
2025-05-19 23:23:27,663 - INFO - [__main__] - Loading logistic_regression model for VDS...
2025-05-19 23:23:27,664 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:27,664 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:27,664 - INFO - [__main__] - Making predictions for VDS using logistic_regression
2025-05-19 23:23:27,664 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:27,665 - INFO - [__main__] - Successfully got last prediction for VDS
2025-05-19 23:23:27,665 - INFO - [__main__] - 
Processing ticker: VDT
2025-05-19 23:23:27,665 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:27,665 - INFO - [__main__] - Getting last prediction point for ticker: VDT
2025-05-19 23:23:27,665 - INFO - [__main__] - ==================================================
2025-05-19 23:23:27,665 - INFO - [__main__] - Preparing test data for VDT...
2025-05-19 23:23:27,698 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:27,698 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:27,698 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:27,719 - INFO - [src.data_preparation] - Ticker VDT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:27,719 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(155), np.int64(1): np.int64(484)}
2025-05-19 23:23:28,006 - INFO - [src.data_preparation] - Ticker VDT - Selected features:
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   TVV: 0.0926
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   vnipc_t: 0.0893
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   ma21_t: 0.0778
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   Volatility: 0.0729
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   ma14_t: 0.0691
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   ATR: 0.0688
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   s_d7_t: 0.0677
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   ma7_t: 0.0610
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   Median_HL: 0.0561
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   PM: 0.0561
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   SK: 0.0502
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   HL: 0.0448
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   variation_t: 0.0424
2025-05-19 23:23:28,007 - INFO - [src.data_preparation] -   insec_t: 0.0374
2025-05-19 23:23:28,008 - INFO - [src.data_preparation] -   ret: 0.0374
2025-05-19 23:23:28,010 - INFO - [src.data_preparation] - Ticker VDT - Using features: ['Date', 'TVV', 'vnipc_t', 'ma21_t', 'Volatility', 'ma14_t', 'ATR', 's_d7_t', 'ma7_t', 'Median_HL', 'PM', 'SK', 'HL', 'variation_t', 'insec_t', 'ret']
2025-05-19 23:23:28,108 - INFO - [src.data_preparation] - Ticker VDT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:28,108 - INFO - [src.data_preparation] - Ticker VDT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:28,111 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VDT
2025-05-19 23:23:28,111 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:28,111 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(125), np.int64(1): np.int64(338)}
2025-05-19 23:23:28,111 - INFO - [src.data_preparation] - Generating 213 synthetic minority samples
2025-05-19 23:23:28,121 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (676, 13, 15), y shape: (676,)
2025-05-19 23:23:28,121 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(338), np.int64(1): np.int64(338)}
2025-05-19 23:23:28,124 - INFO - [src.data_preparation] - Ticker VDT - Final 3D shapes: X_train=(676, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:28,124 - INFO - [__main__] - Using best model for VDT: svm (F1: 0.8421)
2025-05-19 23:23:28,127 - INFO - [__main__] - Loading svm model for VDT...
2025-05-19 23:23:28,129 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:28,130 - INFO - [__main__] - Model size: 1.02 MB
2025-05-19 23:23:28,130 - INFO - [__main__] - Making predictions for VDT using svm
2025-05-19 23:23:28,131 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:28,131 - INFO - [__main__] - Successfully got last prediction for VDT
2025-05-19 23:23:28,131 - INFO - [__main__] - 
Processing ticker: VE1
2025-05-19 23:23:28,132 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:28,132 - INFO - [__main__] - Getting last prediction point for ticker: VE1
2025-05-19 23:23:28,132 - INFO - [__main__] - ==================================================
2025-05-19 23:23:28,132 - INFO - [__main__] - Preparing test data for VE1...
2025-05-19 23:23:28,159 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:28,159 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:28,159 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:28,181 - INFO - [src.data_preparation] - Ticker VE1 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:28,181 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] - Ticker VE1 - Selected features:
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   vnipc_t: 0.0764
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   Volatility: 0.0752
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   TVV: 0.0727
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   insec_t: 0.0684
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   SK: 0.0681
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   s_d7_t: 0.0674
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   ma21_t: 0.0601
2025-05-19 23:23:28,484 - INFO - [src.data_preparation] -   ma14_t: 0.0595
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   ATR: 0.0592
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   variation_t: 0.0539
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   PM: 0.0539
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   ret: 0.0524
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   HL: 0.0500
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   ma7_t: 0.0488
2025-05-19 23:23:28,485 - INFO - [src.data_preparation] -   Median_HL: 0.0478
2025-05-19 23:23:28,488 - INFO - [src.data_preparation] - Ticker VE1 - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 'insec_t', 'SK', 's_d7_t', 'ma21_t', 'ma14_t', 'ATR', 'variation_t', 'PM', 'ret', 'HL', 'ma7_t', 'Median_HL']
2025-05-19 23:23:28,577 - INFO - [src.data_preparation] - Ticker VE1 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:28,577 - INFO - [src.data_preparation] - Ticker VE1 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:28,578 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VE1
2025-05-19 23:23:28,579 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:28,579 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(194), np.int64(1): np.int64(269)}
2025-05-19 23:23:28,579 - INFO - [src.data_preparation] - Generating 75 synthetic minority samples
2025-05-19 23:23:28,583 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (538, 13, 15), y shape: (538,)
2025-05-19 23:23:28,583 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(269), np.int64(1): np.int64(269)}
2025-05-19 23:23:28,587 - INFO - [src.data_preparation] - Ticker VE1 - Final 3D shapes: X_train=(538, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:28,587 - INFO - [__main__] - Using best model for VE1: transformer (F1: 0.7606)
2025-05-19 23:23:28,587 - INFO - [__main__] - Loading transformer model for VE1...
2025-05-19 23:23:28,603 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:28,609 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:23:28,609 - INFO - [__main__] - Making predictions for VE1 using transformer
2025-05-19 23:23:28,612 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:28,613 - INFO - [__main__] - Successfully got last prediction for VE1
2025-05-19 23:23:28,613 - INFO - [__main__] - 
Processing ticker: VE2
2025-05-19 23:23:28,613 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:28,613 - INFO - [__main__] - Getting last prediction point for ticker: VE2
2025-05-19 23:23:28,613 - INFO - [__main__] - ==================================================
2025-05-19 23:23:28,613 - INFO - [__main__] - Preparing test data for VE2...
2025-05-19 23:23:28,668 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:28,668 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:28,668 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:28,690 - INFO - [src.data_preparation] - Ticker VE2 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:28,690 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(123), np.int64(1): np.int64(516)}
2025-05-19 23:23:28,970 - INFO - [src.data_preparation] - Ticker VE2 - Selected features:
2025-05-19 23:23:28,970 - INFO - [src.data_preparation] -   vnipc_t: 0.1018
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   TVV: 0.0868
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   ma7_t: 0.0786
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   Volatility: 0.0731
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   ATR: 0.0728
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   s_d7_t: 0.0717
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   ma21_t: 0.0699
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   ma14_t: 0.0638
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   SK: 0.0612
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   insec_t: 0.0602
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   Median_HL: 0.0580
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   PM: 0.0477
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   HL: 0.0340
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   ret: 0.0328
2025-05-19 23:23:28,971 - INFO - [src.data_preparation] -   variation_t: 0.0323
2025-05-19 23:23:28,974 - INFO - [src.data_preparation] - Ticker VE2 - Using features: ['Date', 'vnipc_t', 'TVV', 'ma7_t', 'Volatility', 'ATR', 's_d7_t', 'ma21_t', 'ma14_t', 'SK', 'insec_t', 'Median_HL', 'PM', 'HL', 'ret', 'variation_t']
2025-05-19 23:23:29,067 - INFO - [src.data_preparation] - Ticker VE2 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:29,067 - INFO - [src.data_preparation] - Ticker VE2 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:29,069 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VE2
2025-05-19 23:23:29,069 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:29,069 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(113), np.int64(1): np.int64(350)}
2025-05-19 23:23:29,069 - INFO - [src.data_preparation] - Generating 237 synthetic minority samples
2025-05-19 23:23:29,080 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (700, 13, 15), y shape: (700,)
2025-05-19 23:23:29,080 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(350), np.int64(1): np.int64(350)}
2025-05-19 23:23:29,084 - INFO - [src.data_preparation] - Ticker VE2 - Final 3D shapes: X_train=(700, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:29,085 - INFO - [__main__] - Using best model for VE2: transformer (F1: 0.9885)
2025-05-19 23:23:29,085 - INFO - [__main__] - Loading transformer model for VE2...
2025-05-19 23:23:29,099 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:29,104 - INFO - [__main__] - Model size: 0.22 MB
2025-05-19 23:23:29,105 - INFO - [__main__] - Making predictions for VE2 using transformer
2025-05-19 23:23:29,106 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:29,106 - INFO - [__main__] - Successfully got last prediction for VE2
2025-05-19 23:23:29,106 - INFO - [__main__] - 
Processing ticker: VE3
2025-05-19 23:23:29,107 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:29,107 - INFO - [__main__] - Getting last prediction point for ticker: VE3
2025-05-19 23:23:29,107 - INFO - [__main__] - ==================================================
2025-05-19 23:23:29,107 - INFO - [__main__] - Preparing test data for VE3...
2025-05-19 23:23:29,142 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:29,142 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:29,142 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:29,166 - INFO - [src.data_preparation] - Ticker VE3 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:29,166 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(232), np.int64(1): np.int64(407)}
2025-05-19 23:23:29,509 - INFO - [src.data_preparation] - Ticker VE3 - Selected features:
2025-05-19 23:23:29,509 - INFO - [src.data_preparation] -   TVV: 0.0731
2025-05-19 23:23:29,509 - INFO - [src.data_preparation] -   vnipc_t: 0.0718
2025-05-19 23:23:29,509 - INFO - [src.data_preparation] -   SK: 0.0685
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   Volatility: 0.0678
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   insec_t: 0.0675
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   s_d7_t: 0.0645
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   ATR: 0.0609
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   ma21_t: 0.0605
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   ma7_t: 0.0592
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   ma14_t: 0.0583
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   PM: 0.0560
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   variation_t: 0.0544
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   SR: 0.0517
2025-05-19 23:23:29,510 - INFO - [src.data_preparation] -   ret: 0.0489
2025-05-19 23:23:29,514 - INFO - [src.data_preparation] - Ticker VE3 - Using features: ['Date', 'TVV', 'vnipc_t', 'SK', 'Volatility', 'insec_t', 's_d7_t', 'ATR', 'ma21_t', 'ma7_t', 'ma14_t', 'PM', 'Median_HL', 'variation_t', 'SR', 'ret']
2025-05-19 23:23:29,617 - INFO - [src.data_preparation] - Ticker VE3 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:29,618 - INFO - [src.data_preparation] - Ticker VE3 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:29,619 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VE3
2025-05-19 23:23:29,620 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:29,620 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(164), np.int64(1): np.int64(299)}
2025-05-19 23:23:29,620 - INFO - [src.data_preparation] - Generating 135 synthetic minority samples
2025-05-19 23:23:29,625 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (598, 13, 15), y shape: (598,)
2025-05-19 23:23:29,625 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(299), np.int64(1): np.int64(299)}
2025-05-19 23:23:29,629 - INFO - [src.data_preparation] - Ticker VE3 - Final 3D shapes: X_train=(598, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:29,629 - INFO - [__main__] - Using best model for VE3: svm (F1: 0.7945)
2025-05-19 23:23:29,630 - INFO - [__main__] - Loading svm model for VE3...
2025-05-19 23:23:29,631 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:29,631 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:23:29,631 - INFO - [__main__] - Making predictions for VE3 using svm
2025-05-19 23:23:29,632 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:29,633 - INFO - [__main__] - Successfully got last prediction for VE3
2025-05-19 23:23:29,633 - INFO - [__main__] - 
Processing ticker: VE4
2025-05-19 23:23:29,633 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:29,633 - INFO - [__main__] - Getting last prediction point for ticker: VE4
2025-05-19 23:23:29,633 - INFO - [__main__] - ==================================================
2025-05-19 23:23:29,633 - INFO - [__main__] - Preparing test data for VE4...
2025-05-19 23:23:29,661 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:29,661 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:29,661 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:29,688 - INFO - [src.data_preparation] - Ticker VE4 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:29,689 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(139), np.int64(1): np.int64(500)}
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] - Ticker VE4 - Selected features:
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   vnipc_t: 0.0941
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   ma21_t: 0.0784
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   TVV: 0.0784
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   ma14_t: 0.0777
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   ma7_t: 0.0675
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   Median_HL: 0.0627
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   PM: 0.0612
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   ATR: 0.0600
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   s_d7_t: 0.0572
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   SK: 0.0559
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   Volatility: 0.0540
2025-05-19 23:23:29,956 - INFO - [src.data_preparation] -   insec_t: 0.0470
2025-05-19 23:23:29,957 - INFO - [src.data_preparation] -   SR: 0.0422
2025-05-19 23:23:29,957 - INFO - [src.data_preparation] -   HL: 0.0409
2025-05-19 23:23:29,957 - INFO - [src.data_preparation] -   ret: 0.0400
2025-05-19 23:23:29,959 - INFO - [src.data_preparation] - Ticker VE4 - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ma14_t', 'ma7_t', 'Median_HL', 'PM', 'ATR', 's_d7_t', 'SK', 'Volatility', 'insec_t', 'SR', 'HL', 'ret']
2025-05-19 23:23:30,052 - INFO - [src.data_preparation] - Ticker VE4 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:30,053 - INFO - [src.data_preparation] - Ticker VE4 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:30,055 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VE4
2025-05-19 23:23:30,055 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:30,055 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(124), np.int64(1): np.int64(339)}
2025-05-19 23:23:30,055 - INFO - [src.data_preparation] - Generating 215 synthetic minority samples
2025-05-19 23:23:30,068 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (678, 13, 15), y shape: (678,)
2025-05-19 23:23:30,068 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(339), np.int64(1): np.int64(339)}
2025-05-19 23:23:30,073 - INFO - [src.data_preparation] - Ticker VE4 - Final 3D shapes: X_train=(678, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:30,074 - INFO - [__main__] - Using best model for VE4: lstm (F1: 0.9885)
2025-05-19 23:23:30,074 - INFO - [__main__] - Loading lstm model for VE4...
2025-05-19 23:23:30,079 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:30,081 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:23:30,081 - INFO - [__main__] - Making predictions for VE4 using lstm
2025-05-19 23:23:30,083 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:30,084 - INFO - [__main__] - Successfully got last prediction for VE4
2025-05-19 23:23:30,084 - INFO - [__main__] - 
Processing ticker: VE8
2025-05-19 23:23:30,084 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:30,084 - INFO - [__main__] - Getting last prediction point for ticker: VE8
2025-05-19 23:23:30,085 - INFO - [__main__] - ==================================================
2025-05-19 23:23:30,085 - INFO - [__main__] - Preparing test data for VE8...
2025-05-19 23:23:30,138 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:30,138 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:30,139 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:30,163 - INFO - [src.data_preparation] - Ticker VE8 - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:30,163 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(210), np.int64(1): np.int64(429)}
2025-05-19 23:23:30,471 - INFO - [src.data_preparation] - Ticker VE8 - Selected features:
2025-05-19 23:23:30,471 - INFO - [src.data_preparation] -   TVV: 0.0938
2025-05-19 23:23:30,471 - INFO - [src.data_preparation] -   vnipc_t: 0.0807
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   s_d7_t: 0.0757
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   ATR: 0.0755
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   Volatility: 0.0705
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   HL: 0.0641
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   insec_t: 0.0591
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   SK: 0.0582
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   LO: 0.0532
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   ma21_t: 0.0517
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   ma7_t: 0.0514
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   ma14_t: 0.0481
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   PM: 0.0464
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   variation_t: 0.0439
2025-05-19 23:23:30,472 - INFO - [src.data_preparation] -   Median_HL: 0.0437
2025-05-19 23:23:30,475 - INFO - [src.data_preparation] - Ticker VE8 - Using features: ['Date', 'TVV', 'vnipc_t', 's_d7_t', 'ATR', 'Volatility', 'HL', 'insec_t', 'SK', 'LO', 'ma21_t', 'ma7_t', 'ma14_t', 'PM', 'variation_t', 'Median_HL']
2025-05-19 23:23:30,561 - INFO - [src.data_preparation] - Ticker VE8 - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:30,561 - INFO - [src.data_preparation] - Ticker VE8 - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:30,564 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VE8
2025-05-19 23:23:30,564 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:30,564 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(144), np.int64(1): np.int64(319)}
2025-05-19 23:23:30,564 - INFO - [src.data_preparation] - Generating 175 synthetic minority samples
2025-05-19 23:23:30,571 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (638, 13, 15), y shape: (638,)
2025-05-19 23:23:30,571 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(319), np.int64(1): np.int64(319)}
2025-05-19 23:23:30,574 - INFO - [src.data_preparation] - Ticker VE8 - Final 3D shapes: X_train=(638, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:30,574 - INFO - [__main__] - Using best model for VE8: transformer (F1: 0.7945)
2025-05-19 23:23:30,575 - INFO - [__main__] - Loading transformer model for VE8...
2025-05-19 23:23:30,593 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:23:30,600 - INFO - [__main__] - Model size: 0.46 MB
2025-05-19 23:23:30,600 - INFO - [__main__] - Making predictions for VE8 using transformer
2025-05-19 23:23:30,604 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:30,605 - INFO - [__main__] - Successfully got last prediction for VE8
2025-05-19 23:23:30,605 - INFO - [__main__] - 
Processing ticker: VE9
2025-05-19 23:23:30,605 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:30,605 - INFO - [__main__] - Getting last prediction point for ticker: VE9
2025-05-19 23:23:30,605 - INFO - [__main__] - ==================================================
2025-05-19 23:23:30,605 - INFO - [__main__] - Preparing test data for VE9...
2025-05-19 23:23:30,646 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:30,646 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:30,646 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:30,670 - INFO - [src.data_preparation] - Ticker VE9 - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:30,670 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(259), np.int64(1): np.int64(379)}
2025-05-19 23:23:31,002 - INFO - [src.data_preparation] - Ticker VE9 - Selected features:
2025-05-19 23:23:31,002 - INFO - [src.data_preparation] -   Volatility: 0.0726
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   vnipc_t: 0.0724
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   TVV: 0.0696
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   SK: 0.0668
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   insec_t: 0.0666
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   s_d7_t: 0.0630
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   ma14_t: 0.0626
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   Median_HL: 0.0576
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   ma7_t: 0.0570
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   variation_t: 0.0563
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   ATR: 0.0561
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   ma21_t: 0.0559
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   SR: 0.0525
2025-05-19 23:23:31,003 - INFO - [src.data_preparation] -   ret: 0.0509
2025-05-19 23:23:31,004 - INFO - [src.data_preparation] -   PM: 0.0491
2025-05-19 23:23:31,007 - INFO - [src.data_preparation] - Ticker VE9 - Using features: ['Date', 'Volatility', 'vnipc_t', 'TVV', 'SK', 'insec_t', 's_d7_t', 'ma14_t', 'Median_HL', 'ma7_t', 'variation_t', 'ATR', 'ma21_t', 'SR', 'ret', 'PM']
2025-05-19 23:23:31,093 - INFO - [src.data_preparation] - Ticker VE9 - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:31,093 - INFO - [src.data_preparation] - Ticker VE9 - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:31,094 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VE9
2025-05-19 23:23:31,094 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:31,095 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(187), np.int64(1): np.int64(275)}
2025-05-19 23:23:31,095 - INFO - [src.data_preparation] - Generating 88 synthetic minority samples
2025-05-19 23:23:31,101 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (550, 13, 15), y shape: (550,)
2025-05-19 23:23:31,101 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(275), np.int64(1): np.int64(275)}
2025-05-19 23:23:31,105 - INFO - [src.data_preparation] - Ticker VE9 - Final 3D shapes: X_train=(550, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:31,105 - INFO - [__main__] - Using best model for VE9: lstm (F1: 0.8000)
2025-05-19 23:23:31,105 - INFO - [__main__] - Loading lstm model for VE9...
2025-05-19 23:23:31,109 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:31,110 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:23:31,110 - INFO - [__main__] - Making predictions for VE9 using lstm
2025-05-19 23:23:31,111 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:31,112 - INFO - [__main__] - Successfully got last prediction for VE9
2025-05-19 23:23:31,112 - INFO - [__main__] - 
Processing ticker: VES
2025-05-19 23:23:31,112 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:31,112 - INFO - [__main__] - Getting last prediction point for ticker: VES
2025-05-19 23:23:31,112 - INFO - [__main__] - ==================================================
2025-05-19 23:23:31,112 - INFO - [__main__] - Preparing test data for VES...
2025-05-19 23:23:31,144 - INFO - [src.data_preparation] - After processing - X shape: (543, 19), y shape: (543,)
2025-05-19 23:23:31,144 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:31,144 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:31,170 - INFO - [src.data_preparation] - Ticker VES - Original shapes: X=(543, 18), y=(543,)
2025-05-19 23:23:31,170 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(116), np.int64(1): np.int64(427)}
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] - Ticker VES - Selected features:
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   TVV: 0.1043
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   vnipc_t: 0.0979
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   ATR: 0.0842
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   Volatility: 0.0797
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   insec_t: 0.0686
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   s_d7_t: 0.0662
2025-05-19 23:23:31,428 - INFO - [src.data_preparation] -   ma14_t: 0.0629
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   ma21_t: 0.0591
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   ma7_t: 0.0523
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   SK: 0.0488
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   PM: 0.0460
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   HL: 0.0448
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   Median_HL: 0.0403
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   SR: 0.0400
2025-05-19 23:23:31,429 - INFO - [src.data_preparation] -   variation_t: 0.0374
2025-05-19 23:23:31,432 - INFO - [src.data_preparation] - Ticker VES - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 'Volatility', 'insec_t', 's_d7_t', 'ma14_t', 'ma21_t', 'ma7_t', 'SK', 'PM', 'HL', 'Median_HL', 'SR', 'variation_t']
2025-05-19 23:23:31,507 - INFO - [src.data_preparation] - Ticker VES - 2D shapes: X_train=(367, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:31,507 - INFO - [src.data_preparation] - Ticker VES - 3D shapes: X_train=(367, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:31,509 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VES
2025-05-19 23:23:31,509 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (367, 13, 15), y shape: (367,)
2025-05-19 23:23:31,509 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(85), np.int64(1): np.int64(282)}
2025-05-19 23:23:31,509 - INFO - [src.data_preparation] - Generating 197 synthetic minority samples
2025-05-19 23:23:31,517 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (564, 13, 15), y shape: (564,)
2025-05-19 23:23:31,518 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(282), np.int64(1): np.int64(282)}
2025-05-19 23:23:31,521 - INFO - [src.data_preparation] - Ticker VES - Final 3D shapes: X_train=(564, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:31,521 - INFO - [__main__] - Using best model for VES: svm (F1: 0.9143)
2025-05-19 23:23:31,521 - INFO - [__main__] - Loading svm model for VES...
2025-05-19 23:23:31,523 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:31,523 - INFO - [__main__] - Model size: 0.75 MB
2025-05-19 23:23:31,523 - INFO - [__main__] - Making predictions for VES using svm
2025-05-19 23:23:31,524 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:31,524 - INFO - [__main__] - Successfully got last prediction for VES
2025-05-19 23:23:31,524 - INFO - [__main__] - 
Processing ticker: VFC
2025-05-19 23:23:31,524 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:31,524 - INFO - [__main__] - Getting last prediction point for ticker: VFC
2025-05-19 23:23:31,524 - INFO - [__main__] - ==================================================
2025-05-19 23:23:31,524 - INFO - [__main__] - Preparing test data for VFC...
2025-05-19 23:23:31,553 - INFO - [src.data_preparation] - After processing - X shape: (619, 19), y shape: (619,)
2025-05-19 23:23:31,553 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:31,553 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:31,573 - INFO - [src.data_preparation] - Ticker VFC - Original shapes: X=(619, 18), y=(619,)
2025-05-19 23:23:31,573 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(218), np.int64(1): np.int64(401)}
2025-05-19 23:23:31,874 - INFO - [src.data_preparation] - Ticker VFC - Selected features:
2025-05-19 23:23:31,874 - INFO - [src.data_preparation] -   TVV: 0.0984
2025-05-19 23:23:31,874 - INFO - [src.data_preparation] -   vnipc_t: 0.0763
2025-05-19 23:23:31,874 - INFO - [src.data_preparation] -   Volatility: 0.0647
2025-05-19 23:23:31,874 - INFO - [src.data_preparation] -   ma21_t: 0.0629
2025-05-19 23:23:31,874 - INFO - [src.data_preparation] -   s_d7_t: 0.0617
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   SK: 0.0585
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   variation_t: 0.0558
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   ma14_t: 0.0554
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   ma7_t: 0.0551
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   ATR: 0.0549
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   insec_t: 0.0542
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   PM: 0.0512
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   HL: 0.0499
2025-05-19 23:23:31,875 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:23:31,880 - INFO - [src.data_preparation] - Ticker VFC - Using features: ['Date', 'TVV', 'vnipc_t', 'Volatility', 'ma21_t', 's_d7_t', 'SK', 'variation_t', 'ma14_t', 'ma7_t', 'ATR', 'insec_t', 'ret', 'PM', 'HL', 'Median_HL']
2025-05-19 23:23:31,986 - INFO - [src.data_preparation] - Ticker VFC - 2D shapes: X_train=(443, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:31,986 - INFO - [src.data_preparation] - Ticker VFC - 3D shapes: X_train=(443, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:31,988 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VFC
2025-05-19 23:23:31,988 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (443, 13, 15), y shape: (443,)
2025-05-19 23:23:31,988 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(153), np.int64(1): np.int64(290)}
2025-05-19 23:23:31,988 - INFO - [src.data_preparation] - Generating 137 synthetic minority samples
2025-05-19 23:23:31,994 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (580, 13, 15), y shape: (580,)
2025-05-19 23:23:31,994 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(290), np.int64(1): np.int64(290)}
2025-05-19 23:23:31,998 - INFO - [src.data_preparation] - Ticker VFC - Final 3D shapes: X_train=(580, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:31,998 - INFO - [__main__] - Using best model for VFC: lstm (F1: 0.8108)
2025-05-19 23:23:31,998 - INFO - [__main__] - Loading lstm model for VFC...
2025-05-19 23:23:32,002 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:32,004 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:23:32,004 - INFO - [__main__] - Making predictions for VFC using lstm
2025-05-19 23:23:32,005 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:32,006 - INFO - [__main__] - Successfully got last prediction for VFC
2025-05-19 23:23:32,006 - INFO - [__main__] - 
Processing ticker: VFG
2025-05-19 23:23:32,006 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:32,006 - INFO - [__main__] - Getting last prediction point for ticker: VFG
2025-05-19 23:23:32,006 - INFO - [__main__] - ==================================================
2025-05-19 23:23:32,006 - INFO - [__main__] - Preparing test data for VFG...
2025-05-19 23:23:32,040 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:32,040 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:32,040 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:32,071 - INFO - [src.data_preparation] - Ticker VFG - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:32,071 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(351)}
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] - Ticker VFG - Selected features:
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   SK: 0.0722
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   SR: 0.0678
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   insec_t: 0.0677
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   HL: 0.0643
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   TVV: 0.0642
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   vnipc_t: 0.0636
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   ATR: 0.0627
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   LO: 0.0559
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   variation_t: 0.0541
2025-05-19 23:23:32,501 - INFO - [src.data_preparation] -   Volatility: 0.0540
2025-05-19 23:23:32,502 - INFO - [src.data_preparation] -   ma21_t: 0.0518
2025-05-19 23:23:32,502 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:23:32,502 - INFO - [src.data_preparation] -   ma14_t: 0.0515
2025-05-19 23:23:32,502 - INFO - [src.data_preparation] -   Median_HL: 0.0504
2025-05-19 23:23:32,505 - INFO - [src.data_preparation] - Ticker VFG - Using features: ['Date', 'SK', 'SR', 'insec_t', 'HL', 'TVV', 'vnipc_t', 's_d7_t', 'ATR', 'LO', 'variation_t', 'Volatility', 'ma21_t', 'ret', 'ma14_t', 'Median_HL']
2025-05-19 23:23:32,605 - INFO - [src.data_preparation] - Ticker VFG - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:32,605 - INFO - [src.data_preparation] - Ticker VFG - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:32,607 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VFG
2025-05-19 23:23:32,607 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:32,607 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(204), np.int64(1): np.int64(258)}
2025-05-19 23:23:32,607 - INFO - [src.data_preparation] - Generating 54 synthetic minority samples
2025-05-19 23:23:32,609 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (516, 13, 15), y shape: (516,)
2025-05-19 23:23:32,611 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(258), np.int64(1): np.int64(258)}
2025-05-19 23:23:32,614 - INFO - [src.data_preparation] - Ticker VFG - Final 3D shapes: X_train=(516, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:32,615 - INFO - [__main__] - Using best model for VFG: svm (F1: 0.6462)
2025-05-19 23:23:32,615 - INFO - [__main__] - Loading svm model for VFG...
2025-05-19 23:23:32,617 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:32,618 - INFO - [__main__] - Model size: 0.78 MB
2025-05-19 23:23:32,618 - INFO - [__main__] - Making predictions for VFG using svm
2025-05-19 23:23:32,619 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:32,619 - INFO - [__main__] - Successfully got last prediction for VFG
2025-05-19 23:23:32,619 - INFO - [__main__] - 
Processing ticker: VFR
2025-05-19 23:23:32,619 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:32,620 - INFO - [__main__] - Getting last prediction point for ticker: VFR
2025-05-19 23:23:32,620 - INFO - [__main__] - ==================================================
2025-05-19 23:23:32,620 - INFO - [__main__] - Preparing test data for VFR...
2025-05-19 23:23:32,658 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:32,658 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:32,658 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:32,680 - INFO - [src.data_preparation] - Ticker VFR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:32,680 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(256), np.int64(1): np.int64(383)}
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] - Ticker VFR - Selected features:
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   vnipc_t: 0.0751
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   TVV: 0.0692
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   ATR: 0.0659
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   ma21_t: 0.0654
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   ma14_t: 0.0644
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   SK: 0.0634
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   s_d7_t: 0.0622
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   Volatility: 0.0620
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   ma7_t: 0.0602
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   Median_HL: 0.0600
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   insec_t: 0.0593
2025-05-19 23:23:32,971 - INFO - [src.data_preparation] -   PM: 0.0565
2025-05-19 23:23:32,972 - INFO - [src.data_preparation] -   ret: 0.0499
2025-05-19 23:23:32,972 - INFO - [src.data_preparation] -   variation_t: 0.0458
2025-05-19 23:23:32,972 - INFO - [src.data_preparation] -   HL: 0.0428
2025-05-19 23:23:32,974 - INFO - [src.data_preparation] - Ticker VFR - Using features: ['Date', 'vnipc_t', 'TVV', 'ATR', 'ma21_t', 'ma14_t', 'SK', 's_d7_t', 'Volatility', 'ma7_t', 'Median_HL', 'insec_t', 'PM', 'ret', 'variation_t', 'HL']
2025-05-19 23:23:33,065 - INFO - [src.data_preparation] - Ticker VFR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:33,065 - INFO - [src.data_preparation] - Ticker VFR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:33,067 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VFR
2025-05-19 23:23:33,068 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:33,068 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(167), np.int64(1): np.int64(296)}
2025-05-19 23:23:33,068 - INFO - [src.data_preparation] - Generating 129 synthetic minority samples
2025-05-19 23:23:33,073 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (592, 13, 15), y shape: (592,)
2025-05-19 23:23:33,073 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(296), np.int64(1): np.int64(296)}
2025-05-19 23:23:33,078 - INFO - [src.data_preparation] - Ticker VFR - Final 3D shapes: X_train=(592, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:33,078 - INFO - [__main__] - Using best model for VFR: svm (F1: 0.6866)
2025-05-19 23:23:33,078 - INFO - [__main__] - Loading svm model for VFR...
2025-05-19 23:23:33,080 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:33,081 - INFO - [__main__] - Model size: 0.89 MB
2025-05-19 23:23:33,081 - INFO - [__main__] - Making predictions for VFR using svm
2025-05-19 23:23:33,082 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:33,083 - INFO - [__main__] - Successfully got last prediction for VFR
2025-05-19 23:23:33,083 - INFO - [__main__] - 
Processing ticker: VGP
2025-05-19 23:23:33,083 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:33,083 - INFO - [__main__] - Getting last prediction point for ticker: VGP
2025-05-19 23:23:33,083 - INFO - [__main__] - ==================================================
2025-05-19 23:23:33,083 - INFO - [__main__] - Preparing test data for VGP...
2025-05-19 23:23:33,128 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:33,128 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:33,128 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:33,150 - INFO - [src.data_preparation] - Ticker VGP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:33,151 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(217), np.int64(1): np.int64(422)}
2025-05-19 23:23:33,467 - INFO - [src.data_preparation] - Ticker VGP - Selected features:
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   ATR: 0.0755
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   Volatility: 0.0734
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   TVV: 0.0729
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   SK: 0.0722
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   vnipc_t: 0.0696
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   s_d7_t: 0.0674
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   Median_HL: 0.0574
2025-05-19 23:23:33,468 - INFO - [src.data_preparation] -   ma21_t: 0.0564
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   ma14_t: 0.0564
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   insec_t: 0.0554
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   PM: 0.0549
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   HL: 0.0543
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   ma7_t: 0.0511
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   ret: 0.0472
2025-05-19 23:23:33,469 - INFO - [src.data_preparation] -   SR: 0.0458
2025-05-19 23:23:33,472 - INFO - [src.data_preparation] - Ticker VGP - Using features: ['Date', 'ATR', 'Volatility', 'TVV', 'SK', 'vnipc_t', 's_d7_t', 'Median_HL', 'ma21_t', 'ma14_t', 'insec_t', 'PM', 'HL', 'ma7_t', 'ret', 'SR']
2025-05-19 23:23:33,571 - INFO - [src.data_preparation] - Ticker VGP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:33,571 - INFO - [src.data_preparation] - Ticker VGP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:33,573 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VGP
2025-05-19 23:23:33,573 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:33,573 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(165), np.int64(1): np.int64(298)}
2025-05-19 23:23:33,573 - INFO - [src.data_preparation] - Generating 133 synthetic minority samples
2025-05-19 23:23:33,580 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (596, 13, 15), y shape: (596,)
2025-05-19 23:23:33,580 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(298), np.int64(1): np.int64(298)}
2025-05-19 23:23:33,585 - INFO - [src.data_preparation] - Ticker VGP - Final 3D shapes: X_train=(596, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:33,585 - INFO - [__main__] - Using best model for VGP: svm (F1: 0.7059)
2025-05-19 23:23:33,585 - INFO - [__main__] - Loading svm model for VGP...
2025-05-19 23:23:33,588 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:33,589 - INFO - [__main__] - Model size: 0.90 MB
2025-05-19 23:23:33,589 - INFO - [__main__] - Making predictions for VGP using svm
2025-05-19 23:23:33,590 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:33,590 - INFO - [__main__] - Successfully got last prediction for VGP
2025-05-19 23:23:33,590 - INFO - [__main__] - 
Processing ticker: VGS
2025-05-19 23:23:33,590 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:33,590 - INFO - [__main__] - Getting last prediction point for ticker: VGS
2025-05-19 23:23:33,590 - INFO - [__main__] - ==================================================
2025-05-19 23:23:33,591 - INFO - [__main__] - Preparing test data for VGS...
2025-05-19 23:23:33,645 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:33,645 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:33,646 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:33,681 - INFO - [src.data_preparation] - Ticker VGS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:33,683 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(286), np.int64(1): np.int64(353)}
2025-05-19 23:23:34,034 - INFO - [src.data_preparation] - Ticker VGS - Selected features:
2025-05-19 23:23:34,034 - INFO - [src.data_preparation] -   vnipc_t: 0.0741
2025-05-19 23:23:34,034 - INFO - [src.data_preparation] -   insec_t: 0.0706
2025-05-19 23:23:34,034 - INFO - [src.data_preparation] -   Volatility: 0.0627
2025-05-19 23:23:34,034 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   HL: 0.0621
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   TVV: 0.0611
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   s_d7_t: 0.0600
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   ATR: 0.0586
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   ma21_t: 0.0582
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   ret: 0.0570
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   SR: 0.0556
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   Median_HL: 0.0552
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   LO: 0.0544
2025-05-19 23:23:34,035 - INFO - [src.data_preparation] -   variation_t: 0.0536
2025-05-19 23:23:34,036 - INFO - [src.data_preparation] -   PM: 0.0524
2025-05-19 23:23:34,039 - INFO - [src.data_preparation] - Ticker VGS - Using features: ['Date', 'vnipc_t', 'insec_t', 'Volatility', 'SK', 'HL', 'TVV', 's_d7_t', 'ATR', 'ma21_t', 'ret', 'SR', 'Median_HL', 'LO', 'variation_t', 'PM']
2025-05-19 23:23:34,149 - INFO - [src.data_preparation] - Ticker VGS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:34,149 - INFO - [src.data_preparation] - Ticker VGS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:34,151 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VGS
2025-05-19 23:23:34,151 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:34,151 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(203), np.int64(1): np.int64(260)}
2025-05-19 23:23:34,151 - INFO - [src.data_preparation] - Generating 57 synthetic minority samples
2025-05-19 23:23:34,154 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (520, 13, 15), y shape: (520,)
2025-05-19 23:23:34,154 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(260), np.int64(1): np.int64(260)}
2025-05-19 23:23:34,157 - INFO - [src.data_preparation] - Ticker VGS - Final 3D shapes: X_train=(520, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:34,159 - INFO - [__main__] - Using best model for VGS: lstm (F1: 0.4118)
2025-05-19 23:23:34,159 - INFO - [__main__] - Loading lstm model for VGS...
2025-05-19 23:23:34,164 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:34,168 - INFO - [__main__] - Model size: 0.45 MB
2025-05-19 23:23:34,168 - INFO - [__main__] - Making predictions for VGS using lstm
2025-05-19 23:23:34,172 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:34,173 - INFO - [__main__] - Successfully got last prediction for VGS
2025-05-19 23:23:34,173 - INFO - [__main__] - 
Processing ticker: VHC
2025-05-19 23:23:34,173 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:34,173 - INFO - [__main__] - Getting last prediction point for ticker: VHC
2025-05-19 23:23:34,173 - INFO - [__main__] - ==================================================
2025-05-19 23:23:34,174 - INFO - [__main__] - Preparing test data for VHC...
2025-05-19 23:23:34,229 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:34,229 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:34,229 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:34,257 - INFO - [src.data_preparation] - Ticker VHC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:34,257 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:23:34,651 - INFO - [src.data_preparation] - Ticker VHC - Selected features:
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   vnipc_t: 0.0729
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   Volatility: 0.0715
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   TVV: 0.0704
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   s_d7_t: 0.0645
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   SK: 0.0641
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   insec_t: 0.0627
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   HL: 0.0622
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   SR: 0.0616
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   ATR: 0.0565
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   ma21_t: 0.0563
2025-05-19 23:23:34,652 - INFO - [src.data_preparation] -   LO: 0.0560
2025-05-19 23:23:34,653 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:23:34,653 - INFO - [src.data_preparation] -   variation_t: 0.0524
2025-05-19 23:23:34,653 - INFO - [src.data_preparation] -   ma14_t: 0.0498
2025-05-19 23:23:34,653 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:23:34,655 - INFO - [src.data_preparation] - Ticker VHC - Using features: ['Date', 'vnipc_t', 'Volatility', 'TVV', 's_d7_t', 'SK', 'insec_t', 'HL', 'SR', 'ATR', 'ma21_t', 'LO', 'ret', 'variation_t', 'ma14_t', 'Median_HL']
2025-05-19 23:23:34,794 - INFO - [src.data_preparation] - Ticker VHC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:34,794 - INFO - [src.data_preparation] - Ticker VHC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:34,799 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VHC
2025-05-19 23:23:34,799 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:34,799 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:23:34,799 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:23:34,805 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:23:34,805 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:23:34,811 - INFO - [src.data_preparation] - Ticker VHC - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:34,811 - INFO - [__main__] - Using best model for VHC: lstm (F1: 0.6250)
2025-05-19 23:23:34,812 - INFO - [__main__] - Loading lstm model for VHC...
2025-05-19 23:23:34,819 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:34,821 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:23:34,821 - INFO - [__main__] - Making predictions for VHC using lstm
2025-05-19 23:23:34,824 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:34,824 - INFO - [__main__] - Successfully got last prediction for VHC
2025-05-19 23:23:34,825 - INFO - [__main__] - 
Processing ticker: VHF
2025-05-19 23:23:34,825 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:34,825 - INFO - [__main__] - Getting last prediction point for ticker: VHF
2025-05-19 23:23:34,825 - INFO - [__main__] - ==================================================
2025-05-19 23:23:34,825 - INFO - [__main__] - Preparing test data for VHF...
2025-05-19 23:23:34,865 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:34,865 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:34,865 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:34,899 - INFO - [src.data_preparation] - Ticker VHF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:34,899 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(43), np.int64(1): np.int64(596)}
2025-05-19 23:23:35,227 - INFO - [src.data_preparation] - Ticker VHF - Selected features:
2025-05-19 23:23:35,227 - INFO - [src.data_preparation] -   vnipc_t: 0.1920
2025-05-19 23:23:35,227 - INFO - [src.data_preparation] -   ma21_t: 0.1691
2025-05-19 23:23:35,227 - INFO - [src.data_preparation] -   ma14_t: 0.1215
2025-05-19 23:23:35,227 - INFO - [src.data_preparation] -   ma7_t: 0.0905
2025-05-19 23:23:35,227 - INFO - [src.data_preparation] -   s_d7_t: 0.0679
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   PM: 0.0611
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   TVV: 0.0597
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   Median_HL: 0.0532
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   ATR: 0.0430
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   Volatility: 0.0345
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   SK: 0.0323
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   SR: 0.0160
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   insec_t: 0.0139
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   variation_t: 0.0135
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] -   ret: 0.0122
2025-05-19 23:23:35,229 - INFO - [src.data_preparation] - Ticker VHF - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'PM', 'TVV', 'Median_HL', 'ATR', 'Volatility', 'SK', 'SR', 'insec_t', 'variation_t', 'ret']
2025-05-19 23:23:35,331 - INFO - [src.data_preparation] - Ticker VHF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:35,331 - INFO - [src.data_preparation] - Ticker VHF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:35,333 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VHF
2025-05-19 23:23:35,333 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:35,333 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(27), np.int64(1): np.int64(436)}
2025-05-19 23:23:35,333 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:23:35,338 - INFO - [src.data_preparation] - Ticker VHF - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:35,338 - INFO - [__main__] - Using best model for VHF: lstm (F1: 0.9885)
2025-05-19 23:23:35,338 - INFO - [__main__] - Loading lstm model for VHF...
2025-05-19 23:23:35,344 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:35,345 - INFO - [__main__] - Model size: 0.03 MB
2025-05-19 23:23:35,346 - INFO - [__main__] - Making predictions for VHF using lstm
2025-05-19 23:23:35,346 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:35,347 - INFO - [__main__] - Successfully got last prediction for VHF
2025-05-19 23:23:35,347 - INFO - [__main__] - 
Processing ticker: VHG
2025-05-19 23:23:35,347 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:35,347 - INFO - [__main__] - Getting last prediction point for ticker: VHG
2025-05-19 23:23:35,347 - INFO - [__main__] - ==================================================
2025-05-19 23:23:35,347 - INFO - [__main__] - Preparing test data for VHG...
2025-05-19 23:23:35,393 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:35,393 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:35,393 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:35,429 - INFO - [src.data_preparation] - Ticker VHG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:35,429 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(287), np.int64(1): np.int64(352)}
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] - Ticker VHG - Selected features:
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   Volatility: 0.0786
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   SK: 0.0779
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   insec_t: 0.0764
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   TVV: 0.0707
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   ma14_t: 0.0626
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   ma21_t: 0.0615
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   ATR: 0.0605
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   s_d7_t: 0.0579
2025-05-19 23:23:35,780 - INFO - [src.data_preparation] -   ret: 0.0503
2025-05-19 23:23:35,781 - INFO - [src.data_preparation] -   PM: 0.0502
2025-05-19 23:23:35,781 - INFO - [src.data_preparation] -   ma7_t: 0.0496
2025-05-19 23:23:35,781 - INFO - [src.data_preparation] -   variation_t: 0.0494
2025-05-19 23:23:35,781 - INFO - [src.data_preparation] -   HL: 0.0484
2025-05-19 23:23:35,781 - INFO - [src.data_preparation] -   Median_HL: 0.0467
2025-05-19 23:23:35,785 - INFO - [src.data_preparation] - Ticker VHG - Using features: ['Date', 'Volatility', 'SK', 'insec_t', 'TVV', 'vnipc_t', 'ma14_t', 'ma21_t', 'ATR', 's_d7_t', 'ret', 'PM', 'ma7_t', 'variation_t', 'HL', 'Median_HL']
2025-05-19 23:23:35,877 - INFO - [src.data_preparation] - Ticker VHG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:35,878 - INFO - [src.data_preparation] - Ticker VHG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:35,879 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VHG
2025-05-19 23:23:35,879 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:35,879 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(210), np.int64(1): np.int64(253)}
2025-05-19 23:23:35,879 - INFO - [src.data_preparation] - Generating 43 synthetic minority samples
2025-05-19 23:23:35,882 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (506, 13, 15), y shape: (506,)
2025-05-19 23:23:35,882 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(253), np.int64(1): np.int64(253)}
2025-05-19 23:23:35,886 - INFO - [src.data_preparation] - Ticker VHG - Final 3D shapes: X_train=(506, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:35,887 - INFO - [__main__] - Using best model for VHG: transformer (F1: 0.6154)
2025-05-19 23:23:35,887 - INFO - [__main__] - Loading transformer model for VHG...
2025-05-19 23:23:35,904 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:23:35,909 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:23:35,909 - INFO - [__main__] - Making predictions for VHG using transformer
2025-05-19 23:23:35,911 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:35,912 - INFO - [__main__] - Successfully got last prediction for VHG
2025-05-19 23:23:35,912 - INFO - [__main__] - 
Processing ticker: VHH
2025-05-19 23:23:35,912 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:35,912 - INFO - [__main__] - Getting last prediction point for ticker: VHH
2025-05-19 23:23:35,912 - INFO - [__main__] - ==================================================
2025-05-19 23:23:35,912 - INFO - [__main__] - Preparing test data for VHH...
2025-05-19 23:23:35,948 - INFO - [src.data_preparation] - After processing - X shape: (635, 19), y shape: (635,)
2025-05-19 23:23:35,948 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:35,948 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:35,975 - INFO - [src.data_preparation] - Ticker VHH - Original shapes: X=(635, 18), y=(635,)
2025-05-19 23:23:35,975 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(168), np.int64(1): np.int64(467)}
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] - Ticker VHH - Selected features:
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   vnipc_t: 0.0852
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   TVV: 0.0825
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   Volatility: 0.0733
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   ma14_t: 0.0721
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   ma7_t: 0.0688
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   ma21_t: 0.0659
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   s_d7_t: 0.0656
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   SK: 0.0627
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   ATR: 0.0559
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   Median_HL: 0.0546
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   insec_t: 0.0492
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   variation_t: 0.0480
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   PM: 0.0478
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   ret: 0.0465
2025-05-19 23:23:36,258 - INFO - [src.data_preparation] -   SR: 0.0377
2025-05-19 23:23:36,262 - INFO - [src.data_preparation] - Ticker VHH - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'ma14_t', 'ma7_t', 'ma21_t', 's_d7_t', 'SK', 'ATR', 'Median_HL', 'insec_t', 'variation_t', 'PM', 'ret', 'SR']
2025-05-19 23:23:36,357 - INFO - [src.data_preparation] - Ticker VHH - 2D shapes: X_train=(459, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:36,358 - INFO - [src.data_preparation] - Ticker VHH - 3D shapes: X_train=(459, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:36,360 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VHH
2025-05-19 23:23:36,360 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (459, 13, 15), y shape: (459,)
2025-05-19 23:23:36,360 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(101), np.int64(1): np.int64(358)}
2025-05-19 23:23:36,360 - INFO - [src.data_preparation] - Generating 257 synthetic minority samples
2025-05-19 23:23:36,372 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (716, 13, 15), y shape: (716,)
2025-05-19 23:23:36,372 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(358), np.int64(1): np.int64(358)}
2025-05-19 23:23:36,377 - INFO - [src.data_preparation] - Ticker VHH - Final 3D shapes: X_train=(716, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:36,378 - INFO - [__main__] - Using best model for VHH: logistic_regression (F1: 0.4651)
2025-05-19 23:23:36,378 - INFO - [__main__] - Loading logistic_regression model for VHH...
2025-05-19 23:23:36,379 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:36,379 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:36,379 - INFO - [__main__] - Making predictions for VHH using logistic_regression
2025-05-19 23:23:36,379 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:36,379 - INFO - [__main__] - Successfully got last prediction for VHH
2025-05-19 23:23:36,379 - INFO - [__main__] - 
Processing ticker: VHL
2025-05-19 23:23:36,380 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:36,380 - INFO - [__main__] - Getting last prediction point for ticker: VHL
2025-05-19 23:23:36,380 - INFO - [__main__] - ==================================================
2025-05-19 23:23:36,380 - INFO - [__main__] - Preparing test data for VHL...
2025-05-19 23:23:36,422 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:36,422 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:36,423 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:36,444 - INFO - [src.data_preparation] - Ticker VHL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:36,444 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(271), np.int64(1): np.int64(368)}
2025-05-19 23:23:36,799 - INFO - [src.data_preparation] - Ticker VHL - Selected features:
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   TVV: 0.0753
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   HL: 0.0705
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   vnipc_t: 0.0675
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   insec_t: 0.0649
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   ATR: 0.0637
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   SK: 0.0636
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   s_d7_t: 0.0635
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   Volatility: 0.0631
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   ret: 0.0575
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   SR: 0.0545
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   LO: 0.0524
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   ma14_t: 0.0520
2025-05-19 23:23:36,801 - INFO - [src.data_preparation] -   ma21_t: 0.0497
2025-05-19 23:23:36,805 - INFO - [src.data_preparation] - Ticker VHL - Using features: ['Date', 'TVV', 'HL', 'vnipc_t', 'insec_t', 'ATR', 'SK', 's_d7_t', 'Volatility', 'ret', 'SR', 'ma7_t', 'variation_t', 'LO', 'ma14_t', 'ma21_t']
2025-05-19 23:23:36,903 - INFO - [src.data_preparation] - Ticker VHL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:36,903 - INFO - [src.data_preparation] - Ticker VHL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:36,904 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VHL
2025-05-19 23:23:36,904 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:36,905 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(189), np.int64(1): np.int64(274)}
2025-05-19 23:23:36,905 - INFO - [src.data_preparation] - Generating 85 synthetic minority samples
2025-05-19 23:23:36,909 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (548, 13, 15), y shape: (548,)
2025-05-19 23:23:36,909 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(274), np.int64(1): np.int64(274)}
2025-05-19 23:23:36,915 - INFO - [src.data_preparation] - Ticker VHL - Final 3D shapes: X_train=(548, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:36,915 - INFO - [__main__] - Using best model for VHL: lstm (F1: 0.7536)
2025-05-19 23:23:36,916 - INFO - [__main__] - Loading lstm model for VHL...
2025-05-19 23:23:36,924 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:36,926 - INFO - [__main__] - Model size: 0.44 MB
2025-05-19 23:23:36,927 - INFO - [__main__] - Making predictions for VHL using lstm
2025-05-19 23:23:36,933 - INFO - [__main__] - Prediction completed in 0.01 seconds
2025-05-19 23:23:36,933 - INFO - [__main__] - Successfully got last prediction for VHL
2025-05-19 23:23:36,933 - INFO - [__main__] - 
Processing ticker: VIC
2025-05-19 23:23:36,934 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:36,934 - INFO - [__main__] - Getting last prediction point for ticker: VIC
2025-05-19 23:23:36,934 - INFO - [__main__] - ==================================================
2025-05-19 23:23:36,934 - INFO - [__main__] - Preparing test data for VIC...
2025-05-19 23:23:36,985 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:36,987 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:36,987 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:37,009 - INFO - [src.data_preparation] - Ticker VIC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:37,010 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(309), np.int64(1): np.int64(330)}
2025-05-19 23:23:37,382 - INFO - [src.data_preparation] - Ticker VIC - Selected features:
2025-05-19 23:23:37,382 - INFO - [src.data_preparation] -   vnipc_t: 0.0709
2025-05-19 23:23:37,382 - INFO - [src.data_preparation] -   ATR: 0.0702
2025-05-19 23:23:37,382 - INFO - [src.data_preparation] -   TVV: 0.0693
2025-05-19 23:23:37,382 - INFO - [src.data_preparation] -   Volatility: 0.0656
2025-05-19 23:23:37,382 - INFO - [src.data_preparation] -   LO: 0.0652
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   SK: 0.0646
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   insec_t: 0.0628
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   SR: 0.0619
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   ma14_t: 0.0588
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   ma21_t: 0.0550
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   ret: 0.0534
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:23:37,383 - INFO - [src.data_preparation] -   PM: 0.0494
2025-05-19 23:23:37,384 - INFO - [src.data_preparation] -   HL: 0.0492
2025-05-19 23:23:37,387 - INFO - [src.data_preparation] - Ticker VIC - Using features: ['Date', 'vnipc_t', 'ATR', 'TVV', 'Volatility', 'LO', 'SK', 'insec_t', 'SR', 's_d7_t', 'ma14_t', 'ma21_t', 'ret', 'Median_HL', 'PM', 'HL']
2025-05-19 23:23:37,484 - INFO - [src.data_preparation] - Ticker VIC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:37,484 - INFO - [src.data_preparation] - Ticker VIC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:37,488 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIC
2025-05-19 23:23:37,488 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:37,488 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(215), np.int64(1): np.int64(248)}
2025-05-19 23:23:37,488 - INFO - [src.data_preparation] - Generating 33 synthetic minority samples
2025-05-19 23:23:37,490 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (496, 13, 15), y shape: (496,)
2025-05-19 23:23:37,490 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(248), np.int64(1): np.int64(248)}
2025-05-19 23:23:37,493 - INFO - [src.data_preparation] - Ticker VIC - Final 3D shapes: X_train=(496, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:37,493 - INFO - [__main__] - Using best model for VIC: svm (F1: 0.5098)
2025-05-19 23:23:37,493 - INFO - [__main__] - Loading svm model for VIC...
2025-05-19 23:23:37,495 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:37,495 - INFO - [__main__] - Model size: 0.61 MB
2025-05-19 23:23:37,495 - INFO - [__main__] - Making predictions for VIC using svm
2025-05-19 23:23:37,495 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:37,497 - INFO - [__main__] - Successfully got last prediction for VIC
2025-05-19 23:23:37,497 - INFO - [__main__] - 
Processing ticker: VID
2025-05-19 23:23:37,497 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:37,497 - INFO - [__main__] - Getting last prediction point for ticker: VID
2025-05-19 23:23:37,497 - INFO - [__main__] - ==================================================
2025-05-19 23:23:37,497 - INFO - [__main__] - Preparing test data for VID...
2025-05-19 23:23:37,531 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:37,531 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:37,532 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:37,552 - INFO - [src.data_preparation] - Ticker VID - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:37,552 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(315), np.int64(1): np.int64(324)}
2025-05-19 23:23:37,858 - INFO - [src.data_preparation] - Ticker VID - Selected features:
2025-05-19 23:23:37,858 - INFO - [src.data_preparation] -   SK: 0.0767
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   vnipc_t: 0.0676
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   insec_t: 0.0645
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   ret: 0.0628
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   ATR: 0.0614
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   TVV: 0.0607
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   ma21_t: 0.0599
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   Volatility: 0.0591
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   ma7_t: 0.0580
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   variation_t: 0.0578
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   SR: 0.0560
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   ma14_t: 0.0551
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   HL: 0.0550
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   PM: 0.0547
2025-05-19 23:23:37,859 - INFO - [src.data_preparation] -   Median_HL: 0.0528
2025-05-19 23:23:37,862 - INFO - [src.data_preparation] - Ticker VID - Using features: ['Date', 'SK', 'vnipc_t', 'insec_t', 'ret', 'ATR', 'TVV', 'ma21_t', 'Volatility', 'ma7_t', 'variation_t', 'SR', 'ma14_t', 'HL', 'PM', 'Median_HL']
2025-05-19 23:23:37,960 - INFO - [src.data_preparation] - Ticker VID - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:37,960 - INFO - [src.data_preparation] - Ticker VID - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:37,962 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VID
2025-05-19 23:23:37,962 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:37,962 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:23:37,963 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:23:37,964 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:23:37,964 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:23:37,968 - INFO - [src.data_preparation] - Ticker VID - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:37,968 - INFO - [__main__] - Using best model for VID: svm (F1: 0.1481)
2025-05-19 23:23:37,968 - INFO - [__main__] - Loading svm model for VID...
2025-05-19 23:23:37,971 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:37,971 - INFO - [__main__] - Model size: 0.47 MB
2025-05-19 23:23:37,972 - INFO - [__main__] - Making predictions for VID using svm
2025-05-19 23:23:37,972 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:37,972 - INFO - [__main__] - Successfully got last prediction for VID
2025-05-19 23:23:37,972 - INFO - [__main__] - 
Processing ticker: VIE
2025-05-19 23:23:37,973 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:37,973 - INFO - [__main__] - Getting last prediction point for ticker: VIE
2025-05-19 23:23:37,973 - INFO - [__main__] - ==================================================
2025-05-19 23:23:37,973 - INFO - [__main__] - Preparing test data for VIE...
2025-05-19 23:23:38,001 - INFO - [src.data_preparation] - After processing - X shape: (637, 19), y shape: (637,)
2025-05-19 23:23:38,001 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:38,001 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:38,028 - INFO - [src.data_preparation] - Ticker VIE - Original shapes: X=(637, 18), y=(637,)
2025-05-19 23:23:38,028 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(148), np.int64(1): np.int64(489)}
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] - Ticker VIE - Selected features:
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   vnipc_t: 0.1050
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   Volatility: 0.0812
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   ma21_t: 0.0773
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   TVV: 0.0765
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   s_d7_t: 0.0705
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   ma7_t: 0.0691
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   ma14_t: 0.0689
2025-05-19 23:23:38,296 - INFO - [src.data_preparation] -   ATR: 0.0629
2025-05-19 23:23:38,297 - INFO - [src.data_preparation] -   HL: 0.0578
2025-05-19 23:23:38,297 - INFO - [src.data_preparation] -   PM: 0.0508
2025-05-19 23:23:38,297 - INFO - [src.data_preparation] -   SK: 0.0498
2025-05-19 23:23:38,297 - INFO - [src.data_preparation] -   Median_HL: 0.0458
2025-05-19 23:23:38,297 - INFO - [src.data_preparation] -   insec_t: 0.0411
2025-05-19 23:23:38,298 - INFO - [src.data_preparation] -   ret: 0.0356
2025-05-19 23:23:38,298 - INFO - [src.data_preparation] -   variation_t: 0.0339
2025-05-19 23:23:38,300 - INFO - [src.data_preparation] - Ticker VIE - Using features: ['Date', 'vnipc_t', 'Volatility', 'ma21_t', 'TVV', 's_d7_t', 'ma7_t', 'ma14_t', 'ATR', 'HL', 'PM', 'SK', 'Median_HL', 'insec_t', 'ret', 'variation_t']
2025-05-19 23:23:38,387 - INFO - [src.data_preparation] - Ticker VIE - 2D shapes: X_train=(463, 195), X_valid=(88, 195), X_test=(45, 195)
2025-05-19 23:23:38,387 - INFO - [src.data_preparation] - Ticker VIE - 3D shapes: X_train=(463, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:38,389 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIE
2025-05-19 23:23:38,389 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:38,389 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(89), np.int64(1): np.int64(374)}
2025-05-19 23:23:38,389 - INFO - [src.data_preparation] - Generating 285 synthetic minority samples
2025-05-19 23:23:38,399 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (748, 13, 15), y shape: (748,)
2025-05-19 23:23:38,399 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(374), np.int64(1): np.int64(374)}
2025-05-19 23:23:38,404 - INFO - [src.data_preparation] - Ticker VIE - Final 3D shapes: X_train=(748, 13, 15), X_valid=(88, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:38,405 - INFO - [__main__] - Using best model for VIE: svm (F1: 0.7797)
2025-05-19 23:23:38,405 - INFO - [__main__] - Loading svm model for VIE...
2025-05-19 23:23:38,407 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:38,407 - INFO - [__main__] - Model size: 0.53 MB
2025-05-19 23:23:38,407 - INFO - [__main__] - Making predictions for VIE using svm
2025-05-19 23:23:38,408 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:38,408 - INFO - [__main__] - Successfully got last prediction for VIE
2025-05-19 23:23:38,408 - INFO - [__main__] - 
Processing ticker: VIG
2025-05-19 23:23:38,408 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:38,408 - INFO - [__main__] - Getting last prediction point for ticker: VIG
2025-05-19 23:23:38,408 - INFO - [__main__] - ==================================================
2025-05-19 23:23:38,408 - INFO - [__main__] - Preparing test data for VIG...
2025-05-19 23:23:38,442 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:38,442 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:38,442 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:38,463 - INFO - [src.data_preparation] - Ticker VIG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:38,463 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(251), np.int64(1): np.int64(388)}
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] - Ticker VIG - Selected features:
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   SK: 0.0812
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   vnipc_t: 0.0808
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   TVV: 0.0785
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   insec_t: 0.0730
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   Volatility: 0.0691
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   ma21_t: 0.0656
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   ma14_t: 0.0631
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   s_d7_t: 0.0605
2025-05-19 23:23:38,765 - INFO - [src.data_preparation] -   ma7_t: 0.0599
2025-05-19 23:23:38,767 - INFO - [src.data_preparation] -   ret: 0.0572
2025-05-19 23:23:38,767 - INFO - [src.data_preparation] -   Median_HL: 0.0550
2025-05-19 23:23:38,767 - INFO - [src.data_preparation] -   variation_t: 0.0529
2025-05-19 23:23:38,767 - INFO - [src.data_preparation] -   PM: 0.0486
2025-05-19 23:23:38,767 - INFO - [src.data_preparation] -   ATR: 0.0477
2025-05-19 23:23:38,767 - INFO - [src.data_preparation] -   SR: 0.0359
2025-05-19 23:23:38,770 - INFO - [src.data_preparation] - Ticker VIG - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 'insec_t', 'Volatility', 'ma21_t', 'ma14_t', 's_d7_t', 'ma7_t', 'ret', 'Median_HL', 'variation_t', 'PM', 'ATR', 'SR']
2025-05-19 23:23:38,871 - INFO - [src.data_preparation] - Ticker VIG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:38,871 - INFO - [src.data_preparation] - Ticker VIG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:38,872 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIG
2025-05-19 23:23:38,873 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:38,873 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(172), np.int64(1): np.int64(291)}
2025-05-19 23:23:38,873 - INFO - [src.data_preparation] - Generating 119 synthetic minority samples
2025-05-19 23:23:38,879 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (582, 13, 15), y shape: (582,)
2025-05-19 23:23:38,879 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(291), np.int64(1): np.int64(291)}
2025-05-19 23:23:38,882 - INFO - [src.data_preparation] - Ticker VIG - Final 3D shapes: X_train=(582, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:38,882 - INFO - [__main__] - Using best model for VIG: svm (F1: 0.6866)
2025-05-19 23:23:38,882 - INFO - [__main__] - Loading svm model for VIG...
2025-05-19 23:23:38,883 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:38,884 - INFO - [__main__] - Model size: 0.88 MB
2025-05-19 23:23:38,884 - INFO - [__main__] - Making predictions for VIG using svm
2025-05-19 23:23:38,885 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:38,885 - INFO - [__main__] - Successfully got last prediction for VIG
2025-05-19 23:23:38,885 - INFO - [__main__] - 
Processing ticker: VIP
2025-05-19 23:23:38,886 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:38,886 - INFO - [__main__] - Getting last prediction point for ticker: VIP
2025-05-19 23:23:38,886 - INFO - [__main__] - ==================================================
2025-05-19 23:23:38,886 - INFO - [__main__] - Preparing test data for VIP...
2025-05-19 23:23:38,925 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:38,926 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:38,926 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:38,951 - INFO - [src.data_preparation] - Ticker VIP - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:38,951 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(302), np.int64(1): np.int64(337)}
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] - Ticker VIP - Selected features:
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   insec_t: 0.0776
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   Volatility: 0.0688
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   ma21_t: 0.0633
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   SK: 0.0624
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   s_d7_t: 0.0623
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   ret: 0.0598
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   ATR: 0.0597
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   SR: 0.0565
2025-05-19 23:23:39,278 - INFO - [src.data_preparation] -   TVV: 0.0557
2025-05-19 23:23:39,279 - INFO - [src.data_preparation] -   ma14_t: 0.0541
2025-05-19 23:23:39,279 - INFO - [src.data_preparation] -   ma7_t: 0.0537
2025-05-19 23:23:39,279 - INFO - [src.data_preparation] -   variation_t: 0.0532
2025-05-19 23:23:39,279 - INFO - [src.data_preparation] -   LO: 0.0524
2025-05-19 23:23:39,279 - INFO - [src.data_preparation] -   PM: 0.0519
2025-05-19 23:23:39,282 - INFO - [src.data_preparation] - Ticker VIP - Using features: ['Date', 'insec_t', 'Volatility', 'vnipc_t', 'ma21_t', 'SK', 's_d7_t', 'ret', 'ATR', 'SR', 'TVV', 'ma14_t', 'ma7_t', 'variation_t', 'LO', 'PM']
2025-05-19 23:23:39,368 - INFO - [src.data_preparation] - Ticker VIP - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:39,368 - INFO - [src.data_preparation] - Ticker VIP - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:39,369 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIP
2025-05-19 23:23:39,369 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:39,369 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(225), np.int64(1): np.int64(238)}
2025-05-19 23:23:39,369 - INFO - [src.data_preparation] - Generating 13 synthetic minority samples
2025-05-19 23:23:39,371 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (476, 13, 15), y shape: (476,)
2025-05-19 23:23:39,371 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(238), np.int64(1): np.int64(238)}
2025-05-19 23:23:39,374 - INFO - [src.data_preparation] - Ticker VIP - Final 3D shapes: X_train=(476, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:39,374 - INFO - [__main__] - Using best model for VIP: logistic_regression (F1: 0.5333)
2025-05-19 23:23:39,374 - INFO - [__main__] - Loading logistic_regression model for VIP...
2025-05-19 23:23:39,375 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:39,375 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:39,375 - INFO - [__main__] - Making predictions for VIP using logistic_regression
2025-05-19 23:23:39,375 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:39,377 - INFO - [__main__] - Successfully got last prediction for VIP
2025-05-19 23:23:39,377 - INFO - [__main__] - 
Processing ticker: VIR
2025-05-19 23:23:39,377 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:39,377 - INFO - [__main__] - Getting last prediction point for ticker: VIR
2025-05-19 23:23:39,377 - INFO - [__main__] - ==================================================
2025-05-19 23:23:39,377 - INFO - [__main__] - Preparing test data for VIR...
2025-05-19 23:23:39,410 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:39,411 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:39,411 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:39,439 - INFO - [src.data_preparation] - Ticker VIR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:39,439 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(70), np.int64(1): np.int64(569)}
2025-05-19 23:23:39,680 - INFO - [src.data_preparation] - Ticker VIR - Selected features:
2025-05-19 23:23:39,680 - INFO - [src.data_preparation] -   vnipc_t: 0.1822
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   ma21_t: 0.0896
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   ma14_t: 0.0874
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   ma7_t: 0.0829
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   s_d7_t: 0.0734
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   ATR: 0.0634
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   TVV: 0.0603
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   Volatility: 0.0603
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   Median_HL: 0.0579
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   PM: 0.0558
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   SK: 0.0400
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   insec_t: 0.0389
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   HL: 0.0274
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   variation_t: 0.0246
2025-05-19 23:23:39,681 - INFO - [src.data_preparation] -   ret: 0.0224
2025-05-19 23:23:39,684 - INFO - [src.data_preparation] - Ticker VIR - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 's_d7_t', 'ATR', 'TVV', 'Volatility', 'Median_HL', 'PM', 'SK', 'insec_t', 'HL', 'variation_t', 'ret']
2025-05-19 23:23:39,774 - INFO - [src.data_preparation] - Ticker VIR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:39,774 - INFO - [src.data_preparation] - Ticker VIR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:39,775 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIR
2025-05-19 23:23:39,775 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:39,775 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(62), np.int64(1): np.int64(401)}
2025-05-19 23:23:39,775 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:23:39,779 - INFO - [src.data_preparation] - Ticker VIR - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:39,779 - INFO - [__main__] - Using best model for VIR: lstm (F1: 0.9647)
2025-05-19 23:23:39,779 - INFO - [__main__] - Loading lstm model for VIR...
2025-05-19 23:23:39,782 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:39,783 - INFO - [__main__] - Model size: 0.14 MB
2025-05-19 23:23:39,783 - INFO - [__main__] - Making predictions for VIR using lstm
2025-05-19 23:23:39,785 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:39,787 - INFO - [__main__] - Successfully got last prediction for VIR
2025-05-19 23:23:39,787 - INFO - [__main__] - 
Processing ticker: VIT
2025-05-19 23:23:39,787 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:39,787 - INFO - [__main__] - Getting last prediction point for ticker: VIT
2025-05-19 23:23:39,788 - INFO - [__main__] - ==================================================
2025-05-19 23:23:39,788 - INFO - [__main__] - Preparing test data for VIT...
2025-05-19 23:23:39,827 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:39,827 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:39,827 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:39,850 - INFO - [src.data_preparation] - Ticker VIT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:39,850 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(252), np.int64(1): np.int64(387)}
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] - Ticker VIT - Selected features:
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   SK: 0.0757
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   insec_t: 0.0699
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   ATR: 0.0689
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   TVV: 0.0666
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   s_d7_t: 0.0658
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   vnipc_t: 0.0653
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   HL: 0.0651
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   Volatility: 0.0637
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   ma14_t: 0.0567
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   ma21_t: 0.0551
2025-05-19 23:23:40,209 - INFO - [src.data_preparation] -   ret: 0.0527
2025-05-19 23:23:40,210 - INFO - [src.data_preparation] -   ma7_t: 0.0524
2025-05-19 23:23:40,210 - INFO - [src.data_preparation] -   variation_t: 0.0507
2025-05-19 23:23:40,210 - INFO - [src.data_preparation] -   SR: 0.0505
2025-05-19 23:23:40,210 - INFO - [src.data_preparation] -   PM: 0.0484
2025-05-19 23:23:40,212 - INFO - [src.data_preparation] - Ticker VIT - Using features: ['Date', 'SK', 'insec_t', 'ATR', 'TVV', 's_d7_t', 'vnipc_t', 'HL', 'Volatility', 'ma14_t', 'ma21_t', 'ret', 'ma7_t', 'variation_t', 'SR', 'PM']
2025-05-19 23:23:40,299 - INFO - [src.data_preparation] - Ticker VIT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:40,299 - INFO - [src.data_preparation] - Ticker VIT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:40,300 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIT
2025-05-19 23:23:40,300 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:40,300 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(177), np.int64(1): np.int64(286)}
2025-05-19 23:23:40,301 - INFO - [src.data_preparation] - Generating 109 synthetic minority samples
2025-05-19 23:23:40,308 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (572, 13, 15), y shape: (572,)
2025-05-19 23:23:40,308 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(286), np.int64(1): np.int64(286)}
2025-05-19 23:23:40,311 - INFO - [src.data_preparation] - Ticker VIT - Final 3D shapes: X_train=(572, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:40,311 - INFO - [__main__] - Using best model for VIT: svm (F1: 0.7606)
2025-05-19 23:23:40,311 - INFO - [__main__] - Loading svm model for VIT...
2025-05-19 23:23:40,313 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:40,313 - INFO - [__main__] - Model size: 0.86 MB
2025-05-19 23:23:40,313 - INFO - [__main__] - Making predictions for VIT using svm
2025-05-19 23:23:40,314 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:40,314 - INFO - [__main__] - Successfully got last prediction for VIT
2025-05-19 23:23:40,314 - INFO - [__main__] - 
Processing ticker: VIX
2025-05-19 23:23:40,315 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:40,315 - INFO - [__main__] - Getting last prediction point for ticker: VIX
2025-05-19 23:23:40,315 - INFO - [__main__] - ==================================================
2025-05-19 23:23:40,315 - INFO - [__main__] - Preparing test data for VIX...
2025-05-19 23:23:40,344 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:40,344 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:40,344 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:40,362 - INFO - [src.data_preparation] - Ticker VIX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:40,363 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(273), np.int64(1): np.int64(366)}
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] - Ticker VIX - Selected features:
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   vnipc_t: 0.0719
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   s_d7_t: 0.0675
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   SK: 0.0658
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   ATR: 0.0650
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   TVV: 0.0649
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   Volatility: 0.0630
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   insec_t: 0.0626
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   ma14_t: 0.0622
2025-05-19 23:23:40,674 - INFO - [src.data_preparation] -   ma21_t: 0.0608
2025-05-19 23:23:40,675 - INFO - [src.data_preparation] -   ma7_t: 0.0564
2025-05-19 23:23:40,675 - INFO - [src.data_preparation] -   PM: 0.0548
2025-05-19 23:23:40,675 - INFO - [src.data_preparation] -   ret: 0.0523
2025-05-19 23:23:40,675 - INFO - [src.data_preparation] -   LO: 0.0523
2025-05-19 23:23:40,675 - INFO - [src.data_preparation] -   HL: 0.0517
2025-05-19 23:23:40,675 - INFO - [src.data_preparation] -   Median_HL: 0.0499
2025-05-19 23:23:40,677 - INFO - [src.data_preparation] - Ticker VIX - Using features: ['Date', 'vnipc_t', 's_d7_t', 'SK', 'ATR', 'TVV', 'Volatility', 'insec_t', 'ma14_t', 'ma21_t', 'ma7_t', 'PM', 'ret', 'LO', 'HL', 'Median_HL']
2025-05-19 23:23:40,762 - INFO - [src.data_preparation] - Ticker VIX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:40,762 - INFO - [src.data_preparation] - Ticker VIX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:40,764 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VIX
2025-05-19 23:23:40,764 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:40,764 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(195), np.int64(1): np.int64(268)}
2025-05-19 23:23:40,764 - INFO - [src.data_preparation] - Generating 73 synthetic minority samples
2025-05-19 23:23:40,768 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (536, 13, 15), y shape: (536,)
2025-05-19 23:23:40,768 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(268), np.int64(1): np.int64(268)}
2025-05-19 23:23:40,771 - INFO - [src.data_preparation] - Ticker VIX - Final 3D shapes: X_train=(536, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:40,771 - INFO - [__main__] - Using best model for VIX: svm (F1: 0.6667)
2025-05-19 23:23:40,771 - INFO - [__main__] - Loading svm model for VIX...
2025-05-19 23:23:40,773 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:40,773 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:23:40,773 - INFO - [__main__] - Making predictions for VIX using svm
2025-05-19 23:23:40,774 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:40,774 - INFO - [__main__] - Successfully got last prediction for VIX
2025-05-19 23:23:40,774 - INFO - [__main__] - 
Processing ticker: VKC
2025-05-19 23:23:40,774 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:40,774 - INFO - [__main__] - Getting last prediction point for ticker: VKC
2025-05-19 23:23:40,775 - INFO - [__main__] - ==================================================
2025-05-19 23:23:40,775 - INFO - [__main__] - Preparing test data for VKC...
2025-05-19 23:23:40,804 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:40,804 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:40,805 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:40,828 - INFO - [src.data_preparation] - Ticker VKC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:40,828 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(284), np.int64(1): np.int64(354)}
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] - Ticker VKC - Selected features:
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   SK: 0.0774
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   insec_t: 0.0750
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   TVV: 0.0720
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   vnipc_t: 0.0706
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   Volatility: 0.0637
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   s_d7_t: 0.0637
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   ma21_t: 0.0616
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   ma14_t: 0.0596
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   ma7_t: 0.0568
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   PM: 0.0529
2025-05-19 23:23:41,125 - INFO - [src.data_preparation] -   Median_HL: 0.0514
2025-05-19 23:23:41,127 - INFO - [src.data_preparation] -   HL: 0.0507
2025-05-19 23:23:41,127 - INFO - [src.data_preparation] -   variation_t: 0.0488
2025-05-19 23:23:41,127 - INFO - [src.data_preparation] -   ATR: 0.0481
2025-05-19 23:23:41,127 - INFO - [src.data_preparation] -   LO: 0.0460
2025-05-19 23:23:41,130 - INFO - [src.data_preparation] - Ticker VKC - Using features: ['Date', 'SK', 'insec_t', 'TVV', 'vnipc_t', 'Volatility', 's_d7_t', 'ma21_t', 'ma14_t', 'ma7_t', 'PM', 'Median_HL', 'HL', 'variation_t', 'ATR', 'LO']
2025-05-19 23:23:41,226 - INFO - [src.data_preparation] - Ticker VKC - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:23:41,226 - INFO - [src.data_preparation] - Ticker VKC - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:41,229 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VKC
2025-05-19 23:23:41,229 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:41,229 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:23:41,229 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:23:41,232 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:23:41,232 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:23:41,235 - INFO - [src.data_preparation] - Ticker VKC - Final 3D shapes: X_train=(508, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:41,235 - INFO - [__main__] - Using best model for VKC: lstm (F1: 0.7606)
2025-05-19 23:23:41,235 - INFO - [__main__] - Loading lstm model for VKC...
2025-05-19 23:23:41,242 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:41,244 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:23:41,244 - INFO - [__main__] - Making predictions for VKC using lstm
2025-05-19 23:23:41,246 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:41,246 - INFO - [__main__] - Successfully got last prediction for VKC
2025-05-19 23:23:41,247 - INFO - [__main__] - 
Processing ticker: VLA
2025-05-19 23:23:41,247 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:41,247 - INFO - [__main__] - Getting last prediction point for ticker: VLA
2025-05-19 23:23:41,247 - INFO - [__main__] - ==================================================
2025-05-19 23:23:41,247 - INFO - [__main__] - Preparing test data for VLA...
2025-05-19 23:23:41,290 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:41,291 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:41,291 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:41,313 - INFO - [src.data_preparation] - Ticker VLA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:41,314 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(210), np.int64(1): np.int64(429)}
2025-05-19 23:23:41,653 - INFO - [src.data_preparation] - Ticker VLA - Selected features:
2025-05-19 23:23:41,653 - INFO - [src.data_preparation] -   ma7_t: 0.0710
2025-05-19 23:23:41,653 - INFO - [src.data_preparation] -   vnipc_t: 0.0702
2025-05-19 23:23:41,653 - INFO - [src.data_preparation] -   ATR: 0.0660
2025-05-19 23:23:41,653 - INFO - [src.data_preparation] -   ma14_t: 0.0657
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   TVV: 0.0649
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   s_d7_t: 0.0649
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   ma21_t: 0.0645
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   SK: 0.0642
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   Volatility: 0.0606
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   Median_HL: 0.0604
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   variation_t: 0.0564
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   PM: 0.0540
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   insec_t: 0.0534
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   HL: 0.0487
2025-05-19 23:23:41,654 - INFO - [src.data_preparation] -   SR: 0.0462
2025-05-19 23:23:41,657 - INFO - [src.data_preparation] - Ticker VLA - Using features: ['Date', 'ma7_t', 'vnipc_t', 'ATR', 'ma14_t', 'TVV', 's_d7_t', 'ma21_t', 'SK', 'Volatility', 'Median_HL', 'variation_t', 'PM', 'insec_t', 'HL', 'SR']
2025-05-19 23:23:41,747 - INFO - [src.data_preparation] - Ticker VLA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:41,747 - INFO - [src.data_preparation] - Ticker VLA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:41,749 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VLA
2025-05-19 23:23:41,749 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:41,749 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(123), np.int64(1): np.int64(340)}
2025-05-19 23:23:41,749 - INFO - [src.data_preparation] - Generating 217 synthetic minority samples
2025-05-19 23:23:41,759 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (680, 13, 15), y shape: (680,)
2025-05-19 23:23:41,759 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(340), np.int64(1): np.int64(340)}
2025-05-19 23:23:41,763 - INFO - [src.data_preparation] - Ticker VLA - Final 3D shapes: X_train=(680, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:41,764 - INFO - [__main__] - Using best model for VLA: svm (F1: 0.6866)
2025-05-19 23:23:41,764 - INFO - [__main__] - Loading svm model for VLA...
2025-05-19 23:23:41,765 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:41,767 - INFO - [__main__] - Model size: 1.03 MB
2025-05-19 23:23:41,767 - INFO - [__main__] - Making predictions for VLA using svm
2025-05-19 23:23:41,768 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:41,769 - INFO - [__main__] - Successfully got last prediction for VLA
2025-05-19 23:23:41,769 - INFO - [__main__] - 
Processing ticker: VLF
2025-05-19 23:23:41,769 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:41,769 - INFO - [__main__] - Getting last prediction point for ticker: VLF
2025-05-19 23:23:41,769 - INFO - [__main__] - ==================================================
2025-05-19 23:23:41,769 - INFO - [__main__] - Preparing test data for VLF...
2025-05-19 23:23:41,813 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:41,813 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:41,813 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:41,838 - INFO - [src.data_preparation] - Ticker VLF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:41,838 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(193), np.int64(1): np.int64(446)}
2025-05-19 23:23:42,110 - INFO - [src.data_preparation] - Ticker VLF - Selected features:
2025-05-19 23:23:42,110 - INFO - [src.data_preparation] -   vnipc_t: 0.0845
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   ma21_t: 0.0819
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   ma14_t: 0.0809
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   TVV: 0.0759
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   s_d7_t: 0.0677
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   ma7_t: 0.0644
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   insec_t: 0.0618
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   Volatility: 0.0597
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   SK: 0.0595
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   Median_HL: 0.0571
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   PM: 0.0561
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   ATR: 0.0526
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   ret: 0.0517
2025-05-19 23:23:42,111 - INFO - [src.data_preparation] -   variation_t: 0.0470
2025-05-19 23:23:42,112 - INFO - [src.data_preparation] -   HL: 0.0394
2025-05-19 23:23:42,114 - INFO - [src.data_preparation] - Ticker VLF - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'TVV', 's_d7_t', 'ma7_t', 'insec_t', 'Volatility', 'SK', 'Median_HL', 'PM', 'ATR', 'ret', 'variation_t', 'HL']
2025-05-19 23:23:42,212 - INFO - [src.data_preparation] - Ticker VLF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:42,212 - INFO - [src.data_preparation] - Ticker VLF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:42,217 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VLF
2025-05-19 23:23:42,217 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:42,218 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(130), np.int64(1): np.int64(333)}
2025-05-19 23:23:42,218 - INFO - [src.data_preparation] - Generating 203 synthetic minority samples
2025-05-19 23:23:42,232 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (666, 13, 15), y shape: (666,)
2025-05-19 23:23:42,232 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(333), np.int64(1): np.int64(333)}
2025-05-19 23:23:42,239 - INFO - [src.data_preparation] - Ticker VLF - Final 3D shapes: X_train=(666, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:42,239 - INFO - [__main__] - Using best model for VLF: lstm (F1: 0.8219)
2025-05-19 23:23:42,239 - INFO - [__main__] - Loading lstm model for VLF...
2025-05-19 23:23:42,248 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:42,248 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:23:42,248 - INFO - [__main__] - Making predictions for VLF using lstm
2025-05-19 23:23:42,251 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:42,252 - INFO - [__main__] - Successfully got last prediction for VLF
2025-05-19 23:23:42,252 - INFO - [__main__] - 
Processing ticker: VMC
2025-05-19 23:23:42,252 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:42,253 - INFO - [__main__] - Getting last prediction point for ticker: VMC
2025-05-19 23:23:42,253 - INFO - [__main__] - ==================================================
2025-05-19 23:23:42,253 - INFO - [__main__] - Preparing test data for VMC...
2025-05-19 23:23:42,300 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:42,300 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:42,300 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:42,329 - INFO - [src.data_preparation] - Ticker VMC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:42,329 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(269), np.int64(1): np.int64(370)}
2025-05-19 23:23:42,644 - INFO - [src.data_preparation] - Ticker VMC - Selected features:
2025-05-19 23:23:42,644 - INFO - [src.data_preparation] -   TVV: 0.0675
2025-05-19 23:23:42,644 - INFO - [src.data_preparation] -   ma21_t: 0.0664
2025-05-19 23:23:42,644 - INFO - [src.data_preparation] -   s_d7_t: 0.0657
2025-05-19 23:23:42,644 - INFO - [src.data_preparation] -   vnipc_t: 0.0646
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   ma14_t: 0.0639
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   Median_HL: 0.0636
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   SK: 0.0618
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   PM: 0.0609
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   ATR: 0.0595
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   Volatility: 0.0592
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   insec_t: 0.0578
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   ma7_t: 0.0578
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   HL: 0.0539
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   ret: 0.0528
2025-05-19 23:23:42,645 - INFO - [src.data_preparation] -   LO: 0.0511
2025-05-19 23:23:42,647 - INFO - [src.data_preparation] - Ticker VMC - Using features: ['Date', 'TVV', 'ma21_t', 's_d7_t', 'vnipc_t', 'ma14_t', 'Median_HL', 'SK', 'PM', 'ATR', 'Volatility', 'insec_t', 'ma7_t', 'HL', 'ret', 'LO']
2025-05-19 23:23:42,732 - INFO - [src.data_preparation] - Ticker VMC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:42,732 - INFO - [src.data_preparation] - Ticker VMC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:42,733 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VMC
2025-05-19 23:23:42,733 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:42,733 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(191), np.int64(1): np.int64(272)}
2025-05-19 23:23:42,733 - INFO - [src.data_preparation] - Generating 81 synthetic minority samples
2025-05-19 23:23:42,737 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (544, 13, 15), y shape: (544,)
2025-05-19 23:23:42,737 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(272), np.int64(1): np.int64(272)}
2025-05-19 23:23:42,741 - INFO - [src.data_preparation] - Ticker VMC - Final 3D shapes: X_train=(544, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:42,741 - INFO - [__main__] - Using best model for VMC: svm (F1: 0.7059)
2025-05-19 23:23:42,741 - INFO - [__main__] - Loading svm model for VMC...
2025-05-19 23:23:42,743 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:42,743 - INFO - [__main__] - Model size: 0.82 MB
2025-05-19 23:23:42,743 - INFO - [__main__] - Making predictions for VMC using svm
2025-05-19 23:23:42,744 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:42,744 - INFO - [__main__] - Successfully got last prediction for VMC
2025-05-19 23:23:42,744 - INFO - [__main__] - 
Processing ticker: VMD
2025-05-19 23:23:42,745 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:42,745 - INFO - [__main__] - Getting last prediction point for ticker: VMD
2025-05-19 23:23:42,745 - INFO - [__main__] - ==================================================
2025-05-19 23:23:42,745 - INFO - [__main__] - Preparing test data for VMD...
2025-05-19 23:23:42,788 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:42,788 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:42,788 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:42,811 - INFO - [src.data_preparation] - Ticker VMD - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:42,811 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] - Ticker VMD - Selected features:
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] -   vnipc_t: 0.0793
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] -   insec_t: 0.0659
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] -   SK: 0.0630
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] -   TVV: 0.0595
2025-05-19 23:23:43,126 - INFO - [src.data_preparation] -   HL: 0.0588
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   ATR: 0.0588
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   SR: 0.0586
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   variation_t: 0.0575
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   Volatility: 0.0573
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   LO: 0.0548
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   ma7_t: 0.0528
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   PM: 0.0523
2025-05-19 23:23:43,127 - INFO - [src.data_preparation] -   ma21_t: 0.0514
2025-05-19 23:23:43,129 - INFO - [src.data_preparation] - Ticker VMD - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 's_d7_t', 'TVV', 'HL', 'ATR', 'SR', 'variation_t', 'Volatility', 'LO', 'Median_HL', 'ma7_t', 'PM', 'ma21_t']
2025-05-19 23:23:43,215 - INFO - [src.data_preparation] - Ticker VMD - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:43,215 - INFO - [src.data_preparation] - Ticker VMD - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:43,217 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VMD
2025-05-19 23:23:43,217 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:43,217 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(206), np.int64(1): np.int64(257)}
2025-05-19 23:23:43,217 - INFO - [src.data_preparation] - Generating 51 synthetic minority samples
2025-05-19 23:23:43,220 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (514, 13, 15), y shape: (514,)
2025-05-19 23:23:43,220 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(257), np.int64(1): np.int64(257)}
2025-05-19 23:23:43,222 - INFO - [src.data_preparation] - Ticker VMD - Final 3D shapes: X_train=(514, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:43,222 - INFO - [__main__] - Using best model for VMD: transformer (F1: 0.6452)
2025-05-19 23:23:43,222 - INFO - [__main__] - Loading transformer model for VMD...
2025-05-19 23:23:43,234 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:43,238 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:23:43,238 - INFO - [__main__] - Making predictions for VMD using transformer
2025-05-19 23:23:43,242 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:43,243 - INFO - [__main__] - Successfully got last prediction for VMD
2025-05-19 23:23:43,243 - INFO - [__main__] - 
Processing ticker: VNA
2025-05-19 23:23:43,243 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:43,243 - INFO - [__main__] - Getting last prediction point for ticker: VNA
2025-05-19 23:23:43,243 - INFO - [__main__] - ==================================================
2025-05-19 23:23:43,244 - INFO - [__main__] - Preparing test data for VNA...
2025-05-19 23:23:43,273 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:43,273 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:43,274 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:43,294 - INFO - [src.data_preparation] - Ticker VNA - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:43,294 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(362)}
2025-05-19 23:23:43,645 - INFO - [src.data_preparation] - Ticker VNA - Selected features:
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   insec_t: 0.0784
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   vnipc_t: 0.0746
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   TVV: 0.0733
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   ma14_t: 0.0629
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   Volatility: 0.0628
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   ATR: 0.0626
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   s_d7_t: 0.0626
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   SK: 0.0602
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   ma21_t: 0.0592
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   ma7_t: 0.0575
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   variation_t: 0.0528
2025-05-19 23:23:43,646 - INFO - [src.data_preparation] -   Median_HL: 0.0517
2025-05-19 23:23:43,647 - INFO - [src.data_preparation] -   PM: 0.0469
2025-05-19 23:23:43,647 - INFO - [src.data_preparation] -   HL: 0.0467
2025-05-19 23:23:43,650 - INFO - [src.data_preparation] - Ticker VNA - Using features: ['Date', 'insec_t', 'vnipc_t', 'TVV', 'ma14_t', 'Volatility', 'ATR', 's_d7_t', 'SK', 'ma21_t', 'ma7_t', 'ret', 'variation_t', 'Median_HL', 'PM', 'HL']
2025-05-19 23:23:43,741 - INFO - [src.data_preparation] - Ticker VNA - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:43,741 - INFO - [src.data_preparation] - Ticker VNA - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:43,743 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNA
2025-05-19 23:23:43,743 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:43,744 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(183), np.int64(1): np.int64(279)}
2025-05-19 23:23:43,744 - INFO - [src.data_preparation] - Generating 96 synthetic minority samples
2025-05-19 23:23:43,749 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (558, 13, 15), y shape: (558,)
2025-05-19 23:23:43,749 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(279), np.int64(1): np.int64(279)}
2025-05-19 23:23:43,752 - INFO - [src.data_preparation] - Ticker VNA - Final 3D shapes: X_train=(558, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:43,752 - INFO - [__main__] - Using best model for VNA: svm (F1: 0.5806)
2025-05-19 23:23:43,752 - INFO - [__main__] - Loading svm model for VNA...
2025-05-19 23:23:43,753 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:43,754 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:23:43,754 - INFO - [__main__] - Making predictions for VNA using svm
2025-05-19 23:23:43,755 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:43,756 - INFO - [__main__] - Successfully got last prediction for VNA
2025-05-19 23:23:43,756 - INFO - [__main__] - 
Processing ticker: VNC
2025-05-19 23:23:43,756 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:43,756 - INFO - [__main__] - Getting last prediction point for ticker: VNC
2025-05-19 23:23:43,756 - INFO - [__main__] - ==================================================
2025-05-19 23:23:43,756 - INFO - [__main__] - Preparing test data for VNC...
2025-05-19 23:23:43,779 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:43,779 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:43,779 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:43,801 - INFO - [src.data_preparation] - Ticker VNC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:43,801 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(216), np.int64(1): np.int64(423)}
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] - Ticker VNC - Selected features:
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   vnipc_t: 0.0720
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   SK: 0.0698
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   TVV: 0.0695
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   ATR: 0.0649
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   Volatility: 0.0626
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   ma21_t: 0.0615
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   s_d7_t: 0.0590
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   ma7_t: 0.0589
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   ma14_t: 0.0583
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   SR: 0.0572
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   insec_t: 0.0559
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   ret: 0.0557
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   PM: 0.0557
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   Median_HL: 0.0531
2025-05-19 23:23:44,149 - INFO - [src.data_preparation] -   HL: 0.0524
2025-05-19 23:23:44,153 - INFO - [src.data_preparation] - Ticker VNC - Using features: ['Date', 'vnipc_t', 'SK', 'TVV', 'ATR', 'Volatility', 'ma21_t', 's_d7_t', 'ma7_t', 'ma14_t', 'SR', 'insec_t', 'ret', 'PM', 'Median_HL', 'HL']
2025-05-19 23:23:44,252 - INFO - [src.data_preparation] - Ticker VNC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:44,252 - INFO - [src.data_preparation] - Ticker VNC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:44,254 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNC
2025-05-19 23:23:44,255 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:44,255 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(150), np.int64(1): np.int64(313)}
2025-05-19 23:23:44,255 - INFO - [src.data_preparation] - Generating 163 synthetic minority samples
2025-05-19 23:23:44,264 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (626, 13, 15), y shape: (626,)
2025-05-19 23:23:44,264 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(313), np.int64(1): np.int64(313)}
2025-05-19 23:23:44,268 - INFO - [src.data_preparation] - Ticker VNC - Final 3D shapes: X_train=(626, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:44,268 - INFO - [__main__] - Using best model for VNC: svm (F1: 0.7778)
2025-05-19 23:23:44,268 - INFO - [__main__] - Loading svm model for VNC...
2025-05-19 23:23:44,269 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:44,270 - INFO - [__main__] - Model size: 0.94 MB
2025-05-19 23:23:44,271 - INFO - [__main__] - Making predictions for VNC using svm
2025-05-19 23:23:44,271 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:44,271 - INFO - [__main__] - Successfully got last prediction for VNC
2025-05-19 23:23:44,271 - INFO - [__main__] - 
Processing ticker: VND
2025-05-19 23:23:44,271 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:44,271 - INFO - [__main__] - Getting last prediction point for ticker: VND
2025-05-19 23:23:44,271 - INFO - [__main__] - ==================================================
2025-05-19 23:23:44,271 - INFO - [__main__] - Preparing test data for VND...
2025-05-19 23:23:44,305 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:44,305 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:44,307 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:44,329 - INFO - [src.data_preparation] - Ticker VND - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:44,330 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(283), np.int64(1): np.int64(355)}
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] - Ticker VND - Selected features:
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   SK: 0.0795
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   Volatility: 0.0677
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   TVV: 0.0649
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   vnipc_t: 0.0631
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   s_d7_t: 0.0628
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   insec_t: 0.0620
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   ma14_t: 0.0600
2025-05-19 23:23:44,645 - INFO - [src.data_preparation] -   ma7_t: 0.0562
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   LO: 0.0560
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   ret: 0.0559
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   ma21_t: 0.0556
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   variation_t: 0.0537
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   PM: 0.0534
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   SR: 0.0530
2025-05-19 23:23:44,647 - INFO - [src.data_preparation] -   ATR: 0.0529
2025-05-19 23:23:44,650 - INFO - [src.data_preparation] - Ticker VND - Using features: ['Date', 'SK', 'Volatility', 'TVV', 'vnipc_t', 's_d7_t', 'insec_t', 'ma14_t', 'ma7_t', 'LO', 'ret', 'ma21_t', 'variation_t', 'PM', 'SR', 'ATR']
2025-05-19 23:23:44,739 - INFO - [src.data_preparation] - Ticker VND - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:44,739 - INFO - [src.data_preparation] - Ticker VND - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:44,740 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VND
2025-05-19 23:23:44,740 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:44,740 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(196), np.int64(1): np.int64(266)}
2025-05-19 23:23:44,740 - INFO - [src.data_preparation] - Generating 70 synthetic minority samples
2025-05-19 23:23:44,744 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (532, 13, 15), y shape: (532,)
2025-05-19 23:23:44,744 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(266), np.int64(1): np.int64(266)}
2025-05-19 23:23:44,748 - INFO - [src.data_preparation] - Ticker VND - Final 3D shapes: X_train=(532, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:44,748 - INFO - [__main__] - Using best model for VND: logistic_regression (F1: 0.6400)
2025-05-19 23:23:44,748 - INFO - [__main__] - Loading logistic_regression model for VND...
2025-05-19 23:23:44,749 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:44,749 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:44,749 - INFO - [__main__] - Making predictions for VND using logistic_regression
2025-05-19 23:23:44,749 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:44,750 - INFO - [__main__] - Successfully got last prediction for VND
2025-05-19 23:23:44,750 - INFO - [__main__] - 
Processing ticker: VNE
2025-05-19 23:23:44,750 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:44,750 - INFO - [__main__] - Getting last prediction point for ticker: VNE
2025-05-19 23:23:44,750 - INFO - [__main__] - ==================================================
2025-05-19 23:23:44,750 - INFO - [__main__] - Preparing test data for VNE...
2025-05-19 23:23:44,783 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:44,783 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:44,783 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:44,803 - INFO - [src.data_preparation] - Ticker VNE - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:44,803 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(328), np.int64(1): np.int64(311)}
2025-05-19 23:23:45,134 - INFO - [src.data_preparation] - Ticker VNE - Selected features:
2025-05-19 23:23:45,134 - INFO - [src.data_preparation] -   insec_t: 0.0794
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   Volatility: 0.0760
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   TVV: 0.0737
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   vnipc_t: 0.0680
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   SK: 0.0604
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   LO: 0.0552
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   ret: 0.0550
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   ATR: 0.0546
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   ma21_t: 0.0544
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   HL: 0.0541
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   SR: 0.0530
2025-05-19 23:23:45,135 - INFO - [src.data_preparation] -   variation_t: 0.0508
2025-05-19 23:23:45,136 - INFO - [src.data_preparation] -   ma14_t: 0.0507
2025-05-19 23:23:45,136 - INFO - [src.data_preparation] -   Median_HL: 0.0506
2025-05-19 23:23:45,138 - INFO - [src.data_preparation] - Ticker VNE - Using features: ['Date', 'insec_t', 'Volatility', 'TVV', 'vnipc_t', 's_d7_t', 'SK', 'LO', 'ret', 'ATR', 'ma21_t', 'HL', 'SR', 'variation_t', 'ma14_t', 'Median_HL']
2025-05-19 23:23:45,233 - INFO - [src.data_preparation] - Ticker VNE - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:45,233 - INFO - [src.data_preparation] - Ticker VNE - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:45,235 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNE
2025-05-19 23:23:45,235 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:45,235 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(226), np.int64(1): np.int64(237)}
2025-05-19 23:23:45,235 - INFO - [src.data_preparation] - Generating 11 synthetic minority samples
2025-05-19 23:23:45,236 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (474, 13, 15), y shape: (474,)
2025-05-19 23:23:45,236 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(237), np.int64(1): np.int64(237)}
2025-05-19 23:23:45,239 - INFO - [src.data_preparation] - Ticker VNE - Final 3D shapes: X_train=(474, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:45,239 - INFO - [__main__] - Using best model for VNE: transformer (F1: 0.5000)
2025-05-19 23:23:45,239 - INFO - [__main__] - Loading transformer model for VNE...
2025-05-19 23:23:45,253 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:45,259 - INFO - [__main__] - Model size: 0.05 MB
2025-05-19 23:23:45,259 - INFO - [__main__] - Making predictions for VNE using transformer
2025-05-19 23:23:45,261 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:45,262 - INFO - [__main__] - Successfully got last prediction for VNE
2025-05-19 23:23:45,262 - INFO - [__main__] - 
Processing ticker: VNF
2025-05-19 23:23:45,262 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:45,262 - INFO - [__main__] - Getting last prediction point for ticker: VNF
2025-05-19 23:23:45,262 - INFO - [__main__] - ==================================================
2025-05-19 23:23:45,263 - INFO - [__main__] - Preparing test data for VNF...
2025-05-19 23:23:45,319 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:45,319 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:45,319 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:45,349 - INFO - [src.data_preparation] - Ticker VNF - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:45,350 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(243), np.int64(1): np.int64(396)}
2025-05-19 23:23:45,731 - INFO - [src.data_preparation] - Ticker VNF - Selected features:
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   TVV: 0.0795
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   vnipc_t: 0.0671
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   ATR: 0.0644
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   s_d7_t: 0.0627
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   insec_t: 0.0612
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   HL: 0.0611
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   ret: 0.0595
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   SK: 0.0592
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   ma21_t: 0.0574
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   ma14_t: 0.0556
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   SR: 0.0548
2025-05-19 23:23:45,732 - INFO - [src.data_preparation] -   Volatility: 0.0536
2025-05-19 23:23:45,733 - INFO - [src.data_preparation] -   variation_t: 0.0514
2025-05-19 23:23:45,733 - INFO - [src.data_preparation] -   LO: 0.0510
2025-05-19 23:23:45,733 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:23:45,735 - INFO - [src.data_preparation] - Ticker VNF - Using features: ['Date', 'TVV', 'vnipc_t', 'ATR', 's_d7_t', 'insec_t', 'HL', 'ret', 'SK', 'ma21_t', 'ma14_t', 'SR', 'Volatility', 'variation_t', 'LO', 'Median_HL']
2025-05-19 23:23:45,834 - INFO - [src.data_preparation] - Ticker VNF - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:45,834 - INFO - [src.data_preparation] - Ticker VNF - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:45,836 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNF
2025-05-19 23:23:45,837 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:45,837 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(160), np.int64(1): np.int64(303)}
2025-05-19 23:23:45,837 - INFO - [src.data_preparation] - Generating 143 synthetic minority samples
2025-05-19 23:23:45,846 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (606, 13, 15), y shape: (606,)
2025-05-19 23:23:45,846 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(303), np.int64(1): np.int64(303)}
2025-05-19 23:23:45,849 - INFO - [src.data_preparation] - Ticker VNF - Final 3D shapes: X_train=(606, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:45,849 - INFO - [__main__] - Using best model for VNF: svm (F1: 0.6667)
2025-05-19 23:23:45,849 - INFO - [__main__] - Loading svm model for VNF...
2025-05-19 23:23:45,849 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:45,849 - INFO - [__main__] - Model size: 0.91 MB
2025-05-19 23:23:45,849 - INFO - [__main__] - Making predictions for VNF using svm
2025-05-19 23:23:45,849 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:45,849 - INFO - [__main__] - Successfully got last prediction for VNF
2025-05-19 23:23:45,849 - INFO - [__main__] - 
Processing ticker: VNG
2025-05-19 23:23:45,849 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:45,849 - INFO - [__main__] - Getting last prediction point for ticker: VNG
2025-05-19 23:23:45,849 - INFO - [__main__] - ==================================================
2025-05-19 23:23:45,849 - INFO - [__main__] - Preparing test data for VNG...
2025-05-19 23:23:45,893 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:45,893 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:45,893 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:45,918 - INFO - [src.data_preparation] - Ticker VNG - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:45,918 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(299), np.int64(1): np.int64(340)}
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] - Ticker VNG - Selected features:
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   SK: 0.0743
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   vnipc_t: 0.0701
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   Volatility: 0.0669
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   TVV: 0.0666
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   ma7_t: 0.0627
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   insec_t: 0.0621
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   ma14_t: 0.0607
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   ATR: 0.0606
2025-05-19 23:23:46,249 - INFO - [src.data_preparation] -   ma21_t: 0.0598
2025-05-19 23:23:46,250 - INFO - [src.data_preparation] -   Median_HL: 0.0570
2025-05-19 23:23:46,250 - INFO - [src.data_preparation] -   PM: 0.0562
2025-05-19 23:23:46,250 - INFO - [src.data_preparation] -   s_d7_t: 0.0535
2025-05-19 23:23:46,250 - INFO - [src.data_preparation] -   variation_t: 0.0512
2025-05-19 23:23:46,250 - INFO - [src.data_preparation] -   ret: 0.0503
2025-05-19 23:23:46,250 - INFO - [src.data_preparation] -   LO: 0.0495
2025-05-19 23:23:46,252 - INFO - [src.data_preparation] - Ticker VNG - Using features: ['Date', 'SK', 'vnipc_t', 'Volatility', 'TVV', 'ma7_t', 'insec_t', 'ma14_t', 'ATR', 'ma21_t', 'Median_HL', 'PM', 's_d7_t', 'variation_t', 'ret', 'LO']
2025-05-19 23:23:46,328 - INFO - [src.data_preparation] - Ticker VNG - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:46,337 - INFO - [src.data_preparation] - Ticker VNG - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:46,339 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNG
2025-05-19 23:23:46,339 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:46,339 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(202), np.int64(1): np.int64(261)}
2025-05-19 23:23:46,339 - INFO - [src.data_preparation] - Generating 59 synthetic minority samples
2025-05-19 23:23:46,342 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (522, 13, 15), y shape: (522,)
2025-05-19 23:23:46,342 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(261), np.int64(1): np.int64(261)}
2025-05-19 23:23:46,347 - INFO - [src.data_preparation] - Ticker VNG - Final 3D shapes: X_train=(522, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:46,348 - INFO - [__main__] - Using best model for VNG: svm (F1: 0.5574)
2025-05-19 23:23:46,348 - INFO - [__main__] - Loading svm model for VNG...
2025-05-19 23:23:46,350 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:46,350 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:23:46,350 - INFO - [__main__] - Making predictions for VNG using svm
2025-05-19 23:23:46,351 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:46,351 - INFO - [__main__] - Successfully got last prediction for VNG
2025-05-19 23:23:46,351 - INFO - [__main__] - 
Processing ticker: VNH
2025-05-19 23:23:46,351 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:46,351 - INFO - [__main__] - Getting last prediction point for ticker: VNH
2025-05-19 23:23:46,352 - INFO - [__main__] - ==================================================
2025-05-19 23:23:46,352 - INFO - [__main__] - Preparing test data for VNH...
2025-05-19 23:23:46,391 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:46,391 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:46,391 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:46,413 - INFO - [src.data_preparation] - Ticker VNH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:46,413 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(262), np.int64(1): np.int64(377)}
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] - Ticker VNH - Selected features:
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   Volatility: 0.0766
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   vnipc_t: 0.0738
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   s_d7_t: 0.0733
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   ma14_t: 0.0723
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   ma21_t: 0.0693
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   TVV: 0.0676
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   insec_t: 0.0642
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   ma7_t: 0.0609
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   SK: 0.0594
2025-05-19 23:23:46,727 - INFO - [src.data_preparation] -   ATR: 0.0574
2025-05-19 23:23:46,728 - INFO - [src.data_preparation] -   PM: 0.0553
2025-05-19 23:23:46,728 - INFO - [src.data_preparation] -   Median_HL: 0.0544
2025-05-19 23:23:46,728 - INFO - [src.data_preparation] -   variation_t: 0.0471
2025-05-19 23:23:46,728 - INFO - [src.data_preparation] -   ret: 0.0452
2025-05-19 23:23:46,728 - INFO - [src.data_preparation] -   HL: 0.0371
2025-05-19 23:23:46,730 - INFO - [src.data_preparation] - Ticker VNH - Using features: ['Date', 'Volatility', 'vnipc_t', 's_d7_t', 'ma14_t', 'ma21_t', 'TVV', 'insec_t', 'ma7_t', 'SK', 'ATR', 'PM', 'Median_HL', 'variation_t', 'ret', 'HL']
2025-05-19 23:23:46,829 - INFO - [src.data_preparation] - Ticker VNH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:46,829 - INFO - [src.data_preparation] - Ticker VNH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:46,831 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNH
2025-05-19 23:23:46,831 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:46,831 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(185), np.int64(1): np.int64(278)}
2025-05-19 23:23:46,831 - INFO - [src.data_preparation] - Generating 93 synthetic minority samples
2025-05-19 23:23:46,835 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (556, 13, 15), y shape: (556,)
2025-05-19 23:23:46,835 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(278), np.int64(1): np.int64(278)}
2025-05-19 23:23:46,838 - INFO - [src.data_preparation] - Ticker VNH - Final 3D shapes: X_train=(556, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:46,838 - INFO - [__main__] - Using best model for VNH: lstm (F1: 0.8571)
2025-05-19 23:23:46,838 - INFO - [__main__] - Loading lstm model for VNH...
2025-05-19 23:23:46,842 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:46,844 - INFO - [__main__] - Model size: 0.13 MB
2025-05-19 23:23:46,845 - INFO - [__main__] - Making predictions for VNH using lstm
2025-05-19 23:23:46,847 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:46,848 - INFO - [__main__] - Successfully got last prediction for VNH
2025-05-19 23:23:46,848 - INFO - [__main__] - 
Processing ticker: VNI
2025-05-19 23:23:46,848 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:46,848 - INFO - [__main__] - Getting last prediction point for ticker: VNI
2025-05-19 23:23:46,848 - INFO - [__main__] - ==================================================
2025-05-19 23:23:46,848 - INFO - [__main__] - Preparing test data for VNI...
2025-05-19 23:23:46,887 - INFO - [src.data_preparation] - After processing - X shape: (634, 19), y shape: (634,)
2025-05-19 23:23:46,887 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:46,887 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:46,908 - INFO - [src.data_preparation] - Ticker VNI - Original shapes: X=(634, 18), y=(634,)
2025-05-19 23:23:46,909 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(217), np.int64(1): np.int64(417)}
2025-05-19 23:23:47,239 - INFO - [src.data_preparation] - Ticker VNI - Selected features:
2025-05-19 23:23:47,239 - INFO - [src.data_preparation] -   TVV: 0.0867
2025-05-19 23:23:47,239 - INFO - [src.data_preparation] -   SK: 0.0757
2025-05-19 23:23:47,239 - INFO - [src.data_preparation] -   ATR: 0.0742
2025-05-19 23:23:47,239 - INFO - [src.data_preparation] -   Volatility: 0.0736
2025-05-19 23:23:47,239 - INFO - [src.data_preparation] -   vnipc_t: 0.0697
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   s_d7_t: 0.0662
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   ma14_t: 0.0623
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   ma21_t: 0.0579
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   ma7_t: 0.0536
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   ret: 0.0534
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   Median_HL: 0.0514
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   insec_t: 0.0514
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   PM: 0.0501
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   variation_t: 0.0485
2025-05-19 23:23:47,240 - INFO - [src.data_preparation] -   HL: 0.0417
2025-05-19 23:23:47,243 - INFO - [src.data_preparation] - Ticker VNI - Using features: ['Date', 'TVV', 'SK', 'ATR', 'Volatility', 'vnipc_t', 's_d7_t', 'ma14_t', 'ma21_t', 'ma7_t', 'ret', 'Median_HL', 'insec_t', 'PM', 'variation_t', 'HL']
2025-05-19 23:23:47,328 - INFO - [src.data_preparation] - Ticker VNI - 2D shapes: X_train=(458, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:47,328 - INFO - [src.data_preparation] - Ticker VNI - 3D shapes: X_train=(458, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:47,337 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNI
2025-05-19 23:23:47,337 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (458, 13, 15), y shape: (458,)
2025-05-19 23:23:47,337 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(168), np.int64(1): np.int64(290)}
2025-05-19 23:23:47,337 - INFO - [src.data_preparation] - Generating 122 synthetic minority samples
2025-05-19 23:23:47,342 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (580, 13, 15), y shape: (580,)
2025-05-19 23:23:47,342 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(290), np.int64(1): np.int64(290)}
2025-05-19 23:23:47,348 - INFO - [src.data_preparation] - Ticker VNI - Final 3D shapes: X_train=(580, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:47,348 - INFO - [__main__] - Using best model for VNI: lstm (F1: 0.8615)
2025-05-19 23:23:47,348 - INFO - [__main__] - Loading lstm model for VNI...
2025-05-19 23:23:47,351 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:47,352 - INFO - [__main__] - Model size: 0.07 MB
2025-05-19 23:23:47,352 - INFO - [__main__] - Making predictions for VNI using lstm
2025-05-19 23:23:47,354 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:47,354 - INFO - [__main__] - Successfully got last prediction for VNI
2025-05-19 23:23:47,354 - INFO - [__main__] - 
Processing ticker: VNL
2025-05-19 23:23:47,354 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:47,354 - INFO - [__main__] - Getting last prediction point for ticker: VNL
2025-05-19 23:23:47,354 - INFO - [__main__] - ==================================================
2025-05-19 23:23:47,354 - INFO - [__main__] - Preparing test data for VNL...
2025-05-19 23:23:47,399 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:47,399 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:47,399 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:47,424 - INFO - [src.data_preparation] - Ticker VNL - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:47,424 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(277), np.int64(1): np.int64(362)}
2025-05-19 23:23:47,780 - INFO - [src.data_preparation] - Ticker VNL - Selected features:
2025-05-19 23:23:47,780 - INFO - [src.data_preparation] -   vnipc_t: 0.0719
2025-05-19 23:23:47,780 - INFO - [src.data_preparation] -   insec_t: 0.0716
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   SK: 0.0703
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   Volatility: 0.0699
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   TVV: 0.0645
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   ATR: 0.0629
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   SR: 0.0628
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   LO: 0.0605
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   HL: 0.0603
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   ret: 0.0570
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   s_d7_t: 0.0563
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   variation_t: 0.0535
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   ma21_t: 0.0513
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   ma14_t: 0.0484
2025-05-19 23:23:47,781 - INFO - [src.data_preparation] -   ma7_t: 0.0470
2025-05-19 23:23:47,784 - INFO - [src.data_preparation] - Ticker VNL - Using features: ['Date', 'vnipc_t', 'insec_t', 'SK', 'Volatility', 'TVV', 'ATR', 'SR', 'LO', 'HL', 'ret', 's_d7_t', 'variation_t', 'ma21_t', 'ma14_t', 'ma7_t']
2025-05-19 23:23:47,880 - INFO - [src.data_preparation] - Ticker VNL - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:47,880 - INFO - [src.data_preparation] - Ticker VNL - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:47,882 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNL
2025-05-19 23:23:47,882 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:47,882 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(196), np.int64(1): np.int64(267)}
2025-05-19 23:23:47,882 - INFO - [src.data_preparation] - Generating 71 synthetic minority samples
2025-05-19 23:23:47,886 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (534, 13, 15), y shape: (534,)
2025-05-19 23:23:47,886 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(267), np.int64(1): np.int64(267)}
2025-05-19 23:23:47,889 - INFO - [src.data_preparation] - Ticker VNL - Final 3D shapes: X_train=(534, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:47,889 - INFO - [__main__] - Using best model for VNL: svm (F1: 0.7059)
2025-05-19 23:23:47,890 - INFO - [__main__] - Loading svm model for VNL...
2025-05-19 23:23:47,891 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:47,892 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:23:47,892 - INFO - [__main__] - Making predictions for VNL using svm
2025-05-19 23:23:47,892 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:47,893 - INFO - [__main__] - Successfully got last prediction for VNL
2025-05-19 23:23:47,893 - INFO - [__main__] - 
Processing ticker: VNM
2025-05-19 23:23:47,893 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:47,893 - INFO - [__main__] - Getting last prediction point for ticker: VNM
2025-05-19 23:23:47,893 - INFO - [__main__] - ==================================================
2025-05-19 23:23:47,893 - INFO - [__main__] - Preparing test data for VNM...
2025-05-19 23:23:47,921 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:47,921 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:47,921 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:47,941 - INFO - [src.data_preparation] - Ticker VNM - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:47,941 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(305), np.int64(1): np.int64(334)}
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] - Ticker VNM - Selected features:
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   insec_t: 0.0675
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   Volatility: 0.0666
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   SK: 0.0644
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   ma14_t: 0.0636
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   HL: 0.0633
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   s_d7_t: 0.0621
2025-05-19 23:23:48,266 - INFO - [src.data_preparation] -   vnipc_t: 0.0617
2025-05-19 23:23:48,267 - INFO - [src.data_preparation] -   TVV: 0.0601
2025-05-19 23:23:48,267 - INFO - [src.data_preparation] -   ATR: 0.0589
2025-05-19 23:23:48,267 - INFO - [src.data_preparation] -   ma21_t: 0.0588
2025-05-19 23:23:48,267 - INFO - [src.data_preparation] -   ma7_t: 0.0567
2025-05-19 23:23:48,268 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:23:48,268 - INFO - [src.data_preparation] -   Median_HL: 0.0542
2025-05-19 23:23:48,268 - INFO - [src.data_preparation] -   PM: 0.0541
2025-05-19 23:23:48,268 - INFO - [src.data_preparation] -   LO: 0.0530
2025-05-19 23:23:48,271 - INFO - [src.data_preparation] - Ticker VNM - Using features: ['Date', 'insec_t', 'Volatility', 'SK', 'ma14_t', 'HL', 's_d7_t', 'vnipc_t', 'TVV', 'ATR', 'ma21_t', 'ma7_t', 'SR', 'Median_HL', 'PM', 'LO']
2025-05-19 23:23:48,362 - INFO - [src.data_preparation] - Ticker VNM - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:48,363 - INFO - [src.data_preparation] - Ticker VNM - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:48,365 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNM
2025-05-19 23:23:48,365 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:48,365 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(216), np.int64(1): np.int64(247)}
2025-05-19 23:23:48,365 - INFO - [src.data_preparation] - Generating 31 synthetic minority samples
2025-05-19 23:23:48,367 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (494, 13, 15), y shape: (494,)
2025-05-19 23:23:48,368 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(247), np.int64(1): np.int64(247)}
2025-05-19 23:23:48,371 - INFO - [src.data_preparation] - Ticker VNM - Final 3D shapes: X_train=(494, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:48,371 - INFO - [__main__] - Using best model for VNM: logistic_regression (F1: 0.5333)
2025-05-19 23:23:48,372 - INFO - [__main__] - Loading logistic_regression model for VNM...
2025-05-19 23:23:48,372 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:48,372 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:48,372 - INFO - [__main__] - Making predictions for VNM using logistic_regression
2025-05-19 23:23:48,373 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:48,373 - INFO - [__main__] - Successfully got last prediction for VNM
2025-05-19 23:23:48,373 - INFO - [__main__] - 
Processing ticker: VNR
2025-05-19 23:23:48,373 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:48,373 - INFO - [__main__] - Getting last prediction point for ticker: VNR
2025-05-19 23:23:48,373 - INFO - [__main__] - ==================================================
2025-05-19 23:23:48,373 - INFO - [__main__] - Preparing test data for VNR...
2025-05-19 23:23:48,405 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:48,405 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:48,405 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:48,427 - INFO - [src.data_preparation] - Ticker VNR - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:48,427 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(285), np.int64(1): np.int64(354)}
2025-05-19 23:23:48,753 - INFO - [src.data_preparation] - Ticker VNR - Selected features:
2025-05-19 23:23:48,753 - INFO - [src.data_preparation] -   SK: 0.0726
2025-05-19 23:23:48,753 - INFO - [src.data_preparation] -   vnipc_t: 0.0721
2025-05-19 23:23:48,753 - INFO - [src.data_preparation] -   SR: 0.0663
2025-05-19 23:23:48,753 - INFO - [src.data_preparation] -   insec_t: 0.0647
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   TVV: 0.0644
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   Volatility: 0.0629
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   s_d7_t: 0.0616
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   ATR: 0.0600
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   HL: 0.0588
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   ma7_t: 0.0569
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   ret: 0.0562
2025-05-19 23:23:48,754 - INFO - [src.data_preparation] -   LO: 0.0546
2025-05-19 23:23:48,755 - INFO - [src.data_preparation] -   PM: 0.0516
2025-05-19 23:23:48,755 - INFO - [src.data_preparation] -   Median_HL: 0.0514
2025-05-19 23:23:48,755 - INFO - [src.data_preparation] -   variation_t: 0.0507
2025-05-19 23:23:48,757 - INFO - [src.data_preparation] - Ticker VNR - Using features: ['Date', 'SK', 'vnipc_t', 'SR', 'insec_t', 'TVV', 'Volatility', 's_d7_t', 'ATR', 'HL', 'ma7_t', 'ret', 'LO', 'PM', 'Median_HL', 'variation_t']
2025-05-19 23:23:48,865 - INFO - [src.data_preparation] - Ticker VNR - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:48,865 - INFO - [src.data_preparation] - Ticker VNR - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:48,867 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNR
2025-05-19 23:23:48,867 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:48,867 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:23:48,868 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:23:48,870 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:23:48,870 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:23:48,873 - INFO - [src.data_preparation] - Ticker VNR - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:48,874 - INFO - [__main__] - Using best model for VNR: svm (F1: 0.7246)
2025-05-19 23:23:48,874 - INFO - [__main__] - Loading svm model for VNR...
2025-05-19 23:23:48,875 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:48,876 - INFO - [__main__] - Model size: 0.77 MB
2025-05-19 23:23:48,876 - INFO - [__main__] - Making predictions for VNR using svm
2025-05-19 23:23:48,876 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:48,877 - INFO - [__main__] - Successfully got last prediction for VNR
2025-05-19 23:23:48,877 - INFO - [__main__] - 
Processing ticker: VNS
2025-05-19 23:23:48,877 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:48,877 - INFO - [__main__] - Getting last prediction point for ticker: VNS
2025-05-19 23:23:48,878 - INFO - [__main__] - ==================================================
2025-05-19 23:23:48,878 - INFO - [__main__] - Preparing test data for VNS...
2025-05-19 23:23:48,916 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:48,916 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:48,916 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:48,937 - INFO - [src.data_preparation] - Ticker VNS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:48,937 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(304), np.int64(1): np.int64(335)}
2025-05-19 23:23:49,265 - INFO - [src.data_preparation] - Ticker VNS - Selected features:
2025-05-19 23:23:49,265 - INFO - [src.data_preparation] -   vnipc_t: 0.0726
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   TVV: 0.0714
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   insec_t: 0.0696
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   s_d7_t: 0.0646
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   SK: 0.0641
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   Volatility: 0.0638
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   HL: 0.0601
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   ret: 0.0563
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   ma21_t: 0.0560
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   SR: 0.0555
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   ma14_t: 0.0549
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   ATR: 0.0543
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   variation_t: 0.0542
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   LO: 0.0526
2025-05-19 23:23:49,267 - INFO - [src.data_preparation] -   Median_HL: 0.0498
2025-05-19 23:23:49,270 - INFO - [src.data_preparation] - Ticker VNS - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 's_d7_t', 'SK', 'Volatility', 'HL', 'ret', 'ma21_t', 'SR', 'ma14_t', 'ATR', 'variation_t', 'LO', 'Median_HL']
2025-05-19 23:23:49,355 - INFO - [src.data_preparation] - Ticker VNS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:49,357 - INFO - [src.data_preparation] - Ticker VNS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:49,358 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNS
2025-05-19 23:23:49,358 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:49,358 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(224), np.int64(1): np.int64(239)}
2025-05-19 23:23:49,358 - INFO - [src.data_preparation] - Generating 15 synthetic minority samples
2025-05-19 23:23:49,359 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (478, 13, 15), y shape: (478,)
2025-05-19 23:23:49,359 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(239), np.int64(1): np.int64(239)}
2025-05-19 23:23:49,362 - INFO - [src.data_preparation] - Ticker VNS - Final 3D shapes: X_train=(478, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:49,363 - INFO - [__main__] - Using best model for VNS: svm (F1: 0.6667)
2025-05-19 23:23:49,363 - INFO - [__main__] - Loading svm model for VNS...
2025-05-19 23:23:49,364 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:49,365 - INFO - [__main__] - Model size: 0.47 MB
2025-05-19 23:23:49,365 - INFO - [__main__] - Making predictions for VNS using svm
2025-05-19 23:23:49,365 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:49,365 - INFO - [__main__] - Successfully got last prediction for VNS
2025-05-19 23:23:49,365 - INFO - [__main__] - 
Processing ticker: VNT
2025-05-19 23:23:49,365 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:49,367 - INFO - [__main__] - Getting last prediction point for ticker: VNT
2025-05-19 23:23:49,367 - INFO - [__main__] - ==================================================
2025-05-19 23:23:49,367 - INFO - [__main__] - Preparing test data for VNT...
2025-05-19 23:23:49,399 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:49,399 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:49,399 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:49,421 - INFO - [src.data_preparation] - Ticker VNT - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:49,421 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(249), np.int64(1): np.int64(390)}
2025-05-19 23:23:49,725 - INFO - [src.data_preparation] - Ticker VNT - Selected features:
2025-05-19 23:23:49,725 - INFO - [src.data_preparation] -   vnipc_t: 0.0785
2025-05-19 23:23:49,725 - INFO - [src.data_preparation] -   Volatility: 0.0709
2025-05-19 23:23:49,725 - INFO - [src.data_preparation] -   SK: 0.0676
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   s_d7_t: 0.0669
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   ma21_t: 0.0622
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   Median_HL: 0.0609
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   ATR: 0.0590
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   TVV: 0.0586
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   ma7_t: 0.0559
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   ma14_t: 0.0554
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   PM: 0.0546
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   HL: 0.0533
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   variation_t: 0.0532
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   LO: 0.0524
2025-05-19 23:23:49,726 - INFO - [src.data_preparation] -   insec_t: 0.0510
2025-05-19 23:23:49,730 - INFO - [src.data_preparation] - Ticker VNT - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 's_d7_t', 'ma21_t', 'Median_HL', 'ATR', 'TVV', 'ma7_t', 'ma14_t', 'PM', 'HL', 'variation_t', 'LO', 'insec_t']
2025-05-19 23:23:49,819 - INFO - [src.data_preparation] - Ticker VNT - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:49,819 - INFO - [src.data_preparation] - Ticker VNT - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:49,822 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNT
2025-05-19 23:23:49,822 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:49,822 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(184), np.int64(1): np.int64(279)}
2025-05-19 23:23:49,822 - INFO - [src.data_preparation] - Generating 95 synthetic minority samples
2025-05-19 23:23:49,826 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (558, 13, 15), y shape: (558,)
2025-05-19 23:23:49,827 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(279), np.int64(1): np.int64(279)}
2025-05-19 23:23:49,831 - INFO - [src.data_preparation] - Ticker VNT - Final 3D shapes: X_train=(558, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:49,832 - INFO - [__main__] - Using best model for VNT: svm (F1: 0.8571)
2025-05-19 23:23:49,832 - INFO - [__main__] - Loading svm model for VNT...
2025-05-19 23:23:49,833 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:49,834 - INFO - [__main__] - Model size: 0.84 MB
2025-05-19 23:23:49,834 - INFO - [__main__] - Making predictions for VNT using svm
2025-05-19 23:23:49,834 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:49,835 - INFO - [__main__] - Successfully got last prediction for VNT
2025-05-19 23:23:49,835 - INFO - [__main__] - 
Processing ticker: VNX
2025-05-19 23:23:49,835 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:49,835 - INFO - [__main__] - Getting last prediction point for ticker: VNX
2025-05-19 23:23:49,835 - INFO - [__main__] - ==================================================
2025-05-19 23:23:49,835 - INFO - [__main__] - Preparing test data for VNX...
2025-05-19 23:23:49,870 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:49,870 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:49,870 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:49,889 - INFO - [src.data_preparation] - Ticker VNX - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:49,889 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(68), np.int64(1): np.int64(571)}
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] - Ticker VNX - Selected features:
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   vnipc_t: 0.1078
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   ma14_t: 0.0774
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   ma21_t: 0.0747
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   PM: 0.0746
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   ma7_t: 0.0720
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   TVV: 0.0715
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   ATR: 0.0689
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   Median_HL: 0.0687
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   s_d7_t: 0.0644
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   HL: 0.0471
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   LO: 0.0464
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   Volatility: 0.0444
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   SK: 0.0370
2025-05-19 23:23:50,085 - INFO - [src.data_preparation] -   ret: 0.0317
2025-05-19 23:23:50,089 - INFO - [src.data_preparation] - Ticker VNX - Using features: ['Date', 'vnipc_t', 'ma14_t', 'ma21_t', 'PM', 'ma7_t', 'TVV', 'ATR', 'Median_HL', 's_d7_t', 'SR', 'HL', 'LO', 'Volatility', 'SK', 'ret']
2025-05-19 23:23:50,173 - INFO - [src.data_preparation] - Ticker VNX - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:50,173 - INFO - [src.data_preparation] - Ticker VNX - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:50,178 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VNX
2025-05-19 23:23:50,178 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:50,178 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(45), np.int64(1): np.int64(418)}
2025-05-19 23:23:50,178 - WARNING - [src.data_preparation] - Skipping TimeSeriesSMOTE - imbalance too severe or no need for resampling
2025-05-19 23:23:50,184 - INFO - [src.data_preparation] - Ticker VNX - Final 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:50,184 - INFO - [__main__] - Using best model for VNX: svm (F1: 0.9136)
2025-05-19 23:23:50,185 - INFO - [__main__] - Loading svm model for VNX...
2025-05-19 23:23:50,186 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:50,186 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:50,186 - INFO - [__main__] - Making predictions for VNX using svm
2025-05-19 23:23:50,186 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:50,187 - INFO - [__main__] - Successfully got last prediction for VNX
2025-05-19 23:23:50,187 - INFO - [__main__] - 
Processing ticker: VOS
2025-05-19 23:23:50,187 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:50,187 - INFO - [__main__] - Getting last prediction point for ticker: VOS
2025-05-19 23:23:50,187 - INFO - [__main__] - ==================================================
2025-05-19 23:23:50,187 - INFO - [__main__] - Preparing test data for VOS...
2025-05-19 23:23:50,216 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:50,217 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:50,217 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:50,236 - INFO - [src.data_preparation] - Ticker VOS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:50,237 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(311), np.int64(1): np.int64(328)}
2025-05-19 23:23:50,575 - INFO - [src.data_preparation] - Ticker VOS - Selected features:
2025-05-19 23:23:50,575 - INFO - [src.data_preparation] -   insec_t: 0.0747
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   SK: 0.0737
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   Volatility: 0.0703
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   vnipc_t: 0.0662
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   ma14_t: 0.0640
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   s_d7_t: 0.0634
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   TVV: 0.0626
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   ma7_t: 0.0577
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   ma21_t: 0.0548
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   variation_t: 0.0548
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   ATR: 0.0543
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   ret: 0.0535
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   Median_HL: 0.0509
2025-05-19 23:23:50,576 - INFO - [src.data_preparation] -   PM: 0.0489
2025-05-19 23:23:50,577 - INFO - [src.data_preparation] -   HL: 0.0486
2025-05-19 23:23:50,581 - INFO - [src.data_preparation] - Ticker VOS - Using features: ['Date', 'insec_t', 'SK', 'Volatility', 'vnipc_t', 'ma14_t', 's_d7_t', 'TVV', 'ma7_t', 'ma21_t', 'variation_t', 'ATR', 'ret', 'Median_HL', 'PM', 'HL']
2025-05-19 23:23:50,692 - INFO - [src.data_preparation] - Ticker VOS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:50,692 - INFO - [src.data_preparation] - Ticker VOS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:50,693 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VOS
2025-05-19 23:23:50,694 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:50,694 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(227), np.int64(1): np.int64(236)}
2025-05-19 23:23:50,694 - INFO - [src.data_preparation] - Generating 9 synthetic minority samples
2025-05-19 23:23:50,694 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (472, 13, 15), y shape: (472,)
2025-05-19 23:23:50,694 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(236), np.int64(1): np.int64(236)}
2025-05-19 23:23:50,700 - INFO - [src.data_preparation] - Ticker VOS - Final 3D shapes: X_train=(472, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:50,700 - INFO - [__main__] - Using best model for VOS: transformer (F1: 0.6667)
2025-05-19 23:23:50,701 - INFO - [__main__] - Loading transformer model for VOS...
2025-05-19 23:23:50,723 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:23:50,728 - INFO - [__main__] - Model size: 0.09 MB
2025-05-19 23:23:50,728 - INFO - [__main__] - Making predictions for VOS using transformer
2025-05-19 23:23:50,730 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:50,731 - INFO - [__main__] - Successfully got last prediction for VOS
2025-05-19 23:23:50,732 - INFO - [__main__] - 
Processing ticker: VPC
2025-05-19 23:23:50,732 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:50,732 - INFO - [__main__] - Getting last prediction point for ticker: VPC
2025-05-19 23:23:50,732 - INFO - [__main__] - ==================================================
2025-05-19 23:23:50,732 - INFO - [__main__] - Preparing test data for VPC...
2025-05-19 23:23:50,777 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:50,777 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:50,777 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:50,803 - INFO - [src.data_preparation] - Ticker VPC - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:50,804 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(206), np.int64(1): np.int64(432)}
2025-05-19 23:23:51,124 - INFO - [src.data_preparation] - Ticker VPC - Selected features:
2025-05-19 23:23:51,124 - INFO - [src.data_preparation] -   vnipc_t: 0.0916
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   TVV: 0.0747
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   ma21_t: 0.0713
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   s_d7_t: 0.0688
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   Volatility: 0.0651
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   ma14_t: 0.0610
2025-05-19 23:23:51,125 - INFO - [src.data_preparation] -   ma7_t: 0.0606
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   SK: 0.0583
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   ATR: 0.0572
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   PM: 0.0563
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   Median_HL: 0.0549
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   ret: 0.0460
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   variation_t: 0.0454
2025-05-19 23:23:51,126 - INFO - [src.data_preparation] -   HL: 0.0375
2025-05-19 23:23:51,129 - INFO - [src.data_preparation] - Ticker VPC - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 's_d7_t', 'Volatility', 'insec_t', 'ma14_t', 'ma7_t', 'SK', 'ATR', 'PM', 'Median_HL', 'ret', 'variation_t', 'HL']
2025-05-19 23:23:51,240 - INFO - [src.data_preparation] - Ticker VPC - 2D shapes: X_train=(462, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:51,241 - INFO - [src.data_preparation] - Ticker VPC - 3D shapes: X_train=(462, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:51,242 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VPC
2025-05-19 23:23:51,243 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (462, 13, 15), y shape: (462,)
2025-05-19 23:23:51,243 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(148), np.int64(1): np.int64(314)}
2025-05-19 23:23:51,243 - INFO - [src.data_preparation] - Generating 166 synthetic minority samples
2025-05-19 23:23:51,253 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (628, 13, 15), y shape: (628,)
2025-05-19 23:23:51,253 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(314), np.int64(1): np.int64(314)}
2025-05-19 23:23:51,258 - INFO - [src.data_preparation] - Ticker VPC - Final 3D shapes: X_train=(628, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:51,258 - INFO - [__main__] - Using best model for VPC: svm (F1: 0.9136)
2025-05-19 23:23:51,258 - INFO - [__main__] - Loading svm model for VPC...
2025-05-19 23:23:51,260 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:51,261 - INFO - [__main__] - Model size: 0.95 MB
2025-05-19 23:23:51,261 - INFO - [__main__] - Making predictions for VPC using svm
2025-05-19 23:23:51,261 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:51,262 - INFO - [__main__] - Successfully got last prediction for VPC
2025-05-19 23:23:51,262 - INFO - [__main__] - 
Processing ticker: VPH
2025-05-19 23:23:51,262 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:51,262 - INFO - [__main__] - Getting last prediction point for ticker: VPH
2025-05-19 23:23:51,262 - INFO - [__main__] - ==================================================
2025-05-19 23:23:51,262 - INFO - [__main__] - Preparing test data for VPH...
2025-05-19 23:23:51,309 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:51,309 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:51,309 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:51,329 - INFO - [src.data_preparation] - Ticker VPH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:51,329 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(319), np.int64(1): np.int64(320)}
2025-05-19 23:23:51,659 - INFO - [src.data_preparation] - Ticker VPH - Selected features:
2025-05-19 23:23:51,659 - INFO - [src.data_preparation] -   s_d7_t: 0.0781
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   ATR: 0.0721
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   vnipc_t: 0.0706
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   SK: 0.0675
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   insec_t: 0.0642
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   TVV: 0.0617
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   ma14_t: 0.0596
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   ma21_t: 0.0587
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   Volatility: 0.0562
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   variation_t: 0.0547
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   ret: 0.0531
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   Median_HL: 0.0530
2025-05-19 23:23:51,660 - INFO - [src.data_preparation] -   SR: 0.0521
2025-05-19 23:23:51,661 - INFO - [src.data_preparation] -   PM: 0.0517
2025-05-19 23:23:51,661 - INFO - [src.data_preparation] -   ma7_t: 0.0515
2025-05-19 23:23:51,664 - INFO - [src.data_preparation] - Ticker VPH - Using features: ['Date', 's_d7_t', 'ATR', 'vnipc_t', 'SK', 'insec_t', 'TVV', 'ma14_t', 'ma21_t', 'Volatility', 'variation_t', 'ret', 'Median_HL', 'SR', 'PM', 'ma7_t']
2025-05-19 23:23:51,763 - INFO - [src.data_preparation] - Ticker VPH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:51,763 - INFO - [src.data_preparation] - Ticker VPH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:51,765 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VPH
2025-05-19 23:23:51,765 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:51,765 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(221), np.int64(1): np.int64(242)}
2025-05-19 23:23:51,767 - INFO - [src.data_preparation] - Generating 21 synthetic minority samples
2025-05-19 23:23:51,768 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (484, 13, 15), y shape: (484,)
2025-05-19 23:23:51,769 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(242), np.int64(1): np.int64(242)}
2025-05-19 23:23:51,772 - INFO - [src.data_preparation] - Ticker VPH - Final 3D shapes: X_train=(484, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:51,772 - INFO - [__main__] - Using best model for VPH: svm (F1: 0.2727)
2025-05-19 23:23:51,772 - INFO - [__main__] - Loading svm model for VPH...
2025-05-19 23:23:51,774 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:51,774 - INFO - [__main__] - Model size: 0.66 MB
2025-05-19 23:23:51,774 - INFO - [__main__] - Making predictions for VPH using svm
2025-05-19 23:23:51,775 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:51,775 - INFO - [__main__] - Successfully got last prediction for VPH
2025-05-19 23:23:51,775 - INFO - [__main__] - 
Processing ticker: VQC
2025-05-19 23:23:51,775 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:51,775 - INFO - [__main__] - Getting last prediction point for ticker: VQC
2025-05-19 23:23:51,775 - INFO - [__main__] - ==================================================
2025-05-19 23:23:51,775 - INFO - [__main__] - Preparing test data for VQC...
2025-05-19 23:23:51,812 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:51,812 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:51,812 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:51,836 - INFO - [src.data_preparation] - Ticker VQC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:51,836 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(157), np.int64(1): np.int64(482)}
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] - Ticker VQC - Selected features:
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   ma21_t: 0.0831
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   vnipc_t: 0.0751
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   ma14_t: 0.0732
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   ma7_t: 0.0731
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   ATR: 0.0729
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   Volatility: 0.0707
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   Median_HL: 0.0703
2025-05-19 23:23:52,109 - INFO - [src.data_preparation] -   SK: 0.0691
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   PM: 0.0686
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   TVV: 0.0669
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   s_d7_t: 0.0613
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   SR: 0.0394
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   insec_t: 0.0390
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   variation_t: 0.0366
2025-05-19 23:23:52,110 - INFO - [src.data_preparation] -   HL: 0.0360
2025-05-19 23:23:52,112 - INFO - [src.data_preparation] - Ticker VQC - Using features: ['Date', 'ma21_t', 'vnipc_t', 'ma14_t', 'ma7_t', 'ATR', 'Volatility', 'Median_HL', 'SK', 'PM', 'TVV', 's_d7_t', 'SR', 'insec_t', 'variation_t', 'HL']
2025-05-19 23:23:52,199 - INFO - [src.data_preparation] - Ticker VQC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:52,199 - INFO - [src.data_preparation] - Ticker VQC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:52,201 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VQC
2025-05-19 23:23:52,202 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:52,202 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(99), np.int64(1): np.int64(364)}
2025-05-19 23:23:52,202 - INFO - [src.data_preparation] - Generating 265 synthetic minority samples
2025-05-19 23:23:52,212 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (728, 13, 15), y shape: (728,)
2025-05-19 23:23:52,213 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(364), np.int64(1): np.int64(364)}
2025-05-19 23:23:52,220 - INFO - [src.data_preparation] - Ticker VQC - Final 3D shapes: X_train=(728, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:52,220 - INFO - [__main__] - Using best model for VQC: svm (F1: 0.7606)
2025-05-19 23:23:52,220 - INFO - [__main__] - Loading svm model for VQC...
2025-05-19 23:23:52,222 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:52,223 - INFO - [__main__] - Model size: 1.10 MB
2025-05-19 23:23:52,223 - INFO - [__main__] - Making predictions for VQC using svm
2025-05-19 23:23:52,223 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:52,224 - INFO - [__main__] - Successfully got last prediction for VQC
2025-05-19 23:23:52,224 - INFO - [__main__] - 
Processing ticker: VRC
2025-05-19 23:23:52,224 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:52,224 - INFO - [__main__] - Getting last prediction point for ticker: VRC
2025-05-19 23:23:52,224 - INFO - [__main__] - ==================================================
2025-05-19 23:23:52,224 - INFO - [__main__] - Preparing test data for VRC...
2025-05-19 23:23:52,260 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:52,260 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:52,260 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:52,282 - INFO - [src.data_preparation] - Ticker VRC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:52,283 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(313), np.int64(1): np.int64(326)}
2025-05-19 23:23:52,575 - INFO - [src.data_preparation] - Ticker VRC - Selected features:
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   ma14_t: 0.0701
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   SK: 0.0687
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   s_d7_t: 0.0676
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   vnipc_t: 0.0647
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   TVV: 0.0636
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   ma7_t: 0.0611
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   variation_t: 0.0601
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   ma21_t: 0.0595
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   Median_HL: 0.0574
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   ATR: 0.0573
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   insec_t: 0.0560
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   ret: 0.0554
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   Volatility: 0.0551
2025-05-19 23:23:52,576 - INFO - [src.data_preparation] -   HL: 0.0534
2025-05-19 23:23:52,577 - INFO - [src.data_preparation] -   LO: 0.0485
2025-05-19 23:23:52,580 - INFO - [src.data_preparation] - Ticker VRC - Using features: ['Date', 'ma14_t', 'SK', 's_d7_t', 'vnipc_t', 'TVV', 'ma7_t', 'variation_t', 'ma21_t', 'Median_HL', 'ATR', 'insec_t', 'ret', 'Volatility', 'HL', 'LO']
2025-05-19 23:23:52,668 - INFO - [src.data_preparation] - Ticker VRC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:52,668 - INFO - [src.data_preparation] - Ticker VRC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:52,669 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VRC
2025-05-19 23:23:52,669 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:52,669 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(219), np.int64(1): np.int64(244)}
2025-05-19 23:23:52,669 - INFO - [src.data_preparation] - Generating 25 synthetic minority samples
2025-05-19 23:23:52,671 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (488, 13, 15), y shape: (488,)
2025-05-19 23:23:52,671 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(244), np.int64(1): np.int64(244)}
2025-05-19 23:23:52,675 - INFO - [src.data_preparation] - Ticker VRC - Final 3D shapes: X_train=(488, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:52,675 - INFO - [__main__] - Using best model for VRC: svm (F1: 0.5862)
2025-05-19 23:23:52,675 - INFO - [__main__] - Loading svm model for VRC...
2025-05-19 23:23:52,676 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:52,677 - INFO - [__main__] - Model size: 0.68 MB
2025-05-19 23:23:52,677 - INFO - [__main__] - Making predictions for VRC using svm
2025-05-19 23:23:52,677 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:52,678 - INFO - [__main__] - Successfully got last prediction for VRC
2025-05-19 23:23:52,678 - INFO - [__main__] - 
Processing ticker: VSC
2025-05-19 23:23:52,678 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:52,678 - INFO - [__main__] - Getting last prediction point for ticker: VSC
2025-05-19 23:23:52,678 - INFO - [__main__] - ==================================================
2025-05-19 23:23:52,678 - INFO - [__main__] - Preparing test data for VSC...
2025-05-19 23:23:52,716 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:52,716 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:52,716 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:52,736 - INFO - [src.data_preparation] - Ticker VSC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:52,737 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(296), np.int64(1): np.int64(343)}
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] - Ticker VSC - Selected features:
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   SK: 0.0702
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   vnipc_t: 0.0673
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   s_d7_t: 0.0657
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   insec_t: 0.0654
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   Volatility: 0.0645
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   ma7_t: 0.0609
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   ma14_t: 0.0592
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   HL: 0.0587
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   LO: 0.0584
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   TVV: 0.0579
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   ATR: 0.0577
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   PM: 0.0575
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   Median_HL: 0.0555
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   ma21_t: 0.0554
2025-05-19 23:23:53,085 - INFO - [src.data_preparation] -   ret: 0.0533
2025-05-19 23:23:53,090 - INFO - [src.data_preparation] - Ticker VSC - Using features: ['Date', 'SK', 'vnipc_t', 's_d7_t', 'insec_t', 'Volatility', 'ma7_t', 'ma14_t', 'HL', 'LO', 'TVV', 'ATR', 'PM', 'Median_HL', 'ma21_t', 'ret']
2025-05-19 23:23:53,272 - INFO - [src.data_preparation] - Ticker VSC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:53,273 - INFO - [src.data_preparation] - Ticker VSC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:53,274 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VSC
2025-05-19 23:23:53,274 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:53,274 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(207), np.int64(1): np.int64(256)}
2025-05-19 23:23:53,274 - INFO - [src.data_preparation] - Generating 49 synthetic minority samples
2025-05-19 23:23:53,277 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (512, 13, 15), y shape: (512,)
2025-05-19 23:23:53,277 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(256), np.int64(1): np.int64(256)}
2025-05-19 23:23:53,280 - INFO - [src.data_preparation] - Ticker VSC - Final 3D shapes: X_train=(512, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:53,281 - INFO - [__main__] - Using best model for VSC: svm (F1: 0.7213)
2025-05-19 23:23:53,281 - INFO - [__main__] - Loading svm model for VSC...
2025-05-19 23:23:53,284 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:53,285 - INFO - [__main__] - Model size: 0.54 MB
2025-05-19 23:23:53,285 - INFO - [__main__] - Making predictions for VSC using svm
2025-05-19 23:23:53,285 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:53,285 - INFO - [__main__] - Successfully got last prediction for VSC
2025-05-19 23:23:53,285 - INFO - [__main__] - 
Processing ticker: VSG
2025-05-19 23:23:53,287 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:53,287 - INFO - [__main__] - Getting last prediction point for ticker: VSG
2025-05-19 23:23:53,287 - INFO - [__main__] - ==================================================
2025-05-19 23:23:53,287 - INFO - [__main__] - Preparing test data for VSG...
2025-05-19 23:23:53,315 - INFO - [src.data_preparation] - After processing - X shape: (633, 19), y shape: (633,)
2025-05-19 23:23:53,315 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:53,315 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:53,334 - INFO - [src.data_preparation] - Ticker VSG - Original shapes: X=(633, 18), y=(633,)
2025-05-19 23:23:53,334 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(183), np.int64(1): np.int64(450)}
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] - Ticker VSG - Selected features:
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   vnipc_t: 0.0870
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   TVV: 0.0827
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   ma21_t: 0.0750
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   Volatility: 0.0750
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   ma14_t: 0.0739
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   ma7_t: 0.0679
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   s_d7_t: 0.0670
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   insec_t: 0.0644
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   ATR: 0.0630
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   SK: 0.0581
2025-05-19 23:23:53,630 - INFO - [src.data_preparation] -   PM: 0.0552
2025-05-19 23:23:53,631 - INFO - [src.data_preparation] -   Median_HL: 0.0550
2025-05-19 23:23:53,631 - INFO - [src.data_preparation] -   variation_t: 0.0437
2025-05-19 23:23:53,631 - INFO - [src.data_preparation] -   ret: 0.0419
2025-05-19 23:23:53,631 - INFO - [src.data_preparation] -   HL: 0.0303
2025-05-19 23:23:53,634 - INFO - [src.data_preparation] - Ticker VSG - Using features: ['Date', 'vnipc_t', 'TVV', 'ma21_t', 'Volatility', 'ma14_t', 'ma7_t', 's_d7_t', 'insec_t', 'ATR', 'SK', 'PM', 'Median_HL', 'variation_t', 'ret', 'HL']
2025-05-19 23:23:53,720 - INFO - [src.data_preparation] - Ticker VSG - 2D shapes: X_train=(457, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:53,720 - INFO - [src.data_preparation] - Ticker VSG - 3D shapes: X_train=(457, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:53,722 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VSG
2025-05-19 23:23:53,722 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (457, 13, 15), y shape: (457,)
2025-05-19 23:23:53,722 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(126), np.int64(1): np.int64(331)}
2025-05-19 23:23:53,722 - INFO - [src.data_preparation] - Generating 205 synthetic minority samples
2025-05-19 23:23:53,730 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (662, 13, 15), y shape: (662,)
2025-05-19 23:23:53,730 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(331), np.int64(1): np.int64(331)}
2025-05-19 23:23:53,735 - INFO - [src.data_preparation] - Ticker VSG - Final 3D shapes: X_train=(662, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:53,735 - INFO - [__main__] - Using best model for VSG: svm (F1: 0.8718)
2025-05-19 23:23:53,735 - INFO - [__main__] - Loading svm model for VSG...
2025-05-19 23:23:53,737 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:53,738 - INFO - [__main__] - Model size: 1.00 MB
2025-05-19 23:23:53,738 - INFO - [__main__] - Making predictions for VSG using svm
2025-05-19 23:23:53,740 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:53,740 - INFO - [__main__] - Successfully got last prediction for VSG
2025-05-19 23:23:53,740 - INFO - [__main__] - 
Processing ticker: VSH
2025-05-19 23:23:53,740 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:53,740 - INFO - [__main__] - Getting last prediction point for ticker: VSH
2025-05-19 23:23:53,740 - INFO - [__main__] - ==================================================
2025-05-19 23:23:53,740 - INFO - [__main__] - Preparing test data for VSH...
2025-05-19 23:23:53,773 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:53,773 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:53,773 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:53,791 - INFO - [src.data_preparation] - Ticker VSH - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:53,791 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(385)}
2025-05-19 23:23:54,109 - INFO - [src.data_preparation] - Ticker VSH - Selected features:
2025-05-19 23:23:54,109 - INFO - [src.data_preparation] -   s_d7_t: 0.0719
2025-05-19 23:23:54,109 - INFO - [src.data_preparation] -   TVV: 0.0711
2025-05-19 23:23:54,109 - INFO - [src.data_preparation] -   insec_t: 0.0690
2025-05-19 23:23:54,109 - INFO - [src.data_preparation] -   vnipc_t: 0.0683
2025-05-19 23:23:54,109 - INFO - [src.data_preparation] -   Volatility: 0.0667
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   ATR: 0.0661
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   SK: 0.0613
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   ret: 0.0610
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   variation_t: 0.0565
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   LO: 0.0548
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   PM: 0.0530
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   ma21_t: 0.0527
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   HL: 0.0517
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   SR: 0.0509
2025-05-19 23:23:54,110 - INFO - [src.data_preparation] -   Median_HL: 0.0500
2025-05-19 23:23:54,113 - INFO - [src.data_preparation] - Ticker VSH - Using features: ['Date', 's_d7_t', 'TVV', 'insec_t', 'vnipc_t', 'Volatility', 'ATR', 'SK', 'ret', 'variation_t', 'LO', 'PM', 'ma21_t', 'HL', 'SR', 'Median_HL']
2025-05-19 23:23:54,209 - INFO - [src.data_preparation] - Ticker VSH - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:54,209 - INFO - [src.data_preparation] - Ticker VSH - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:54,210 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VSH
2025-05-19 23:23:54,210 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:54,210 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(190), np.int64(1): np.int64(273)}
2025-05-19 23:23:54,210 - INFO - [src.data_preparation] - Generating 83 synthetic minority samples
2025-05-19 23:23:54,214 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (546, 13, 15), y shape: (546,)
2025-05-19 23:23:54,214 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(273), np.int64(1): np.int64(273)}
2025-05-19 23:23:54,220 - INFO - [src.data_preparation] - Ticker VSH - Final 3D shapes: X_train=(546, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:54,221 - INFO - [__main__] - Using best model for VSH: lstm (F1: 0.7945)
2025-05-19 23:23:54,221 - INFO - [__main__] - Loading lstm model for VSH...
2025-05-19 23:23:54,225 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:54,226 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:23:54,226 - INFO - [__main__] - Making predictions for VSH using lstm
2025-05-19 23:23:54,227 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:54,227 - INFO - [__main__] - Successfully got last prediction for VSH
2025-05-19 23:23:54,228 - INFO - [__main__] - 
Processing ticker: VSI
2025-05-19 23:23:54,228 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:54,228 - INFO - [__main__] - Getting last prediction point for ticker: VSI
2025-05-19 23:23:54,228 - INFO - [__main__] - ==================================================
2025-05-19 23:23:54,228 - INFO - [__main__] - Preparing test data for VSI...
2025-05-19 23:23:54,278 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:54,278 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:54,278 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:54,307 - INFO - [src.data_preparation] - Ticker VSI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:54,308 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(282), np.int64(1): np.int64(357)}
2025-05-19 23:23:54,657 - INFO - [src.data_preparation] - Ticker VSI - Selected features:
2025-05-19 23:23:54,657 - INFO - [src.data_preparation] -   SK: 0.0779
2025-05-19 23:23:54,657 - INFO - [src.data_preparation] -   vnipc_t: 0.0754
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   TVV: 0.0709
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   s_d7_t: 0.0654
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   insec_t: 0.0633
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   Volatility: 0.0607
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   HL: 0.0596
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   variation_t: 0.0589
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   ret: 0.0585
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   ATR: 0.0580
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   SR: 0.0561
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   LO: 0.0541
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   ma14_t: 0.0528
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   ma7_t: 0.0494
2025-05-19 23:23:54,659 - INFO - [src.data_preparation] -   ma21_t: 0.0489
2025-05-19 23:23:54,662 - INFO - [src.data_preparation] - Ticker VSI - Using features: ['Date', 'SK', 'vnipc_t', 'TVV', 's_d7_t', 'insec_t', 'Volatility', 'HL', 'variation_t', 'ret', 'ATR', 'SR', 'LO', 'ma14_t', 'ma7_t', 'ma21_t']
2025-05-19 23:23:54,750 - INFO - [src.data_preparation] - Ticker VSI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:54,750 - INFO - [src.data_preparation] - Ticker VSI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:54,752 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VSI
2025-05-19 23:23:54,752 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:54,752 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(209), np.int64(1): np.int64(254)}
2025-05-19 23:23:54,752 - INFO - [src.data_preparation] - Generating 45 synthetic minority samples
2025-05-19 23:23:54,754 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (508, 13, 15), y shape: (508,)
2025-05-19 23:23:54,754 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(254), np.int64(1): np.int64(254)}
2025-05-19 23:23:54,757 - INFO - [src.data_preparation] - Ticker VSI - Final 3D shapes: X_train=(508, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:54,757 - INFO - [__main__] - Using best model for VSI: logistic_regression (F1: 0.4651)
2025-05-19 23:23:54,758 - INFO - [__main__] - Loading logistic_regression model for VSI...
2025-05-19 23:23:54,758 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:54,759 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:54,759 - INFO - [__main__] - Making predictions for VSI using logistic_regression
2025-05-19 23:23:54,759 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:54,759 - INFO - [__main__] - Successfully got last prediction for VSI
2025-05-19 23:23:54,759 - INFO - [__main__] - 
Processing ticker: VST
2025-05-19 23:23:54,759 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:54,760 - INFO - [__main__] - Getting last prediction point for ticker: VST
2025-05-19 23:23:54,760 - INFO - [__main__] - ==================================================
2025-05-19 23:23:54,760 - INFO - [__main__] - Preparing test data for VST...
2025-05-19 23:23:54,789 - INFO - [src.data_preparation] - After processing - X shape: (635, 19), y shape: (635,)
2025-05-19 23:23:54,789 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:54,789 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:54,810 - INFO - [src.data_preparation] - Ticker VST - Original shapes: X=(635, 18), y=(635,)
2025-05-19 23:23:54,811 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(206), np.int64(1): np.int64(429)}
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] - Ticker VST - Selected features:
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   vnipc_t: 0.0856
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   TVV: 0.0826
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   ma7_t: 0.0747
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   Volatility: 0.0737
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   ma21_t: 0.0711
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   insec_t: 0.0681
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   ma14_t: 0.0681
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   ATR: 0.0656
2025-05-19 23:23:55,081 - INFO - [src.data_preparation] -   s_d7_t: 0.0639
2025-05-19 23:23:55,082 - INFO - [src.data_preparation] -   SK: 0.0613
2025-05-19 23:23:55,082 - INFO - [src.data_preparation] -   Median_HL: 0.0529
2025-05-19 23:23:55,082 - INFO - [src.data_preparation] -   PM: 0.0518
2025-05-19 23:23:55,082 - INFO - [src.data_preparation] -   variation_t: 0.0410
2025-05-19 23:23:55,082 - INFO - [src.data_preparation] -   ret: 0.0380
2025-05-19 23:23:55,082 - INFO - [src.data_preparation] -   HL: 0.0311
2025-05-19 23:23:55,086 - INFO - [src.data_preparation] - Ticker VST - Using features: ['Date', 'vnipc_t', 'TVV', 'ma7_t', 'Volatility', 'ma21_t', 'insec_t', 'ma14_t', 'ATR', 's_d7_t', 'SK', 'Median_HL', 'PM', 'variation_t', 'ret', 'HL']
2025-05-19 23:23:55,217 - INFO - [src.data_preparation] - Ticker VST - 2D shapes: X_train=(459, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:55,218 - INFO - [src.data_preparation] - Ticker VST - 3D shapes: X_train=(459, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:55,220 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VST
2025-05-19 23:23:55,220 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (459, 13, 15), y shape: (459,)
2025-05-19 23:23:55,220 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(136), np.int64(1): np.int64(323)}
2025-05-19 23:23:55,220 - INFO - [src.data_preparation] - Generating 187 synthetic minority samples
2025-05-19 23:23:55,228 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (646, 13, 15), y shape: (646,)
2025-05-19 23:23:55,228 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(323), np.int64(1): np.int64(323)}
2025-05-19 23:23:55,232 - INFO - [src.data_preparation] - Ticker VST - Final 3D shapes: X_train=(646, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:55,233 - INFO - [__main__] - Using best model for VST: svm (F1: 0.7778)
2025-05-19 23:23:55,233 - INFO - [__main__] - Loading svm model for VST...
2025-05-19 23:23:55,236 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:55,237 - INFO - [__main__] - Model size: 0.97 MB
2025-05-19 23:23:55,237 - INFO - [__main__] - Making predictions for VST using svm
2025-05-19 23:23:55,238 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:55,238 - INFO - [__main__] - Successfully got last prediction for VST
2025-05-19 23:23:55,238 - INFO - [__main__] - 
Processing ticker: VTA
2025-05-19 23:23:55,238 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:55,238 - INFO - [__main__] - Getting last prediction point for ticker: VTA
2025-05-19 23:23:55,239 - INFO - [__main__] - ==================================================
2025-05-19 23:23:55,239 - INFO - [__main__] - Preparing test data for VTA...
2025-05-19 23:23:55,271 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:55,271 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:55,271 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:55,294 - INFO - [src.data_preparation] - Ticker VTA - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:55,294 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(244), np.int64(1): np.int64(395)}
2025-05-19 23:23:55,636 - INFO - [src.data_preparation] - Ticker VTA - Selected features:
2025-05-19 23:23:55,637 - INFO - [src.data_preparation] -   vnipc_t: 0.0775
2025-05-19 23:23:55,637 - INFO - [src.data_preparation] -   TVV: 0.0733
2025-05-19 23:23:55,637 - INFO - [src.data_preparation] -   Volatility: 0.0727
2025-05-19 23:23:55,637 - INFO - [src.data_preparation] -   insec_t: 0.0713
2025-05-19 23:23:55,637 - INFO - [src.data_preparation] -   SK: 0.0694
2025-05-19 23:23:55,637 - INFO - [src.data_preparation] -   ATR: 0.0652
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   s_d7_t: 0.0612
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   ma14_t: 0.0604
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   ma7_t: 0.0572
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   ma21_t: 0.0562
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   ret: 0.0558
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   Median_HL: 0.0542
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   PM: 0.0525
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   variation_t: 0.0522
2025-05-19 23:23:55,638 - INFO - [src.data_preparation] -   SR: 0.0418
2025-05-19 23:23:55,641 - INFO - [src.data_preparation] - Ticker VTA - Using features: ['Date', 'vnipc_t', 'TVV', 'Volatility', 'insec_t', 'SK', 'ATR', 's_d7_t', 'ma14_t', 'ma7_t', 'ma21_t', 'ret', 'Median_HL', 'PM', 'variation_t', 'SR']
2025-05-19 23:23:55,756 - INFO - [src.data_preparation] - Ticker VTA - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:55,756 - INFO - [src.data_preparation] - Ticker VTA - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:55,759 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTA
2025-05-19 23:23:55,759 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:55,759 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(174), np.int64(1): np.int64(289)}
2025-05-19 23:23:55,759 - INFO - [src.data_preparation] - Generating 115 synthetic minority samples
2025-05-19 23:23:55,765 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (578, 13, 15), y shape: (578,)
2025-05-19 23:23:55,766 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(289), np.int64(1): np.int64(289)}
2025-05-19 23:23:55,772 - INFO - [src.data_preparation] - Ticker VTA - Final 3D shapes: X_train=(578, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:55,772 - INFO - [__main__] - Using best model for VTA: svm (F1: 0.7606)
2025-05-19 23:23:55,772 - INFO - [__main__] - Loading svm model for VTA...
2025-05-19 23:23:55,774 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:55,775 - INFO - [__main__] - Model size: 0.87 MB
2025-05-19 23:23:55,775 - INFO - [__main__] - Making predictions for VTA using svm
2025-05-19 23:23:55,776 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:55,776 - INFO - [__main__] - Successfully got last prediction for VTA
2025-05-19 23:23:55,776 - INFO - [__main__] - 
Processing ticker: VTB
2025-05-19 23:23:55,776 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:55,776 - INFO - [__main__] - Getting last prediction point for ticker: VTB
2025-05-19 23:23:55,776 - INFO - [__main__] - ==================================================
2025-05-19 23:23:55,776 - INFO - [__main__] - Preparing test data for VTB...
2025-05-19 23:23:55,820 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:55,821 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:55,821 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:55,847 - INFO - [src.data_preparation] - Ticker VTB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:55,848 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(289), np.int64(1): np.int64(350)}
2025-05-19 23:23:56,199 - INFO - [src.data_preparation] - Ticker VTB - Selected features:
2025-05-19 23:23:56,199 - INFO - [src.data_preparation] -   vnipc_t: 0.0765
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   TVV: 0.0705
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   insec_t: 0.0665
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   ATR: 0.0613
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   SK: 0.0610
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   s_d7_t: 0.0606
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   ret: 0.0595
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   PM: 0.0580
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   SR: 0.0575
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   LO: 0.0574
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   Median_HL: 0.0571
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   Volatility: 0.0563
2025-05-19 23:23:56,200 - INFO - [src.data_preparation] -   ma7_t: 0.0543
2025-05-19 23:23:56,202 - INFO - [src.data_preparation] -   HL: 0.0529
2025-05-19 23:23:56,202 - INFO - [src.data_preparation] -   ma21_t: 0.0528
2025-05-19 23:23:56,205 - INFO - [src.data_preparation] - Ticker VTB - Using features: ['Date', 'vnipc_t', 'TVV', 'insec_t', 'ATR', 'SK', 's_d7_t', 'ret', 'PM', 'SR', 'LO', 'Median_HL', 'Volatility', 'ma7_t', 'HL', 'ma21_t']
2025-05-19 23:23:56,295 - INFO - [src.data_preparation] - Ticker VTB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:56,295 - INFO - [src.data_preparation] - Ticker VTB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:56,297 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTB
2025-05-19 23:23:56,297 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:56,297 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(211), np.int64(1): np.int64(252)}
2025-05-19 23:23:56,297 - INFO - [src.data_preparation] - Generating 41 synthetic minority samples
2025-05-19 23:23:56,299 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (504, 13, 15), y shape: (504,)
2025-05-19 23:23:56,299 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(252), np.int64(1): np.int64(252)}
2025-05-19 23:23:56,302 - INFO - [src.data_preparation] - Ticker VTB - Final 3D shapes: X_train=(504, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:56,302 - INFO - [__main__] - Using best model for VTB: transformer (F1: 0.5926)
2025-05-19 23:23:56,302 - INFO - [__main__] - Loading transformer model for VTB...
2025-05-19 23:23:56,319 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:23:56,324 - INFO - [__main__] - Model size: 0.60 MB
2025-05-19 23:23:56,324 - INFO - [__main__] - Making predictions for VTB using transformer
2025-05-19 23:23:56,328 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:56,329 - INFO - [__main__] - Successfully got last prediction for VTB
2025-05-19 23:23:56,329 - INFO - [__main__] - 
Processing ticker: VTC
2025-05-19 23:23:56,329 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:56,329 - INFO - [__main__] - Getting last prediction point for ticker: VTC
2025-05-19 23:23:56,329 - INFO - [__main__] - ==================================================
2025-05-19 23:23:56,330 - INFO - [__main__] - Preparing test data for VTC...
2025-05-19 23:23:56,383 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:56,384 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:56,384 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:56,414 - INFO - [src.data_preparation] - Ticker VTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:56,414 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(275), np.int64(1): np.int64(364)}
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] - Ticker VTC - Selected features:
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   TVV: 0.0728
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   vnipc_t: 0.0714
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   SK: 0.0700
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   insec_t: 0.0674
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   ATR: 0.0673
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   s_d7_t: 0.0632
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   Volatility: 0.0626
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   SR: 0.0577
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   ret: 0.0556
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   variation_t: 0.0553
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   PM: 0.0539
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   ma14_t: 0.0530
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   HL: 0.0516
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   Median_HL: 0.0508
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] -   LO: 0.0487
2025-05-19 23:23:56,751 - INFO - [src.data_preparation] - Ticker VTC - Using features: ['Date', 'TVV', 'vnipc_t', 'SK', 'insec_t', 'ATR', 's_d7_t', 'Volatility', 'SR', 'ret', 'variation_t', 'PM', 'ma14_t', 'HL', 'Median_HL', 'LO']
2025-05-19 23:23:56,853 - INFO - [src.data_preparation] - Ticker VTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:56,854 - INFO - [src.data_preparation] - Ticker VTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:56,856 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTC
2025-05-19 23:23:56,856 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:56,856 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(194), np.int64(1): np.int64(269)}
2025-05-19 23:23:56,857 - INFO - [src.data_preparation] - Generating 75 synthetic minority samples
2025-05-19 23:23:56,860 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (538, 13, 15), y shape: (538,)
2025-05-19 23:23:56,860 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(269), np.int64(1): np.int64(269)}
2025-05-19 23:23:56,864 - INFO - [src.data_preparation] - Ticker VTC - Final 3D shapes: X_train=(538, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:56,864 - INFO - [__main__] - Using best model for VTC: svm (F1: 0.6667)
2025-05-19 23:23:56,864 - INFO - [__main__] - Loading svm model for VTC...
2025-05-19 23:23:56,866 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:56,868 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:23:56,868 - INFO - [__main__] - Making predictions for VTC using svm
2025-05-19 23:23:56,869 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:56,870 - INFO - [__main__] - Successfully got last prediction for VTC
2025-05-19 23:23:56,870 - INFO - [__main__] - 
Processing ticker: VTI
2025-05-19 23:23:56,870 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:56,870 - INFO - [__main__] - Getting last prediction point for ticker: VTI
2025-05-19 23:23:56,870 - INFO - [__main__] - ==================================================
2025-05-19 23:23:56,870 - INFO - [__main__] - Preparing test data for VTI...
2025-05-19 23:23:56,899 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:56,899 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:56,901 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:56,929 - INFO - [src.data_preparation] - Ticker VTI - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:56,929 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(79), np.int64(1): np.int64(560)}
2025-05-19 23:23:57,163 - INFO - [src.data_preparation] - Ticker VTI - Selected features:
2025-05-19 23:23:57,163 - INFO - [src.data_preparation] -   vnipc_t: 0.1151
2025-05-19 23:23:57,163 - INFO - [src.data_preparation] -   ma21_t: 0.1001
2025-05-19 23:23:57,163 - INFO - [src.data_preparation] -   ma14_t: 0.0815
2025-05-19 23:23:57,163 - INFO - [src.data_preparation] -   ma7_t: 0.0712
2025-05-19 23:23:57,163 - INFO - [src.data_preparation] -   ATR: 0.0688
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   s_d7_t: 0.0670
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   Median_HL: 0.0566
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   PM: 0.0553
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   variation_t: 0.0525
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   TVV: 0.0515
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   Volatility: 0.0509
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   ret: 0.0496
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   SK: 0.0485
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   HL: 0.0386
2025-05-19 23:23:57,164 - INFO - [src.data_preparation] -   SR: 0.0359
2025-05-19 23:23:57,167 - INFO - [src.data_preparation] - Ticker VTI - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 'ma7_t', 'ATR', 's_d7_t', 'Median_HL', 'PM', 'variation_t', 'TVV', 'Volatility', 'ret', 'SK', 'HL', 'SR']
2025-05-19 23:23:57,258 - INFO - [src.data_preparation] - Ticker VTI - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:57,258 - INFO - [src.data_preparation] - Ticker VTI - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:57,260 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTI
2025-05-19 23:23:57,260 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:57,260 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(72), np.int64(1): np.int64(391)}
2025-05-19 23:23:57,260 - INFO - [src.data_preparation] - Generating 319 synthetic minority samples
2025-05-19 23:23:57,274 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (782, 13, 15), y shape: (782,)
2025-05-19 23:23:57,274 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(391), np.int64(1): np.int64(391)}
2025-05-19 23:23:57,278 - INFO - [src.data_preparation] - Ticker VTI - Final 3D shapes: X_train=(782, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:57,279 - INFO - [__main__] - Using best model for VTI: logistic_regression (F1: 0.8421)
2025-05-19 23:23:57,279 - INFO - [__main__] - Loading logistic_regression model for VTI...
2025-05-19 23:23:57,280 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:57,280 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:23:57,280 - INFO - [__main__] - Making predictions for VTI using logistic_regression
2025-05-19 23:23:57,280 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:57,281 - INFO - [__main__] - Successfully got last prediction for VTI
2025-05-19 23:23:57,281 - INFO - [__main__] - 
Processing ticker: VTL
2025-05-19 23:23:57,281 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:57,281 - INFO - [__main__] - Getting last prediction point for ticker: VTL
2025-05-19 23:23:57,281 - INFO - [__main__] - ==================================================
2025-05-19 23:23:57,281 - INFO - [__main__] - Preparing test data for VTL...
2025-05-19 23:23:57,318 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:57,318 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:57,319 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:57,340 - INFO - [src.data_preparation] - Ticker VTL - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:57,340 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(121), np.int64(1): np.int64(517)}
2025-05-19 23:23:57,589 - INFO - [src.data_preparation] - Ticker VTL - Selected features:
2025-05-19 23:23:57,589 - INFO - [src.data_preparation] -   vnipc_t: 0.1158
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   ATR: 0.0861
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   Volatility: 0.0818
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   ma14_t: 0.0803
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   ma21_t: 0.0800
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   s_d7_t: 0.0771
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   ma7_t: 0.0682
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   TVV: 0.0665
2025-05-19 23:23:57,590 - INFO - [src.data_preparation] -   PM: 0.0561
2025-05-19 23:23:57,591 - INFO - [src.data_preparation] -   Median_HL: 0.0521
2025-05-19 23:23:57,591 - INFO - [src.data_preparation] -   SK: 0.0481
2025-05-19 23:23:57,591 - INFO - [src.data_preparation] -   SR: 0.0383
2025-05-19 23:23:57,591 - INFO - [src.data_preparation] -   insec_t: 0.0366
2025-05-19 23:23:57,591 - INFO - [src.data_preparation] -   HL: 0.0359
2025-05-19 23:23:57,591 - INFO - [src.data_preparation] -   ret: 0.0264
2025-05-19 23:23:57,593 - INFO - [src.data_preparation] - Ticker VTL - Using features: ['Date', 'vnipc_t', 'ATR', 'Volatility', 'ma14_t', 'ma21_t', 's_d7_t', 'ma7_t', 'TVV', 'PM', 'Median_HL', 'SK', 'SR', 'insec_t', 'HL', 'ret']
2025-05-19 23:23:57,690 - INFO - [src.data_preparation] - Ticker VTL - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:23:57,690 - INFO - [src.data_preparation] - Ticker VTL - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:57,693 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTL
2025-05-19 23:23:57,694 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:57,694 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(76), np.int64(1): np.int64(387)}
2025-05-19 23:23:57,694 - INFO - [src.data_preparation] - Generating 311 synthetic minority samples
2025-05-19 23:23:57,718 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (774, 13, 15), y shape: (774,)
2025-05-19 23:23:57,719 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(387), np.int64(1): np.int64(387)}
2025-05-19 23:23:57,725 - INFO - [src.data_preparation] - Ticker VTL - Final 3D shapes: X_train=(774, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:57,726 - INFO - [__main__] - Using best model for VTL: transformer (F1: 0.8378)
2025-05-19 23:23:57,726 - INFO - [__main__] - Loading transformer model for VTL...
2025-05-19 23:23:57,738 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:23:57,742 - INFO - [__main__] - Model size: 0.11 MB
2025-05-19 23:23:57,743 - INFO - [__main__] - Making predictions for VTL using transformer
2025-05-19 23:23:57,745 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:57,745 - INFO - [__main__] - Successfully got last prediction for VTL
2025-05-19 23:23:57,745 - INFO - [__main__] - 
Processing ticker: VTO
2025-05-19 23:23:57,745 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:57,745 - INFO - [__main__] - Getting last prediction point for ticker: VTO
2025-05-19 23:23:57,747 - INFO - [__main__] - ==================================================
2025-05-19 23:23:57,747 - INFO - [__main__] - Preparing test data for VTO...
2025-05-19 23:23:57,807 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:57,808 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:57,808 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:57,843 - INFO - [src.data_preparation] - Ticker VTO - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:57,843 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(283), np.int64(1): np.int64(356)}
2025-05-19 23:23:58,320 - INFO - [src.data_preparation] - Ticker VTO - Selected features:
2025-05-19 23:23:58,320 - INFO - [src.data_preparation] -   vnipc_t: 0.0781
2025-05-19 23:23:58,320 - INFO - [src.data_preparation] -   Volatility: 0.0767
2025-05-19 23:23:58,320 - INFO - [src.data_preparation] -   SK: 0.0761
2025-05-19 23:23:58,320 - INFO - [src.data_preparation] -   insec_t: 0.0758
2025-05-19 23:23:58,320 - INFO - [src.data_preparation] -   s_d7_t: 0.0659
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   ATR: 0.0637
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   TVV: 0.0619
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   ret: 0.0547
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   variation_t: 0.0526
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   HL: 0.0515
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   ma21_t: 0.0514
2025-05-19 23:23:58,321 - INFO - [src.data_preparation] -   LO: 0.0508
2025-05-19 23:23:58,322 - INFO - [src.data_preparation] -   ma14_t: 0.0499
2025-05-19 23:23:58,322 - INFO - [src.data_preparation] -   Median_HL: 0.0491
2025-05-19 23:23:58,322 - INFO - [src.data_preparation] -   ma7_t: 0.0485
2025-05-19 23:23:58,328 - INFO - [src.data_preparation] - Ticker VTO - Using features: ['Date', 'vnipc_t', 'Volatility', 'SK', 'insec_t', 's_d7_t', 'ATR', 'TVV', 'ret', 'variation_t', 'HL', 'ma21_t', 'LO', 'ma14_t', 'Median_HL', 'ma7_t']
2025-05-19 23:23:58,454 - INFO - [src.data_preparation] - Ticker VTO - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:58,454 - INFO - [src.data_preparation] - Ticker VTO - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:58,457 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTO
2025-05-19 23:23:58,457 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:58,458 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(199), np.int64(1): np.int64(264)}
2025-05-19 23:23:58,458 - INFO - [src.data_preparation] - Generating 65 synthetic minority samples
2025-05-19 23:23:58,462 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (528, 13, 15), y shape: (528,)
2025-05-19 23:23:58,462 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(264), np.int64(1): np.int64(264)}
2025-05-19 23:23:58,466 - INFO - [src.data_preparation] - Ticker VTO - Final 3D shapes: X_train=(528, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:58,467 - INFO - [__main__] - Using best model for VTO: transformer (F1: 0.4444)
2025-05-19 23:23:58,467 - INFO - [__main__] - Loading transformer model for VTO...
2025-05-19 23:23:58,488 - INFO - [__main__] - Model loaded in 0.02 seconds
2025-05-19 23:23:58,493 - INFO - [__main__] - Model size: 0.25 MB
2025-05-19 23:23:58,493 - INFO - [__main__] - Making predictions for VTO using transformer
2025-05-19 23:23:58,496 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:58,496 - INFO - [__main__] - Successfully got last prediction for VTO
2025-05-19 23:23:58,496 - INFO - [__main__] - 
Processing ticker: VTS
2025-05-19 23:23:58,497 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:58,497 - INFO - [__main__] - Getting last prediction point for ticker: VTS
2025-05-19 23:23:58,497 - INFO - [__main__] - ==================================================
2025-05-19 23:23:58,497 - INFO - [__main__] - Preparing test data for VTS...
2025-05-19 23:23:58,579 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:58,579 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:58,579 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:58,610 - INFO - [src.data_preparation] - Ticker VTS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:58,610 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(155), np.int64(1): np.int64(484)}
2025-05-19 23:23:58,959 - INFO - [src.data_preparation] - Ticker VTS - Selected features:
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   vnipc_t: 0.0865
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   ma21_t: 0.0809
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   TVV: 0.0774
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   ma14_t: 0.0731
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   ma7_t: 0.0709
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   Volatility: 0.0671
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   PM: 0.0619
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   s_d7_t: 0.0614
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   ATR: 0.0604
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   SK: 0.0597
2025-05-19 23:23:58,960 - INFO - [src.data_preparation] -   Median_HL: 0.0570
2025-05-19 23:23:58,961 - INFO - [src.data_preparation] -   insec_t: 0.0428
2025-05-19 23:23:58,961 - INFO - [src.data_preparation] -   variation_t: 0.0426
2025-05-19 23:23:58,961 - INFO - [src.data_preparation] -   ret: 0.0425
2025-05-19 23:23:58,961 - INFO - [src.data_preparation] -   HL: 0.0367
2025-05-19 23:23:58,963 - INFO - [src.data_preparation] - Ticker VTS - Using features: ['Date', 'vnipc_t', 'ma21_t', 'TVV', 'ma14_t', 'ma7_t', 'Volatility', 'PM', 's_d7_t', 'ATR', 'SK', 'Median_HL', 'insec_t', 'variation_t', 'ret', 'HL']
2025-05-19 23:23:59,082 - INFO - [src.data_preparation] - Ticker VTS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:59,083 - INFO - [src.data_preparation] - Ticker VTS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:59,084 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTS
2025-05-19 23:23:59,084 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:59,085 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(117), np.int64(1): np.int64(346)}
2025-05-19 23:23:59,085 - INFO - [src.data_preparation] - Generating 229 synthetic minority samples
2025-05-19 23:23:59,098 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (692, 13, 15), y shape: (692,)
2025-05-19 23:23:59,098 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(346), np.int64(1): np.int64(346)}
2025-05-19 23:23:59,104 - INFO - [src.data_preparation] - Ticker VTS - Final 3D shapes: X_train=(692, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:59,104 - INFO - [__main__] - Using best model for VTS: svm (F1: 0.8718)
2025-05-19 23:23:59,104 - INFO - [__main__] - Loading svm model for VTS...
2025-05-19 23:23:59,107 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:59,108 - INFO - [__main__] - Model size: 1.04 MB
2025-05-19 23:23:59,108 - INFO - [__main__] - Making predictions for VTS using svm
2025-05-19 23:23:59,109 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:59,109 - INFO - [__main__] - Successfully got last prediction for VTS
2025-05-19 23:23:59,109 - INFO - [__main__] - 
Processing ticker: VTV
2025-05-19 23:23:59,110 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:59,110 - INFO - [__main__] - Getting last prediction point for ticker: VTV
2025-05-19 23:23:59,110 - INFO - [__main__] - ==================================================
2025-05-19 23:23:59,110 - INFO - [__main__] - Preparing test data for VTV...
2025-05-19 23:23:59,148 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:23:59,148 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:59,148 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:59,191 - INFO - [src.data_preparation] - Ticker VTV - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:23:59,192 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:23:59,638 - INFO - [src.data_preparation] - Ticker VTV - Selected features:
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   Volatility: 0.0702
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   vnipc_t: 0.0697
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   ATR: 0.0672
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   HL: 0.0660
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   ma21_t: 0.0638
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   insec_t: 0.0635
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   s_d7_t: 0.0615
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   TVV: 0.0582
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   SK: 0.0581
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   ma14_t: 0.0580
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   variation_t: 0.0574
2025-05-19 23:23:59,639 - INFO - [src.data_preparation] -   ret: 0.0570
2025-05-19 23:23:59,640 - INFO - [src.data_preparation] -   ma7_t: 0.0525
2025-05-19 23:23:59,640 - INFO - [src.data_preparation] -   SR: 0.0499
2025-05-19 23:23:59,640 - INFO - [src.data_preparation] -   LO: 0.0497
2025-05-19 23:23:59,643 - INFO - [src.data_preparation] - Ticker VTV - Using features: ['Date', 'Volatility', 'vnipc_t', 'ATR', 'HL', 'ma21_t', 'insec_t', 's_d7_t', 'TVV', 'SK', 'ma14_t', 'variation_t', 'ret', 'ma7_t', 'SR', 'LO']
2025-05-19 23:23:59,750 - INFO - [src.data_preparation] - Ticker VTV - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:23:59,751 - INFO - [src.data_preparation] - Ticker VTV - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:59,753 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VTV
2025-05-19 23:23:59,753 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:23:59,754 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(196), np.int64(1): np.int64(267)}
2025-05-19 23:23:59,754 - INFO - [src.data_preparation] - Generating 71 synthetic minority samples
2025-05-19 23:23:59,759 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (534, 13, 15), y shape: (534,)
2025-05-19 23:23:59,759 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(267), np.int64(1): np.int64(267)}
2025-05-19 23:23:59,763 - INFO - [src.data_preparation] - Ticker VTV - Final 3D shapes: X_train=(534, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:23:59,763 - INFO - [__main__] - Using best model for VTV: svm (F1: 0.6667)
2025-05-19 23:23:59,763 - INFO - [__main__] - Loading svm model for VTV...
2025-05-19 23:23:59,765 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:23:59,766 - INFO - [__main__] - Model size: 0.81 MB
2025-05-19 23:23:59,766 - INFO - [__main__] - Making predictions for VTV using svm
2025-05-19 23:23:59,767 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:23:59,767 - INFO - [__main__] - Successfully got last prediction for VTV
2025-05-19 23:23:59,767 - INFO - [__main__] - 
Processing ticker: VXB
2025-05-19 23:23:59,768 - INFO - [__main__] - 
==================================================
2025-05-19 23:23:59,768 - INFO - [__main__] - Getting last prediction point for ticker: VXB
2025-05-19 23:23:59,768 - INFO - [__main__] - ==================================================
2025-05-19 23:23:59,768 - INFO - [__main__] - Preparing test data for VXB...
2025-05-19 23:23:59,805 - INFO - [src.data_preparation] - After processing - X shape: (638, 19), y shape: (638,)
2025-05-19 23:23:59,805 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:23:59,805 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:23:59,833 - INFO - [src.data_preparation] - Ticker VXB - Original shapes: X=(638, 18), y=(638,)
2025-05-19 23:23:59,833 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(153), np.int64(1): np.int64(485)}
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] - Ticker VXB - Selected features:
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   vnipc_t: 0.0951
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   ma21_t: 0.0829
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   ma14_t: 0.0765
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   s_d7_t: 0.0743
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   Volatility: 0.0696
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   ma7_t: 0.0691
2025-05-19 23:24:00,230 - INFO - [src.data_preparation] -   PM: 0.0605
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   Median_HL: 0.0596
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   ATR: 0.0591
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   TVV: 0.0564
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   SK: 0.0524
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   variation_t: 0.0456
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   ret: 0.0448
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   SR: 0.0425
2025-05-19 23:24:00,231 - INFO - [src.data_preparation] -   HL: 0.0387
2025-05-19 23:24:00,234 - INFO - [src.data_preparation] - Ticker VXB - Using features: ['Date', 'vnipc_t', 'ma21_t', 'ma14_t', 's_d7_t', 'Volatility', 'ma7_t', 'PM', 'Median_HL', 'ATR', 'TVV', 'SK', 'variation_t', 'ret', 'SR', 'HL']
2025-05-19 23:24:00,350 - INFO - [src.data_preparation] - Ticker VXB - 2D shapes: X_train=(463, 195), X_valid=(89, 195), X_test=(45, 195)
2025-05-19 23:24:00,351 - INFO - [src.data_preparation] - Ticker VXB - 3D shapes: X_train=(463, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:00,352 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker VXB
2025-05-19 23:24:00,352 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:24:00,353 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(104), np.int64(1): np.int64(359)}
2025-05-19 23:24:00,353 - INFO - [src.data_preparation] - Generating 255 synthetic minority samples
2025-05-19 23:24:00,365 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (718, 13, 15), y shape: (718,)
2025-05-19 23:24:00,365 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(359), np.int64(1): np.int64(359)}
2025-05-19 23:24:00,371 - INFO - [src.data_preparation] - Ticker VXB - Final 3D shapes: X_train=(718, 13, 15), X_valid=(89, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:00,372 - INFO - [__main__] - Using best model for VXB: svm (F1: 0.9398)
2025-05-19 23:24:00,372 - INFO - [__main__] - Loading svm model for VXB...
2025-05-19 23:24:00,373 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:24:00,373 - INFO - [__main__] - Model size: 1.08 MB
2025-05-19 23:24:00,373 - INFO - [__main__] - Making predictions for VXB using svm
2025-05-19 23:24:00,373 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:00,377 - INFO - [__main__] - Successfully got last prediction for VXB
2025-05-19 23:24:00,377 - INFO - [__main__] - 
Processing ticker: WCS
2025-05-19 23:24:00,377 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:00,378 - INFO - [__main__] - Getting last prediction point for ticker: WCS
2025-05-19 23:24:00,378 - INFO - [__main__] - ==================================================
2025-05-19 23:24:00,378 - INFO - [__main__] - Preparing test data for WCS...
2025-05-19 23:24:00,410 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:24:00,411 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:24:00,411 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:24:00,434 - INFO - [src.data_preparation] - Ticker WCS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:24:00,435 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(276), np.int64(1): np.int64(363)}
2025-05-19 23:24:00,826 - INFO - [src.data_preparation] - Ticker WCS - Selected features:
2025-05-19 23:24:00,826 - INFO - [src.data_preparation] -   vnipc_t: 0.0746
2025-05-19 23:24:00,826 - INFO - [src.data_preparation] -   TVV: 0.0723
2025-05-19 23:24:00,826 - INFO - [src.data_preparation] -   HL: 0.0654
2025-05-19 23:24:00,826 - INFO - [src.data_preparation] -   SK: 0.0649
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   ATR: 0.0647
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   insec_t: 0.0646
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   Volatility: 0.0642
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   SR: 0.0606
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   s_d7_t: 0.0580
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   variation_t: 0.0575
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   LO: 0.0569
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   ret: 0.0553
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   Median_HL: 0.0531
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   PM: 0.0492
2025-05-19 23:24:00,827 - INFO - [src.data_preparation] -   ma14_t: 0.0485
2025-05-19 23:24:00,830 - INFO - [src.data_preparation] - Ticker WCS - Using features: ['Date', 'vnipc_t', 'TVV', 'HL', 'SK', 'ATR', 'insec_t', 'Volatility', 'SR', 's_d7_t', 'variation_t', 'LO', 'ret', 'Median_HL', 'PM', 'ma14_t']
2025-05-19 23:24:00,924 - INFO - [src.data_preparation] - Ticker WCS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:24:00,924 - INFO - [src.data_preparation] - Ticker WCS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:00,927 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker WCS
2025-05-19 23:24:00,927 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:24:00,927 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(201), np.int64(1): np.int64(262)}
2025-05-19 23:24:00,927 - INFO - [src.data_preparation] - Generating 61 synthetic minority samples
2025-05-19 23:24:00,929 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (524, 13, 15), y shape: (524,)
2025-05-19 23:24:00,929 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(262), np.int64(1): np.int64(262)}
2025-05-19 23:24:00,933 - INFO - [src.data_preparation] - Ticker WCS - Final 3D shapes: X_train=(524, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:00,933 - INFO - [__main__] - Using best model for WCS: svm (F1: 0.7429)
2025-05-19 23:24:00,933 - INFO - [__main__] - Loading svm model for WCS...
2025-05-19 23:24:00,935 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:24:00,935 - INFO - [__main__] - Model size: 0.79 MB
2025-05-19 23:24:00,935 - INFO - [__main__] - Making predictions for WCS using svm
2025-05-19 23:24:00,935 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:00,937 - INFO - [__main__] - Successfully got last prediction for WCS
2025-05-19 23:24:00,937 - INFO - [__main__] - 
Processing ticker: WSB
2025-05-19 23:24:00,937 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:00,937 - INFO - [__main__] - Getting last prediction point for ticker: WSB
2025-05-19 23:24:00,938 - INFO - [__main__] - ==================================================
2025-05-19 23:24:00,938 - INFO - [__main__] - Preparing test data for WSB...
2025-05-19 23:24:00,969 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:24:00,969 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:24:00,969 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:24:00,990 - INFO - [src.data_preparation] - Ticker WSB - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:24:00,990 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(291), np.int64(1): np.int64(348)}
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] - Ticker WSB - Selected features:
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   vnipc_t: 0.0742
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   insec_t: 0.0676
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   TVV: 0.0670
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   SK: 0.0659
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   s_d7_t: 0.0610
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   HL: 0.0605
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   Volatility: 0.0594
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   variation_t: 0.0587
2025-05-19 23:24:01,332 - INFO - [src.data_preparation] -   ret: 0.0582
2025-05-19 23:24:01,333 - INFO - [src.data_preparation] -   LO: 0.0563
2025-05-19 23:24:01,333 - INFO - [src.data_preparation] -   SR: 0.0557
2025-05-19 23:24:01,333 - INFO - [src.data_preparation] -   ma21_t: 0.0549
2025-05-19 23:24:01,333 - INFO - [src.data_preparation] -   ma7_t: 0.0546
2025-05-19 23:24:01,333 - INFO - [src.data_preparation] -   ATR: 0.0534
2025-05-19 23:24:01,333 - INFO - [src.data_preparation] -   ma14_t: 0.0521
2025-05-19 23:24:01,335 - INFO - [src.data_preparation] - Ticker WSB - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'SK', 's_d7_t', 'HL', 'Volatility', 'variation_t', 'ret', 'LO', 'SR', 'ma21_t', 'ma7_t', 'ATR', 'ma14_t']
2025-05-19 23:24:01,430 - INFO - [src.data_preparation] - Ticker WSB - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:24:01,430 - INFO - [src.data_preparation] - Ticker WSB - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:01,432 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker WSB
2025-05-19 23:24:01,432 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:24:01,432 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(208), np.int64(1): np.int64(255)}
2025-05-19 23:24:01,432 - INFO - [src.data_preparation] - Generating 47 synthetic minority samples
2025-05-19 23:24:01,434 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (510, 13, 15), y shape: (510,)
2025-05-19 23:24:01,434 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(255), np.int64(1): np.int64(255)}
2025-05-19 23:24:01,438 - INFO - [src.data_preparation] - Ticker WSB - Final 3D shapes: X_train=(510, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:01,439 - INFO - [__main__] - Using best model for WSB: svm (F1: 0.7429)
2025-05-19 23:24:01,439 - INFO - [__main__] - Loading svm model for WSB...
2025-05-19 23:24:01,441 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:24:01,442 - INFO - [__main__] - Model size: 0.77 MB
2025-05-19 23:24:01,442 - INFO - [__main__] - Making predictions for WSB using svm
2025-05-19 23:24:01,443 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:01,443 - INFO - [__main__] - Successfully got last prediction for WSB
2025-05-19 23:24:01,443 - INFO - [__main__] - 
Processing ticker: WSS
2025-05-19 23:24:01,443 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:01,443 - INFO - [__main__] - Getting last prediction point for ticker: WSS
2025-05-19 23:24:01,443 - INFO - [__main__] - ==================================================
2025-05-19 23:24:01,443 - INFO - [__main__] - Preparing test data for WSS...
2025-05-19 23:24:01,478 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:24:01,478 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:24:01,478 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:24:01,497 - INFO - [src.data_preparation] - Ticker WSS - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:24:01,497 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(254), np.int64(1): np.int64(385)}
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] - Ticker WSS - Selected features:
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   vnipc_t: 0.0855
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   insec_t: 0.0736
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   TVV: 0.0704
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   Volatility: 0.0662
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   ma21_t: 0.0658
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   SK: 0.0645
2025-05-19 23:24:01,785 - INFO - [src.data_preparation] -   s_d7_t: 0.0638
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   Median_HL: 0.0600
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   ma14_t: 0.0598
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   PM: 0.0581
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   ma7_t: 0.0560
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   ret: 0.0542
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   variation_t: 0.0534
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   ATR: 0.0512
2025-05-19 23:24:01,786 - INFO - [src.data_preparation] -   SR: 0.0416
2025-05-19 23:24:01,789 - INFO - [src.data_preparation] - Ticker WSS - Using features: ['Date', 'vnipc_t', 'insec_t', 'TVV', 'Volatility', 'ma21_t', 'SK', 's_d7_t', 'Median_HL', 'ma14_t', 'PM', 'ma7_t', 'ret', 'variation_t', 'ATR', 'SR']
2025-05-19 23:24:01,884 - INFO - [src.data_preparation] - Ticker WSS - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:24:01,885 - INFO - [src.data_preparation] - Ticker WSS - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:01,886 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker WSS
2025-05-19 23:24:01,886 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:24:01,886 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(175), np.int64(1): np.int64(288)}
2025-05-19 23:24:01,886 - INFO - [src.data_preparation] - Generating 113 synthetic minority samples
2025-05-19 23:24:01,892 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (576, 13, 15), y shape: (576,)
2025-05-19 23:24:01,892 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(288), np.int64(1): np.int64(288)}
2025-05-19 23:24:01,896 - INFO - [src.data_preparation] - Ticker WSS - Final 3D shapes: X_train=(576, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:01,896 - INFO - [__main__] - Using best model for WSS: lstm (F1: 0.8525)
2025-05-19 23:24:01,896 - INFO - [__main__] - Loading lstm model for WSS...
2025-05-19 23:24:01,900 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:24:01,901 - INFO - [__main__] - Model size: 0.06 MB
2025-05-19 23:24:01,901 - INFO - [__main__] - Making predictions for WSS using lstm
2025-05-19 23:24:01,902 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:01,902 - INFO - [__main__] - Successfully got last prediction for WSS
2025-05-19 23:24:01,902 - INFO - [__main__] - 
Processing ticker: WTC
2025-05-19 23:24:01,903 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:01,903 - INFO - [__main__] - Getting last prediction point for ticker: WTC
2025-05-19 23:24:01,903 - INFO - [__main__] - ==================================================
2025-05-19 23:24:01,903 - INFO - [__main__] - Preparing test data for WTC...
2025-05-19 23:24:01,944 - INFO - [src.data_preparation] - After processing - X shape: (639, 19), y shape: (639,)
2025-05-19 23:24:01,944 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:24:01,944 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:24:01,964 - INFO - [src.data_preparation] - Ticker WTC - Original shapes: X=(639, 18), y=(639,)
2025-05-19 23:24:01,964 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(159), np.int64(1): np.int64(480)}
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] - Ticker WTC - Selected features:
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   Median_HL: 0.0921
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   ma14_t: 0.0824
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   ma21_t: 0.0779
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   vnipc_t: 0.0777
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   ATR: 0.0709
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   HL: 0.0639
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   PM: 0.0629
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   SK: 0.0572
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   insec_t: 0.0569
2025-05-19 23:24:02,295 - INFO - [src.data_preparation] -   s_d7_t: 0.0553
2025-05-19 23:24:02,296 - INFO - [src.data_preparation] -   TVV: 0.0525
2025-05-19 23:24:02,296 - INFO - [src.data_preparation] -   ma7_t: 0.0506
2025-05-19 23:24:02,296 - INFO - [src.data_preparation] -   Volatility: 0.0440
2025-05-19 23:24:02,296 - INFO - [src.data_preparation] -   ret: 0.0374
2025-05-19 23:24:02,296 - INFO - [src.data_preparation] -   SR: 0.0371
2025-05-19 23:24:02,299 - INFO - [src.data_preparation] - Ticker WTC - Using features: ['Date', 'Median_HL', 'ma14_t', 'ma21_t', 'vnipc_t', 'ATR', 'HL', 'PM', 'SK', 'insec_t', 's_d7_t', 'TVV', 'ma7_t', 'Volatility', 'ret', 'SR']
2025-05-19 23:24:02,407 - INFO - [src.data_preparation] - Ticker WTC - 2D shapes: X_train=(463, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:24:02,407 - INFO - [src.data_preparation] - Ticker WTC - 3D shapes: X_train=(463, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:02,411 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker WTC
2025-05-19 23:24:02,411 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (463, 13, 15), y shape: (463,)
2025-05-19 23:24:02,411 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(71), np.int64(1): np.int64(392)}
2025-05-19 23:24:02,411 - INFO - [src.data_preparation] - Generating 321 synthetic minority samples
2025-05-19 23:24:02,427 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (784, 13, 15), y shape: (784,)
2025-05-19 23:24:02,427 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(392), np.int64(1): np.int64(392)}
2025-05-19 23:24:02,433 - INFO - [src.data_preparation] - Ticker WTC - Final 3D shapes: X_train=(784, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:02,433 - INFO - [__main__] - Using best model for WTC: logistic_regression (F1: 0.4571)
2025-05-19 23:24:02,433 - INFO - [__main__] - Loading logistic_regression model for WTC...
2025-05-19 23:24:02,434 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:24:02,434 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:24:02,434 - INFO - [__main__] - Making predictions for WTC using logistic_regression
2025-05-19 23:24:02,435 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:02,435 - INFO - [__main__] - Successfully got last prediction for WTC
2025-05-19 23:24:02,435 - INFO - [__main__] - 
Processing ticker: XMC
2025-05-19 23:24:02,435 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:02,435 - INFO - [__main__] - Getting last prediction point for ticker: XMC
2025-05-19 23:24:02,435 - INFO - [__main__] - ==================================================
2025-05-19 23:24:02,435 - INFO - [__main__] - Preparing test data for XMC...
2025-05-19 23:24:02,479 - INFO - [src.data_preparation] - After processing - X shape: (350, 19), y shape: (350,)
2025-05-19 23:24:02,480 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:24:02,480 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:24:02,499 - INFO - [src.data_preparation] - Ticker XMC - Original shapes: X=(350, 18), y=(350,)
2025-05-19 23:24:02,500 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(177), np.int64(1): np.int64(173)}
2025-05-19 23:24:02,734 - INFO - [src.data_preparation] - Ticker XMC - Selected features:
2025-05-19 23:24:02,734 - INFO - [src.data_preparation] -   SK: 0.0738
2025-05-19 23:24:02,734 - INFO - [src.data_preparation] -   insec_t: 0.0706
2025-05-19 23:24:02,734 - INFO - [src.data_preparation] -   ma14_t: 0.0687
2025-05-19 23:24:02,734 - INFO - [src.data_preparation] -   vnipc_t: 0.0681
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   Volatility: 0.0666
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   TVV: 0.0623
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   Median_HL: 0.0590
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   PM: 0.0581
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   ATR: 0.0553
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   s_d7_t: 0.0550
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   SR: 0.0550
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   ret: 0.0541
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   variation_t: 0.0531
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   ma21_t: 0.0529
2025-05-19 23:24:02,735 - INFO - [src.data_preparation] -   ma7_t: 0.0519
2025-05-19 23:24:02,738 - INFO - [src.data_preparation] - Ticker XMC - Using features: ['Date', 'SK', 'insec_t', 'ma14_t', 'vnipc_t', 'Volatility', 'TVV', 'Median_HL', 'PM', 'ATR', 's_d7_t', 'SR', 'ret', 'variation_t', 'ma21_t', 'ma7_t']
2025-05-19 23:24:02,801 - INFO - [src.data_preparation] - Ticker XMC - 2D shapes: X_train=(174, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:24:02,801 - INFO - [src.data_preparation] - Ticker XMC - 3D shapes: X_train=(174, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:02,802 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker XMC
2025-05-19 23:24:02,802 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (174, 13, 15), y shape: (174,)
2025-05-19 23:24:02,802 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(89), np.int64(1): np.int64(85)}
2025-05-19 23:24:02,802 - INFO - [src.data_preparation] - Generating 4 synthetic minority samples
2025-05-19 23:24:02,802 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (178, 13, 15), y shape: (178,)
2025-05-19 23:24:02,802 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(89), np.int64(1): np.int64(89)}
2025-05-19 23:24:02,807 - INFO - [src.data_preparation] - Ticker XMC - Final 3D shapes: X_train=(178, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:02,807 - INFO - [__main__] - Using best model for XMC: lstm (F1: 0.6462)
2025-05-19 23:24:02,807 - INFO - [__main__] - Loading lstm model for XMC...
2025-05-19 23:24:02,815 - INFO - [__main__] - Model loaded in 0.01 seconds
2025-05-19 23:24:02,816 - INFO - [__main__] - Model size: 0.04 MB
2025-05-19 23:24:02,816 - INFO - [__main__] - Making predictions for XMC using lstm
2025-05-19 23:24:02,818 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:02,818 - INFO - [__main__] - Successfully got last prediction for XMC
2025-05-19 23:24:02,819 - INFO - [__main__] - 
Processing ticker: YBC
2025-05-19 23:24:02,819 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:02,819 - INFO - [__main__] - Getting last prediction point for ticker: YBC
2025-05-19 23:24:02,819 - INFO - [__main__] - ==================================================
2025-05-19 23:24:02,820 - INFO - [__main__] - Preparing test data for YBC...
2025-05-19 23:24:02,872 - INFO - [src.data_preparation] - After processing - X shape: (636, 19), y shape: (636,)
2025-05-19 23:24:02,873 - INFO - [src.data_preparation] - Last row target value: 0
2025-05-19 23:24:02,873 - INFO - [src.data_preparation] - 
Selecting top 15 features for each ticker using Random Forest
2025-05-19 23:24:02,910 - INFO - [src.data_preparation] - Ticker YBC - Original shapes: X=(636, 18), y=(636,)
2025-05-19 23:24:02,911 - INFO - [src.data_preparation] - Class distribution: {np.int64(0): np.int64(133), np.int64(1): np.int64(503)}
2025-05-19 23:24:03,230 - INFO - [src.data_preparation] - Ticker YBC - Selected features:
2025-05-19 23:24:03,230 - INFO - [src.data_preparation] -   ma21_t: 0.0986
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   vnipc_t: 0.0939
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   ma14_t: 0.0875
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   Volatility: 0.0817
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   ma7_t: 0.0646
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   s_d7_t: 0.0609
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   TVV: 0.0597
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   PM: 0.0561
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   ATR: 0.0542
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   Median_HL: 0.0522
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   SK: 0.0490
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   HL: 0.0453
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   ret: 0.0390
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   variation_t: 0.0354
2025-05-19 23:24:03,231 - INFO - [src.data_preparation] -   insec_t: 0.0347
2025-05-19 23:24:03,234 - INFO - [src.data_preparation] - Ticker YBC - Using features: ['Date', 'ma21_t', 'vnipc_t', 'ma14_t', 'Volatility', 'ma7_t', 's_d7_t', 'TVV', 'PM', 'ATR', 'Median_HL', 'SK', 'HL', 'ret', 'variation_t', 'insec_t']
2025-05-19 23:24:03,333 - INFO - [src.data_preparation] - Ticker YBC - 2D shapes: X_train=(460, 195), X_valid=(90, 195), X_test=(45, 195)
2025-05-19 23:24:03,334 - INFO - [src.data_preparation] - Ticker YBC - 3D shapes: X_train=(460, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:03,335 - INFO - [src.data_preparation] - Applying TimeSeriesSMOTE for ticker YBC
2025-05-19 23:24:03,335 - INFO - [src.data_preparation] - Before SMOTE - X_3d shape: (460, 13, 15), y shape: (460,)
2025-05-19 23:24:03,335 - INFO - [src.data_preparation] - Class distribution before SMOTE: {np.int64(0): np.int64(76), np.int64(1): np.int64(384)}
2025-05-19 23:24:03,335 - INFO - [src.data_preparation] - Generating 308 synthetic minority samples
2025-05-19 23:24:03,350 - INFO - [src.data_preparation] - After TimeSeriesSMOTE - X_3d shape: (768, 13, 15), y shape: (768,)
2025-05-19 23:24:03,350 - INFO - [src.data_preparation] - Class distribution after TimeSeriesSMOTE: {np.int64(0): np.int64(384), np.int64(1): np.int64(384)}
2025-05-19 23:24:03,354 - INFO - [src.data_preparation] - Ticker YBC - Final 3D shapes: X_train=(768, 13, 15), X_valid=(90, 13, 15), X_test=(45, 13, 15)
2025-05-19 23:24:03,355 - INFO - [__main__] - Using best model for YBC: logistic_regression (F1: 0.5652)
2025-05-19 23:24:03,355 - INFO - [__main__] - Loading logistic_regression model for YBC...
2025-05-19 23:24:03,356 - INFO - [__main__] - Model loaded in 0.00 seconds
2025-05-19 23:24:03,356 - INFO - [__main__] - Model size: 0.00 MB
2025-05-19 23:24:03,356 - INFO - [__main__] - Making predictions for YBC using logistic_regression
2025-05-19 23:24:03,356 - INFO - [__main__] - Prediction completed in 0.00 seconds
2025-05-19 23:24:03,357 - INFO - [__main__] - Successfully got last prediction for YBC
2025-05-19 23:24:03,395 - INFO - [__main__] - 
Saved last points to inferences\20250519_231756\all_last_points.json and inferences\20250519_231756\all_last_points.csv
2025-05-19 23:24:03,395 - INFO - [__main__] - Total predictions: 714
2025-05-19 23:24:03,395 - INFO - [__main__] - 
==================================================
2025-05-19 23:24:03,395 - INFO - [__main__] - FINAL INFERENCE SUMMARY
2025-05-19 23:24:03,395 - INFO - [__main__] - ==================================================
2025-05-19 23:24:03,395 - INFO - [__main__] - Total tickers: 714
2025-05-19 23:24:03,395 - INFO - [__main__] - Successful predictions: 714
2025-05-19 23:24:03,395 - INFO - [__main__] - Failed predictions: 0
